<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="4.3.0">Jekyll</generator><link href="http://localhost:4000/feed.xml" rel="self" type="application/atom+xml" /><link href="http://localhost:4000/" rel="alternate" type="text/html" /><updated>2022-11-22T20:17:51+09:00</updated><id>http://localhost:4000/feed.xml</id><title type="html">LeeJellan</title><subtitle>ì•ˆë…•í•˜ì„¸ìš”!ğŸ™‚ IT,ì—¬í–‰,ê¸°íƒ€ ë“± ê¸°ë¡ì„ ë‚¨ê¸°ê¸°ìœ„í•œ ë¸”ë¡œê·¸ ì…ë‹ˆë‹¤ !</subtitle><author><name>LEE JAEHYEOK</name></author><entry><title type="html">TIL) Spring Security 3 (ê¶Œí•œë¶€ì—¬)</title><link href="http://localhost:4000/til/2022/11/22/til.html" rel="alternate" type="text/html" title="TIL) Spring Security 3 (ê¶Œí•œë¶€ì—¬)" /><published>2022-11-22T00:00:00+09:00</published><updated>2022-11-22T00:00:00+09:00</updated><id>http://localhost:4000/til/2022/11/22/til</id><content type="html" xml:base="http://localhost:4000/til/2022/11/22/til.html"><![CDATA[<p><img src="https://lh3.googleusercontent.com/u/0/drive-viewer/AFDK6gO-9XVEAUETJGFf5AjYCUCurD1z-9yBYl4hAKS_SdfBOSr5ac7uSAlI8PoCiXakOadLKWhnBi-RnF5XAFfKoh4ynbCMmQ=w1920-h921" alt="image" class="align-left" style="max-width: 100%" /></p>

<p>ì–´ì œ ê³µë¶€í–ˆë˜ Spring Security ì¸ì¦ì²˜ë¦¬ ê³¼ì •ì—ì„œëŒ€í•´<br />
ì½”ë“œë¥¼ ì°¾ì•„ê°€ë³´ë©´ì„œ ì–´ëŠì •ë„ ê¹¨ë‹¬ìŒì´ ìˆì–´ì„œ<br />
ì§„ì „ì´ ìˆëŠ” ëŠë‚Œì´ ë“¤ì–´ ì˜¤ëœë§Œì— í¸ì•ˆí•œ ë§ˆìŒìœ¼ë¡œ ê³µë¶€ë¥¼ í–ˆë‹¤.</p>

<p>ì˜¤ëŠ˜ì€ Spring Security ê¶Œí•œê´€ë ¨ Filterë¥¼ ê³µë¶€í•˜ëŠ” ë‚ ì´ê³ <br />
ì„¹ì…˜ ì¤‘ Spring SecurityëŠ” ë§ˆì§€ë§‰ì¸ ì‹œê°„ì´ë‹¤.</p>

<hr />

<p>ì–´ì œ <a href="https://mycatlikeschuru.github.io/til/2022/11/21/til.html">(Spring Security ì¸ì¦ì²˜ë¦¬)</a>ì— ëŒ€í•œ ë‚´ìš©ì„<br />
ì½”ë“œì™€ ì•„ì¼€í…ì³ë¥¼ í†µí•´ ì­‰ ì‚´í´ë³´ì•˜ë‹¤.</p>

<p>ì˜¤ëŠ˜ì€ ê¶Œí•œê³¼ ê´€ë ¨ëœ Filterì¸<br />
<code class="language-plaintext highlighter-rouge">AuthorizationFilter</code> í´ë˜ìŠ¤ì— ëŒ€í•œ ê¶Œí•œ ë¶€ì—¬ì˜<br />
ê°„ë‹¨í•œ ì²˜ë¦¬ íë¦„ê³¼ ì½”ë“œë¥¼ ì‚´í´ë³´ë ¤ê³ í•œë‹¤.</p>

<p><br /></p>

<h2 id="spring-security-ê¶Œí•œë¶€ì—¬">Spring Security ê¶Œí•œë¶€ì—¬</h2>

<p>ì–´ì œëŠ” ì¸ì¦ì²˜ë¦¬ì— ê´€ë ¨ëœ ë‚´ìš©ì„ ë°°ì› ë‹¤.<br />
ì¸ì¦ì´ë€ ì´ ì‚¬ì´íŠ¸ë¥¼ ì´ìš©í•  ìˆ˜ ìˆëŠ” ìœ ì €ì¸ì§€ í™•ì¸í•˜ëŠ” ê³¼ì •ì´ë‹¤.<br />
í•˜ì§€ë§Œ ê¶Œí•œë¶€ì—¬ëŠ” ë­˜ê¹Œ?</p>

<p>ì¸ì¦ëœ ì‚¬ìš©ìê°€ ëª¨ë“  ë¦¬ì†ŒìŠ¤ì— ì ‘ê·¼ì„ ì œí•œí•˜ëŠ” ê²ƒì„ ë§í•œë‹¤. <br />
í—¤ë”© ì‚¬ìš©ìê°€ ì´ìš©í•  ìˆ˜ ìˆëŠ” ë¦¬ì†ŒìŠ¤ë¥¼ ì œí•œí•˜ê±°ë‚˜ í’€ì–´ì£¼ëŠ” ê²ƒì„<br />
ê¶Œí•œ ë¶€ì—¬ë¼ê³  í•œë‹¤.</p>

<p><br /></p>

<h3 id="ê¶Œí•œë¶€ì—¬-ì²˜ë¦¬íë¦„">ê¶Œí•œë¶€ì—¬ ì²˜ë¦¬íë¦„</h3>

<p><strong>AuthorizationFilter</strong></p>

<p><img src="https://lh3.googleusercontent.com/u/0/drive-viewer/AFDK6gOQXGNO9jp7S5n8BR1acug8wbYP2K5CODLz3E8JL1OYltFHyEMNavYMMn7otGOC4UHR5N_85NhELKDMT5Cm9oKCeMjE=w1920-h921" alt="image" class="align-left" style="max-width: 100%" /></p>

<p>Spring Securityì—ì„œëŠ” ê¶Œí•œ ë¶€ì—¬ë¥¼ ìœ„í•´<br />
<code class="language-plaintext highlighter-rouge">AuthorizationFilter</code> í´ë˜ìŠ¤ë¥¼ ì´ìš©í•´ ì²˜ë¦¬ë¥¼ í•œë‹¤.</p>

<p>SecurityFilterChainì„ êµ¬ì„±í•˜ëŠ” Filter ì¤‘ í•˜ë‚˜ë¡œ<br />
ì¸ì¦ Filterë¥¼ ê±°ì¹œ í›„ ì§„í–‰í•˜ê²Œ ë˜ì–´ì§„ë‹¤.<br />
ë³¸ê²©ì ìœ¼ë¡œ <code class="language-plaintext highlighter-rouge">AuthorizationFilter</code>ì˜ ê¶Œí•œì²˜ë¦¬ íë¦„ì„ ì•Œì•„ë³´ì</p>

<p><br /></p>

<p>(1). <code class="language-plaintext highlighter-rouge">SecurityContextHolder</code>ë¡œ ë¶€í„° <code class="language-plaintext highlighter-rouge">Authentication</code> ê°ì±„ë¥¼ ê°€ì ¸ì˜¨ë‹¤.<br />
<a href="https://mycatlikeschuru.github.io/til/2022/11/21/til.html">(Spring Security ì¸ì¦ì²˜ë¦¬)</a> ê³¼ì •ì—ì„œ ì¸ì¦ì´ ì™„ë£Œëœ ê°ì²´ <code class="language-plaintext highlighter-rouge">Authentication</code>ë¥¼ <br />
<code class="language-plaintext highlighter-rouge">SecurityContextHolder</code>ì— ë„£ì–´ì¤¬ë˜ íë¦„ì´ ì¸ì¦ì²˜ë¦¬ì˜ ë§ˆì§€ë§‰ì´ì–´ì—ˆë‹¤.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">AuthorizationFilter</span> <span class="kd">extends</span> <span class="nc">OncePerRequestFilter</span> <span class="o">{</span>
    
    <span class="o">...</span> <span class="n">ì´ìƒ</span> <span class="n">ìƒëµ</span>
    
    <span class="kd">private</span> <span class="nc">Authentication</span> <span class="nf">getAuthentication</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">Authentication</span> <span class="n">authentication</span> <span class="o">=</span> <span class="nc">SecurityContextHolder</span><span class="o">.</span><span class="na">getContext</span><span class="o">().</span><span class="na">getAuthentication</span><span class="o">();</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">authentication</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">AuthenticationCredentialsNotFoundException</span><span class="o">(</span>
                    <span class="s">"An Authentication object was not found in the SecurityContext"</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="n">authentication</span><span class="o">;</span>
    <span class="o">}</span>
    
    <span class="o">...</span> <span class="n">ì´í•˜</span> <span class="n">ìƒëµ</span>
            
<span class="o">}</span>
</code></pre></div></div>
<p>ì‹¤ì œë¡œ <code class="language-plaintext highlighter-rouge">AuthorizationFilter</code> í´ë˜ìŠ¤ ì½”ë“œ ì¤‘ <code class="language-plaintext highlighter-rouge">getAuthentication();</code> ë©”ì„œë“œë¥¼ ì´ìš©í•´  <br />
<code class="language-plaintext highlighter-rouge">Authentication</code> ê°ì²´ë¥¼ êº¼ë‚´ëŠ” ëª¨ìŠµì„ ì½”ë“œë¡œ ë³¼ ìˆ˜ ìˆë‹¤.</p>

<p><br /></p>

<p>(2). <code class="language-plaintext highlighter-rouge">Authentication</code> ê°ì²´ì™€ <code class="language-plaintext highlighter-rouge">HttpServletRequest</code> ê°ì²´ë¥¼<br />
<code class="language-plaintext highlighter-rouge">AuthorizationManager</code>ì—ê²Œ ì „ë‹¬í•œë‹¤.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">AuthorizationFilter</span> <span class="kd">extends</span> <span class="nc">OncePerRequestFilter</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="kd">final</span> <span class="nc">AuthorizationManager</span><span class="o">&lt;</span><span class="nc">HttpServletRequest</span><span class="o">&gt;</span> <span class="n">authorizationManager</span><span class="o">;</span>
     
    <span class="o">...</span> <span class="n">ìƒëµ</span>
    
    <span class="kd">public</span> <span class="nf">AuthorizationFilter</span><span class="o">(</span><span class="nc">AuthorizationManager</span><span class="o">&lt;</span><span class="nc">HttpServletRequest</span><span class="o">&gt;</span> <span class="n">authorizationManager</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">Assert</span><span class="o">.</span><span class="na">notNull</span><span class="o">(</span><span class="n">authorizationManager</span><span class="o">,</span> <span class="s">"authorizationManager cannot be null"</span><span class="o">);</span>
        <span class="k">this</span><span class="o">.</span><span class="na">authorizationManager</span> <span class="o">=</span> <span class="n">authorizationManager</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">doFilterInternal</span><span class="o">(</span><span class="nc">HttpServletRequest</span> <span class="n">request</span><span class="o">,</span> <span class="nc">HttpServletResponse</span> <span class="n">response</span><span class="o">,</span> <span class="nc">FilterChain</span> <span class="n">filterChain</span><span class="o">)</span>
            <span class="kd">throws</span> <span class="nc">ServletException</span><span class="o">,</span> <span class="nc">IOException</span> <span class="o">{</span>

        <span class="nc">AuthorizationDecision</span> <span class="n">decision</span> <span class="o">=</span> <span class="k">this</span><span class="o">.</span><span class="na">authorizationManager</span><span class="o">.</span><span class="na">check</span><span class="o">(</span><span class="k">this</span><span class="o">::</span><span class="n">getAuthentication</span><span class="o">,</span> <span class="n">request</span><span class="o">);</span>
        <span class="k">this</span><span class="o">.</span><span class="na">eventPublisher</span><span class="o">.</span><span class="na">publishAuthorizationEvent</span><span class="o">(</span><span class="k">this</span><span class="o">::</span><span class="n">getAuthentication</span><span class="o">,</span> <span class="n">request</span><span class="o">,</span> <span class="n">decision</span><span class="o">);</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">decision</span> <span class="o">!=</span> <span class="kc">null</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">decision</span><span class="o">.</span><span class="na">isGranted</span><span class="o">())</span> <span class="o">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">AccessDeniedException</span><span class="o">(</span><span class="s">"Access Denied"</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="n">filterChain</span><span class="o">.</span><span class="na">doFilter</span><span class="o">(</span><span class="n">request</span><span class="o">,</span> <span class="n">response</span><span class="o">);</span>
    <span class="o">}</span>
    
    <span class="o">...</span> <span class="n">ì´í•˜</span> <span class="n">ìƒëµ</span>

<span class="o">}</span>

</code></pre></div></div>
<p>ì‹¤ì œë¡œ ì½”ë“œë¥¼ í™•ì¸í•´ë³´ë©´<br />
ìƒì„±ìë¡œ AuthorizationManagerì˜ ê°ì²´ë¥¼ DIë°›ê³  ìˆë‹¤.<br />
ê·¸ë¦¬ê³  <code class="language-plaintext highlighter-rouge">.check(this::getAuthentication, request);</code> ë©”ì„œë“œë¥¼ í˜¸ì¶œí•´<br />
<code class="language-plaintext highlighter-rouge">Authentication</code>ì™€ <code class="language-plaintext highlighter-rouge">HttpServletRequest</code> ê°ì²´ë¥¼ ë§¤ê°œë³€ìˆ˜ë¡œ ë„˜ê²¨ì£¼ê³ ìˆë‹¤.</p>

<p><br /></p>

<p>(3). <code class="language-plaintext highlighter-rouge">AuthorizationManager</code>ëŠ” <br />
ê¶Œí•œ ë¶€ì—¬ ì²˜ë¦¬ë¥¼ ì´ê´„í•˜ëŠ” ë§¤ë‹ˆì € ì—­í• ì˜ ì¸í„°í˜ì´ìŠ¤ì´ë‹¤.<br />
êµ¬í˜„ì²´ëŠ”  <code class="language-plaintext highlighter-rouge">RequestMatcherDelegatingAuthorizationManager</code> í´ë˜ìŠ¤ì´ë‹¤.</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@FunctionalInterface</span>
<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">AuthorizationManager</span><span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;</span> <span class="o">{</span>
    
    <span class="o">...</span> <span class="n">ì´ìƒ</span> <span class="n">ìƒëµ</span>

	<span class="nd">@Nullable</span>
	<span class="nc">AuthorizationDecision</span> <span class="nf">check</span><span class="o">(</span><span class="nc">Supplier</span><span class="o">&lt;</span><span class="nc">Authentication</span><span class="o">&gt;</span> <span class="n">authentication</span><span class="o">,</span> <span class="no">T</span> <span class="n">object</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div></div>
<p>ì½”ë“œë¡œë„ ë³¼ ìˆ˜ ìˆë“¯ì´ ì¸í„°í˜ì´ìŠ¤ì— ë©”ì„œë“œê°€ ì •ì˜ë˜ì–´ìˆê³ </p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">final</span> <span class="kd">class</span> <span class="nc">RequestMatcherDelegatingAuthorizationManager</span> <span class="kd">implements</span> <span class="nc">AuthorizationManager</span><span class="o">&lt;</span><span class="nc">HttpServletRequest</span><span class="o">&gt;</span> <span class="o">{</span>

    <span class="o">...</span>
    <span class="n">ì´ìƒ</span> <span class="n">ìƒëµ</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="nc">AuthorizationDecision</span> <span class="nf">check</span><span class="o">(</span><span class="nc">Supplier</span><span class="o">&lt;</span><span class="nc">Authentication</span><span class="o">&gt;</span> <span class="n">authentication</span><span class="o">,</span> <span class="nc">HttpServletRequest</span> <span class="n">request</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="na">logger</span><span class="o">.</span><span class="na">isTraceEnabled</span><span class="o">())</span> <span class="o">{</span>
            <span class="k">this</span><span class="o">.</span><span class="na">logger</span><span class="o">.</span><span class="na">trace</span><span class="o">(</span><span class="nc">LogMessage</span><span class="o">.</span><span class="na">format</span><span class="o">(</span><span class="s">"Authorizing %s"</span><span class="o">,</span> <span class="n">request</span><span class="o">));</span>
        <span class="o">}</span>
        <span class="k">for</span> <span class="o">(</span><span class="nc">RequestMatcherEntry</span><span class="o">&lt;</span><span class="nc">AuthorizationManager</span><span class="o">&lt;</span><span class="nc">RequestAuthorizationContext</span><span class="o">&gt;&gt;</span> <span class="n">mapping</span> <span class="o">:</span> <span class="k">this</span><span class="o">.</span><span class="na">mappings</span><span class="o">)</span> <span class="o">{</span>

            <span class="nc">RequestMatcher</span> <span class="n">matcher</span> <span class="o">=</span> <span class="n">mapping</span><span class="o">.</span><span class="na">getRequestMatcher</span><span class="o">();</span>
            <span class="nc">MatchResult</span> <span class="n">matchResult</span> <span class="o">=</span> <span class="n">matcher</span><span class="o">.</span><span class="na">matcher</span><span class="o">(</span><span class="n">request</span><span class="o">);</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">matchResult</span><span class="o">.</span><span class="na">isMatch</span><span class="o">())</span> <span class="o">{</span>
                <span class="nc">AuthorizationManager</span><span class="o">&lt;</span><span class="nc">RequestAuthorizationContext</span><span class="o">&gt;</span> <span class="n">manager</span> <span class="o">=</span> <span class="n">mapping</span><span class="o">.</span><span class="na">getEntry</span><span class="o">();</span>
                <span class="k">if</span> <span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="na">logger</span><span class="o">.</span><span class="na">isTraceEnabled</span><span class="o">())</span> <span class="o">{</span>
                    <span class="k">this</span><span class="o">.</span><span class="na">logger</span><span class="o">.</span><span class="na">trace</span><span class="o">(</span><span class="nc">LogMessage</span><span class="o">.</span><span class="na">format</span><span class="o">(</span><span class="s">"Checking authorization on %s using %s"</span><span class="o">,</span> <span class="n">request</span><span class="o">,</span> <span class="n">manager</span><span class="o">));</span>
                <span class="o">}</span>
                <span class="k">return</span> <span class="n">manager</span><span class="o">.</span><span class="na">check</span><span class="o">(</span><span class="n">authentication</span><span class="o">,</span>
                        <span class="k">new</span> <span class="nf">RequestAuthorizationContext</span><span class="o">(</span><span class="n">request</span><span class="o">,</span> <span class="n">matchResult</span><span class="o">.</span><span class="na">getVariables</span><span class="o">()));</span>
            <span class="o">}</span>
        <span class="o">}</span>
        <span class="k">this</span><span class="o">.</span><span class="na">logger</span><span class="o">.</span><span class="na">trace</span><span class="o">(</span><span class="s">"Abstaining since did not find matching RequestMatcher"</span><span class="o">);</span>
        <span class="k">return</span> <span class="kc">null</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="o">...</span> <span class="n">ì´í•˜</span> <span class="n">ìƒëµ</span>
            
<span class="o">}</span>
</code></pre></div></div>
<p>êµ¬í˜„ì²´ì¸ <code class="language-plaintext highlighter-rouge">RequestMatcherDelegatingAuthorizationManager</code> í´ë˜ìŠ¤ì—<br />
<code class="language-plaintext highlighter-rouge">check();</code>ë©”ì„œë“œê°€ Overrideë˜ì–´ ìˆëŠ” ëª¨ìŠµì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.</p>

<p><br /></p>

<p>(4),(5). ì´ì œ ì „ë‹¬ë°›ì€ ê°ì²´ë“¤ë¡œ <code class="language-plaintext highlighter-rouge">check();</code> ë©”ì„œë“œ ë‚´ë¶€ì—ì„œ<br />
ê¶Œí•œ ì²˜ë¦¬ì— ëŒ€í•œ ë¡œì§ì´ ìˆ˜í–‰ëœë‹¤.</p>

<ol>
  <li><code class="language-plaintext highlighter-rouge">RequestMatcherEntry</code> ì •ë³´ë¥¼ ì–»ì€ í›„ì— <code class="language-plaintext highlighter-rouge">RequestMatcher</code> ê°ì²´ë¥¼ ì–»ëŠ”ë‹¤.</li>
  <li><code class="language-plaintext highlighter-rouge">RequestMatcher</code> ê°ì²´ë¡œ <code class="language-plaintext highlighter-rouge">HttpServletRequest</code> ê°ì²´ë¥¼ ë„£ì–´ <code class="language-plaintext highlighter-rouge">MatchResult</code> ê°ì²´ë¥¼ ë§Œë“ ë‹¤.</li>
  <li><code class="language-plaintext highlighter-rouge">MatchResult</code> ê°ì²´ì˜ ë©”ì„œë“œ <code class="language-plaintext highlighter-rouge">.isMatch();</code>ë¡œ ê¶Œí•œì„ ì²´í¬í•œë‹¤.</li>
</ol>

<p>ë§Œì•½ì— ê¶Œí•œì´ ì¡´ì¬í•´ <code class="language-plaintext highlighter-rouge">if (matchResult.isMatch())</code> ë©”ì„œë“œë¥¼ í†µê³¼í•œë‹¤ë©´<br />
<code class="language-plaintext highlighter-rouge">manager.check();</code>ë¥¼ í†µí•´ì„œ <code class="language-plaintext highlighter-rouge">matchResult.getVariables();</code>ë¥¼ í†µí•´ì„œ<br />
Mapì„ ë‹´ê³ ìˆëŠ” ê°ì²´ê°€ ë°˜í™˜ë˜ë©° ê¶Œí•œ ë¶€ì—¬ê³¼ì •ì´ ì§„í–‰ë˜ê³ </p>

<p>ë§Œì•½ì— ê¶Œí•œì´ ì¡´ì¬í•˜ì§€ ì•Šì•„ <code class="language-plaintext highlighter-rouge">if (matchResult.isMatch())</code> ë©”ì„œë“œë¥¼ í†µê³¼í•˜ì§€ ëª»í•œë‹¤ë©´<br />
<code class="language-plaintext highlighter-rouge">return null;</code>ë¡œ ì¸í•´ nullê°’ì´ ë°˜í™˜ë˜ê²Œ ë˜ì–´ì§„ë‹¤.<br />
ì¦‰, ë§¨ì²˜ìŒì— ìš°ë¦¬ê°€ <code class="language-plaintext highlighter-rouge">check();</code>ë©”ì„œë“œë¥¼ í˜¸ì¶œí–ˆë˜ <code class="language-plaintext highlighter-rouge">AuthorizationFilter</code>ì—ì„œ</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Override</span>
<span class="kd">protected</span> <span class="kt">void</span> <span class="nf">doFilterInternal</span><span class="o">(</span><span class="nc">HttpServletRequest</span> <span class="n">request</span><span class="o">,</span> <span class="nc">HttpServletResponse</span> <span class="n">response</span><span class="o">,</span> <span class="nc">FilterChain</span> <span class="n">filterChain</span><span class="o">)</span>
        <span class="kd">throws</span> <span class="nc">ServletException</span><span class="o">,</span> <span class="nc">IOException</span> <span class="o">{</span>

    <span class="nc">AuthorizationDecision</span> <span class="n">decision</span> <span class="o">=</span> <span class="k">this</span><span class="o">.</span><span class="na">authorizationManager</span><span class="o">.</span><span class="na">check</span><span class="o">(</span><span class="k">this</span><span class="o">::</span><span class="n">getAuthentication</span><span class="o">,</span> <span class="n">request</span><span class="o">);</span>
    <span class="k">this</span><span class="o">.</span><span class="na">eventPublisher</span><span class="o">.</span><span class="na">publishAuthorizationEvent</span><span class="o">(</span><span class="k">this</span><span class="o">::</span><span class="n">getAuthentication</span><span class="o">,</span> <span class="n">request</span><span class="o">,</span> <span class="n">decision</span><span class="o">);</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">decision</span> <span class="o">!=</span> <span class="kc">null</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">decision</span><span class="o">.</span><span class="na">isGranted</span><span class="o">())</span> <span class="o">{</span>
        <span class="k">throw</span> <span class="k">new</span> <span class="nf">AccessDeniedException</span><span class="o">(</span><span class="s">"Access Denied"</span><span class="o">);</span>
    <span class="o">}</span>
    <span class="n">filterChain</span><span class="o">.</span><span class="na">doFilter</span><span class="o">(</span><span class="n">request</span><span class="o">,</span> <span class="n">response</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div></div>
<p><code class="language-plaintext highlighter-rouge">throw new AccessDeniedException("Access Denied");</code> ì˜ˆì™¸ë¥¼ ë˜ì§€ê²Œë˜ì–´<br />
ê¶Œí•œì„ ë¶€ì—¬í•˜ì§€ ì•Šë„ë¡ ì²˜ë¦¬ë¥¼ í•´ì£¼ëŠ” ê²ƒì´ë‹¤.</p>

<p><br /></p>

<h3 id="ì ‘ê·¼-ì œì–´-í‘œí˜„ì‹">ì ‘ê·¼ ì œì–´ í‘œí˜„ì‹</h3>

<p>Spring Security ì›¹ ë° ë©”ì„œë“œ ë³´ì•ˆì„ ìœ„í•œ í‘œí˜„ì‹</p>

<p><strong>Spring EL</strong></p>

<table>
  <tbody>
    <tr>
      <td>í‘œí˜„ì‹</td>
      <td>: ì„¤ëª… :</td>
    </tr>
    <tr>
      <td>hasRole</td>
      <td>í˜„ì¬ ë³´ì•ˆ ì£¼ì²´(principal)ê°€ ì§€ì •ëœ ì—­í• ì„ ê°–ê³  ìˆëŠ”ì§€ ì—¬ë¶€ë¥¼ í™•ì¸í•˜ê³  ê°€ì§€ê³  ìˆë‹¤ë©´ trueë¥¼ ë¦¬í„´í•œë‹¤. <br /> hasRole(â€™adminâ€™)ì²˜ëŸ¼ íŒŒë¼ë¯¸í„°ë¡œ ë„˜ê¸´ roleì´ ROLE_ ë¡œ ì‹œì‘í•˜ì§€ ì•Šìœ¼ë©´ ê¸°ë³¸ì ìœ¼ë¡œ ì¶”ê°€í•œë‹¤. <br /> (DefaultWebSecurityExpressionHandlerì˜ defaultRolePrefixë¥¼ ìˆ˜ì •í•˜ë©´ ì»¤ìŠ¤í…€í•  ìˆ˜ ìˆë‹¤.)</td>
    </tr>
    <tr>
      <td>hasAnyRole</td>
      <td>í˜„ì¬ ë³´ì•ˆ ì£¼ì²´ê°€ ì§€ì •í•œ ì—­í•  ì¤‘ 1ê°œë¼ë„ ê°€ì§€ê³  ìˆìœ¼ë©´ trueë¥¼ ë¦¬í„´í•œë‹¤. (ë¬¸ìì—´ ë¦¬ìŠ¤íŠ¸ë¥¼ ì½¤ë§ˆë¡œ êµ¬ë¶„í•´ì„œ ì „ë‹¬í•œë‹¤.) <br /> ex) hasAnyRole(â€™adminâ€™, â€˜userâ€™)</td>
    </tr>
    <tr>
      <td>hasAuthority</td>
      <td>í˜„ì¬ ë³´ì•ˆ ì£¼ì²´ê°€ ì§€ì •í•œ ê¶Œí•œì„ ê°–ê³  ìˆëŠ”ì§€ ì—¬ë¶€ë¥¼ í™•ì¸í•˜ê³  ê°€ì§€ê³  ìˆë‹¤ë©´ trueë¥¼ ë¦¬í„´í•œë‹¤. <br /> ex) hasAuthority(â€™readâ€™)</td>
    </tr>
    <tr>
      <td>hasAnyAuthority</td>
      <td>í˜„ì¬ ë³´ì•ˆ ì£¼ì²´ê°€ ì§€ì •í•œ ê¶Œí•œ ì¤‘ í•˜ë‚˜ë¼ë„ ìˆìœ¼ë©´ trueë¥¼ ë¦¬í„´í•œë‹¤. <br /> ex) hasAnyAuthority(â€™readâ€™, â€˜writeâ€™)</td>
    </tr>
    <tr>
      <td>principal</td>
      <td>í˜„ì¬ ì‚¬ìš©ìë¥¼ ë‚˜íƒ€ë‚´ëŠ” principal ê°ì²´ì— ì§ì ‘ ì ‘ê·¼í•  ìˆ˜ ìˆë‹¤.</td>
    </tr>
    <tr>
      <td>authentication</td>
      <td>SecurityContextë¡œ ì¡°íšŒí•  ìˆ˜ ìˆëŠ” í˜„ì¬ Authentication ê°ì²´ì— ì§ì ‘ ì ‘ê·¼í•  ìˆ˜ ìˆë‹¤.</td>
    </tr>
    <tr>
      <td>permitAll</td>
      <td>í•­ìƒ trueë¡œ í‰ê°€í•œë‹¤.</td>
    </tr>
    <tr>
      <td>denyAll</td>
      <td>í•­ìƒ falseë¡œ í‰ê°€í•œë‹¤.</td>
    </tr>
    <tr>
      <td>isAnonymous()</td>
      <td>í˜„ì¬ ë³´ì•ˆ ì£¼ì²´ê°€ ìµëª… ì‚¬ìš©ìë©´ trueë¥¼ ë¦¬í„´í•œë‹¤.</td>
    </tr>
    <tr>
      <td>isRememberMe()</td>
      <td>í˜„ì¬ ë³´ì•ˆ ì£¼ì²´ê°€ remember-me ì‚¬ìš©ìë©´ trueë¥¼ ë¦¬í„´í•œë‹¤.</td>
    </tr>
    <tr>
      <td>isAuthenticated()</td>
      <td>ì‚¬ìš©ìê°€ ìµëª…ì´ ì•„ë‹Œ ê²½ìš° trueë¥¼ ë¦¬í„´í•œë‹¤.</td>
    </tr>
    <tr>
      <td>isFullyAuthenticated()</td>
      <td>ì‚¬ìš©ìê°€ ìµëª… ì‚¬ìš©ìë‚˜ remember-me ì‚¬ìš©ìê°€ ì•„ë‹ˆë©´ trueë¥¼ ë¦¬í„´í•œë‹¤.</td>
    </tr>
    <tr>
      <td>hasPermission <br /> (Object target, Object permission)</td>
      <td>ì‚¬ìš©ìê°€ targetì— í•´ë‹¹ permission ê¶Œí•œì´ ìˆìœ¼ë©´ trueë¥¼ ë¦¬í„´í•œë‹¤. <br /> ex) hasPermission(domainObject, â€˜readâ€™)</td>
    </tr>
    <tr>
      <td>hasPermission <br /> (Object targetId, String targetType, Object permission)</td>
      <td>ì‚¬ìš©ìê°€ targetì— í•´ë‹¹ permission ê¶Œí•œì´ ìˆìœ¼ë©´ trueë¥¼ ë¦¬í„´í•œë‹¤. <br /> ex) hasPermission(1, â€˜com.example.domain.Messageâ€™, â€˜readâ€™)</td>
    </tr>
  </tbody>
</table>

<p><br /></p>

<hr />

<p><br /></p>

<p><span style="color:#994C00"><strong>ì˜¤ëŠ˜ì˜ ì»¤í”¼ëŸ‰</strong></span>: â˜•ï¸ â˜•ï¸<br />
<strong>ì˜¤ëŠ˜ì˜ ì ì‹¬</strong>: ì‚½ê²¹ì‚´, ëœì¥ì°Œê°œ, ë°¥</p>]]></content><author><name>LEE JAEHYEOK</name></author><category term="TIL" /><category term="TIL" /><category term="ë¶€íŠ¸ìº í”„" /><category term="ì½”ë“œìŠ¤í…Œì´ì¸ " /><summary type="html"><![CDATA[]]></summary></entry><entry><title type="html">TIL) Spring Security 2 (ì¸ì¦ì²˜ë¦¬)</title><link href="http://localhost:4000/til/2022/11/21/til.html" rel="alternate" type="text/html" title="TIL) Spring Security 2 (ì¸ì¦ì²˜ë¦¬)" /><published>2022-11-21T00:00:00+09:00</published><updated>2022-11-21T00:00:00+09:00</updated><id>http://localhost:4000/til/2022/11/21/til</id><content type="html" xml:base="http://localhost:4000/til/2022/11/21/til.html"><![CDATA[<p>ì£¼ë§ì´ë¼ëŠ” ê²ƒì€â€¦ ì‚¬ëŒì„ ì°¸ ë‚˜íƒœí•˜ê²Œ ë§Œë“¤ê¸°ë„<br />
í™œë ¥ì„ ê³µê¸‰í•˜ê¸°ë„ í•˜ëŠ” ê²ƒ ê°™ë‹¤.</p>

<p><img src="https://lh3.googleusercontent.com/u/0/drive-viewer/AFDK6gOjX-PSPnxF_8TEMdso4KXA0JFYzGA1vArqAdtB6h1-NxbA6XRbp-Xy587IzIYiyL_lKX7HXm5PYPHWKxXIq9zV_OpOtA=w1920-h921" alt="image" class="align-left" style="max-width: 100%" /></p>

<p>í† ìš”ì¼ê¹Œì§€ Spring Securityë¥¼ ê³µë¶€í•˜ë‹¤ê°€ ë²ˆì•„ì›ƒì´ì™€<br />
ì¼ìš”ì¼ì— ë„ˆë¬´ ê²Œìœ¼ë¥´ê²Œ ëˆ„ì›Œë§Œ ìˆì—ˆë”ë‹ˆ<br />
ìœ íŠœë¸Œ ë‚˜íƒœì§€ì˜¥ì— ë‹¤ì‹œ ë¹ ì ¸ë²„ë ¸ë‹¤.</p>

<hr />

<p>ì €ë²ˆì£¼ì— Spring Securityë¥¼ ì‚¬ìš©í•˜ëŠ” ì˜ˆì œ ì½”ë“œì™€<br />
ê°„ë‹¨í•œ íë¦„ì„ ì•Œì•„ë³´ì•˜ë‹¤.<br />
ê·¸ì¤‘ Filterë¼ëŠ” ê²ƒë“¤ì„ ë°°ì› ê³  Spring Securityë„<br />
Filterë¡œ êµ¬ì„±ëœ FilterChainìœ¼ë¡œ êµ¬ë™í•˜ëŠ” ê²ƒë„ ë°°ì› ë‹¤.</p>

<p>ì˜¤ëŠ˜ì€ ê·¸ ì¤‘ì—ì„œ ì¸ì¦ê´€ë ¨ëœ Filterë¥¼ ìì„¸íˆ ì•Œì•„ë³´ì</p>

<h2 id="spring-security-ì¸ì¦">Spring Security ì¸ì¦</h2>

<h3 id="filter-íë¦„-ë³µìŠµ">Filter íë¦„ ë³µìŠµ</h3>

<p>ì €ë²ˆì£¼ì— ê³µë¶€í–ˆì—ˆë˜ <a href="https://mycatlikeschuru.github.io/til/2022/11/18/til.html">(Spring Security ê¸°ì´ˆ)</a>ì˜ íë¦„ì„ ë‹¤ì‹œí•œë²ˆ ì§šê³  ë„˜ì–´ê°€ì</p>

<p><img src="https://lh3.googleusercontent.com/u/0/drive-viewer/AFDK6gOdqM4FUdK-kbSe3fOY-_nbwexPCpzCoO0wU4fxsPySDcyhG4ju9jOfdiay5TA0GmdJqNj0L4UZcOZGIHz9XGJLAcqNlw=w1299-h921" alt="image" class="align-left" style="max-width: 60%" /></p>

<p>í´ë¼ì´ì–¸íŠ¸ì—ì„œ ìš”ì²­ì´ì˜¤ë©´<br />
Filterë“¤ì˜ ëª¨ì„ì¸ FilterChainì„ ê±°ì³ í•˜ë‚˜ì”© ì‹¤í–‰í•œë‹¤.<br />
ê·¸ ì¤‘ FilterChainProxy í´ë˜ìŠ¤ë¡œ ë¶€í„° ë³´ì•ˆì„ ìœ„í•œ ì‘ì—… í•„í„°ëª¨ìŒì¸<br />
SecurityFilterChainë¥¼ ìˆ˜í–‰í•˜ê²Œëœë‹¤.</p>

<p>ì—¬ê¸°ì„œ SecurityFilterChainë„ Filterë“¤ë¡œ ì´ë£¨ì–´ì ¸ìˆê³ <br />
ì•„ë˜ì˜ ì‚¬ì§„ì´ SecurityFilterChainì˜ ëŒ€ëµì ì¸ êµ¬ì¡°ì´ë‹¤.</p>

<p><img src="https://lh3.googleusercontent.com/u/0/drive-viewer/AFDK6gNlrpr3UQFs4rI7dXvh6L-v1GvYL_3mSnWy8cA9rKECR2M-C_y4fYtJrNqD7xWcvzqy0TDvYC65satnVVyAEYsoTGaQbg=w1920-h921" alt="image" class="align-left" style="max-width: 100%" /><br />
<a href="https://velog.io/@sa833591/Spring-Security-5">hyozkim.log - ì¶œì²˜</a></p>

<p>ì‚¬ì§„ì—ì„œ ë³´ë©´ ì•Œ ìˆ˜ ìˆë“¯ì´ <br />
SecurityFilterChainì˜ êµ¬ì¡°ëŠ”</p>

<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>SecurityContextPersistenceFilter  
LogoutFilter  
UsernamePasswordAuthenticationFilter  
...  
</code></pre></div></div>

<p>ë“± ì—¬ëŸ¬ê°€ì§€ í•„í„°ë¥¼ê°€ì§„ í˜•íƒœë¡œ ì¡´ì¬í•œë‹¤.</p>

<p>ëª¨ë“  Filterì˜ êµ¬ì¡°ë¥¼ ì•Œê³  ì´í•´í•œë‹¤ë©´ ë¶„ëª… SpringSecurityì— ëŒ€í•œ<br />
ì´í•´ë„ê°€ ê¹Šì–´ì§ˆ ê²ƒì´ìë§Œ, í˜„ì¬ ê³µë¶€ë¥¼ ì‹œì‘í•œì§€ ì–¼ë§ˆì•ˆëœ<br />
ë‚´ê°€ ì „ë¶€ë¥¼ ì´í•´í•˜ê¸°ì—ëŠ” ì‚¬ì‹¤ ë¬´ë¦¬ê°€ ìˆëŠ” ê²ƒ ê°™ë‹¤ê³  ìƒê°ì´ ë“¤ì—ˆë‹¤.</p>

<p>ì´ ì¤‘ì—ì„œë„ ì¸ì¦ê³¼ ê´€ë ¨ëœ UsernamePasswordAuthenticationFilterì˜<br />
ì¸ì¦ ì²˜ë¦¬ íë¦„ì„ ì´í•´í•´ë³´ë ¤í•œë‹¤. í•´ë‹¹í•˜ëŠ” ë¶€ë¶„ì„ ì–´ì œ ì½”ë“œë¡œ êµ¬í˜„í•˜ê¸°ë„ í–ˆê³ <br />
íë¦„ì„ ì•Œì•„ì•¼ SpringSecurityë¥¼ ê¸°ë³¸ì ì¸ ë‚´ìš©ì„ êµ¬í˜„í•˜ëŠ”ë° ë¬´ë¦¬ê°€ ì—†ì„ ê²ƒ ê°™ë‹¤.</p>

<p><br /></p>

<p><strong>Security Filter í™•ì¸ ë°©ë²•?</strong></p>

<p>ìœ„ì—ì„œ ì–˜ê¸°í–ˆë“¯ì´ ì—¬ëŸ¬ Filterë“¤ì„ ê±°ì³ì„œ<br />
ì¸ì¦ê³¼ ê¶Œí•œì— ëŒ€í•œ ìˆ˜í–‰ì„ SpringSecurityê°€ ì§„í–‰í•´ì¤€ë‹¤.<br />
ì‹¤ì œë¡œ ì–´ë– í•œ Filterë¥¼ ê±°ì³ì™”ëŠ”ì§€ í™•ì¸ì„ í•  ìˆ˜ ìˆëŠ” ì• ë…¸í…Œì´ì…˜ì´ ìˆê³   <br />
ë””ë²„ê·¸ ìš©ë„ë¡œ ë§¤ìš° ìœ ìš©í•˜ê²Œ ì“°ì¼ ê²ƒ ê°™ë‹¤.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Configuration</span>
<span class="nd">@EnableWebSecurity</span><span class="o">(</span><span class="n">debug</span> <span class="o">=</span> <span class="kc">true</span><span class="o">)</span> <span class="c1">// ë””ë²„ê·¸ ì„¤ì •</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SecurityConfigurationV2</span> <span class="o">{</span>
    
    <span class="nd">@Bean</span>
    <span class="kd">public</span> <span class="nc">SecurityFilterChain</span> <span class="nf">filterChain</span><span class="o">(</span><span class="nc">HttpSecurity</span> <span class="n">http</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
        <span class="n">http</span>
                <span class="o">.</span><span class="na">csrf</span><span class="o">().</span><span class="na">disable</span><span class="o">()</span>
                <span class="o">.</span><span class="na">formLogin</span><span class="o">()</span>
                <span class="o">.</span><span class="na">loginPage</span><span class="o">(</span><span class="s">"/auths/login-form"</span><span class="o">)</span> 
                <span class="o">.</span><span class="na">loginProcessingUrl</span><span class="o">(</span><span class="s">"/process_login"</span><span class="o">)</span>
                <span class="o">.</span><span class="na">failureUrl</span><span class="o">(</span><span class="s">"/auths/login-form?error"</span><span class="o">)</span>
                <span class="o">.</span><span class="na">and</span><span class="o">()</span>
                <span class="o">.</span><span class="na">authorizeHttpRequests</span><span class="o">()</span> 
                <span class="o">.</span><span class="na">anyRequest</span><span class="o">()</span> 
                <span class="o">.</span><span class="na">permitAll</span><span class="o">();</span>
        <span class="k">return</span> <span class="n">http</span><span class="o">.</span><span class="na">build</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>
<p>@EnableWebSecurity(debug = true) ì–´ë…¸í…Œì´ì…˜ì„<br />
ì´ìš©í•´ í˜„ì¬ ìš”ì²­ì— ì´ìš©ëœ Filterì˜ ëª©ë¡ì´ ì¡°íšŒê°€ ê°€ëŠ¥í•˜ë‹¤.</p>

<p>ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì‹¤í–‰ì‹œí‚¤ê³ <br />
formLogin ë°©ì‹ìœ¼ë¡œ ìš”ì²­ì„ ë³´ë‚´ë³´ì•˜ë‹¤.</p>

<p>ê·¸ë¦¬ê³  ì½˜ì†”ì„ í™•ì¸í•´ë³´ë©´</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Security filter chain: [
  DisableEncodeUrlFilter
  WebAsyncManagerIntegrationFilter
  SecurityContextPersistenceFilter
  HeaderWriterFilter
  LogoutFilter
  UsernamePasswordAuthenticationFilter
  RequestCacheAwareFilter
  SecurityContextHolderAwareRequestFilter
  AnonymousAuthenticationFilter
  SessionManagementFilter
  ExceptionTranslationFilter
  AuthorizationFilter
]
</code></pre></div></div>
<p>ì²«ë²ˆì¨°ë¡œ ìš”ì²­ì— ëŒ€í•œ ì •ë³´ë“¤ê³¼<br />
ë‹¤ìŒìœ¼ë¡œëŠ” Security filter chainì— Filter ëª©ë¡ë“¤ì´<br />
ë‚˜ì˜¤ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.</p>

<p>ìœ„ì—ì„œ ë³¼ ìˆ˜ ìˆë“¯ì´ ìš°ë¦¬ê°€ ì•Œì•„ë³´ë ¤ê³ í•˜ëŠ”<br />
UsernamePasswordAuthenticationFilter í´ë˜ìŠ¤ë„ <br />
ì½˜ì†”ë¡œ í™•ì¸ì´ ê°€ëŠ¥í•˜ë‹¤.</p>

<p><br /></p>

<h3 id="ì¸ì¦-ì²˜ë¦¬">ì¸ì¦ ì²˜ë¦¬</h3>

<p>ì´ì œ ë³¸ê²©ì ìœ¼ë¡œ ì¸ì¦ì´ ì–´ë– í•œ ê³¼ì •ìœ¼ë¡œ<br />
ì§„í–‰ë˜ëŠ”ì§€ ì²˜ë¦¬ ìˆœì„œì— ëŒ€í•œ íë¦„ì„ ì•Œì•„ë³´ì.</p>

<p><img src="https://lh3.googleusercontent.com/u/0/drive-viewer/AFDK6gM9oGy1ZMRYopmfP5I5a2V8YyhzZ_cPot1-9VSX4vFPRYbCISfsxHheqNiPvpRv-ywxmVYbIGBUyfKCX3AaeeChzJ7toQ=w1920-h921" alt="image" class="align-left" style="max-width: 120%" /></p>

<p>(1). í´ë¼ì´ì–¸íŠ¸ì—ì„œ ë¡œê·¸ì¸ ìš”ì²­ì´ ì˜¤ë©´, <code class="language-plaintext highlighter-rouge">SecurityFilterChain</code>ì„ ê±°ì¹˜ê²Œëœë‹¤.<br />
ê·¸ ì¤‘ ì¸ì¦ì— ê´€í•œ ë¶€ë¶„ì€ <code class="language-plaintext highlighter-rouge">UsernamePasswordAuthenticationFilter</code> í´ë˜ìŠ¤ì´ë‹¤.</p>

<p><br /></p>

<p>(2). <code class="language-plaintext highlighter-rouge">Authentication</code> ê°ì²´ë¥¼ ìƒì„±í•œë‹¤.<br />
ì—¬ê¸°ì„œ ë¡œê·¸ì¸í• ë•Œ ë°›ì•„ì˜¨ Usernameê³¼ Passwordë¥¼ ì´ìš©í•´<br />
<code class="language-plaintext highlighter-rouge">Authentication</code>ì˜ êµ¬í˜„ì²´ì¸ <code class="language-plaintext highlighter-rouge">UsernamePasswordAuthenticationToken</code> <br />
í´ë˜ìŠ¤ë¥¼ ì´ìš©í•´ <code class="language-plaintext highlighter-rouge">Authentication</code> ê°ì²´ë¥¼ ë§Œë“ ë‹¤.<br />
<em><strong>(â—ï¸Authentication ê°ì²´ëŠ” ì¸ì¦ì´ ì™„ë£Œë˜ì§€ ì•ŠìŒ)</strong></em></p>

<p><br /></p>

<p>(3). <code class="language-plaintext highlighter-rouge">Authentication</code> ê°ì²´ë¥¼ <code class="language-plaintext highlighter-rouge">AuthenticationManager</code>ë¡œ ì „ë‹¬í•œë‹¤.  <br />
ì—¬ê¸°ì„œ êµ¬í˜„ì²´ì¸ <code class="language-plaintext highlighter-rouge">ProviderManager</code>ê°€ ì¸ì¦ì´ë¼ëŠ” ì‘ì—…ì˜ ì´ê´„ ë§¤ë‹ˆì €ë‹¤. <br />
ì´ê´„ì€ í•˜ì§€ë§Œ ì‹¤ì œ ì¸ì¦ì²˜ë¦¬ëŠ” <code class="language-plaintext highlighter-rouge">AuthenticationProvider</code>ì—ê²Œ ìœ„ì„í•œë‹¤.<br />
<em><strong>(â—ï¸Authentication ê°ì²´ëŠ” ì¸ì¦ì´ ì™„ë£Œë˜ì§€ ì•ŠìŒ)</strong></em></p>

<p><br /></p>

<p>(4). <code class="language-plaintext highlighter-rouge">Authentication</code> ê°ì²´ë¥¼ <code class="language-plaintext highlighter-rouge">AuthenticationProvider</code>ë¡œ ì „ë‹¬í•œë‹¤.<br />
<code class="language-plaintext highlighter-rouge">ProviderManager</code>ê°€ ì „ë‹¬í•´ì¤€ <code class="language-plaintext highlighter-rouge">Authentication</code>ê°ì²´ë¡œ ì¸ì¦í•˜ëŠ” ì‘ì—…ì„ ì§„í–‰í•œë‹¤.<br />
ì¸ì¦ì„ êµ¬í˜„í•˜ëŠ” ë°©ë²•ì€ 2ê°€ì§€ ì •ë„ê°€ ìˆë‹¤.</p>

<ol>
  <li><code class="language-plaintext highlighter-rouge">AuthenticationProvider</code>ë¥¼ ìƒì†ë°›ì•„ êµ¬í˜„</li>
  <li><code class="language-plaintext highlighter-rouge">UserDetailsService</code>ë¥¼ ìƒì†ë°›ì•„ êµ¬í˜„</li>
</ol>

<p><a href="https://mycatlikeschuru.github.io/til/2022/11/18/til.html">(Spring Security ê¸°ì´ˆ)</a>ì—ì„œ ìš°ë¦¬ëŠ” <code class="language-plaintext highlighter-rouge">UserDetailsService</code>ë¥¼<br />
ìƒì†ë°›ì•„ ì§ì ‘ í´ë˜ìŠ¤ë¥¼ êµ¬í˜„í–ˆì—ˆë‹¤.</p>

<p>ì—¬ê¸°ì„œ 1ë²ˆë°©ë²•ìœ¼ë¡œ êµ¬í˜„í•˜ë©´ <code class="language-plaintext highlighter-rouge">â‚©</code>UserDetailsService` ë¶€ë¶„ì€<br />
ì‚¬ìš©í•˜ì§€ ì•Šê³  êµ¬í˜„ì„ í•  ìˆ˜ ìˆë‹¤. êµ¬í˜„í• ë•Œ ì¤‘ìš”í•œ ë¶€ë¶„ì€<br />
ì§ì ‘ Credentialsê³¼ Passwordë¥¼ ì¸ì¦ê³¼ì • ë¡œì§ì„ êµ¬í˜„í•´ì•¼í•œë‹¤ëŠ” ì ì´ë‹¤.</p>

<p>í•˜ì§€ë§Œ ì–´ì œ ìš°ë¦¬ê°€ êµ¬í˜„í–ˆë˜ 2ë²ˆë°©ë²•ìœ¼ë¡œ êµ¬í˜„í•˜ë©´<br />
<code class="language-plaintext highlighter-rouge">AuthenticationProvider</code>ë¥¼ êµ¬í˜„í•˜ì§€ ì•Šì•„ë„ëœë‹¤.<br />
<code class="language-plaintext highlighter-rouge">DaoAuthenticationProvider</code>ë¥¼ êµ¬í˜„ í´ë˜ìŠ¤ë¡œ ì‚¬ìš©í•˜ê¸° ë•Œë¬¸ì´ë‹¤. 
ì‹¤ì œë¡œ í˜¸ì¶œ íë¦„ì„ ë³¸ë‹¤ë©´,</p>

<ol>
  <li><code class="language-plaintext highlighter-rouge">ProviderManager</code> í´ë˜ìŠ¤ì˜ <code class="language-plaintext highlighter-rouge">.authenticate();</code> ë©”ì„œë“œ í˜¸ì¶œ</li>
  <li><code class="language-plaintext highlighter-rouge">AuthenticationProvider</code> ì¸í„°í˜ì´ìŠ¤ì˜ <code class="language-plaintext highlighter-rouge">AbstractUserDetailsAuthenticationProvider</code>ê°€<br />
<code class="language-plaintext highlighter-rouge">.authenticate();</code> ë©”ì„œë“œë¥¼ êµ¬í˜„í–ˆìŒ.</li>
  <li><code class="language-plaintext highlighter-rouge">.authenticate();</code> ë©”ì„œë“œì•ˆì—ì„œ ì¸ì¦ ì²˜ë¦¬ë¥¼ ìœ„í•œ <code class="language-plaintext highlighter-rouge">retrieveUser();</code> í˜¸ì¶œ<br />
<code class="language-plaintext highlighter-rouge">DaoAuthenticationProvider</code> í´ë˜ìŠ¤ê°€ <code class="language-plaintext highlighter-rouge">.retrieveUser();</code>ë¥¼ êµ¬í˜„í–ˆìŒ</li>
  <li><code class="language-plaintext highlighter-rouge">.retrieveUser();</code> ë©”ì„œë“œì—ì„œ <code class="language-plaintext highlighter-rouge">UserDetailsService</code> í´ë˜ìŠ¤ì˜ <code class="language-plaintext highlighter-rouge">.loadUserByUsername()</code>  <br />
ë©”ì„œë“œ í˜¸ì¶œ <code class="language-plaintext highlighter-rouge">.loadUserByUsername();</code> ë©”ì„œë“œëŠ” ìš°ë¦¬ê°€ êµ¬í˜„í•´ì•¼í•˜ëŠ” ë¶€ë¶„ì´ë‹¤.</li>
</ol>

<p><em><strong>(â—ï¸Authentication ê°ì²´ëŠ” ì¸ì¦ì´ ì™„ë£Œë˜ì§€ ì•ŠìŒ)</strong></em></p>

<p><br /></p>

<p>(5). ì¦‰, ìœ„ì—ì„œ ì–˜ê¸°í–ˆë˜ <code class="language-plaintext highlighter-rouge">DaoAuthenticationProvider</code> í´ë˜ìŠ¤ê°€<br />
<code class="language-plaintext highlighter-rouge">UserDetailsService</code>ë¥¼ ì´ìš©í•´ <code class="language-plaintext highlighter-rouge">UserDetails</code>ë¥¼ ê°ì²´ë¥¼ ì¡°íšŒ í•œë‹¤.</p>

<p>ì‹¤ì œë¡œ ì–´ì œ ì˜ˆì œì—ì„œ <code class="language-plaintext highlighter-rouge">UserDetails</code>ë¥¼ ìƒì†ë°›ì•„<br />
username, password, ê¶Œí•œì •ë³´ë¥¼ ê°ì²´ë¡œ ë§Œë“¤ì–´ êµ¬í˜„í•˜ì˜€ê³ <br />
í•´ë‹¹ê°ì²´ë¥¼ <code class="language-plaintext highlighter-rouge">UserDetailsService</code>ë¥¼ ì´ìš©í•´ ë°˜í™˜í•˜ëŠ” í”„ë¡œê·¸ë¨ë„ ì‘ì„±í–ˆë‹¤.<br />
<em><strong>(â—ï¸Authentication ê°ì²´ëŠ” ì¸ì¦ì´ ì™„ë£Œë˜ì§€ ì•ŠìŒ)</strong></em></p>

<p><br /></p>

<p>(6). ì¦‰, Credential ì €ì¥ì†Œë¼ëŠ” ëœ»ì€ DBì˜ ì•”í˜¸í™”ëœ ë¹„ë°€ë²ˆí˜¸ë¥¼ ê°€ì ¸ì˜¨ë‹¤ëŠ” ëœ»ì´ë‹¤.  <br />
ì‰½ê²Œ ë§í•˜ìë©´ (5)ë²ˆì„ í†µí•´ í˜¸ì¶œëœ <code class="language-plaintext highlighter-rouge">UserDetailsService</code>ì—ì„œ<br />
<code class="language-plaintext highlighter-rouge">loadUserByUsername(String username);</code> ë©”ì„œë“œë¥¼ ì´ìš©í•´ <br />
ìš°ë¦¬ëŠ” ì–´ë–¤ usernameìœ¼ë¡œ ì ‘ê·¼í•˜ëŠ”ì§€ ì•Œ ìˆ˜ ìˆìœ¼ë©°, í•´ë‹¹ ì •ë³´ë¡œ DBë¥¼ ì¡°íšŒí•´<br />
ì‹«ì œë¡œ ë™ì¼í•œ usernameì´ ì¡´ì¬í•  ê²½ìš° í•´ë‹¹ í…Œì´ë¸”ì˜ ì •ë³´ë¥¼ ê°€ì ¸ì˜¬ ìˆ˜ ìˆë‹¤.<br />
ì¦‰, ê¶Œí•œì •ë³´, ì•”í˜¸í™”ëœ ë¹„ë°€ë²ˆí˜¸ ë“±ë“± ì‚¬ìš©ì ì •ë³´ë¥¼ ê°€ì ¸ì˜¬ ìˆ˜ ìˆë‹¤ëŠ” ëœ»ì´ë‹¤.</p>

<p><br /></p>

<p>(7). ì´ì œ ìš°ë¦¬ëŠ” (6)ë²ˆì„ í†µí•´ì„œ ì¡°íšŒí•œ ë°ì´í„°ë¡œ ì¸ì¦ì„ ë¹„êµí• <br />
<code class="language-plaintext highlighter-rouge">UserDetails</code> ê°ì²´ë¥¼ ë§Œë“¤ ìˆ˜ ìˆë‹¤. <code class="language-plaintext highlighter-rouge">UserDetails</code> ê°ì²´ëŠ”<br />
username,password,ê¶Œí•œì •ë³´ë¥¼ ê°€ì§€ê³  ìˆìœ¼ë©´ ê°ì²´ë¡œ ë§Œë“¤ ìˆ˜ ìˆë‹¤.</p>

<p><br /></p>

<p>(8). ë§Œë“¤ì–´ì§„ <code class="language-plaintext highlighter-rouge">UserDetails</code> ê°ì²´ëŠ”, ë§¨ì²˜ìŒ í˜¸ì¶œí–ˆë˜ <br />
<code class="language-plaintext highlighter-rouge">DaoAuthenticationProvider</code> í´ë˜ìŠ¤ì— ë°˜í™˜í•˜ê²Œ ë˜ì–´ì§„ë‹¤.<br />
ì•„ê¹Œ ì–˜ê¸°í–ˆë“¯ì´ <code class="language-plaintext highlighter-rouge">AuthenticationProvider</code>ë¥¼ êµ¬í˜„í•œ í´ë˜ìŠ¤ë¡œ<br />
ì¸ì¦ì„ ì²˜ë¦¬í•´ì£¼ëŠ” í´ë˜ìŠ¤ì´ë‹¤.</p>

<p><br /></p>

<p>(9). <code class="language-plaintext highlighter-rouge">UserDetails</code> ì •ë³´ë¥¼ ì´ìš©í•´ <code class="language-plaintext highlighter-rouge">DaoAuthenticationProvider</code> í´ë˜ìŠ¤ê°€<br />
<code class="language-plaintext highlighter-rouge">.mitigateAgainstTimingAttack();</code> ë©”ì„œë“œë¥¼ í˜¸ì¶œí•´ ì¸ì¦ì„ ì²˜ë¦¬í•œë‹¤.<br />
ì¸ì¦ì²˜ë¦¬ê°€ ì •ìƒì ìœ¼ë¡œ ì´ë£¨ì–´ì¡Œì„ ê²½ìš°ì— <br />
ê·¸ë¦¼ê³¼ ê°™ì´ ì¸ì¦ì •ë³´ì¸ <code class="language-plaintext highlighter-rouge">Collection&lt;GrantedAuthority&gt;</code>ê°€ ì¶”ê°€ëœ<br />
<code class="language-plaintext highlighter-rouge">Authentication</code> ê°ì²´ë¥¼ ë°˜í™˜í•˜ê²Œ ëœë‹¤.<br />
<em><strong>(â­•ï¸Authentication ê°ì²´ëŠ” ì¸ì¦ì´ ì™„ë£Œë¨)</strong></em></p>

<p><br /></p>

<p>(10). ì´ì œ ì¸ì¦ì´ ì™„ë£Œëœ ê°ì²´ë¥¼ í˜¸ì¶œí–ˆë˜<br />
<code class="language-plaintext highlighter-rouge">ProviderManager</code>ë¡œ ë°˜í•œëœë‹¤.<br />
<em><strong>(â­•ï¸Authentication ê°ì²´ëŠ” ì¸ì¦ì´ ì™„ë£Œë¨)</strong></em></p>

<p><br /></p>

<p>(11). ë§ˆì°¬ê°€ì§€ë¡œ ì²˜ìŒì— í˜¸ì¶œì„ í–ˆë˜ <br />
<code class="language-plaintext highlighter-rouge">UsernamePasswordAuthenticationFilter</code> í´ë˜ìŠ¤ë¡œ<br />
ì¸ì¦ì´ì™„ë£Œëœ ê°ì²´ê°€ ë°˜í™˜ë˜ê²Œ ë˜ì–´ì§„ë‹¤.<br />
<em><strong>(â­•ï¸Authentication ê°ì²´ëŠ” ì¸ì¦ì´ ì™„ë£Œë¨)</strong></em></p>

<p><br /></p>

<p>(12). ìµœì¢…ì ìœ¼ë¡œ ì¸ì¦ì´ ì™„ë£Œëœ Authentication ê°ì²´ë¥¼<br />
<code class="language-plaintext highlighter-rouge">SecurityContextHolder</code>ë¥¼ ì´ìš©í•´ <code class="language-plaintext highlighter-rouge">SecurityContext</code>ì— ì €ì¥ì„í•˜ê²Œ ëœë‹¤.<br />
S<code class="language-plaintext highlighter-rouge">ecurityContext</code>ì˜ ì„¸ì…˜ ì •ì±…ì— ë”°ë¼ì„œ<br />
HttpSessionì— ì €ì¥ë˜ì–´ ì‚¬ìš©ìì˜ ì¸ì¦ ìƒíƒœë¥¼ ìœ ì§€í•˜ê¸°ë„ í•˜ê³ <br />
HttpSessionì„ ìƒì„±í•˜ì§€ ì•Šê³  ë¬´ìƒíƒœë¥¼ ìœ ì§€í•˜ê¸°ë„ í•œë‹¤.</p>

<p><br /></p>

<hr />

<p>ì´ë ‡ê²Œ ì˜¤ëŠ˜ì€ SecurityFilterChainì—ì„œ<br />
ì–´ë–»ê²Œ ì¸ì¦ì´ ì´ë£¨ì–´ì§€ëŠ”ì§€ ì•Œì•„ë³´ì•˜ë‹¤.</p>

<p>ì˜¤ëŠ˜ ì •ë§ íŒŒê¸‰ì ì¸ íš¨ê³¼ë¡œ ì½”ë“œì— ëŒ€í•´ ì´í•´ë¥¼ í–ˆë‹¤.<br />
ì•„í‚¤í…ì³ë¥¼ ê·¸ë ¤ê°€ë©´ì„œ, ì‹¤ì œ ì½”ë“œë“¤ì´ í˜¸ì¶œë˜ì„œ<br />
ì‹¤í–‰ë˜ëŠ” ê²ƒì„ í•˜ë‚˜í•˜ë‚˜ ë”°ë¼ê°€ë³´ë©´ì„œ ìˆœì„œì— ëŒ€í•œ íë¦„ì„ ê¸€ë¡œ ì •ë¦¬í•´ë´¤ë‹¤.</p>

<p>ì´ë ‡ê²Œ ì½”ë“œë¥¼ ë”°ë¼ê°€ë©´ì„œ, íŒŒì•…í•œ ë‚´ìš©ì„ ì ê³  í•˜ë‹¤ë³´ë‹ˆê¹Œ<br />
ì–´ë””ì„œ ë¶€í„° ì‹œì‘ë˜ì—ˆê³ , ì–´ë–»ê²Œ ê°ì²´ë¥¼ ëŒë ¤ë°›ëŠ”ì§€ê°€<br />
íŒŒì•…ë˜ë‹¤ë³´ë‹ˆê¹Œ ì–´ëŠì •ë„ ì¸ì¦ì²˜ë¦¬ì— ëŒ€í•œ íë¦„ì€ ì¡íŒ ê²ƒ ê°™ë‹¤.</p>

<p>ì˜¤ëŠ˜ ê³µë¶€ëŠ” ì—¬ê¸°ì„œ ë !!</p>

<p><br /></p>

<p><span style="color:#994C00"><strong>ì˜¤ëŠ˜ì˜ ì»¤í”¼ëŸ‰</strong></span>: â˜•ï¸ â˜•ï¸<br />
<strong>ì˜¤ëŠ˜ì˜ ì ì‹¬</strong>: ëœì¥ì°Œê°œ, ë¼ë©´, ë°¥</p>]]></content><author><name>LEE JAEHYEOK</name></author><category term="TIL" /><category term="TIL" /><category term="ë¶€íŠ¸ìº í”„" /><category term="ì½”ë“œìŠ¤í…Œì´ì¸ " /><summary type="html"><![CDATA[ì£¼ë§ì´ë¼ëŠ” ê²ƒì€â€¦ ì‚¬ëŒì„ ì°¸ ë‚˜íƒœí•˜ê²Œ ë§Œë“¤ê¸°ë„ í™œë ¥ì„ ê³µê¸‰í•˜ê¸°ë„ í•˜ëŠ” ê²ƒ ê°™ë‹¤.]]></summary></entry><entry><title type="html">TIL) Spring Security 1 (ê¸°ì´ˆ)</title><link href="http://localhost:4000/til/2022/11/18/til.html" rel="alternate" type="text/html" title="TIL) Spring Security 1 (ê¸°ì´ˆ)" /><published>2022-11-18T00:00:00+09:00</published><updated>2022-11-18T00:00:00+09:00</updated><id>http://localhost:4000/til/2022/11/18/til</id><content type="html" xml:base="http://localhost:4000/til/2022/11/18/til.html"><![CDATA[<p><img src="https://lh3.googleusercontent.com/u/0/drive-viewer/AFDK6gMbi5KBKT2qUujSToFzrlGZ8riZgXZWFRWl1il4pHA0AlwRLqDL1ROTXlmdEytfEfxx0rpCo3VI8iZTbovSWK60aVBtSA=w3024-h1728" alt="image" class="align-left" style="max-width: 100%" /></p>

<p>ì˜ˆì „ë³´ë‹¤ ì›”-ê¸ˆ ì‹œê°„ì´ ì •ë§ ë¹¨ë¦¬ê°„ë‹¤.<br />
ê·¸ë§Œí¼ ê³µë¶€í•˜ëŠ” ì‹œê°„ì„ ì¦ê¸°ê³  ìˆìœ¼ë‹ˆ ì‹œê°„ë„ ë¹¨ë¦¬ê°€ëŠ” ê²ƒ ê°™ë‹¤.</p>

<p>ì˜¤ëŠ˜ë„ ì´ë²ˆì£¼ì˜ ë§ˆì§€ë§‰ì´ë‹ˆ ë§Œí¼<br />
ë” ì§‘ì¤‘í•´ì„œ ê³µë¶€í•´ë³´ì !</p>

<hr />

<p>ì˜¤ëŠ˜ì€ Spring Securityì— ëŒ€í•´ ê³µë¶€í•˜ëŠ” ë‚ ì´ë‹¤.<br />
ë‹¤ìŒì£¼ì—ë„ ê³„ì† ê³µë¶€í•  ê²ƒ ê°™ê³ <br />
ì˜¤ëŠ˜ì€ ê¸°ë³¸ êµ¬ì¡°ì™€ ì›¹ ìš”ì²­ ì²˜ë¦¬ íë¦„ì—ëŒ€í•´ ê³µë¶€í•´ë³´ë ¤í•œë‹¤.</p>

<h2 id="spring-security">Spring Security</h2>

<p><strong>Spring Securityë€ ?</strong><br />
Spring MVC ê¸°ë°˜ ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ì¸ì¦,ì¸ê°€ ê¸°ëŠ¥ì„<br />
ì§€ì›í•˜ëŠ” ë³´ì•ˆ í”„ë ˆì„ì›Œí¬ì´ë‹¤.</p>

<p>Interceptorë‚˜ Servlet Filterê³¼ ê°™ì€ ë³´ì•ˆ ê¸°ëŠ¥ì„<br />
ì§ì ‘ êµ¬í˜„í•  ìˆ˜ ìˆì§€ë§Œ Spring Securityì—ì„œ ì•ˆì •ì ìœ¼ë¡œ ì§€ì›í•˜ê³  ìˆê¸° ë•Œë¬¸ì—<br />
Spring MVCë¥¼ ê¸°ë°˜ìœ¼ë¡œí•œë‹¤ë©´ Spring Securityë¥¼ ì´ìš©í•˜ëŠ”ê²Œ ì•ˆì „í•œ ì„ íƒì´ë¼ í•  ìˆ˜ ìˆë‹¤.</p>

<p><strong>ìŠ¤í”„ë§ ì‹œíë¦¬í‹°ë¥¼ ì´ìš©í•œë‹¤ë©´ ?</strong></p>
<ol>
  <li>ë‹¤ì–‘í•œ ìœ í˜•ì˜ ì‚¬ìš©ì ì¸ì¦ ê¸°ëŠ¥ ì ìš© ê°€ëŠ¥ (í¼ ë¡œê·¸ì¸, í† í°, OAuth 2ê¸°ë°˜ ì¸ì¦)</li>
  <li>ì• í”Œë¦¬ì¼€ì´ì…˜ ì‚¬ìš©ìì˜ ì—­í• ì— ë”°ë¥¸ ê¶Œí•œ ë ˆë²¨ ì ìš©</li>
  <li>ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ ì œê³µí•˜ëŠ” ë¦¬ì†ŒìŠ¤ ëŒ€í•œ ì ‘ê·¼ ì œì–´</li>
  <li>ë¯¼ê°í•œ ì •ë³´ì— ëŒ€í•œ ë°ì´í„° ì•”í˜¸í™”</li>
  <li>ì¼ë°˜ì ìœ¼ë¡œ ì•Œë ¤ì§„ ì›¹ ë³´ì•ˆ ê³µê²© ì°¨ë‹¨</li>
</ol>

<p>ìŠ¤í”„ë§ ì‹œíë¦¬í‹° ê´€ë ¨ ìš©ì–´ë¥¼ ë¯¸ë¦¬ ìˆ™ì§€í•˜ê³  <br />
ë³¸ê²©ì ì¸ ë‚´ìš©ì„ ì‚´í´ë³´ë©´ ë„ì›€ì´ ë  ê²ƒì´ë‹¤.</p>
<ol>
  <li><strong>Principal (ì£¼ì²´)</strong><br />
-&gt; ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ ì‘ì—…ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆëŠ” ì‚¬ìš©ì,ë””ë°”ì´ìŠ¤,ì‹œìŠ¤í…œ ë“±ì´ ë  ìˆ˜ ìˆë‹¤.<br />
ì¸ì¦ í”„ë¡œì„¸ìŠ¤ê°€ ì„±ê³µì ìœ¼ë¡œ ìˆ˜í–‰ëœ ì‚¬ìš©ìì˜ ê³„ì • ì •ë³´ë¥¼ ì˜ë¯¸í•¨.</li>
  <li><strong>Authentication (ì¸ì¦)</strong><br />
-&gt; ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì‚¬ìš©í•˜ëŠ” ì‚¬ìš©ìê°€ ë³¸ì¸ì´ ë§ìŒì„ ì¦ëª…í•˜ëŠ” ì ˆì°¨</li>
  <li><strong>Authorization (ì¸ê°€)</strong><br />
-&gt; ì¸ì¦ì´ ì •ìƒì ìœ¼ë¡œ ìˆ˜í–‰ëœ ì‚¬ìš©ìì—ê²Œ í•˜ë‚˜ ì´ìƒì˜ ê¶Œí•œì„ ë¶€ì—¬í•¨.<br />
íŠ¹ì • ì• í”Œë¦¬ì¼€ì´ì…˜ì— íŠ¹ì • ë¦¬ì†ŒìŠ¤ì— ì ‘ê·¼í•  ìˆ˜ ìˆê²Œ í—ˆê°€í•˜ëŠ” ê³¼ì •ì„ ì˜ë¯¸í•œë‹¤.</li>
  <li><strong>Access Control (ì ‘ê·¼ì œì–´)</strong><br />
-&gt; ì‚¬ìš©ìê°€ ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ë¦¬ì†ŒìŠ¤ì— ì ‘ê·¼í•˜ëŠ” í–‰ìœ„ë¥¼ ì œì–´í•˜ëŠ” ê²ƒì„ ì˜ë¯¸í•œë‹¤.</li>
  <li><strong>Credential (ì‹ ì› ì¦ëª…ì •ë³´)</strong><br />
-&gt; ì¸ì¦ì„ ì •ìƒì ìœ¼ë¡œ ìˆ˜í–‰í•˜ê¸° ìœ„í•´ì„œ ì‹ë³„í•˜ê¸° ìœ„í•œ ì •ë³´.</li>
</ol>

<p><br /></p>

<h3 id="spring-security-íë¦„">Spring Security íë¦„</h3>

<p>ì‚¬ìš©í•´ë³´ê¸°ì— ì•ì„œ<br />
SSRë°©ì‹ìœ¼ë¡œ í…ŒìŠ¤íŠ¸ë¥¼ ì§„í–‰í•  ì˜ˆì •ì´ë‹¤.<br />
ë³„ë„ì˜ htmlì„ ë§Œë“¤ì–´ì„œ í…ŒìŠ¤íŠ¸ë¥¼ ì§„í–‰í–ˆê³ <br />
Form Login ë°©ì‹ìœ¼ë¡œ í…ŒìŠ¤íŠ¸ë¥¼ ì§„í–‰í–ˆë‹¤.</p>

<p>ê°„ë‹¨í•œ ìŠ¤í”„ë§ ì‹œíë¦¬í‹°ì˜ ë³´ì•ˆ ì ìš© íë¦„ì„ ì•Œê³  ë„˜ì–´ê°€ë³´ì.<br />
ìš°ë¦¬ëŠ” ë³´í†µ ì›¹ì—ì„œ ìš”ì²­ì„ ë³´ë‚´ë©´ EndPointë¥¼ ê±°ì³ ë¦¬ì†ŒìŠ¤ì— ì ‘ê·¼ì„ í•œë‹¤.</p>

<p>Servlet ê¸°ë°˜ì˜ ì• í”Œë¦¬ì¼€ì´ì…˜ì¼ ê²½ìš° EndPointì— ìš”ì²­ì´ ë„ë‹¬í•˜ê¸°ì „ì— ìš”ì²­ì„ ê°€ë¡œì±ˆ í›„  <br />
ì–´ë–¤ ì²˜ë¦¬ë¥¼ í•  ìˆ˜ ìˆëŠ” ì ì ˆí•œ í¬ì¸íŠ¸ë¥¼ ì œê³µí•´ì¤„ ìˆ˜ ìˆëŠ” APIê°€ ìˆë‹¤.<br />
ê·¸ê²ƒì€ ë°”ë¡œ Servlet Filterì´ë‹¤.</p>

<p>Servlet Filterë¥¼ ì ê¹ ì •ë¦¬í•˜ìë©´</p>
<ol>
  <li>Javaì—ì„œ Interfaceí˜•íƒœë¡œ ì œê³µí•˜ëŠ” APIì´ë‹¤.</li>
  <li>ì›¹ìš”ì²­ì„ ê°€ë¡œì±„ ì „ì²˜ë¦¬, ì‘ë‹µì„ ì „ë‹¬í•˜ê¸°ì „ í›„ì²˜ë¦¬ë¥¼ í•  ìˆ˜ ìˆë‹¤.</li>
</ol>

<p>ì´ëŸ¬í•œ Servlet FilterëŠ” í•˜ë‚˜ ì´ìƒì˜ í•„í„°ë“¤ì„ ì—°ê²°í•´<br />
Filter Chainì„ êµ¬ì„±í•  ìˆ˜ ìˆë‹¤.</p>

<p><img src="https://lh3.googleusercontent.com/u/0/drive-viewer/AFDK6gOgZKwDg4Q2Nju5ltzUyuDISAyDNnWwDlA-x9U3zTRmZq0JpKZx5Q6Qg95NA9nMQoOQuuyyURwFi0LI-XHIUlnGlFw3Ew=w3024-h1620" alt="image" class="align-left" style="max-width: 40%" /><br />
ì¶œì²˜ - <a href="https://docs.spring.io/spring-security/reference/servlet/architecture.html">Spring Security ë ˆí¼ëŸ°ìŠ¤</a></p>

<p><br /></p>

<p>Filter Chainì˜ Filterë“¤ì€ ìš°ë¦¬ê°€ êµ¬í˜„í•œ ì‘ì—…ë“¤ì„ ì‹¤í–‰í•œ í›„ì—<br />
HttpServletì„ ê±°ì³ DispatcherServletì— ìš”ì²­ì´ ì „ë‹¬ë˜ì–´ì§„ë‹¤.</p>

<p>DispatcherServletì€ Spring MVC ê³„ì¸µêµ¬ì¡°í• ë•Œ ë§ì´ ë³´ì•˜ì„ ê²ƒì´ë‹¤.<br />
í´ë¼ì´ì–¸íŠ¸ì—ì„œ ë°›ì€ ëª¨ë“  ìš”ì²­ì„ ì í•©í•œ ì»¨íŠ¸ë¡¤ëŸ¬ì— ìœ„ì„í•´ì£¼ëŠ”<br />
Spring MVCì—ì„œ ì•„ì£¼ ì¤‘ìš”í•œ ì—­í• ì„ ê°€ì§€ê³  ìˆëŠ” ë…€ì„ì´ì˜€ë‹¤.</p>

<p>ì—¬í•˜íŠ¼ ìš°ë¦¬ê°€ ì•Œì•„ì•¼í•  í•µì‹¬ì€ DispatcherServletì— ë„ë‹¬í•˜ê¸° ì „ì—<br />
Servlet Filterê°€ ê°€ë¡œì±ˆë‹¤ëŠ” ê²ƒì´ë‹¤.</p>

<p><br /></p>

<p>ê·¸ëŸ¼ Spring Securityì™€ Servlet Filterì™€ ì–´ë– í•œ ê´€ê³„ê°€ ìˆëƒ?</p>

<p>Spring Securityì—ì„œëŠ” ë³´ì•ˆê³¼ ê´€ë ¨ëœ Filterë¥¼ ì´ìš©í•´ <br />
í´ë¼ì´ì–¸íŠ¸ì— ìš”ì²­ì„ ì¤‘ê°„ì— ê°€ë¡œì±ˆ ë’¤ ì¶”ê°€ì ìœ¼ë¡œ ì‘ì—…ì„ í•  ìˆ˜ ìˆë„ë¡ ë„ì™€ì¤€ë‹¤.</p>

<p><img src="https://lh3.googleusercontent.com/u/0/drive-viewer/AFDK6gMdhZrHIw8wm0G_zG7eQgHqqNnxZhifIy-8Y1taID3Id73Ik4ScIIQt6oclNltVUbpDmsfKO-prb1xGOdVcuLX7eJCA7A=w3024-h1620" alt="image" class="align-left" style="max-width: 70%" /><br />
ì¶œì²˜ - <a href="https://docs.spring.io/spring-security/reference/servlet/architecture.html">Spring Security ë ˆí¼ëŸ°ìŠ¤</a></p>

<p><br /></p>

<p>ê·¸ê²ƒì„ ë„ì™€ì£¼ëŠ” í´ë˜ìŠ¤ë“¤ì´ ë°”ë¡œ ìœ„ì—ìˆëŠ” ì•„í‚¤í…ì³ì—ì„œ ë³´ëŠ”<br />
DelegatingFilterProxyì™€ FilterChainProxyì´ë‹¤. <br />
í•´ë‹¹ í´ë˜ìŠ¤ë“¤ì€ Filter ì¸í„°í˜ì´ìŠ¤ë¥¼ êµ¬í˜„í•˜ê³  ìˆì–´<br />
Servlet Filterë¡œì¨ì˜ ì—­í• ì„ ìˆ˜í–‰í•´í•œë‹¤.</p>

<p>DelegatingFilterProxyëŠ” Servlet Container ì˜ì˜ Filterì™€<br />
ApplicationContextì— Beanìœ¼ë¡œ ë“±ë¡ëœ Filterë“¤ì„ ì—°ê²°í•´ì£¼ëŠ” ì—­í• ì„ ê°€ì§„ë‹¤.</p>

<p>FilterChainProxyëŠ” Spring Securityë¥¼ ì‚¬ìš©í•˜ê¸° ìœ„í•œ ì§„ì…ì ì´ë‹¤.</p>

<p><img src="https://lh3.googleusercontent.com/u/0/drive-viewer/AFDK6gNcZKkvVUXMS9csndq0ceE71GN1u2pu7EDH5twxx0Grcg4f36ZzPqvVnHu73GrKupyuIf_iKM3qR7WVa328iuXmCWqZjQ=w3024-h1620" alt="image" class="align-left" style="max-width: 80%" /><br />
ì¶œì²˜ - <a href="https://docs.spring.io/spring-security/reference/servlet/architecture.html">Spring Security ë ˆí¼ëŸ°ìŠ¤</a></p>

<p><br /></p>

<p>ìœ„ì˜ ê·¸ë¦¼ì—ì„œ ë³´ë“¯ì´ Spring Securityì˜ Filter Chainìœ¼ë¡œ <br />
ë³´ì•ˆì„ ìœ„í•œ ì‘ì—…ì„ ì²˜ë¦¬í•˜ëŠ” í•„í„°ì˜ ëª¨ìŒì„ ë§Œë“¤ë©´ <br />
FilterChainProxyë¡œ ë¶€í„° í•´ë‹¹ Filterë“¤ì„ ì‹œì‘í•  ìˆ˜ ìˆê²Œë˜ì–´ì§„ë‹¤.</p>

<p>í•œë§ˆë””ë¡œ FilterChainProxyë¶€í„° Spring Securityì—ì„œ ì œê³µí•˜ëŠ”<br />
ë³´ì•ˆ Filterë“¤ì´ í•„ìš”í•œ ì‘ì—…ì„ ìˆ˜í–‰í•´ì£¼ê²Œ ë„ì™€ì£¼ëŠ” í´ë˜ìŠ¤ë¼ ë³´ë©´ëœë‹¤.</p>

<p><br /></p>

<h3 id="spring-security-ì—°ìŠµí•´ë³´ê¸°">Spring Security ì—°ìŠµí•´ë³´ê¸°</h3>

<p>ìœ„ì˜ Spring Security ìš”ì²­ íë¦„ì— ëŒ€í•´ ì–´ëŠì •ë„<br />
ì´í•´ê°€ ë˜ì—ˆë‹¤ë©´, ì•„ë˜ ì½”ë“œë“¤ì„ ë³´ê³ <br />
ì–´ëŠ ë¶€ë¶„ì¸ì§€ ì •í™•íˆëŠ” ëª°ë¼ë„ íë¦„ì€ íŒŒì•…ì´ ê°€ëŠ¥í•˜ë‹¤.</p>

<p>ìš°ì„  Spring Securityë¥¼ ì‚¬ìš©í•˜ê¸° ìœ„í•œ ì˜ì¡´ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì¶”ê°€í•´ì•¼í•œë‹¤.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">implementation</span> <span class="err">'</span><span class="n">org</span><span class="o">.</span><span class="na">springframework</span><span class="o">.</span><span class="na">boot</span><span class="o">:</span><span class="n">spring</span><span class="o">-</span><span class="n">boot</span><span class="o">-</span><span class="n">starter</span><span class="o">-</span><span class="n">security</span><span class="err">'</span>
</code></pre></div></div>
<p>build.gradleì— ì˜ì¡´ë¼ì´ë¸ŒëŸ¬ë¥¼ ì¶”ê°€ì‹œì¼œ ë†“ìœ¼ë©´ ì¤€ë¹„ ëì´ë‹¤.</p>

<p>ì²˜ìŒìœ¼ë¡œ ìš°ì„  ìœ„ì—ì„œ ë³´ì•˜ë˜<br />
SecurityFilterChainì„ êµ¬ì„±í•´ë³´ì</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Configuration</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SecurityConfiguration</span> <span class="o">{</span>
    
    <span class="nd">@Bean</span>
    <span class="kd">public</span> <span class="nc">SecurityFilterChain</span> <span class="nf">filterChain</span><span class="o">(</span><span class="nc">HttpSecurity</span> <span class="n">http</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
        <span class="n">http</span>
                <span class="o">.</span><span class="na">csrf</span><span class="o">().</span><span class="na">disable</span><span class="o">()</span> <span class="c1">// csrf ê³µê²©ì— ëŒ€í•œ ì„¤ì • ë¹„í™œì„±í™”</span>
                <span class="o">.</span><span class="na">formLogin</span><span class="o">()</span><span class="c1">// Form ë¡œê·¸ì¸ ì¸ì¦ ë°©ë²•</span>
                <span class="o">.</span><span class="na">loginPage</span><span class="o">(</span><span class="s">"/auths/login-form"</span><span class="o">)</span> <span class="c1">// ë¡œê·¸ì¸ ì»¤ìŠ¤í…€ í˜ì´ì§€ ì„¤ì • (ìš°ë¦¬ê°€ë§Œë“  ê²½ë¡œì„¤ì •)</span>
                <span class="o">.</span><span class="na">loginProcessingUrl</span><span class="o">(</span><span class="s">"/process_login"</span><span class="o">)</span><span class="c1">// ì¸ì¦ìš”ì²­ì„ ìˆ˜í–‰í•  ìš”ì²­ URL ì„¤ì • (html formíƒœê·¸ì—ì„œ ìš”ì²­)</span>
                <span class="o">.</span><span class="na">failureUrl</span><span class="o">(</span><span class="s">"/auths/login-form?error"</span><span class="o">)</span><span class="c1">// ì‹¤íŒ¨ì‹œ ë¦¬ë‹¤ì´ë ‰íŠ¸í•  URL ì§€ì •</span>
                <span class="o">.</span><span class="na">and</span><span class="o">()</span> <span class="c1">// ë³´ì•ˆì„¤ì •ì„ ë©”ì„œë“œ ì²´ì¸í˜•íƒœë¡œ êµ¬ì„±í•˜ê²Œ ë„ì™€ì¤Œ</span>
                <span class="o">.</span><span class="na">logout</span><span class="o">()</span> <span class="c1">// ë¡œê·¸ì•„ì›ƒ ì„¤ì •ìœ„í•œ LogoutConfigurerë¥¼ ë¦¬í„´í•´ì¤Œ</span>
                <span class="o">.</span><span class="na">logoutUrl</span><span class="o">(</span><span class="s">"/logout"</span><span class="o">)</span> <span class="c1">// ë¡œê·¸ì•„ì›ƒ ìš”ì²­ url ì„¤ì • (html formíƒœê·¸ì—ì„œ ìš”ì²­)</span>
                <span class="o">.</span><span class="na">logoutSuccessUrl</span><span class="o">(</span><span class="s">"/"</span><span class="o">)</span> <span class="c1">// ì„±ê³µì‹œ ë¦¬ë‹¤ì´ë ‰íŠ¸í•  ì¥ì†Œ</span>
                <span class="o">.</span><span class="na">and</span><span class="o">()</span> <span class="c1">// ë³´ì•ˆì„¤ì •ì„ ë©”ì„œë“œ ì²´ì¸í˜•íƒœë¡œ êµ¬ì„±í•˜ê²Œ ë„ì™€ì¤Œ</span>
                <span class="o">.</span><span class="na">exceptionHandling</span><span class="o">().</span><span class="na">accessDeniedPage</span><span class="o">(</span><span class="s">"/auths/access-denied"</span><span class="o">)</span> <span class="c1">// ê¶Œí•œì´ ì—†ì„ë•Œ ë³´ë‚¼ ìš”ì²­</span>
                <span class="o">.</span><span class="na">and</span><span class="o">()</span> <span class="c1">// ë³´ì•ˆì„¤ì •ì„ ë©”ì„œë“œ ì²´ì¸í˜•íƒœë¡œ êµ¬ì„±í•˜ê²Œ ë„ì™€ì¤Œ</span>
                <span class="o">.</span><span class="na">authorizeHttpRequests</span><span class="o">(</span><span class="n">authorize</span> <span class="o">-&gt;</span>
                        <span class="n">authorize</span><span class="o">.</span><span class="na">antMatchers</span><span class="o">(</span><span class="s">"/orders/**"</span><span class="o">).</span><span class="na">hasRole</span><span class="o">(</span><span class="s">"ADMIN"</span><span class="o">)</span> <span class="c1">// í•´ë‹¹ ê²½ë¡œì— ADMIN ê¶Œí•œë§Œ ì ‘ê·¼ê°€ëŠ¥</span>
                                <span class="o">.</span><span class="na">antMatchers</span><span class="o">(</span><span class="s">"/members/my-page"</span><span class="o">).</span><span class="na">hasRole</span><span class="o">(</span><span class="s">"USER"</span><span class="o">)</span> <span class="c1">// í•´ë‹¹ ê²½ë¡œì— USER ê¶Œí•œë§Œ ì ‘ê·¼ê°€ëŠ¥</span>
                                <span class="o">.</span><span class="na">antMatchers</span><span class="o">(</span><span class="s">"/**"</span><span class="o">).</span><span class="na">permitAll</span><span class="o">()</span> <span class="c1">// ì•ì—ì§€ì •í•œ URLì„ ì œì™¸í•œê²ƒ ì ‘ê·¼ ëª¨ë‘ê°€ëŠ¥</span>
                <span class="o">);</span>
<span class="c1">//                .authorizeHttpRequests() // í´ë¼ì´ì–¸íŠ¸ì˜ ìš”ì²­ì´ ë“¤ì–´ì˜¤ë©´ ì ‘ê·¼ê¶Œí•œì„ í™•ì¸í•˜ê² ë‹¤ê³  ì •ì˜</span>
<span class="c1">//                .anyRequest() // í´ë¼ì´ì–¸íŠ¸ì˜ ëª¨ë“  ìš”ì²­ì— ëŒ€í•´ ì ‘ê·¼ì„ í—ˆìš©</span>
<span class="c1">//                .permitAll(); // í´ë¼ì´ì–¸íŠ¸ì˜ ëª¨ë“  ìš”ì²­ì— ëŒ€í•´ ì ‘ê·¼ì„ í—ˆìš©</span>
        <span class="k">return</span> <span class="n">http</span><span class="o">.</span><span class="na">build</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>ê¸°ë³¸ì ì¸ êµ¬ì„±ë°©ë²•ì€ SecurityFilterChain í´ë˜ìŠ¤ íƒ€ì…ì„ ë°˜í™˜í•˜ëŠ”<br />
ë©”ì„œë“œë¥¼ í•˜ë‚˜ ë§Œë“¤ì–´ filterì˜ ì •ë³´ë¥¼ ë„£ì–´ì£¼ëŠ” ê²ƒì´ë‹¤.<br />
ê·¸ë¦¬ê³  í•´ë‹¹ ë©”ì„œë“œë¥¼ Spring Containerì— Beanìœ¼ë¡œ ë‹´ì•„ì£¼ë©´ëœë‹¤.</p>

<p>ë¹ˆìœ¼ë¡œ ë‹´ì•„ì£¼ë©´ ì•„ê¹Œ ìœ„ì—ì„œ ì–˜ê¸°í–ˆë˜<br />
DelegatingFilterProxy í´ë˜ìŠ¤ì— ì˜í•´<br />
ì„œë¸”ë¦¿ ì»¨í…Œì´ë„ˆ ì˜ì—­ì˜ í•„í„°ì™€ ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆì˜ ë¹ˆìœ¼ë¡œ ë“±ë¡ëœ í•„í„°ë¥¼<br />
ì—°ê²°í•´ì£¼ëŠ” ë¸Œë¦¿ê°€ ìƒê¸´ë‹¤ê³  ì˜ˆìƒí•´ë³¼ ìˆ˜ ìˆì„ ê²ƒ ê°™ë‹¤.</p>

<p>ê·¸ë¦¬ê³  SSRë°©ì‹ì˜ FormLoginì„ ì‚¬ìš©í•œë‹¤ê³  ê°€ì •í–ˆìœ¼ë‹ˆ<br />
ì²«ë²ˆì§¸ í•„í„°ë¡œëŠ” ë¡œê·¸ì¸ì— í•´ë‹¹í•˜ëŠ” ë‚´ìš©ë“¤  <br />
ë‘ë²ˆì§¸ í•„í„°ë¡œëŠ” ë¡œê·¸ì•„ì›ƒì— í•´ë‹¹í•˜ëŠ” ë‚´ìš©ë“¤ <br />
ì„¸ë²ˆì§¸ë¡œëŠ” ê¶Œí•œì´ ì—†ì„ë•Œ ì²˜ë¦¬í•˜ëŠ” ë‚´ìš©<br />
ë„¤ë²ˆì§¸ë¡œëŠ” í´ë¼ì´ì–¸íŠ¸ ìš”ì²­ì—ë”°ë¥¸ ê¶Œí•œ ì„¤ì •ì— ëŒ€í•œ ë‚´ìš©<br />
ì´ë ‡ê²Œ ê°ê° í•„í„°ë“¤ì„ í•˜ë‚˜ì˜ í•„í„°ì²´ì¸ìœ¼ë¡œ .build(); í•˜ì—¬ ë°˜í™˜í•˜ë©´<br />
í•´ë‹¹ ë‚´ìš©ì— ë”°ë¼ ì¸ì¦ê³¼ ê¶Œí•œ ë¶€ì—¬ê°€ ì´ë£¨ì–´ì§ˆ ìˆ˜ ìˆë‹¤.</p>

<p><br /></p>

<h4 id="in-memoryë¡œ-ì¸ì¦-í•´ë³´ê¸°">In Memoryë¡œ ì¸ì¦ í•´ë³´ê¸°</h4>

<p>DBë¥¼ ì´ìš©í•˜ì§€ ì•ŠëŠ” ì¸ì¦ë°©ë²•ì„ í•œë²ˆ ì—°ìŠµí•´ë³´ì</p>

<p><strong><span style="color:#F04965"> 1). ë‹¨ìˆœí•˜ê²Œ ê³ ì •í•´ì„œ ë“±ë¡í•´ ì¸ì¦ê³¼ ê¶Œí•œì„ ì£¼ëŠ” ë°©ì‹ </span></strong></p>

<p>SecurityConfiguration í´ë˜ìŠ¤ ì•„ë˜ì— <br />
UserDetailsManager ë°˜í™˜í•˜ëŠ” Bean ê°ì²´ë¥¼ ë§Œë“¤ì–´ì£¼ì—ˆë‹¤.</p>

<p>UserDetailsManager ë¼ëŠ” ì¸í„°í˜ì´ìŠ¤ë¥¼ <br />
êµ¬í˜„í•œ ê°ì²´ë¥¼ Beanìœ¼ë¡œ ë“±ë¡í•´ì£¼ë©´ í•´ë‹¹ ì •ë³´ë¡œ ë“±ë¡ëœ<br />
ì‚¬ìš©ìë“¤ì€ ì •ë³´ì— í•´ë‹¹í•˜ëŠ” ì¸ì¦ê³¼ ê¶Œí•œì„ ê°€ì§€ê²Œ ëœë‹¤.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="nd">@Bean</span>
 <span class="kd">public</span> <span class="nc">UserDetailsManager</span> <span class="nf">userDetailsService</span><span class="o">(){</span>
     <span class="nc">UserDetails</span> <span class="n">user</span> <span class="o">=</span> <span class="nc">User</span><span class="o">.</span><span class="na">withDefaultPasswordEncoder</span><span class="o">()</span> <span class="c1">// password ì•”í˜¸í™”</span>
             <span class="o">.</span><span class="na">username</span><span class="o">(</span><span class="s">"dhfif718@naver.com"</span><span class="o">)</span> <span class="c1">// ì‹ë³„í•˜ëŠ” ì‚¬ìš©ì ì•„ì´ë”” ê°’</span>
             <span class="o">.</span><span class="na">password</span><span class="o">(</span><span class="s">"1111"</span><span class="o">)</span>
             <span class="o">.</span><span class="na">roles</span><span class="o">(</span><span class="s">"USER"</span><span class="o">)</span> <span class="c1">// ê¶Œí•œì§€ì •</span>
             <span class="o">.</span><span class="na">build</span><span class="o">();</span>
     <span class="nc">UserDetails</span> <span class="n">admin</span> <span class="o">=</span> <span class="nc">User</span><span class="o">.</span><span class="na">withDefaultPasswordEncoder</span><span class="o">()</span>
             <span class="o">.</span><span class="na">username</span><span class="o">(</span><span class="s">"admin@naver.com"</span><span class="o">)</span>
             <span class="o">.</span><span class="na">password</span><span class="o">(</span><span class="s">"2222"</span><span class="o">)</span>
             <span class="o">.</span><span class="na">roles</span><span class="o">(</span><span class="s">"ADMIN"</span><span class="o">)</span>
             <span class="o">.</span><span class="na">build</span><span class="o">();</span>

     <span class="k">return</span> <span class="k">new</span> <span class="nf">InMemoryUserDetailsManager</span><span class="o">(</span><span class="n">user</span><span class="o">,</span><span class="n">admin</span><span class="o">);</span>
 <span class="o">}</span>
</code></pre></div></div>
<p>InMemoryUserDetailsManager êµ¬í˜„ì²´ë¡œ êµ¬ì„± ì •ë³´ë¥¼ ë„˜ê²¨ì£¼ë©´ ëœë‹¤.<br />
êµ¬ì„± ì •ë³´ë¥¼ ë§Œë“œëŠ” ë°©ë²•ì€ UserDetails ì¸í„°í˜ì´ìŠ¤ë¥¼ ìƒì†ë°›ëŠ”<br />
User í´ë˜ìŠ¤ë¥¼ ì´ìš©í•´ ë§Œë“¤ ìˆ˜ìˆë‹¤.</p>

<p>ë§Œì•½ í´ë¼ì´ì–¸íŠ¸ì—ì„œ form login ë°©ì‹ìœ¼ë¡œ ë¡œê·¸ì¸ ìš”ì²­ì´ ì˜¨ë‹¤ë©´<br />
í•´ë‹¹ êµ¬ì„±ì •ë³´ë¥¼ ê°€ì§„ ì‚¬ìš©ìëŠ” ë¡œê·¸ì¸ì´ ë˜ë©°<br />
ê¶Œí•œì„ ê°ê° USER, ADMINìœ¼ë¡œ ë¶€ì—¬ë°›ê²Œ ë˜ì–´ì§„ë‹¤.</p>

<p>ìœ„ì— ìˆëŠ” ì •ë³´ëŠ” DBë¥¼ ì´ìš©í•œ ê²ƒë„ ì•„ë‹ˆë©°<br />
ë‹¨ìˆœí•˜ê²Œ UserDetailsManager íƒ€ì…ì˜ Beanì„ ë§Œë“¤ì–´ ì£¼ ì—ˆì„ ë¿ì¸ë°<br />
Spring SecurityëŠ” í•´ë‹¹ ì •ë³´ë¥¼ ê°€ì§„ ì‚¬ìš©ìê°€ ë¡œê·¸ì¸ì„ í•˜ë©´<br />
ì¸ì¦ì„ í•´ì£¼ê³  ê¶Œí•œì„ ë¶€ì—¬í•´ì¤„ ìˆ˜ ìˆëŠ” ê²ƒì´ë‹¤.</p>

<p>ì—¬ê¸°ì„œ <strong>User.withDefaultPasswordEncoder()</strong> ë©”ì„œë“œë¥¼ ì‚¬ìš©í•˜ë©´<br />
bcrypt ë°©ì‹ìœ¼ë¡œ passwordë¥¼ ì•”í˜¸í™”í•´ì¤€ë‹¤. ì¦‰, 1111,2222ë¡œ ë“¤ì–´ì˜¨ ê°’ì„<br />
ì•”í˜¸í™”í•˜ì—¬ ê´€ë¦¬ë¥¼ í•œë‹¤ëŠ” ì˜ë¯¸ì´ë‹¤.</p>

<p>ë§Œì•½ ì½”ë“œë¡œ ì¹˜ê²Œëœë‹¤ë©´ <strong>Deprecated</strong> ìƒíƒœë¡œ ë³€í•˜ëŠ”ë° (ê°€ìš´ë°ì¤„ ì³ì§)<br />
í•´ë‹¹ APIëŠ” ê¶Œì¥í•˜ì§€ ì•ŠëŠ”ë‹¤ëŠ” ëœ»ì´ë‹¤. ì´ ê²½ìš°ì—ëŠ” ê³ ì •ìœ¼ë¡œ ì‚¬ìš©í•˜ê³  ìˆê¸°ì—<br />
ê³ ì •í•´ì„œ ì‚¬ìš©í•˜ì§€ ë§ë¼ëŠ” ì˜ë¯¸ì—ì„œ Deprecatedë¡œ ë³€í•œ ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤.</p>

<p><br /></p>

<p><strong><span style="color:#F04965"> 2). íšŒì› ê°€ì…ì„ ì´ìš©í•´ ë“±ë¡í•˜ê¸° </span></strong></p>

<p>ê¸°ë³¸ì ìœ¼ë¡œ passwordë¥¼ ì•”í˜¸í™”ë¥¼ í•´ì•¼í•œë‹¤.<br />
ì•”í˜¸í™”ë¥¼ í•˜ê¸°ìœ„í•´ ìœ„ì—ì„œ ì´ìš©í–ˆë˜ bcrpty ë°©ì‹ìœ¼ë¡œ ì•”í˜¸í™”ë¥¼ <br />
ë„ì™€ì£¼ëŠ” APIê°€ ìˆë‹¤.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="cm">/*
 * PasswordEncoder Bean ë“±ë¡
 * ì•”í˜¸í™”ë¥¼ í•´ì•¼í•œë‹¤. Spring Securityì—ì„œ ì§€ì›í•˜ëŠ” Default = bcrypt
 * */</span>
 <span class="nd">@Bean</span>
 <span class="kd">public</span> <span class="nc">PasswordEncoder</span> <span class="nf">passwordEncoder</span><span class="o">(){</span>
     <span class="k">return</span> <span class="nc">PasswordEncoderFactories</span><span class="o">.</span><span class="na">createDelegatingPasswordEncoder</span><span class="o">();</span>
 <span class="o">}</span>
</code></pre></div></div>
<p>SecurityConfiguration í´ë˜ìŠ¤ì—<br />
PasswordEncoder ì¸í„°í˜ì´ìŠ¤ íƒ€ì… ê°ì²´ë¥¼ Beanìœ¼ë¡œ ë“±ë¡í•´ì£¼ê³ <br />
íšŒì›ê°€ì…ì‹œ ì‚¬ìš©í•  ìˆ˜ìˆë‹¤.</p>

<p>íšŒì›ê°€ì…í•  ê²½ìš° ControllerëŠ” êµ¬ì„±ë˜ì–´ ìˆë‹¤ê³  ê°€ì •í•˜ê³ <br />
Service ì½”ë“œë¥¼ í™•ì¸í•´ë³´ì</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cm">/*
*  InMemory ì‚¬ìš©ì„ ìœ„í•œ ë¹ˆì£¼ì…
* */</span>
<span class="c1">//@Configuration</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">JavaConfigurationV1</span> <span class="o">{</span>

    <span class="nd">@Bean</span>
    <span class="kd">public</span> <span class="nc">MemberService</span> <span class="nf">inMemoryMemberService</span><span class="o">(</span><span class="nc">UserDetailsManager</span> <span class="n">userDetailsManager</span><span class="o">,</span> <span class="nc">PasswordEncoder</span> <span class="n">passwordEncoder</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nf">InMemoryMemberService</span><span class="o">(</span><span class="n">userDetailsManager</span><span class="o">,</span><span class="n">passwordEncoder</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>
<p>MemberServiceë¼ëŠ” ì¸í„°í˜ì´ìŠ¤ íƒ€ì…ìœ¼ë¡œ ê°ì²´ë¥¼ Beanìœ¼ë¡œ ë“±ë¡í•´ì¤€ë‹¤.</p>

<p>InMemoryMemberSerivceì— ìš°ë¦¬ê°€ ì´ìš©í•´ì•¼í• <br />
UserDetailsManagerì™€ PasswordEncoderë¥¼ ë§¤ê°œë³€ìˆ˜ë¡œ ë„£ì–´<br />
ìƒì„±ìë¡œ ë°˜í™˜í•˜ê²Œ ë˜ì–´ì§„ë‹¤.</p>

<p>ê·¸ëŸ¼ Beanìœ¼ë¡œ InMemoryMemberServiceì„ êµ¬í˜„ì²´ë¡œ<br />
ì˜ì¡´ì„± ì£¼ì…í•˜ì—¬ Controllerì—ì„œ ì´ìš©ì´ ê°€ëŠ¥í•˜ë‹¤..</p>

<p><br /></p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">InMemoryMemberService</span> <span class="kd">implements</span> <span class="nc">MemberService</span> <span class="o">{</span>

   <span class="kd">private</span> <span class="kd">final</span> <span class="nc">UserDetailsManager</span> <span class="n">userDetailsManager</span><span class="o">;</span>
   <span class="kd">private</span> <span class="kd">final</span> <span class="nc">PasswordEncoder</span> <span class="n">passwordEncoder</span><span class="o">;</span>

   <span class="kd">public</span> <span class="nf">InMemoryMemberService</span><span class="o">(</span><span class="nc">UserDetailsManager</span> <span class="n">userDetailsManager</span><span class="o">,</span> <span class="nc">PasswordEncoder</span> <span class="n">passwordEncoder</span><span class="o">)</span> <span class="o">{</span>
      <span class="k">this</span><span class="o">.</span><span class="na">userDetailsManager</span> <span class="o">=</span> <span class="n">userDetailsManager</span><span class="o">;</span>
      <span class="k">this</span><span class="o">.</span><span class="na">passwordEncoder</span> <span class="o">=</span> <span class="n">passwordEncoder</span><span class="o">;</span>
   <span class="o">}</span>

   <span class="nd">@Override</span>
   <span class="kd">public</span> <span class="nc">Member</span> <span class="nf">createMember</span><span class="o">(</span><span class="nc">Member</span> <span class="n">member</span><span class="o">)</span> <span class="o">{</span>

      <span class="nc">List</span><span class="o">&lt;</span><span class="nc">GrantedAuthority</span><span class="o">&gt;</span> <span class="n">authorities</span> <span class="o">=</span> <span class="n">createAuthorities</span><span class="o">(</span><span class="nc">Member</span><span class="o">.</span><span class="na">MemberRole</span><span class="o">.</span><span class="na">ROLE_USER</span><span class="o">.</span><span class="na">name</span><span class="o">());</span> <span class="c1">// ê¶Œí•œ USERë¡œ ì„¤ì •</span>

      <span class="nc">String</span> <span class="n">encryptedPassword</span> <span class="o">=</span> <span class="n">passwordEncoder</span><span class="o">.</span><span class="na">encode</span><span class="o">(</span><span class="n">member</span><span class="o">.</span><span class="na">getPassword</span><span class="o">());</span> <span class="c1">// ë¹„ë°€ë²ˆí˜¸ ì•”í˜¸í™” ì§„í–‰</span>

      <span class="nc">UserDetails</span> <span class="n">userDetails</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">User</span><span class="o">(</span><span class="n">member</span><span class="o">.</span><span class="na">getEmail</span><span class="o">(),</span> <span class="n">encryptedPassword</span><span class="o">,</span> <span class="n">authorities</span><span class="o">);</span> <span class="c1">// username, password, ê¶Œí•œ ì •ë³´ë¡œ ìœ ì € ìƒì„±</span>
      <span class="n">userDetailsManager</span><span class="o">.</span><span class="na">createUser</span><span class="o">(</span><span class="n">userDetails</span><span class="o">);</span> <span class="c1">// ìƒì„±í•œ ìœ ì €ì •ë³´ ë“±ë¡</span>

      <span class="k">return</span> <span class="n">member</span><span class="o">;</span>
   <span class="o">}</span>

   <span class="kd">private</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">GrantedAuthority</span><span class="o">&gt;</span> <span class="nf">createAuthorities</span><span class="o">(</span><span class="nc">String</span><span class="o">...</span> <span class="n">roles</span><span class="o">)</span> <span class="o">{</span>

      <span class="k">return</span> <span class="nc">Arrays</span><span class="o">.</span><span class="na">stream</span><span class="o">(</span><span class="n">roles</span><span class="o">)</span>
              <span class="o">.</span><span class="na">map</span><span class="o">(</span><span class="n">role</span> <span class="o">-&gt;</span> <span class="k">new</span> <span class="nc">SimpleGrantedAuthority</span><span class="o">(</span><span class="n">role</span><span class="o">))</span>
              <span class="o">.</span><span class="na">collect</span><span class="o">(</span><span class="nc">Collectors</span><span class="o">.</span><span class="na">toList</span><span class="o">());</span>
   <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>
<p>ì—¬ê¸°ì„œ íšŒì›ê°€ì…ì„ ìœ„í•œ ì„œë¹„ìŠ¤ ë¡œì§ createMember <br />
ì•ˆì˜ ë‚´ìš©ì„ ë“¤ì—¬ë‹¤ë³´ë©´ëœë‹¤.</p>

<p>ì²«ë²ˆì§¸ë¡œ ê¶Œí•œì— ëŒ€í•œ ë‚´ìš©ì„ ì„¤ì •í•˜ê¸°ìœ„í•´<br />
new SimpleGrantedAuthority();ì„ ì´ìš©í•´ ê°ì²´ë¥¼<br />
List í˜•íƒœë¡œ ë‹´ì•„ë‘” authoritiesë¥¼ ë§Œë“¤ì—ˆë‹¤.</p>

<p>ë‘ë²ˆì§¸ë¡œ ì•”í˜¸í™”ë¥¼ ìœ„í•´ DIë°›ì€ passwordEncoderì˜ ë©”ì„œë“œì¸<br />
.encode();ë¥¼ ì´ìš©í•´ ë¹„ë°€ë²ˆí˜¸ë¥¼ ë„˜ê²¨ì¤˜<br />
bcrypt ë°©ì‹ìœ¼ë¡œ ì•”í˜¸í™”í•˜ì—¬ String íƒ€ì…ìœ¼ë¡œ ë°›ì•„ë‘ì—ˆë‹¤.</p>

<p>ë§ˆì§€ë§‰ìœ¼ë¡œ new User();ë¥¼ ì´ìš©í•´<br />
ìœ„ì—ì„œ ê³ ì •ìœ¼ë¡œ êµ¬ì„±ì •ë³´ë¥¼ êµ¬ì„±í•œ ê²ƒ ì²˜ëŸ¼</p>

<p>username, password, rolesë¥¼ ìƒì„±ìë¡œ ë„˜ê²¨<br />
UserDetails íƒ€ì…ì˜ ê°ì²´ë¡œ ë§Œë“¤ì–´<br />
ìœ„ì—ì„œ DI ë°›ì€ userDetailsMangerì˜ ë©”ì„œë“œ<br />
createUser();ì˜ ë§¤ê°œë³€ìˆ˜ë¡œ ë„˜ê²¨ì£¼ê²Œ ë˜ë©´<br />
íšŒì› ê°€ì…ì„ í• ë•Œ í•´ë‹¹ ì •ë³´ë¥¼ ê°€ì§„ Memberê°€ ì¸ì¦ê³¼ ê¶Œí•œì •ë³´ë¥¼<br />
ê°€ì§€ê²Œë˜ì–´ ë¡œê·¸ì¸í• ë•Œ í•´ë‹¹ ì •ë³´ë¥¼ ê°€ì§„ ì‚¬ìš©ìê°€ ë¡œê·¸ì¸ì„ í•œë‹¤ë©´<br />
ì¸ì¦ì´ë˜ì–´ ì„¤ì •í•œ ROLE_USER ê¶Œí•œìœ¼ë¡œ ì´ìš©ì´ ê°€ëŠ¥í•˜ê²Œë˜ì–´ì§„ë‹¤.</p>

<p><br />
<br /></p>

<p><strong><span style="color:#0066CC"> ìœ„ì˜ 1,2ë²ˆì„ í•œë§ˆë””ë¡œ ì •ë¦¬ í•´ë³´ìë©´ !! </span></strong></p>

<p>UserDetails ê°ì²´ë¥¼ ë§Œë“¤ì–´ ì¤˜ì•¼í•œë‹¤.<br />
ê·¸ë¦¬ê³  ê·¸ ê°ì²´ë¥¼ ì´ìš©í•´ UserDetailsManagerì˜ êµ¬í˜„ì²´ì¸<br />
InMemoryUserDetailsManager .createUser(); ë©”ì„œë“œì—<br />
ë§¤ê°œë³€ìˆ˜ë¡œ UserDetails ê°ì²´ë¥¼ ë„˜ê²¨ì£¼ëŠ”ê²Œ ëì´ë‹¤ !</p>

<p><br /></p>

<h4 id="h2-dbë¡œ-ì¸ì¦-í•´ë³´ê¸°">H2 DBë¡œ ì¸ì¦ í•´ë³´ê¸°</h4>

<p>ìœ„ì—ì„œ UserDetailsManagerë¥¼ ì´ìš©í•´ ì¸ì¦ê³¼ ê¶Œí•œì„ ê°€ì¡Œë‹¤ë©´</p>

<p>DBë¥¼ ì´ìš©í•˜ê¸° ìœ„í•´ì„œëŠ” UserDetailsService ì¸í„°í˜ì´ìŠ¤ë¥¼ ì´ìš©í•´ì•¼í•œë‹¤.<br />
UserDetailsManagerê°€ UserDetailsServiceë¥¼ ìƒì†ë°›ì€ ê´€ê³„ì´ë‹¤.</p>

<p>ìš°ì„  H2 DB ì„¤ì •ê³¼ ê´€ë ¨ëœ ë¶€ë¶„ì€ ë˜ì–´ìˆë‹¤ê³  ê°€ì •í•˜ê² ë‹¤. <br />
ë¬¸ì œì—†ì´ H2 DataBaseë¥¼ ì‚¬ìš©í•˜ê¸° ìœ„í•´ì„œëŠ”<br />
ê¸°ì¡´ì— ì„¤ì •í–ˆë˜ SecurityFilterChainì—ì„œ í•œê°€ì§€ Filterë¥¼ ì¶”ê°€í•´ì¤˜ì•¼í•œë‹¤.</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Configuration</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SecurityConfiguration</span> <span class="o">{</span>
    
    <span class="nd">@Bean</span>
    <span class="kd">public</span> <span class="nc">SecurityFilterChain</span> <span class="nf">filterChain</span><span class="o">(</span><span class="nc">HttpSecurity</span> <span class="n">http</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
        <span class="n">http</span>
                <span class="o">.</span><span class="na">headers</span><span class="o">().</span><span class="na">frameOptions</span><span class="o">().</span><span class="na">sameOrigin</span><span class="o">()</span>  <span class="c1">// &lt;frame&gt; íƒœê·¸ë“± ë Œë”ë§ì—¬ë¶€ ì„¤ì •, ë™ì¼ ì¶œì²˜ë¡œë¶€í„° ë“¤ì–´ì˜¤ëŠ” requestë§Œ ë Œë”ë§í—ˆìš© , H2 ì‚¬ìš©ì„ ìœ„í•¨</span>
                <span class="o">.</span><span class="na">and</span><span class="o">()</span> <span class="c1">// ë³´ì•ˆì„¤ì •ì„ ë©”ì„œë“œ ì²´ì¸í˜•íƒœë¡œ êµ¬ì„±í•˜ê²Œ ë„ì™€ì¤Œ</span>
                <span class="o">.</span><span class="na">csrf</span><span class="o">().</span><span class="na">disable</span><span class="o">()</span> <span class="c1">// csrf ê³µê²©ì— ëŒ€í•œ ì„¤ì • ë¹„í™œì„±í™”</span>
                <span class="o">.</span><span class="na">formLogin</span><span class="o">()</span><span class="c1">// Form ë¡œê·¸ì¸ ì¸ì¦ ë°©ë²•</span>
                <span class="o">.</span><span class="na">loginPage</span><span class="o">(</span><span class="s">"/auths/login-form"</span><span class="o">)</span> <span class="c1">// ë¡œê·¸ì¸ ì»¤ìŠ¤í…€ í˜ì´ì§€ ì„¤ì • (ìš°ë¦¬ê°€ë§Œë“  ê²½ë¡œì„¤ì •)</span>
                <span class="o">.</span><span class="na">loginProcessingUrl</span><span class="o">(</span><span class="s">"/process_login"</span><span class="o">)</span><span class="c1">// ì¸ì¦ìš”ì²­ì„ ìˆ˜í–‰í•  ìš”ì²­ URL ì„¤ì • (html formíƒœê·¸ì—ì„œ ìš”ì²­)</span>
                <span class="o">.</span><span class="na">failureUrl</span><span class="o">(</span><span class="s">"/auths/login-form?error"</span><span class="o">)</span><span class="c1">// ì‹¤íŒ¨ì‹œ ë¦¬ë‹¤ì´ë ‰íŠ¸í•  URL ì§€ì •</span>
                <span class="o">.</span><span class="na">and</span><span class="o">()</span> <span class="c1">// ë³´ì•ˆì„¤ì •ì„ ë©”ì„œë“œ ì²´ì¸í˜•íƒœë¡œ êµ¬ì„±í•˜ê²Œ ë„ì™€ì¤Œ</span>
                <span class="o">.</span><span class="na">logout</span><span class="o">()</span> <span class="c1">// ë¡œê·¸ì•„ì›ƒ ì„¤ì •ìœ„í•œ LogoutConfigurerë¥¼ ë¦¬í„´í•´ì¤Œ</span>
                <span class="o">.</span><span class="na">logoutUrl</span><span class="o">(</span><span class="s">"/logout"</span><span class="o">)</span> <span class="c1">// ë¡œê·¸ì•„ì›ƒ ìš”ì²­ url ì„¤ì • (html formíƒœê·¸ì—ì„œ ìš”ì²­)</span>
                <span class="o">.</span><span class="na">logoutSuccessUrl</span><span class="o">(</span><span class="s">"/"</span><span class="o">)</span> <span class="c1">// ì„±ê³µì‹œ ë¦¬ë‹¤ì´ë ‰íŠ¸í•  ì¥ì†Œ</span>
                <span class="o">.</span><span class="na">and</span><span class="o">()</span> <span class="c1">// ë³´ì•ˆì„¤ì •ì„ ë©”ì„œë“œ ì²´ì¸í˜•íƒœë¡œ êµ¬ì„±í•˜ê²Œ ë„ì™€ì¤Œ</span>
                <span class="o">.</span><span class="na">exceptionHandling</span><span class="o">().</span><span class="na">accessDeniedPage</span><span class="o">(</span><span class="s">"/auths/access-denied"</span><span class="o">)</span> <span class="c1">// ê¶Œí•œì´ ì—†ì„ë•Œ ë³´ë‚¼ ìš”ì²­</span>
                <span class="o">.</span><span class="na">and</span><span class="o">()</span> <span class="c1">// ë³´ì•ˆì„¤ì •ì„ ë©”ì„œë“œ ì²´ì¸í˜•íƒœë¡œ êµ¬ì„±í•˜ê²Œ ë„ì™€ì¤Œ</span>
                <span class="o">.</span><span class="na">authorizeHttpRequests</span><span class="o">(</span><span class="n">authorize</span> <span class="o">-&gt;</span>
                        <span class="n">authorize</span><span class="o">.</span><span class="na">antMatchers</span><span class="o">(</span><span class="s">"/orders/**"</span><span class="o">).</span><span class="na">hasRole</span><span class="o">(</span><span class="s">"ADMIN"</span><span class="o">)</span> <span class="c1">// í•´ë‹¹ ê²½ë¡œì— ADMIN ê¶Œí•œë§Œ ì ‘ê·¼ê°€ëŠ¥</span>
                                <span class="o">.</span><span class="na">antMatchers</span><span class="o">(</span><span class="s">"/members/my-page"</span><span class="o">).</span><span class="na">hasRole</span><span class="o">(</span><span class="s">"USER"</span><span class="o">)</span> <span class="c1">// í•´ë‹¹ ê²½ë¡œì— USER ê¶Œí•œë§Œ ì ‘ê·¼ê°€ëŠ¥</span>
                                <span class="o">.</span><span class="na">antMatchers</span><span class="o">(</span><span class="s">"/**"</span><span class="o">).</span><span class="na">permitAll</span><span class="o">()</span> <span class="c1">// ì•ì—ì§€ì •í•œ URLì„ ì œì™¸í•œê²ƒ ì ‘ê·¼ ëª¨ë‘ê°€ëŠ¥</span>
                <span class="o">);</span>
<span class="c1">//                .authorizeHttpRequests() // í´ë¼ì´ì–¸íŠ¸ì˜ ìš”ì²­ì´ ë“¤ì–´ì˜¤ë©´ ì ‘ê·¼ê¶Œí•œì„ í™•ì¸í•˜ê² ë‹¤ê³  ì •ì˜</span>
<span class="c1">//                .anyRequest() // í´ë¼ì´ì–¸íŠ¸ì˜ ëª¨ë“  ìš”ì²­ì— ëŒ€í•´ ì ‘ê·¼ì„ í—ˆìš©</span>
<span class="c1">//                .permitAll(); // í´ë¼ì´ì–¸íŠ¸ì˜ ëª¨ë“  ìš”ì²­ì— ëŒ€í•´ ì ‘ê·¼ì„ í—ˆìš©</span>
        <span class="k">return</span> <span class="n">http</span><span class="o">.</span><span class="na">build</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>
<p>.headers().frameOptions().sameOrigin()<br />
ë©”ì„œë“œë“¤ì´ ì¶”ê°€ë˜ì—ˆê³ , ì¶”ê°€í•˜ì§€ ì•Šìœ¼ë©´</p>

<p><img src="https://lh3.googleusercontent.com/u/0/drive-viewer/AFDK6gPof1RAUkqFj1p0icu1y0Y1G_-q79XgeRnNvxsgf4sahOYXm9S9UNHjL3dST2DYsW76e9J9ZS_C961EXzBBqNjpKuygEg=w3024-h1620" alt="image" class="align-left" style="max-width: 100%" /></p>

<p>ìœ„ì˜ í™”ë©´ê³¼ ê°™ì´ ì •ìƒì ìœ¼ë¡œ H2 DataBaseê°€ í‘œì‹œë˜ì§€ ì•Šì„ ìˆ˜ ìˆë‹¤.</p>

<p><br /></p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cm">/*
*  DB ì‚¬ìš©ì„ ìœ„í•œ ë¹ˆì£¼ì…
* */</span>
<span class="nd">@Configuration</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">JavaConfigurationV2</span> <span class="o">{</span>

    <span class="nd">@Bean</span>
    <span class="kd">public</span> <span class="nc">MemberService</span> <span class="nf">dbMemberService</span><span class="o">(</span><span class="nc">MemberRepository</span> <span class="n">memberRepository</span><span class="o">,</span> <span class="nc">PasswordEncoder</span> <span class="n">passwordEncoder</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nf">DBMemberServiceV1</span><span class="o">(</span><span class="n">memberRepository</span><span class="o">,</span><span class="n">passwordEncoder</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>
<p>ê¸°ì¡´ì— InMemoryë¥¼ ì‚¬ìš©í•˜ê¸° ìœ„í•´ ì„¤ì •í–ˆë˜ êµ¬ì„±ì •ë³´ë¥¼ ì§€ìš°ê³ <br />
ìƒˆë¡œìš´ êµ¬ì„±ì •ë³´ë¥¼ ì„¤ì •. DBMemberServiceê°€ ì ìš©ë˜ë„ë¡ ìŠ¤í”„ë§ ë¹ˆìœ¼ë¡œ ë“±ë¡í–ˆë‹¤.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Transactional</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">DBMemberServiceV1</span> <span class="kd">implements</span> <span class="nc">MemberService</span> <span class="o">{</span>

   <span class="kd">private</span> <span class="kd">final</span> <span class="nc">MemberRepository</span> <span class="n">memberRepository</span><span class="o">;</span>
   <span class="kd">private</span> <span class="kd">final</span> <span class="nc">PasswordEncoder</span> <span class="n">passwordEncoder</span><span class="o">;</span>

   <span class="kd">public</span> <span class="nf">DBMemberServiceV1</span><span class="o">(</span><span class="nc">MemberRepository</span> <span class="n">memberRepository</span><span class="o">,</span> <span class="nc">PasswordEncoder</span> <span class="n">passwordEncoder</span><span class="o">)</span> <span class="o">{</span>
      <span class="k">this</span><span class="o">.</span><span class="na">memberRepository</span> <span class="o">=</span> <span class="n">memberRepository</span><span class="o">;</span>
      <span class="k">this</span><span class="o">.</span><span class="na">passwordEncoder</span> <span class="o">=</span> <span class="n">passwordEncoder</span><span class="o">;</span>
   <span class="o">}</span>

   <span class="nd">@Override</span>
   <span class="kd">public</span> <span class="nc">Member</span> <span class="nf">createMember</span><span class="o">(</span><span class="nc">Member</span> <span class="n">member</span><span class="o">)</span> <span class="o">{</span>
      <span class="n">verifyExistsEmail</span><span class="o">(</span><span class="n">member</span><span class="o">.</span><span class="na">getEmail</span><span class="o">());</span>
      <span class="nc">String</span> <span class="n">encryptedPassword</span> <span class="o">=</span> <span class="n">passwordEncoder</span><span class="o">.</span><span class="na">encode</span><span class="o">(</span><span class="n">member</span><span class="o">.</span><span class="na">getPassword</span><span class="o">());</span> <span class="c1">// ë¹„ë°€ë²ˆí˜¸ ì•”í˜¸í™”</span>
      <span class="n">member</span><span class="o">.</span><span class="na">setPassword</span><span class="o">(</span><span class="n">encryptedPassword</span><span class="o">);</span> <span class="c1">// ì•”í˜¸í™”ëœ ë¹„ë°€ë²ˆí˜¸ ê°ì²´ì— ë§µí•‘</span>

      <span class="nc">Member</span> <span class="n">saveMember</span> <span class="o">=</span> <span class="n">memberRepository</span><span class="o">.</span><span class="na">save</span><span class="o">(</span><span class="n">member</span><span class="o">);</span> <span class="c1">// DBì— ì €ì¥</span>

      <span class="k">return</span> <span class="n">saveMember</span><span class="o">;</span>
   <span class="o">}</span>

   <span class="kd">private</span> <span class="kt">void</span> <span class="nf">verifyExistsEmail</span><span class="o">(</span><span class="nc">String</span> <span class="n">email</span><span class="o">)</span> <span class="o">{</span>
      <span class="nc">Optional</span><span class="o">&lt;</span><span class="nc">Member</span><span class="o">&gt;</span> <span class="n">member</span> <span class="o">=</span> <span class="n">memberRepository</span><span class="o">.</span><span class="na">findByEmail</span><span class="o">(</span><span class="n">email</span><span class="o">);</span>
      <span class="k">if</span> <span class="o">(</span><span class="n">member</span><span class="o">.</span><span class="na">isPresent</span><span class="o">())</span>
         <span class="k">throw</span> <span class="k">new</span> <span class="nf">BusinessLogicException</span><span class="o">(</span><span class="nc">ExceptionCode</span><span class="o">.</span><span class="na">MEMBER_EXISTS</span><span class="o">);</span>
   <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>
<p>DBMemberServiceì—ì„œëŠ”<br />
ë¹„ë°€ë²ˆí˜¸ ì•”í˜¸í™”ë¥¼ í•œ ê²ƒì„ member ê°ì²´ì— ë‹´ì•„<br />
Repositoryì— ì €ì¥í•˜ê²Œë§Œ êµ¬ì„±í•´ì£¼ë©´ ëë‚œë‹¤.</p>

<p>ì¸ë©”ëª¨ë¦¬ ì‚¬ìš©í• ë•Œì—ëŠ” UserDetailsManagerì—ë‹¤ê°€ ì €ì¥í–ˆì§€ë§Œ<br />
ì´ì œëŠ” DBMemberServiceëŠ” íšŒì›ê°€ì…ì´ë¼ëŠ”<br />
ì„œë¹„ìŠ¤ ë¡œì§ë§Œ ë‚¨ê²Œ ëœ ê²ƒì´ë‹¤.</p>

<p>ì´ì œ íšŒì›ê°€ì…ì„í•˜ì˜€ê³ <br />
ë¡œê·¸ì¸ì„ í•˜ì˜€ì„ë•Œ UserDetailsManagerì™€ ê°™ì€ ì—­í• ì„ êµ¬í˜„í•´ì¤˜ì•¼í•œë‹¤.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cm">/*
* DBì‚¬ìš©í–ˆì„ë•Œ ì¸ì¦ ì²˜ë¦¬ ì ìš©í•˜ê¸° (ì¸ë©”ëª¨ë¦¬ ì‚¬ìš©ì‹œ ê¸°ì¡´ UserDetailManagerë¥¼ ì‚¬ìš©í–ˆì—ˆìŒ)
* UserDetailsServiceëŠ” Userì •ë³´ë¥¼ ë¡œë“œí•˜ëŠ” í•µì‹¬ì ì¸ ì¸í„°í˜ì´ìŠ¤ë‹¤.
* UserDetailManagerëŠ” UserDetailsServiceë¥¼ ìƒì†í•˜ê³ ìˆìŒ
* */</span>
<span class="nd">@Component</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">HelloUserDetailsServiceV1</span> <span class="kd">implements</span> <span class="nc">UserDetailsService</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="nc">MemberRepository</span> <span class="n">memberRepository</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="nc">HelloAuthorityUtils</span> <span class="n">authorityUtils</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">HelloUserDetailsServiceV1</span><span class="o">(</span><span class="nc">MemberRepository</span> <span class="n">memberRepository</span><span class="o">,</span> <span class="nc">HelloAuthorityUtils</span> <span class="n">authorityUtils</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">memberRepository</span> <span class="o">=</span> <span class="n">memberRepository</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">authorityUtils</span> <span class="o">=</span> <span class="n">authorityUtils</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="cm">/*
    * UserDetailService ì˜¤ë²„ë¼ì´ë”©í•˜ì—¬ UserDetails ê°ì±„ë¥¼ ë§Œë“¤ì–´ ë°˜í™˜í•˜ê¸°
    * ì´í›„ëŠ” ìŠ¤í”„ë§ì‹œíë¦¬í‹°ê°€ ì¸ì¦ì²˜ë¦¬ë¥¼ ëŒ€ì‹ í•´ì¤€ë‹¤
    * */</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="nc">UserDetails</span> <span class="nf">loadUserByUsername</span><span class="o">(</span><span class="nc">String</span> <span class="n">username</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">UsernameNotFoundException</span> <span class="o">{</span>
        <span class="c1">// í•´ë‹¹ ë©”ì„œë“œ í˜¸ì¶œ ì‹œì ì€, login.htmlì—ì„œ ë¡œê·¸ì¸ ë²„íŠ¼ ëˆ„ë¥¼ë–„ì´ë‹¤.</span>
        <span class="c1">// ì¦‰, &lt;form action="/process_login" method="post"&gt; ê°€ ì‹¤í–‰ë ë–„ í˜¸ì¶œë¨</span>
        <span class="nc">Optional</span><span class="o">&lt;</span><span class="nc">Member</span><span class="o">&gt;</span> <span class="n">optionalMember</span> <span class="o">=</span> <span class="n">memberRepository</span><span class="o">.</span><span class="na">findByEmail</span><span class="o">(</span><span class="n">username</span><span class="o">);</span> <span class="c1">// ì´ë©”ì¼ë¡œ ë©¤ë²„ì°¾ê¸°</span>
        <span class="nc">Member</span> <span class="n">findMember</span> <span class="o">=</span> <span class="n">optionalMember</span><span class="o">.</span><span class="na">orElseThrow</span><span class="o">(()</span> <span class="o">-&gt;</span> <span class="k">new</span> <span class="nc">BusinessLogicException</span><span class="o">(</span><span class="nc">ExceptionCode</span><span class="o">.</span><span class="na">MEMBER_NOT_FOUND</span><span class="o">));</span> <span class="c1">// ë©¤ë²„ ì°¾ê¸° ì˜ˆì™¸ ì²˜ë¦¬</span>
        <span class="nc">Collection</span><span class="o">&lt;?</span> <span class="kd">extends</span> <span class="nc">GrantedAuthority</span><span class="o">&gt;</span> <span class="n">authorities</span> <span class="o">=</span> <span class="n">authorityUtils</span><span class="o">.</span><span class="na">createAuthorities</span><span class="o">(</span><span class="n">findMember</span><span class="o">.</span><span class="na">getEmail</span><span class="o">());</span> <span class="c1">// ì´ë©”ì¼ ë¹„êµí›„ ê¶Œí•œ ì²˜ë¦¬</span>
        <span class="nc">UserDetails</span> <span class="n">user1</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">User</span><span class="o">(</span><span class="n">findMember</span><span class="o">.</span><span class="na">getEmail</span><span class="o">(),</span> <span class="n">findMember</span><span class="o">.</span><span class="na">getPassword</span><span class="o">(),</span> <span class="n">authorities</span><span class="o">);</span> <span class="c1">// í•´ë‹¹ ì •ë³´ë¡œ Userìƒì„±ìë¡œ UserDetails ë§Œë“¤ê¸°</span>
        <span class="k">return</span> <span class="n">user1</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>
<p>ìš°ë¦¬ëŠ” UserDetailsServiceë¥¼ êµ¬í˜„í•  í´ë˜ìŠ¤ë¥¼ ë§Œë“¤ì–´<br />
ìƒì†ì„ ë°›ê²Œ ë§Œë“¤ì–´ì¤€ë‹¤ìŒ. loadUserByUsername ì˜¤ë²„ë¼ì´ë”©í•´<br />
ì¬ì •ì˜ë¥¼ í•´ì„œ ë°˜í™˜ì„ UserDetails ê°ì²´ë¡œ ë§Œë“¤ì–´ ë°˜í™˜ì„ í•´ì£¼ë©´ëœë‹¤.</p>

<p>íšŒì›ê°€ì…ì€ ì´ë¯¸ ë˜ì–´ìˆê³ , ì•”í˜¸í™”ê¹Œì§€í•´ ë†“ì€ ìƒíƒœë¡œ DBì— ì €ì¥ë˜ì–´ìˆë‹¤.<br />
ìš°ë¦¬ê°€ ë¡œê·¸ì¸ í˜ì´ì§€ì—ì„œ form loginìœ¼ë¡œ post ë©”ì„œë“œ /process_loginì„ í˜¸ì¶œí•˜ê²Œë˜ë©´<br />
ìš°ë¦¬ê°€ ìœ„ì—ì„œ ë´¤ë˜ íë¦„ëŒ€ë¡œ EndPointê¹Œì§€ ê°€ê¸°ì „ì—<br />
Servlet Filterê°€ íë¦„ì„ ê°€ë¡œì±„ì„œ ì‹¤í–‰í•˜ê²Œ ë˜ê³ <br />
ìš°ë¦¬ëŠ” Spring Securityë¥¼ ì‚¬ìš©í•˜ê³  ìˆê¸°ë•Œë¬¸ì— ì¸ì¦ ì ˆì°¨ë¥¼ ê°€ì§€ê²Œëœë‹¤.</p>

<p><img src="https://lh3.googleusercontent.com/u/0/drive-viewer/AFDK6gOFEpthgmY3S8CBykz2TudWwacXHEngWxFMzuqUbbRWjNwnV379_0wvzLGpOM0t0X18sB8nTpumplyiCwlc5r_PjdIZfg=w3024-h1620" alt="image" class="align-left" style="max-width: 100%" /></p>

<p>ì¸ì¦ ì ˆì°¨ëŠ” ì‹¤ì œë¡œ ì´ëŸ¬í•œ íë¦„ì„ ì§„í–‰ëœë‹¤ê³ í•œë‹¤.</p>

<ol>
  <li>
    <p>ì‚¬ìš©ìê°€ ë¡œê·¸ì¸ ì •ë³´ì™€ í•¨ê»˜ ì¸ì¦ ìš”ì²­ì„ í•œë‹¤.(Http Request)</p>
  </li>
  <li>
    <p>AuthenticationFilterê°€ ìš”ì²­ì„ ê°€ë¡œì±„ê³ , ê°€ë¡œì±ˆ ì •ë³´ë¥¼ í†µí•´<br />
UsernamePasswordAuthenticationTokenì˜ ì¸ì¦ìš© ê°ì²´ë¥¼ ìƒì„±í•œë‹¤.</p>
  </li>
  <li>
    <p>AuthenticationManagerì˜ êµ¬í˜„ì²´ì¸ ProviderManagerì—ê²Œ ìƒì„±í•œ <br />
UsernamePasswordToken ê°ì²´ë¥¼ ì „ë‹¬í•œë‹¤.</p>
  </li>
  <li>
    <p>AuthenticationManagerëŠ” ë“±ë¡ëœ AuthenticationProvider(ë“¤)ì„ ì¡°íšŒí•˜ì—¬ ì¸ì¦ì„ ìš”êµ¬í•œë‹¤.</p>
  </li>
  <li>
    <p>ì‹¤ì œ DBì—ì„œ ì‚¬ìš©ì ì¸ì¦ì •ë³´ë¥¼ ê°€ì ¸ì˜¤ëŠ” UserDetailsServiceì— ì‚¬ìš©ì ì •ë³´ë¥¼ ë„˜ê²¨ì¤€ë‹¤.</p>
  </li>
  <li>
    <p>ë„˜ê²¨ë°›ì€ ì‚¬ìš©ì ì •ë³´ë¥¼ í†µí•´ DBì—ì„œ ì°¾ì€ ì‚¬ìš©ì ì •ë³´ì¸ UserDetails ê°ì²´ë¥¼ ë§Œë“ ë‹¤.</p>
  </li>
  <li>
    <p>AuthenticationProvider(ë“¤)ì€ UserDetailsë¥¼ ë„˜ê²¨ë°›ê³  ì‚¬ìš©ì ì •ë³´ë¥¼ ë¹„êµí•œë‹¤.</p>
  </li>
  <li>
    <p>ì¸ì¦ì´ ì™„ë£Œë˜ë©´ ê¶Œí•œ ë“±ì˜ ì‚¬ìš©ì ì •ë³´ë¥¼ ë‹´ì€ Authentication ê°ì²´ë¥¼ ë°˜í™˜í•œë‹¤.</p>
  </li>
  <li>
    <p>ë‹¤ì‹œ ìµœì´ˆì˜ AuthenticationFilterì— Authentication ê°ì²´ê°€ ë°˜í™˜ëœë‹¤.</p>
  </li>
  <li>
    <p>Authenticaton ê°ì²´ë¥¼ SecurityContextì— ì €ì¥í•œë‹¤.</p>
  </li>
</ol>

<p><a href="https://dev-coco.tistory.com/174">ì¶œì²˜ - ìŠ¬ê¸°ë¡œìš´ ê°œë°œìƒí™œ</a></p>

<p><br /></p>

<p>ì¦‰, ìš°ë¦¬ê°€ êµ¬í˜„í•´ì¤˜ì•¼í•  ë¶€ë¶„ì€<br />
5ë²ˆì—ì„œ ì‚¬ìš©ì ì •ë³´ë¥¼ ë°›ëŠ” ê²ƒì„ ì´ìš©í•´<br />
6ë²ˆ, ë°›ì€ ì •ë³´ë¥¼ ì´ìš©í•´ UserDetails ê°ì²´ë¥¼ ë°˜í™˜ë§Œ ì‹œì¼œì£¼ë©´<br />
ê·¸ ì´í›„ëŠ” 7ë²ˆ ë¶€í„° Spring Securityê°€ ì•Œì•„ì„œ ì§„í–‰ì‹œì¼œì¤€ë‹¤.</p>

<p>ì´ë¥¼ í† ëŒ€ë¡œ ìœ„ì— í”„ë¡œê·¸ë¨ì„ ì‘ì„±í•´ ë†“ì€ ê²ƒì„ ë³´ë©´<br />
ì˜¤ë²„ë¼ì´ë”©í•œ loadUserByUsername ë©”ì„œë“œë¥¼ í†µí•´ì„œ<br />
usernameì„ ë§¤ê°œë³€ìˆ˜ë¡œ ì •ë³´ë¥¼ ë°›ëŠ”ë‹¤.<br />
í•´ë‹¹ ì •ë³´ë¡œ DBë¥¼ ì¡°íšŒí•œë‹¤ìŒ, UserDetails ê°ì²´ë¥¼ ë°˜í™˜ì‹œì¼œì£¼ëŠ” í”„ë¡œê·¸ë¨ì´ë‹¤.</p>

<p><br /></p>

<p><strong><span style="color:#0066CC"> ìœ„ì˜ ì–˜ê¸°ë¥¼ í•œë§ˆë””ë¡œ ì •ë¦¬ í•´ë³´ìë©´ !! </span></strong></p>

<p>UserDetailsService ì¸í„°í˜ì´ìŠ¤ë¥¼ êµ¬í˜„í•œ í´ë˜ìŠ¤ë¥¼ ë§Œë“ ë‹¤.<br />
loadUserByUsername(); ë©”ì„œë“œë¥¼ ì˜¤ë²„ë¼ì´ë”©í•˜ì—¬ ë§¤ê°œë³€ìˆ˜ë¡œ username ì •ë³´ë¥¼ ë°›ì„ ìˆ˜ ìˆë‹¤.<br />
usernameì •ë³´ë¥¼ ì´ìš©í•´ DBì— ì¡°íšŒë¥¼ í•œë‹¤.<br />
ì¡°íšŒí•œ ë°ì´í„°ë¥¼ í† ëŒ€ë¡œ UserDetails ê°ì²´ë¥¼ ë§Œë“¤ì–´ ë°˜í™˜ë§Œ ì‹œì¼œì£¼ë©´ ëœë‹¤.<br />
ì´í›„ëŠ” Spring Securityê°€ ì•Œì•„ì„œ í•´ì¤Œ</p>

<p><br /></p>

<h3 id="ì˜¤ëŠ˜-ë§Œë‚œ-error">ì˜¤ëŠ˜ ë§Œë‚œ ERROR</h3>

<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>***************************
APPLICATION FAILED TO START
***************************

Description:

Parameter 0 of constructor in com.codestates.member.MemberController required a single bean, but 2 were found:
	- inMemoryMemberService: defined by method 'inMemoryMemberService' in class path resource [com/codestates/config/JavaConfigurationV1.class]
	- dbMemberService: defined by method 'dbMemberService' in class path resource [com/codestates/config/JavaConfigurationV2.class]
</code></pre></div></div>
<p>ì˜¤ëŠ˜ í…ŒìŠ¤íŠ¸ ì¤‘ ë§Œë‚¬ë˜ ì—ëŸ¬ë‹¤. <br />
ë‚´ìš©ì€ MemberControllerì—ì„œ ì‹±ê¸€ë¹ˆì„ ìš”êµ¬í•œëŠ”ë° 2ê°œê°€ ìˆë‹¤ëŠ” ê²ƒ ê°™ì€ ë‚´ìš©ì´ë‹¤.<br />
ì¦‰, ê°™ì€ íƒ€ì…ì˜ ë¹ˆì´ ë‘ê°œê°€ ë“±ë¡ëœ ë¬¸ì œë¼ê³  ìƒê°í–ˆë‹¤.</p>

<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Action:

Consider marking one of the beans as @Primary, updating the consumer to accept multiple beans, or using @Qualifier to identify the bean that should be consumed
</code></pre></div></div>
<p>ë°‘ì— ì•„ì£¼ì¹œì ˆí•˜ê²Œ @Primaryë‚˜  @Qualifierë¥¼ ì‚¬ìš©í•˜ë¼í•œë‹¤.</p>

<p><br /></p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cm">/*
*  InMemory ì‚¬ìš©ì„ ìœ„í•œ ë¹ˆì£¼ì…
* */</span>
<span class="nd">@Configuration</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">JavaConfigurationV1</span> <span class="o">{</span>
    <span class="nd">@Bean</span>
    <span class="kd">public</span> <span class="nc">MemberService</span> <span class="nf">inMemoryMemberService</span><span class="o">(</span><span class="nc">UserDetailsManager</span> <span class="n">userDetailsManager</span><span class="o">,</span> <span class="nc">PasswordEncoder</span> <span class="n">passwordEncoder</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nf">InMemoryMemberService</span><span class="o">(</span><span class="n">userDetailsManager</span><span class="o">,</span><span class="n">passwordEncoder</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cm">/*
*  DB ì‚¬ìš©ì„ ìœ„í•œ ë¹ˆì£¼ì…
* */</span>
<span class="nd">@Configuration</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">JavaConfigurationV2</span> <span class="o">{</span>
    <span class="nd">@Bean</span>
    <span class="kd">public</span> <span class="nc">MemberService</span> <span class="nf">dbMemberService</span><span class="o">(</span><span class="nc">MemberRepository</span> <span class="n">memberRepository</span><span class="o">,</span> <span class="nc">PasswordEncoder</span> <span class="n">passwordEncoder</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nf">DBMemberService</span><span class="o">(</span><span class="n">memberRepository</span><span class="o">,</span><span class="n">passwordEncoder</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>
<p>MemberControlerì—ì„œëŠ” MemberServiceë¥¼ DIë°›ê²Œ ì„¤ê³„í•´ë†“ì•˜ê³ </p>

<p>MemberServiceë¼ëŠ” ì¸í„°í˜ì´ìŠ¤ë¥¼ êµ¬í˜„í•œ<br />
í´ë˜ìŠ¤ inMemoryMemberServie, DBMemberService ë‘ê°œë¥¼<br />
ë¹ˆìœ¼ë¡œ ë“±ë¡í•˜ë ¤ê³  ì‹œë„í•˜ë‹ˆê¹Œ ë°œìƒí•œ ì•ŒëŒì¸ ê²ƒ ê°™ë‹¤.</p>

<p>ì—¬ê¸°ì„œ @Configurationì„ í•œêµ°ë°ë¥¼ ì§€ì›Œì£¼ë©´<br />
ì¤‘ë³µë˜ì§€ ì•Šê³  í•´ê²° í•  ìˆ˜ ìˆë‹¤.</p>

<p>í•˜ì§€ë§Œ ì½”ë“œëŠ” ê·¸ëŒ€ë¡œ ìœ ì§€ì‹¶ì—ˆê¸°ì—</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Configuration</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">JavaConfigurationV2</span> <span class="o">{</span>
    <span class="nd">@Bean</span>
    <span class="nd">@Primary</span>
    <span class="kd">public</span> <span class="nc">MemberService</span> <span class="nf">dbMemberService</span><span class="o">(</span><span class="nc">MemberRepository</span> <span class="n">memberRepository</span><span class="o">,</span> <span class="nc">PasswordEncoder</span> <span class="n">passwordEncoder</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nf">DBMemberService</span><span class="o">(</span><span class="n">memberRepository</span><span class="o">,</span> <span class="n">passwordEncoder</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>JavaConfigurationV2ì— ë¹ˆë“±ë¡ ë©”ì„œë“œì— @Primaryë¥¼ ì´ìš©í•´<br />
ë¹ˆì„ ì„ íƒí•´ ì£¼ì…í•´ì£¼ë„ë¡ ì •í–ˆë‹¤.</p>

<hr />

<p>ì˜¤ëŠ˜ì€ ì´ë ‡ê²Œ ìŠ¤í”„ë§ ì‹œíë¦¬í‹°ì˜ ê¸°ë³¸ì ì¸<br />
ì‚¬ìš©ë°©ë²•ì„ ì•Œì•„ë³´ì•˜ë‹¤.</p>

<p>ë‚´ë¶€ì ìœ¼ë¡œ ì´ë£¨ì–´ì§€ëŠ” ì‘ì—…ë“¤ì´ ë§ì•„ ì •í™•í•œ<br />
íë¦„ì´ ê°ì´ ì¡íˆì§ˆ ì•ŠëŠ” ê²ƒ ê°™ë‹¤.<br />
ê¸€ì„ ì ìœ¼ë©´ì„œë„ ë‚´ê°€ ì •í™•íˆ ì´í•´í•œê²Œ ë§ëŠ”ì§€ ìˆ˜ì‹­ë²ˆì„ ëŒì•„ê°€ì„œ í™•ì¸í•˜ê³  ë°˜ë³µí–ˆë‹¤. <br />
í™•ì¸í–ˆë‹¤ê³  í•œë“¤â€¦ ì •í™•í•œ ì •ë³´ë¥¼ ì ì€ ê²ƒ ê°™ì§€ ì•Šì€ ëŠë‚Œì´ë“ ë‹¤.<br />
ê³„ì† ìµìˆ™í•´ì§€ê²Œ ì‚¬ìš©í•´ë³´ë©´ì„œ ì‚¬ìš©ë²•ì— ìµìˆ™í•´ì ¸ë³´ì</p>

<p>ì˜¤ëŠ˜ê³µë¶€ëŠ” ì—¬ê¸°ì„œ ë !!</p>

<p><br /></p>

<p><span style="color:#994C00"><strong>ì˜¤ëŠ˜ì˜ ì»¤í”¼ëŸ‰</strong></span>: â˜•ï¸ â˜•ï¸<br />
<strong>ì˜¤ëŠ˜ì˜ ì ì‹¬</strong>: ì§œì¥ë©´, íƒ•ìˆ˜ìœ¡</p>]]></content><author><name>LEE JAEHYEOK</name></author><category term="TIL" /><category term="TIL" /><category term="ë¶€íŠ¸ìº í”„" /><category term="ì½”ë“œìŠ¤í…Œì´ì¸ " /><summary type="html"><![CDATA[]]></summary></entry><entry><title type="html">TIL) ì¸ì¦, ë³´ì•ˆ ê¸°ì´ˆ</title><link href="http://localhost:4000/til/2022/11/17/til.html" rel="alternate" type="text/html" title="TIL) ì¸ì¦, ë³´ì•ˆ ê¸°ì´ˆ" /><published>2022-11-17T00:00:00+09:00</published><updated>2022-11-17T00:00:00+09:00</updated><id>http://localhost:4000/til/2022/11/17/til</id><content type="html" xml:base="http://localhost:4000/til/2022/11/17/til.html"><![CDATA[<p>ì˜¤ëŠ˜ì€ ë“œë””ì–´<br />
ì¸ì¦ê³¼ ë³´ì•ˆê´€ë ¨ëœ ê³µë¶€ê°€ ì‹œì‘ë˜ì—ˆë‹¤.</p>

<p><img src="https://lh3.googleusercontent.com/u/0/drive-viewer/AJc5JmSK7Vlbd6P-ZA2TpRO9yTFxz9gH-OdxjYebZ6-r_KUFyGQiml5Hx8m6WodAQFCprhzYPGAg5SXnE-TkysLMqq-BedG44A=w1920-h864" alt="image" class="align-left" style="max-width: 50%" /></p>

<p>Spring Security, JWT, OAuth2 ë“±<br />
ì—¬ëŸ¬ê°€ì§€ë¥¼ ë°°ìš¸ ì˜ˆì •ì´ê³ </p>

<p>ê°€ì¥ ê³ ì „í•˜ëŠ” ì˜ì—­ì´ì§€ ì•Šì„ê¹Œ ìƒê°í•œë‹¤.</p>

<hr />

<p>ì˜¤ëŠ˜ì€ ì¸ì¦, ë³´ì•ˆì— ëŒ€í•œ ê¸°ì´ˆë¥¼ ë¨¼ì € íŒŒì•…í•˜ê³ <br />
ë‚´ì¼ë¶€í„° ë³¸ê²©ì ì¸ Spring Security ì‚¬ìš©ë²•ì„ ì•Œì•„ë³¼ ê²ƒ ê°™ë‹¤.<br />
ì˜¤ëŠ˜ì€ ê¸°ì´ˆì¸ HTTPSì™€ Hashing, Cookie, Sessionì— ëŒ€í•´ ì•Œì•„ë³´ì</p>

<p><br /></p>

<h3 id="https">HTTPS</h3>

<p>ìš°ë¦¬ê°€ ì—¬íƒœê¹Œì§€ ë°°ì› ê¸°ë¥¼ HTTP í”„ë¡œí† ì½œì„ ì´ìš©í•´<br />
TCP/IP í†µì‹ ìœ¼ë¡œ ì„œë²„ì™€ ì—°ê²°í•  ìˆ˜ ìˆë‹¤ê³  ê³µë¶€ë¥¼ í–ˆì—ˆë‹¤.<br />
HTTP Messageë¥¼ í†µí•´ Json ê°ì²´ë¥¼ ë°›ì•„ë³´ê¸°ë„ í•˜ì˜€ë‹¤.</p>

<p>HTTPSì˜ Hyper Text Transfer Protocol Secure Socket layerì˜ ì•½ìë‹¤. <br />
ë³´ë©´ ì•Œ ìˆ˜ ìˆë“¯ì´ ê¸°ì¡´ì˜ <strong>HTTP + Secure Socket layer</strong>ê°€ ë¶™ì€ ëª¨ìŠµì´ë‹¤.<br />
HTTP í”„ë¡œí† ì½œì„ ë³´ë‹¤ ì•ˆì „í•˜ê²Œ ìš”ì²­ì„ ì£¼ê³  ë°›ê¸°ìœ„í•´ SSL, TLSë¼ëŠ” ì•Œê³ ë¦¬ì¦˜ì„ ì´ìš©í•´ <br />
HTTP í†µì‹ ì„ í•˜ëŠ” ê³¼ì •ì—ì„œ ë°ì´í„°ë¥¼ ì•”í˜¸í™”í•˜ì—¬ ì „ì†¡í•˜ëŠ” ë°©ë²•ì´ë‹¤.</p>

<p><img src="https://lh3.googleusercontent.com/u/0/drive-viewer/AJc5JmQ7kg8wBa9J9dzD10tI68mzIX9M97wYHvAyH-tNw-vTeDL5V8vTsTeX3a_QiO7FnYOL0DMp_w7JRIh9Jt27wXdEgUoDiw=w1510-h1614" alt="image" class="align-left" style="max-width: 100%" /><br />
HTTPS TLS HandShake (ì¶œì²˜: <a href="https://www.cloudflare.com/ko-kr/learning/ssl/what-happens-in-a-tls-handshake">CLOUDFLARE ì‚¬ì´íŠ¸ ì°¸ì¡°</a> )</p>

<p>í•´ë‹¹ ê·¸ë¦¼ì€ HTTPSì˜ í†µì‹  í•¸ë“œì‰ì´í¬ì´ë‹¤. <br />
í´ë¼ì´ì–¸íŠ¸ì—ì„œ ì ‘ì†ìš”ì²­ì´ ì™”ì„ ë•Œ, ë‚´ë¶€ì ìœ¼ë¡œ í†µì‹ ì´ë˜ì–´ì§€ëŠ” ìˆœì„œì´ë‹¤.</p>

<p>TCP ì—°ê²°ì´ ì™„ë£Œí›„ TLS í•¸ë“œì‰ì´í¬ê°€ ë™ì‘í•˜ëŠ” ëª¨ìŠµì„ ë³¼ ìˆ˜ ìˆê³ <br />
TLS í•¸ë“œì‰ì´í¬ ë‚´ì—ì„œëŠ” ì¸ì¦ì„œ, ëŒ€ì¹­í‚¤, ë¹„ëŒ€ì¹­í‚¤ì™€ ê°™ì€ ì•”ë³µí˜¸ë¥¼ í†µí•´<br />
ì¸ì¦ëœ ì„œë²„ì— ì ‘ì†ì„ í•  ìˆ˜ ìˆê²Œ í™•ì¸ì„ í•´ì¤€ë‹¤.</p>

<p>ì •ë§ ê°„ë‹¨í•˜ê²Œ ì •ë¦¬í•´ë³´ìë©´</p>

<p><strong><span style="color:#F04965">ëŒ€ì¹­í‚¤ </span>: í‚¤ í•œê°œë¡œ ì•”ë³µí˜¸ë¥¼ í•œë‹¤.</strong><br />
<strong><span style="color:#F04965">ë¹„ëŒ€ì¹­í‚¤</span> : ì•”í˜¸í™”í•œ í‚¤ì™€ ë³µí˜¸í™”í•œí‚¤ê°€ ë‹¤ë¥´ë‹¤.</strong></p>

<p>í‚¤ì˜ ì¢…ë¥˜ë¡œëŠ” <strong>ê³µê°œí‚¤(Public Key)</strong>ì™€ <strong>ê°œì¸í‚¤(Private Key)</strong>ê°€ ì¡´ì¬í•˜ê³ </p>

<p>ëŒ€ì¹­í‚¤ ê°™ì€ê²½ìš°ì—ëŠ” ê³µê°œí‚¤-ê³µê°œí‚¤, ê°œì¸í‚¤-ê°œì¸í‚¤ë¡œ ì•”í˜¸í™” ë³µí˜¸í™”ë¥¼ í•  ìˆ˜ ìˆê³ <br />
ë¹„ëŒ€ì¹­í‚¤ ê°™ì€ ê²½ìš°ì—ëŠ” ê³µê°œí‚¤-ê°œì¸í‚¤, ê°œì¸í‚¤-ê³µê°œí‚¤ë¡œ ì•”í˜¸í™” ë³µí˜¸í™”ë¥¼ í•  ìˆ˜ ìˆë‹¤.<br />
HTTPS TLS í•¸ë“œì‰ì´í¬ëŠ” ëŒ€ì¹­í‚¤,ë¹„ëŒ€ì¹­í‚¤ë¥¼ ë‘˜ë‹¤ ì‚¬ìš©í•œë‹¤.</p>

<p>ì—¬ê¸°ì„œ ë¹„ëŒ€ì¹­í‚¤ ê°™ì€ ê²½ìš°ì—ëŠ”<br />
ê°œì¸í‚¤ë¡œ ì•”í˜¸í™”í•œê²ƒì„ ê³µê°œí‚¤ë¡œ ë³µí˜¸í™”í•  ìˆ˜ ìˆëŠ”ë°, ëª©ì ì€ ì¸ì¦ì„œê°™ì€ ëˆ„êµ¬ë‚˜ ë³¼ ìˆ˜ ìˆëŠ” ì •ë³´ê³ <br />
ê³µê°œí‚¤ë¡œ ì•”í˜¸í™”í•œê²ƒì„ ê°œì¸í‚¤ë¡œ ë³µí˜¸í™”í•  ìˆ˜ ìˆëŠ”ë°, ëª©ì ì€ ì •ë³´ë³´í˜¸ì™€ ì™¸ë¶€ì˜ íƒˆì·¨ë°©ì§€ë¥¼ ìœ„í•œ ê²ƒì´ë‹¤.</p>

<p>ì—¬ê¸°ì„œ <strong>ì¸ì¦ì„œ</strong>ë¼ëŠ” ê°œë…ì´ë‚˜ì˜¤ëŠ”ë°<br />
ì´ëŸ¬í•œ ì¸ì¦ì„œì˜ ì—­í• ì€ ì„œë²„ì—ì„œ ì¸ì¦ì„œë¥¼ ë¸Œë¼ìš°ì €ì—ê²Œ ë³´ë‚´ì£¼ëŠ”ë°<br />
í´ë¼ì´ì–¸íŠ¸ì— ì ‘ì†í•œ ê³³ì´ ì •ë§ í•´ë‹¹ ì„œë²„ì™€ ì¼ì¹˜í•˜ëŠ”ì§€ ë³´ì¦í•´ì£¼ëŠ” ì¥ì¹˜ì´ë‹¤.<br />
ì´ëŸ¬í•œ ì¸ì¦ì„œë¥¼ ê´€ë¦¬í•´ì£¼ëŠ” ê³µì¸ëœ ê¸°ê´€ë“¤ì„<br />
Certificate Authority ë¼ê³ í•˜ë©° ëŒ€í‘œì ìœ¼ë¡œ AWSê°€ ìˆë‹¤.</p>

<p>TLS í•¸ë“œì‰ì´í¬ë¥¼ ì •ë¦¬í•´ë³´ìë©´</p>

<ol>
  <li>Client -&gt; Serverì—ê²Œ í—¬ë¡œ ìš”ì²­</li>
  <li>Server -&gt; Client ì¸ì¦ì„œë¥¼ í¬í•¨í•´ì„œ í—¬ë¡œ ì‘ë‹µ (ê°œì¸í‚¤ë¡œ ì•”í˜¸í™”í•˜ì—¬ ì „ë‹¬)</li>
  <li>ClientëŠ” ë‚´ì¥ëœ CA ë¦¬ìŠ¤íŠ¸ë¥¼ ë³´ê³  ì¸ì¦ì„œë¥¼ í™•ì¸í•œë‹¤. (ê°œì¸í‚¤-&gt;ê³µê°œí‚¤ ë³µí˜¸í™”)</li>
  <li>Clientê°€ CAì˜ ê³µê°œí‚¤ë¡œ ë³µí˜¸í™”ë¥¼ í†µí•´ ì¸ì¦ì„œë¥¼ ê²€ì¦í–ˆë‹¤ë©´ ClientëŠ” ëŒ€ì¹­í‚¤ë¥¼ ë§Œë“ ë‹¤.</li>
  <li>ì´ ëŒ€ì¹­í‚¤ë¥¼ ì„œë²„ì˜ ê³µê°œí‚¤ë¡œ ì•”í˜¸í™”í•´ì„œ Client -&gt; Serverì— ì „ë‹¬í•œë‹¤.</li>
  <li>ê·¸ëŸ¼ ServerëŠ” ì„œë²„ì˜ ê°œì¸í‚¤ë¡œ ë³µí˜¸í™”í•˜ì—¬ í´ë¼ì´ì–¸íŠ¸ì˜ ëŒ€ì¹­í‚¤ë¥¼ í™•ì¸í•œë‹¤. (ê³µê°œí‚¤-&gt;ê°œì¸í‚¤ ë³µí˜¸í™”)</li>
  <li>Server -&gt; Clientì˜ ëŒ€ì¹­í‚¤ë¡œ ìƒ˜í”Œ ë°ì´í„°ë¥¼ ì•”í˜¸í™”í•´ì„œ í´ë¼ì´ì–¸íŠ¸ì—ê²Œ ë³´ë‚´ì„œ í™•ì¸í•œë‹¤.</li>
  <li>ClientëŠ” ì„œë²„ì—ê²Œ ë°›ì€ ë°ì´í„°ë¥¼ ëŒ€ì¹­í‚¤ë¡œ ë³µí˜¸í™”í•´ì„œ ì„œë¡œ ëŒ€ì¹­í‚¤ë¥¼ ì˜ ê°€ì§€ê³  ìˆëŠ”ì§€ í™•ì¸í•œë‹¤</li>
  <li>ì´ í›„ì—ëŠ” Clientì™€ ServerëŠ” ì„œë¡œ ëŒ€ì¹­í‚¤ë¡œ ì•”í˜¸í™”ì™€ ë³µí˜¸í™”ë¥¼ ì§„í–‰í•˜ì—¬ ë°ì´í„°ë¥¼ ì „ì†¡í•œë‹¤</li>
</ol>

<p>ì‚¬ì‹¤ ì´ëŸ° ì¼ë ¨ì˜ ê³¼ì •ë“¤ì€<br />
ë¸Œë¼ìš°ì €ì™€ ì„œë²„ê°€ í•´ë‹¹ ê³¼ì •ì„ ëŒ€ì‹  ì²˜ë¦¬í•´ì£¼ê¸° ë•Œë¬¸ì—<br />
ê°œë…ê³¼ ìˆœì„œì •ë„ë§Œ ì´í•´í•˜ë©´ ì¢‹ì„ ê²ƒ ê°™ë‹¤.</p>

<p><br /></p>

<h4 id="ë¡œì»¬-í™˜ê²½ì—ì„œ-í…ŒìŠ¤íŠ¸">ë¡œì»¬ í™˜ê²½ì—ì„œ í…ŒìŠ¤íŠ¸</h4>
<p>ê·¸ëŸ¼ ë¡œì»¬í™˜ê²½ì—ì„œ ì¸ì¦ì„œ ë°œê¸‰ê³¼ <br />
Https ì„œë²„ë¥¼ êµ¬í˜„í•˜ëŠ” ê°„ë‹¨í•œ ì˜ˆì œë¥¼ ì‚´í´ë³´ì</p>

<p>ìš°ì„  Tomcat WASë¥¼ ì‚¬ìš©í•˜ê¸°ìœ„í•´<br />
ìŠ¤í”„ë§ë¶€íŠ¸ë¡œ í”„ë¡œì íŠ¸ë¥¼ ë§Œë“¤ì—ˆê³ </p>

<p>ë¡œì»¬í™˜ê²½ì—ì„œ ì¸ì¦ì„œë¥¼ ë§Œë“¤ê¸°ìœ„í•´ í„°ë¯¸ë„ë¡œ mkcertë¥¼ ì„¤ì¹˜í•´ì•¼í•œë‹¤.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>brew <span class="nb">install </span>mkcert
</code></pre></div></div>
<p>homebrewë¥¼ ì´ìš©í•´ mkcert ì„¤ì¹˜</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>mkcert <span class="nt">-install</span>
</code></pre></div></div>
<p>PKCS12 í˜•ì‹ ì¸ì¦ì„œë¥¼ ìƒì„±í•  ìˆ˜ ìˆë„ë¡ ì„¤ì¹˜</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>mkcert <span class="nt">-pkcs12</span> localhost
</code></pre></div></div>
<p>ë‚´ê°€ ë§Œë“  í”„ë¡œì íŠ¸ resources ê²½ë¡œì—ì„œ<br />
ìœ„ì˜ ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰ì‹œì¼œ PKCS12 ì¸ì¦ì„œë¥¼ ìƒì„±í•´ì£¼ë©´</p>

<p><br /></p>

<p><img src="https://lh3.googleusercontent.com/u/0/drive-viewer/AJc5JmSGGxmFhNDI5InKLm5xBczg_DBOgwK4OJj_PGLONuWvOCIyDPyNnQBHZR2LmGmp5KEwzXwK3MxI2-ryG8RDepbN8HRYxw=w3024-h1614" alt="image" class="align-left" style="max-width: 50%" /></p>

<p>ìœ„ì™€ ê°™ì´ resourcesì— <br />
localhost.p12 ì¸ì¦ì„œê°€ ìƒê¸´ë‹¤.</p>

<p>ì¸ì¦ì„œê°€ ìƒê²¼ë‹¤ë©´ application.properties ì•ˆì—</p>
<div class="language-properties highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="py">server.ssl.key-store</span><span class="p">=</span><span class="s">classpath:localhost.p12</span>
<span class="py">server.ssl.key-store-type</span><span class="p">=</span><span class="s">PKCS12</span>
<span class="py">server.ssl.key-store-password</span><span class="p">=</span><span class="s">changeit</span>
</code></pre></div></div>
<p>ì™€ ê°™ì´ ì…ë ¥í•´ì£¼ë©´ httpsë¡œ ì„œë²„ë¥¼ ì‚¬ìš©ê°€ëŠ¥í•˜ë‹¤.<br />
ì—¬ê¸°ì„œ ë¹„ë°€ë²ˆí˜¸ëŠ” ì´ˆê¸°í•´ ì…‹íŒ…ì„ í•˜ì§€ì•Šìœ¼ë©´ changeitìœ¼ë¡œ ì…ë ¥í•˜ë©´ëœë‹¤.</p>

<p>ê·¸ë¦¬ê³  ìŠ¤í”„ë§ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì‹¤í–‰ì‹œí‚¤ë©´</p>

<p><img src="https://lh3.googleusercontent.com/u/0/drive-viewer/AJc5JmThmekJqkRGtjmJemxwLYuP9uTAyLwsOWuvrxTqsdCdOtk4pnyAXTjmlQ8MrR_5PaU4rYOu8DZll_u-Qvzy1E2s4UGW7A=w3024-h1614" alt="image" class="align-left" style="max-width: 100%" /></p>

<p>ì‚¬ì§„ê³¼ ê°™ì´ httpsë¡œ ì„œë²„ êµ¬í˜„ëœ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.</p>

<p><br /></p>

<h3 id="hasing">Hasing</h3>
<p>ì–´ë–¤í•œ ë¬¸ìì—´ì— ì„ì˜ì˜ ì—°ìƒì„ ì ìš©í•˜ì—¬ <br />
ë‹¤ë¥¸ ë¬¸ìì—´ë¡œ ë³€í™˜í•˜ëŠ” ê²ƒì„ Hasingì´ë¼ê³  í•œë‹¤.</p>

<p>ì¦‰, í•´ì‹±í•œë‹¤ëŠ” ì˜ë¯¸ëŠ” ì–´ë– í•œ ê°’ì„ ì•”í˜¸í™”í•´ì¤€ë‹¤ ìƒê°í•˜ë©´ ë  ê²ƒ ê°™ë‹¤.<br />
ì—¬ê¸°ì„œ í•´ì‹±ì˜ íŠ¹ì§•ì„ ì ì–´ë³´ìë©´</p>

<ol>
  <li>ëª¨ë“  ê°’ì— ëŒ€í•œ í•´ì‹œê°’ì„ ê³„ì‚°í•˜ëŠ”ë° ì˜¤ë˜ê±¸ë¦¬ì§€ ì•Šì•„ì•¼í•œë‹¤.</li>
  <li>ìµœëŒ€í•œ í•´ì‹œê°’ì„ í”¼í•´ì•¼ í•˜ë©°, ëª¨ë“  ê°’ì€ ê³ ìœ í•œ í•´ì‹œê°’ì„ ê°€ì§„ë‹¤.</li>
  <li>ì•„ì£½ ì‘ì€ ë‹¨ìœ„ì˜ ë³€ê²½ì´ë¼ë„ ì™„ì „íˆ ë‹¤ë¥¸ í•´ì‹œê°’ì„ ê°€ì ¸ì•¼í•œë‹¤.</li>
</ol>

<h3 id="salt">Salt</h3>
<p>ì•”í˜¸í™”í•´ì•¼ í•˜ëŠ” ê°’ì— ì–´ë–¤ ë³„ë„ì˜ ê°’ì„ ì¶”ê°€í•˜ì—¬ ê²°ê³¼ë¥¼ ë³€í˜•í•˜ëŠ” ê²ƒì´ë‹¤.<br />
ì˜ì–´ë¡œ ì†Œê¸ˆì´ë¼ëŠ” ëœ»ê³¼ ê±¸ë§ê²Œ ë¬´ì–¸ê°€ ê°„ì„ì¹˜ëŠ” ëŠë‚Œì´ë¼ ìƒê°í•˜ë©´ ë  ê²ƒ ê°™ë‹¤.</p>

<p>Saltì˜ í° íŠ¹ì§•ì„ 4ê°€ì§€ ì‚´í´ë³´ë©´</p>

<ol>
  <li>ìœ ì €ì™€ íŒ¨ìŠ¤ì›Œë“œ ë³„ë¡œ ìœ ì¼í•œ ê°’ì„ ê°€ì ¸ì•¼ í•œë‹¤.</li>
  <li>ì‚¬ìš©ì ê³„ì •ì„ ìƒì„±í•  ë•Œì™€ ë¹„ë°€ë²ˆí˜¸ë¥¼ ë³€ê²½í•  ë•Œ ë§ˆë‹¤ ìƒˆë¡œìš´ ì„ì˜ì˜ Saltë¥¼ ì‚¬ìš©í•´ì„œ í•´ì‹±í•´ì•¼ í•œë‹¤.</li>
  <li>ì ˆëŒ€ ì¬ì‚¬ìš©í•˜ì§€ ë§ì•„ì•¼í•œë‹¤.</li>
  <li>DBì˜ ìœ ì €í…Œì´ë¸”ì— ê°™ì´ ì €ì¥ ë˜ì–´ì•¼í•œë‹¤.</li>
</ol>

<h3 id="cookie">Cookie</h3>

<p>ì¿ í‚¤ëŠ” ì„œë²„ê°€ ì›¹ ë¸Œë¼ìš°ì €ì— ì •ë³´ë¥¼ ì €ì¥í•˜ê³  ë¶ˆëŸ¬ì˜¬ ìˆ˜ ìˆëŠ” ìˆ˜ë‹¨<br />
ì´ë¼ê³  ìƒê°í•˜ë©´ ê°„ë‹¨í•  ê²ƒ ê°™ë‹¤.</p>

<p>ìš°ë¦¬ê°€ ì´ì „ì— ë°°ìš´ Http í”„ë¡œí† ì½œì€<br />
ë¬´ìƒíƒœì„±(stateless)ì€ ì´ì „ì— í–ˆë˜ ì‘ì—…ì— ëŒ€í•´ ê¸°ì–µí•˜ì§€ ì•ŠëŠ” íŠ¹ì„±ì„ ê°€ì§€ëŠ”ë°<br />
ê²€ìƒ‰ì„ í•˜ë ¤ëŠ”ë° ê²€ìƒ‰ëª©ë¡ì´ ì•„ë˜ í‘œì‹œëœë‹¤ë“ ì§€<br />
ë¡œê·¸ì¸ ê¸°ì–µë²„íŠ¼ì„ ëˆŒëŸ¬ë†“ì•˜ëŠ”ë° ë‹¤ìŒì— ì—´ì–´ë„ ëˆŒë ¤ì ¸ìˆë‹¤ë“ ì§€<br />
ìš°ë¦¬ëŠ” ìš”ì²­ì„ ë³´ë‚¼ë•Œ ë¬´ìƒíƒœì„±ìœ¼ë¡œ ë™ì‘í•˜ê¸°ë•Œë¬¸ì— ì´ëŸ¬í•œ ë‚´ìš©ë“¤ì„ ê¸°ì–µí•˜ì§€ ëª» í•˜ëŠ”ë°<br />
ë¸Œë¼ìš°ì €ì—ì„œ ì¿ í‚¤ë¼ëŠ” ê²ƒì„ ì´ìš©í•´ ì´ëŸ¬í•œ ë‚´ìš©ë“¤ì„ ì €ì¥í•´ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ê²ƒì´ë‹¤.</p>

<p>í•œë§ˆë””ë¡œ ì„œë²„ê°€ í´ë¼ì´ì–¸íŠ¸ì—ì„œ ìš”ì²­ì„ ë°›ê³ <br />
í´ë¼ì´ì–¸íŠ¸ìª½ì— ì‘ë‹µí• ë•Œ ì¿ í‚¤ì— ë°ì´í„°ë¥¼ ì‹¦ì–´ì„œ ë³´ë‚´ë©´<br />
ë¸Œë¼ìš°ì €ì—ì„œ ì¿ í‚¤ê°’ì„ ìœ ì§€ì‹œí‚¤ê³  ì‚¬ìš©í•œë‹¤ê³  ë³´ë©´ë  ê²ƒ ê°™ë‹¤.</p>

<p>ì¿ í‚¤ì˜ ì˜µì…˜ìœ¼ë¡œëŠ”</p>

<p>domain - ì„œë²„ì™€ ìš”ì²­ì˜ ë„ë©”ì¸ì´ ì¼ì¹˜í•˜ëŠ” ê²½ìš° ì¿ í‚¤ ì „ì†¡<br />
path - ì„œë²„ì˜ ìš”ì²­ì˜ ì„¸ë¶€ ê²½ë¡œê°€ ì¼ì¹˜í•˜ëŠ” ê²½ìš° ì¿ í‚¤ ì „ì†¡<br />
maxage/expires - ì¿ í‚¤ì˜ ìœ íš¨ê¸°ê°„ ì„¤ì •<br />
httpOnly - ìŠ¤í¬ë¦½íŠ¸ì˜ ì¿ í‚¤ ì ‘ê·¼ ê°€ëŠ¥ ì—¬ë¶€ ì„¤ì •<br />
secure - HTTPS ì—ì„œë§Œ ì¿ í‚¤ ì „ì†¡ ì—¬ë¶€ ì„¤ì •<br />
sameSite - ê°™ì€ ì‚¬ì´íŠ¸ì—ì„œë§Œ ì¿ í‚¤ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆê²Œ í•˜ëŠ” ì„¤ì •</p>

<h3 id="session">Session</h3>

<p>ì„¸ì…˜ì€ ì¸ì¦í•´ì£¼ëŠ” ë°©ë²•ìœ¼ë¡œ<br />
ì—¬ëŸ¬ í˜ì´ì§€ì— ê±¸ì³ ì‚¬ìš©ë˜ëŠ” ì‚¬ìš©ì ì •ë³´ë¥¼ ì €ì¥í•˜ëŠ” ë°©ë²•ì´ë‹¤.</p>

<p>ì„¸ì…˜ì€ ì¤‘ìš”í•œ ë°ì´í„°ë¥¼ ì„œë²„ì— ì €ì¥í•˜ê³  ì•”í˜¸í™”ëœ<br />
ì„¸ì…˜idë¥¼ ì¿ í‚¤ì— ë‹´ì•„ í´ë¼ì´ì–¸íŠ¸ì— ì „ë‹¬í•˜ê³ <br />
ì„¸ì…˜idê°€ ë¶€ì—¬ëœ ë¸Œë¼ìš°ì €ëŠ” ì‹ ë¶„ì¦ê°™ì´ ì´ë¥¼ ì´ ìœ ì €ëŠ” ì¸ì¦ì— ì„±ê³µí–ˆë‹¤ê³  ì•Œë¦¬ë©°<br />
ë‹¤ë¥¸ ìš”ì²­ì„ ë³´ë‚¼ë•Œ ë§ˆë‹¤ í•´ë‹¹ ì„¸ì„ idë¡œ ì¸ì¦ì„ ê±°ì¹˜ë©° ì‚¬ìš©í•  ìˆ˜ ìˆê²Œëœë‹¤.</p>

<p><br />
<br /></p>

<p><strong>ì¿ í‚¤ì™€ ì„¸ì…˜ì˜ ë¹„êµ</strong></p>

<table>
  <thead>
    <tr>
      <th>Â </th>
      <th style="text-align: center">Cookie</th>
      <th style="text-align: center">Seesion</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>ì„¤ëª…</td>
      <td style="text-align: center">ì¿ í‚¤ëŠ” ê·¸ì € httpì˜ stateless<br />í•œ ê²ƒì„ ë³´ì™„í•´ì£¼ëŠ” ë„êµ¬</td>
      <td style="text-align: center">ì ‘ì† ìƒíƒœë¥¼ ì„œë²„ê°€ ê°€ì§<br /> ì ‘ì† ìƒíƒœì™€ ê¶Œí™˜ ë¶€ì—¬ë¥¼ ìœ„í•´<br />ì„¸ì…˜ì•„ì´ë””ë¥¼ ì¿ í‚¤ë¡œ ì „ì†¡</td>
    </tr>
    <tr>
      <td>ì ‘ì† ìƒíƒœ<br />ì €ì¥ ê²½ë¡œ</td>
      <td style="text-align: center">í´ë¼ì´ì–¸íŠ¸</td>
      <td style="text-align: center">ì„œë²„</td>
    </tr>
    <tr>
      <td>ì¥ì </td>
      <td style="text-align: center">ì„œë²„ì— ë¶€ë‹´ì„ ëœì–´ì¤Œ</td>
      <td style="text-align: center">ì‹ ë¢°í•  ìˆ˜ ìˆëŠ” ìœ ì €ì¸ì§€ ì„œë²„ì—ì„œ í™•ì¸</td>
    </tr>
    <tr>
      <td>ë‹¨ì </td>
      <td style="text-align: center">ì¿ í‚¤ ê·¸ìì²´ëŠ” ì¸ì¦ì´ ì•„ë‹˜</td>
      <td style="text-align: center">í•˜ë‚˜ì˜ ì„œë²„ì—ì„œë§Œ ì ‘ì† ìƒíƒœë¥¼ ê°€ì§€ë¯€ë¡œ <br />ì„œë²„ë¶„ì‚°ì— ë¶ˆë¦¬</td>
    </tr>
  </tbody>
</table>

<p><br /></p>

<hr />

<p>ì˜¤ëŠ˜ì€ ì´ë ‡ê²Œ ì¸ì¦, ë³´ì•ˆì— ê´€í•œ <br />
ê°„ë‹¨í•œ CS ì§€ì‹ë“¤ì„ ê³µë¶€í•´ë³´ì•˜ëŠ”ë°<br />
ì‚¬ì‹¤ ì²˜ìŒ ë“£ëŠ” ê°œë…ë“¤ì´ë¼ ì•„ì§ ì–´ë–»ê²Œ ì“°ì´ëŠ”ì§€ ê°ì„ ì¡ê¸°ê°€ ì–´ë µë‹¤.</p>

<p>ì´ëŸ¬í•œ ê²ƒë“¤ì´ ìˆê³  í›„ì— í•™ìŠµí•˜ë©´ì„œ<br />
ì´ë ‡ê²Œ ì‚¬ìš©í•˜ëŠ”êµ¬ë‚˜ë¥¼ ê¹¨ë‹«ê³  ë‚´ê²ƒìœ¼ë¡œ ì²´ë“ì„ í•´ì•¼í•  ê²ƒ ê°™ë‹¤.</p>

<p>ì˜¤ëŠ˜ ê³µë¶€ëŠ” ì—¬ê¸°ì„œ ë !</p>

<p><br /></p>

<p><span style="color:#994C00"><strong>ì˜¤ëŠ˜ì˜ ì»¤í”¼ëŸ‰</strong></span>: â˜•ï¸ â˜•ï¸<br />
<strong>ì˜¤ëŠ˜ì˜ ì ì‹¬</strong>: ë¼ë©´, ê¹€ë°¥</p>]]></content><author><name>LEE JAEHYEOK</name></author><category term="TIL" /><category term="TIL" /><category term="ë¶€íŠ¸ìº í”„" /><category term="ì½”ë“œìŠ¤í…Œì´ì¸ " /><summary type="html"><![CDATA[ì˜¤ëŠ˜ì€ ë“œë””ì–´ ì¸ì¦ê³¼ ë³´ì•ˆê´€ë ¨ëœ ê³µë¶€ê°€ ì‹œì‘ë˜ì—ˆë‹¤.]]></summary></entry><entry><title type="html">TIL) ì„¸ë‹¬ì°¨ íšŒê³ </title><link href="http://localhost:4000/til/2022/11/16/til.html" rel="alternate" type="text/html" title="TIL) ì„¸ë‹¬ì°¨ íšŒê³ " /><published>2022-11-16T00:00:00+09:00</published><updated>2022-11-16T00:00:00+09:00</updated><id>http://localhost:4000/til/2022/11/16/til</id><content type="html" xml:base="http://localhost:4000/til/2022/11/16/til.html"><![CDATA[<p>ì–´ëŠë§ ê°€ì„ì„ ì§€ë‚˜ ê²¨ìš¸ì„ í–¥í•´ ë‹¬ë¦¬ê³ ìˆë‹¤.<br />
ì‹œê°„ì€ ë©ˆì¶”ì§€ ì•ŠëŠ”ë‹¤.</p>

<p><img src="https://lh3.googleusercontent.com/u/0/drive-viewer/AJc5JmR16i01UpPNroUzNknMVxn4tsIkhDV6gkngKajpEaMzj2xJ4E5Vyez__5rtpW5xjh_1Acwk1IZjAcZmfys0znB7kYUlsA=w3024-h1728" alt="image" class="align-left" style="max-width: 100%" /></p>

<p>ë‚´ê°€ ëŠë¼ëŠ” í•œêµ­ì‚¬íšŒì—ì„œì˜ ì‹œê°„ì€<br />
ì¡°ê¸ˆë” ë¹ ë¥¸ ê²ƒ ê°™ë‹¤ëŠ” ìƒê°ì´ë“œëŠ” ìš”ì¦˜.</p>

<p>ê³µë¶€ì— ëŒ€í•œ ì¬ë¯¸ì™€ ì—´ë§ì´ ê°•í•´ì§€ê³  ìˆë‹¤.<br />
ì¢‹ì€ ì§•ì¡°ì¸ ê²ƒ ê°™ë‹¤ëŠ” ìƒê°ë„ë“¤ê³ , ê³µë¶€í•˜ë©´í•  ìˆ˜ë¡ ë”ìš±ë”<br />
íŒŒê³ ë“¤ì–´ ì•Œê³ ì‹¶ë‹¤ëŠ” ìš•ì‹¬ì´ ê°€ë“í•´ì§„ë‹¤.</p>

<p>í˜„ì¬ ë‹¨ê³„ì—ì„œ í•™ìŠµì— ì–´ëŠì •ë„ ë°©í•´ê°€ ë˜ëŠ” ìš”ì†Œë¼ê³  ìƒê°í•œë‹¤.<br />
ì•Œë©´ì„œë„ í•œê°€ì§€ì— ëŒ€í•´ ê³„ì† íŒŒë‹¤ë³´ë‹ˆ ë‹¤ë¥¸ ê³µë¶€ë“¤ì„<br />
ì „ë¶€ í•™ìŠµí•˜ê¸°ì— ì‹œê°„ì´ ë§ì´ í—ˆë¹„ë˜ê³  ë¹„íš¨ìœ¨ì ì´ë¼ëŠ”  ì ì„ ë°œê²¬í–ˆë‹¤.</p>

<p>ì–´ëŠë§ ê°œë°œê³µë¶€í•œì§€ ì„¸ë‹¬ì°¨ê°€ ë˜ì–´ë²„ë¦°<br />
ë‚˜ì˜ ì¼ìƒê³¼ íšŒê³ ë¥¼ ì‘ì„±í•´ë³´ë ¤í•œë‹¤.</p>

<hr />

<h3 id="ë‚´ê°€-ë°°ìš´-ê²ƒ">ë‚´ê°€ ë°°ìš´ ê²ƒ?</h3>
<p>ì§€ë‚œ ì„¸ë‹¬ê°„ ë°°ìš´ ê²ƒì„ ë‚˜ì—´í•˜ìë©´<br />
ì—„ì²­ë‚˜ê²Œ ë§ì€ ë‚´ìš©ë“¤ì´ ìˆë‹¤.</p>

<p><img src="https://lh3.googleusercontent.com/drive-viewer/AJc5JmSXU951Um_58x0b3_0a2GfPEYsLXEs-jRIv8ABUveSo7Iw5c_T-fB_Qq0joTmnrxVKOQF2vwPY=w1512-h753" alt="image" class="align-left" style="max-width: 80%" /></p>

<p>Javaì™€ JavaScrpitë„ êµ¬ë¶„í•˜ì§€ ëª»í•˜ëŠ” ë‚´ê°€<br />
ì–´ëŠë§ Javaì™€ Spring Frameworkë¥¼ ì‚¬ìš©í•˜ê³  ìˆìœ¼ë‹ˆ<br />
ëŠë¦¬ì§€ë§Œ ëŒ€ë‹¨í•œ ë°œì „ì´ë¼ê³  ìƒê°í•œë‹¤.</p>

<p>ì´ë²ˆ í•œë‹¬ì€ Springì— ëŒ€í•´ ì§‘ì¤‘ì ìœ¼ë¡œ ê³µë¶€í•˜ëŠ” ì‹œê°„ì´ì˜€ë‹¤.<br />
Spring MVC, ì• í”Œë¦¬ì¼€ì´ì…˜ ê³„ì¸µ, Spring ì˜ˆì™¸ì²˜ë¦¬,<br />
Spring JDBC,JPA,Transaction, JUnit, APi ë¬¸ì„œ ìë™í™” ë“±<br />
ê¸°ë³¸ì ì¸ ì§€ì‹ë¶€í„° Springì„ ì´ìš©í•œ ì›¹ì• í”Œë¦¬ì¼€ì´ì…˜<br />
ì„¤ê³„ì™€ êµ¬í˜„ì— ëŒ€í•œ ì „ë°˜ì ì¸ ë‚´ìš©ë“¤ì„ ë‹¤ë£¨ì–´ë³´ì•˜ì—ˆë‹¤.</p>

<p>í•œë‹¬ë™ì•ˆ ì •ë§ì´ì§€ ê°€ì¥ ìœ ìµí–ˆë˜ ê³µë¶€ë¥¼ ë§ì´í•œ ê²ƒ ê°™ë‹¤.  <br />
ì´ìœ ëŠ” ë‹¹ì—°í•˜ê²Œë„ ì‹¤ë¬´ì—ì„œ ì‚¬ìš©ë˜ëŠ” ê¸°ìˆ ë“¤ì„ ë°°ì› ë‹¤ëŠ” ì ì´ ê°€ì¥ ì»¸ê³ <br />
í•´ë‹¹ ê¸°ìˆ ë¡œ ì–´ëŠì •ë„ ì›¹ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ë§Œë“œëŠ” êµ¬ì¡°ì—ëŒ€í•´ ìµíŒ ê²ƒ ê°™ì•„ì„œì´ë‹¤.</p>

<p><br /></p>

<h3 id="ì„¸ë‹¬-ê°„-ë‚˜ì˜-ë£¨í‹´ì€">ì„¸ë‹¬ ê°„ ë‚˜ì˜ ë£¨í‹´ì€?</h3>
<p>ì¸ê°„ì´ë€ ìƒë¬¼ì€ ì°¸ ì‹ ê¸°í•œ ê²ƒ ê°™ë‹¤.<br />
ë³µì¡í•œ ê°ì •ì„ ëŠë¼ê²Œ ë˜ì–´ í–‰ë³µí•  ìˆ˜ë„ ë¶ˆí–‰í•  ìˆ˜ë„ ìˆëŠ” ê²ƒ ê°™ìœ¼ë‹ˆ,,</p>

<p>ì´ë²ˆë‹¬ì€ ì‚¬ì‹¤ ê°€ì¥ ë³µì¡í•œ ê°ì •ì„ ë§ì´ ëŠë‚€ ë‹¬ì´ë‹¤.<br />
ì˜¤ëœê¸°ê°„ ê°™ì€ê±¸ ë°˜ë³µí•˜ë‹¤ë³´ë©´ ëª©í‘œê°€ íë ¤ì§€ê³  ì§€ì¹˜ê¸° ë§ˆë ¨ì´ë‹¤.<br />
ë‚˜ë„ ë‚œì´ë„ê°€ ì¦ê°€í•˜ëŠ” í•™ìŠµê³¼ í•™ìŠµëŸ‰ ê·¸ë¦¬ê³  ë°˜ë³µë˜ëŠ” ì¼ìƒì—<br />
ì–´ëŠì •ë„ ë²ˆì•„ì›ƒì´ ì™”ì—ˆê³ , ë§ˆìŒê°€ì§ì„ ì—¬ëŸ¬ë²ˆ ê³ ì³ë¨¹ì—ˆì—ˆë‹¤.</p>

<p><img src="https://lh3.googleusercontent.com/u/0/drive-viewer/AJc5JmRlTDexto7K3zOvG3HYqMS_zovg7kMNMWV_JL6QzWm5fP4TRqS5b9iNtWo3ee1ln1iJUhg2uR-djF3gZupYtWSzYRNn=w3024-h1614" alt="image" class="align-left" style="max-width: 80%" /></p>

<p>ì„¸ë‹¬ ë™ì•ˆ ê±°ì˜ ë£¨í‹´ì´ ë™ì¼í•˜ë‹¤.<br />
<strong>ì½˜í…ì¸  í•™ìŠµ(09:00~18:00) -&gt; ë³µìŠµ ë° TIL ì‘ì„±(19:00~21:00) -&gt; ê°•ì˜ ê³µë¶€ ë° ì˜ˆìŠµ(21:00~)</strong><br />
ìœ„ì™€ ê°™ì€ ë£¨í‹´ìœ¼ë¡œ ê³„ì† ê³µë¶€í•´ì™”ê³ , ì¤‘ê°„ì— ë¦¬í”„ë ˆì‰¬ë¥¼ ìœ„í•´<br />
ìš´ë™ë„ í•´ë³´ê³  ì—¬ëŸ¬ê°€ì§€ë¥¼ ì‹œë„í•´ë³´ì•˜ì§€ë§Œ, ì¹¨ëŒ€ì—ì„œ ì‰¬ì—ˆë‹¤ê°€ <br />
ë‹¤ì‹œ ê³µë¶€í•˜ëŠ”ê²Œ ê°€ì¥ ë‚˜í•œí…Œ ì§‘ì¤‘ì„ í•  ìˆ˜ ìˆê²Œ í•´ì£¼ëŠ” ìš”ì¸ìœ¼ë¡œ í™•ì¸í–ˆë‹¤.</p>

<p>ê°•ì˜ëŠ” ì£¼ë¡œ Infren ê¹€ì˜í•œë‹˜ì˜ ê°•ì˜ë¥¼ ë“£ê³ ìˆê³ <br />
ì§€ì‹ì ìœ¼ë¡œë‚˜ ì¸ê°„ì ìœ¼ë¡œ ë§¤ìš° ë°°ìš¸ì ì´ ë§ì€ ë¶„ì´ì‹  ê²ƒ ê°™ë‹¤ëŠ” ìƒê°ì´ ë“ ë‹¤.<br />
í•˜ì‹  ë§ì”€ì¤‘ì— ë„ˆë¬´ë‚˜ë„ ê¸°ì–µì— ë‚¨ëŠ”ê²Œ</p>

<p>ì—´ì •ì€ ê¸ˆë°©ì‹ëŠ”ë‹¤. ë¬´ì–¸ê°€ ë„ì „ì„í•œë‹¤ë©´<br />
ëª°ì…í•  ìˆ˜ ìˆëŠ” ì‹œìŠ¤í…œì„ ë§Œë“¤ì–´ì„œ ê±°ê¸°ì— ë‚˜ë¥¼ ë˜ì§€ë¼ëŠ” ë§ì´ ë„ˆë¬´ë‚˜ë„ ì™€ë‹¿ì•˜ë‹¤.  <br />
í˜„ì¬ ë‚´ê°€ ê·¸ëŸ° ìƒíƒœì´ê¸° ë•Œë¬¸ì—, ì—´ì •ë³´ë‹¨ ë‚´ê°€ ê³µë¶€í•˜ëŠ”<br />
ë£¨í‹´ê³¼ ì‹œìŠ¤í…œì„ ë§Œë“¤ì–´ ì˜ ì§€í‚¤ë„ë¡ ë…¸ë ¥ì„ í•´ì•¼ê² ë‹¤ê³  ìƒê°í–ˆê³ </p>

<p>ë‚˜ë„ ì €ë ‡ê²Œ ë©‹ì§€ê²Œ ì„±ì¥í•´ì•¼ê² ë‹¤ëŠ” ë§ˆìŒì„ í•­ìƒ ë‹¤ì§€ê³ ìˆë‹¤.</p>

<p><br /></p>

<h3 id="ë‹¤ìŒë‹¬ì€-ì–´ë–»ê²Œ-ë³´ë‚¼-ê²ƒì¸ê°€">ë‹¤ìŒë‹¬ì€ ì–´ë–»ê²Œ ë³´ë‚¼ ê²ƒì¸ê°€?</h3>

<p>ì§€ë‚œ ì„¸ë‹¬ê°„ ì—´ì‹¬íˆ ë‹¬ë ¤ì™”ê³ <br />
í•­ìƒ í•´ì˜¤ë˜ ê²ƒë“¤ì€ ìœ ì§€í•  ìƒê°ì´ë‹¤.</p>

<p>ë°ì¼ë¦¬ ë£¨í‹´ìœ¼ë¡œ í•­ìƒ í•˜ëŠ”ê²ƒì€</p>
<ol>
  <li>1ì¼ 1ì»¤ë°‹í•˜ì—¬ ì”ë””ì‹¬ê¸° (ì˜ë¯¸ìˆëŠ” ê²ƒë“¤ë¡œ)</li>
  <li>TIL ë¸”ë¡œê·¸ ì‘ì„±í•˜ê¸°</li>
</ol>

<p>ì´ë ‡ê²Œ 2ê°€ì§€ëŠ” í•­ìƒ í•´ì˜¤ê³  ìˆë‹¤.<br />
ì£¼ë§ì—ëŠ” ëª»í•˜ë”ë¼ë„ ë¶€ì¡±í–ˆë˜ ë¶€ë¶„ì— ëŒ€í•œ ë³µìŠµê³¼ í”„ë¡œì íŠ¸ë•Œ<br />
í•„ìš”í•  ê²ƒ ê°™ì€ ê¸°ìˆ ì— ëŒ€í•œ ì˜ˆìŠµì„ ì£¼ë¡œí•˜ëŠ” í¸ì´ë‹¤.<br />
ì´ ë¶€ë¶„ë“¤ì€ ë‚˜ì™€ ì˜ ë§ëŠ” ê²ƒ ê°™ê³ , ì„±ì¥ì— ë„ì›€ì´ëœë‹¤ ìƒê°í•˜ì—¬<br />
ë§¤ë²ˆ ì‹¤ì²œí•  ìƒê°ì´ë‹¤.</p>

<p>ì˜¤ëœ ê³µë¶€ì‹œê°„ë™ì•ˆ ìš´ë™ì„ ë‚˜ê°”ë‹¤ì˜¤ê±°ë‚˜<br />
ë‹¤ë¥¸ ê²ƒìœ¼ë¡œ ë¦¬í”„ë ˆì‰¬í•˜ëŠ” ë°©ë²•ì„ ë§ì´ ì·¨í•´ë³´ì•˜ëŠ”ë°<br />
í¬ê²Œ ë„ì›€ì€ ì—†ë‹¤ê³  ê¹¨ë‹¬ì•˜ê³ , ëˆ„ì›Œì„œ ì •ì‹ ì„ ë§‘ê²Œ<br />
ì‰¬ëŠ” ê²ƒì´ ìµœê³ ì˜ ë°©ë²•ì´ë¼ ìƒê°í•˜ì—¬ ì´ ë¶€ë¶„ë„ ê³„ì† ì´ë ‡ê²Œ ê³µë¶€ì—<br />
ì§‘ì¤‘í•  ìˆ˜ ìˆë„ë¡ ìœ ì§€í•  ìƒê°ì´ë‹¤.</p>

<p><br /></p>

<p>ê·¸ë¦¬ê³  ê³µë¶€í•˜ë©´ì„œ ê¹¨ë‹¬ì€ ì•ˆì¢‹ì€ ìŠµê´€ë“¤ì„ ë°œê²¬í–ˆë‹¤.</p>

<p><img src="https://lh3.googleusercontent.com/u/0/drive-viewer/AJc5JmRpTAUYSI-GUgK5uUnr4WgRsY_BsNfK-teJ_Bu1og9-RxJlO8Q1HRRnCY01NZUpfNaJdscM7wwPNseuLvdUlc7ZLff_5w=w1920-h864" alt="image" class="align-left" style="max-width: 40%" /></p>

<ol>
  <li>ê³µë¶€ì¤‘ ì¹´ì¹´ì˜¤í†¡ê³¼ SNSë¥¼ ìˆ˜ì‹œë¡œ ë“¤ì–´ê°„ë‹¤.</li>
  <li>ë…¸ë˜ë¥¼ ë“¤ìœ¼ë©´ì„œ ê³µë¶€í•œë‹¤.</li>
  <li>ì˜¤ëŠ˜ ê³µë¶€ì˜ ëª©í‘œì ì— ë„ë‹¬í•˜ë©´ ë‹¤ìŒê³µë¶€ë¥¼ ë¯¸ë£¬ë‹¤.</li>
</ol>

<p>ì²˜ìŒì—ëŠ” ëŒ€ìˆ˜ë¡­ì§€ ì•Šê²Œ ìƒê°í•˜ê³  ìˆë˜ ìŠµê´€ë“¤ì´ë‹¤.<br />
ìµœê·¼ì— ê³µë¶€ë¥¼í•˜ë©´ì„œ ë‚´ì§‘ì¤‘ì„ íë¦¬ëŠ”ë° ê°€ì¥ í° ì—­í• ì„ í•œë‹¤ê³  ìƒê°í–ˆê³  <br />
í•™êµì²˜ëŸ¼ ê³µë¶€ì‹œê°„ì— ì² ì €í•˜ê²Œ ì‹œìŠ¤í…œì„ ê°–ì¶°<br />
ê±°ê¸°ì•ˆì—ì„œ ë‚´ê°€ ì‹¤ì²œí•  ìˆ˜ ìˆê²Œë” ê³µë¶€í•˜ëŠ” ë°©ì‹ìœ¼ë¡œ ê°œì„ ì„ í–ˆë‹¤.</p>

<p>ì´ ê°œì„ ë°©ë²•ìœ¼ë¡œ ê³„ì† ê³µë¶€í•´ë‚˜ì•„ê°ˆ ìƒê°ì´ê³ <br />
3ë²ˆê³¼ ê°™ì€ ê²½ìš°, ë‹¤ë“¤ ê·¸ëŸ°ì§€ëŠ” ëª¨ë¥´ê² ì§€ë§Œâ€¦ ì˜¤ëŠ˜ì˜ í•™ìŠµëŸ‰ì„<br />
ë§ˆì¹˜ê³  ë‚˜ë©´ ê·¸ëƒ¥ ì‹œê°„ì´ ë‚¨ì•„ë„ ì‰¬ì–´ë²„ë¦¬ëŠ” ë¬¸ì œê°€ ìˆì—ˆë‹¤.</p>

<p>ë§ˆìŒì˜ ì•ˆì‹¬ì´ë„ê¹Œ? ì˜¤ëŠ˜í• êº¼ ë‹¤í–ˆë‹¤! ë¼ëŠ” ìƒê°ì´ ë“¤ì–´ì„œ<br />
ê³µë¶€ë¥¼ ì•ˆí•˜ê²Œë˜ì–´ì„œ, ì–µì§€ë¡œë¼ë„ ì¸í”„ëŸ° ê°•ì˜ë¥¼ ì¼œì„œ<br />
ë“£ê¸° ì‹œì‘í•˜ë‹¤ë³´ë‹ˆ ì´ì œ ê·¸ ì‹œê°„ì´ ì¬ë°‹ì–´ì§€ê¸° ì‹œì‘í•˜ê³ ìˆë‹¤.<br />
ë­ë“ ì§€ ì‹¤ì²œí•˜ëŠ”ê²Œ ê°€ì¥ ì–´ë µë“¯ì´ ê°•ì˜ë¥¼ í‚¤ê¸°ê¹Œì§€ê°€ ì œì¼ ì–´ë µì§€ë§Œ<br />
ë§‰ìƒ í‚¤ê³ ë‚˜ë©´ ì¬ë°Œì–´ì„œ ê³„ì† ë“£ê²Œë˜ëŠ” íš¨ê³¼ê°€ ìˆëŠ” ê²ƒ ê°™ë‹¤.</p>

<p><br /></p>

<p>ê·¸ë¦¬ê³  ê°€ì¥ ê³µë¶€ê°€ í•„ìš”í•˜ë‹¤ê³  ìƒê°í•˜ëŠ” ë¶€ë¶„ì´ ë“œëŠ”ê²Œ ìˆë‹¤.<br />
ë¬¼ë¡  í˜„ì¬ ë°°ìš°ê³ ìˆëŠ” Spring ê´€ë ¨ ê³µë¶€ëŠ” ê³„ì†í•´ì•¼í•˜ëŠ” ê²ƒì´ì§€ë§Œ<br />
ì´ì œ ìŠ¬ìŠ¬ <strong>ì •ê·œì‹ê´€ë ¨ ë¬¸ë²•, ì•Œê³ ë¦¬ì¦˜ ê³µë¶€</strong>ë¥¼ ì¤€ë¹„í•´ì•¼í•  ê²ƒ ê°™ë‹¤ëŠ” ìƒê°ì´ë“ ë‹¤.</p>

<p>ë‹¤ìŒë‹¬ í•™ìŠµì„ ì–´ëŠì •ë„ ë§ˆì¹œí›„<br />
ì•Œê³ ë¦¬ì¦˜ ê³µë¶€ë„ ì²´ê³„ì ìœ¼ë¡œ ì§„í–‰í•´ë³¼ ì˜ˆì •ì´ë‹¤.<br />
ë‹¤ì–‘í•œ ë¬¸ì œë¥¼ ì ‘í•˜ê¸° ë³´ë‹¤ëŠ”, í•œê°€ì§€ ìœ í˜•ì˜ ë¬¸ì œë¥¼ ë§ì´ í’€ì–´<br />
ë¨¼ì € ìµìˆ™í•´ì§€ëŠ” ë°©ë²•ì„ ê°€ì§€ê³  ë²”ìœ„ë¥¼ í™•ì¥ì‹œì¼œ ë‚˜ì•„ê°ˆ ìƒê°ì´ë‹¤.</p>

<p><br /></p>

<h3 id="ë§ˆì¹˜ë©°">ë§ˆì¹˜ë©°</h3>

<p>ì–´ë ¸ì„ ë•Œ ë¶€í„°, ì—¬ëŸ¬ê°€ì§€ë¥¼ ë§ì´ ê²½í—˜í•´ë³´ê³  ì‹¶ì—ˆê³ <br />
ì–´ë–»ê²Œ í•˜ë‹¤ë³´ë‹ˆê¹Œ ì§€ê¸ˆì—ì„œì•¼ ê°œë°œì ì¤€ë¹„ë¥¼ í•˜ê²Œë˜ì—ˆë‹¤.</p>

<p>ì ì§€ì•Šì€ ë‚˜ì´ì— ì¤€ë¹„ë¥¼ ì‹œì‘í•˜ìë‹ˆ ë¶ˆì•ˆê°ê³¼ ìƒëŒ€ì  ë¹„êµê°€<br />
ë‚˜ë¥¼ ê°€ì¥ ë¶ˆì•ˆí•˜ê²Œ í–ˆë˜ ë‹¬ì´ì—ˆë˜ ê²ƒ ê°™ë‹¤.</p>

<p>ìµœê·¼ì— ê°€ì¥ ê°ëª…ê¹Šê²Œ ë³´ì•˜ë˜ ê²ƒ ì¤‘ì—ì„œ<br />
ì¡°ê¸ˆ ì˜¤ê·¸ë¼ë“¤ê±°ë‚˜ ë³„ê±° ì•„ë‹Œ ê²ƒ ì²˜ëŸ¼ ëŠë¼ëŠ” ë¶„ë“¤ë„ ìˆì„ ê²ƒ ê°™ê¸´í•œë°<br />
ë‚˜í•œí…ŒëŠ” í° ì„í™íŠ¸ë¡œ ë‹¤ê°€ì™€ì„œ ì–˜ê¸°í•´ë³´ë ¤í•œë‹¤.</p>

<p>ë‚´ê°€ ê°€ì¥ ë§ì´í•˜ëŠ” ê²Œì„.. ë¦¬ê·¸ì˜¤ë¸Œë ˆì „ë“œ<br />
ë‚˜ ê°™ì€ ê²œëŒì´ë“¤ì€ ë‹¹ì—°íˆ ì´ë²ˆë…„ë„ì— ì—´ë¦¬ëŠ” ê²°ìŠ¹ì „ ê²½ê¸°ë¥¼ ë³´ì•˜ì„ ê±°ë¼ ìƒê°í•œë‹¤.</p>

<p><img src="https://lh3.googleusercontent.com/u/0/drive-viewer/AJc5JmTXoT1HvGMR6nEoy_n4kpu1lcISRNm8bgZN4eeS86_HASrkFdxrDDPt7RLkMKW6DR-q62hJyo-QTUpuNjaoKCC-c5o59w=w1920-h864" alt="image" class="align-left" style="max-width: 70%" /></p>

<p>DRX Deft ì„ ìˆ˜ê°€ 10ë…„ì˜ ì—­ê²½ì„ ì´ê¸°ê³  ìš°ìŠ¹ íŠ¸ë¡œí”¼ë¥¼ ë“¤ì–´ì˜¬ë¦¬ëŠ” ì¥ë©´ì´ë‹¤.<br />
ì•„ë§ˆ ì—­ëŒ€ ê°€ì¥ ìŠ¤í† ë¦¬ê°€ ì¢‹ì€ ê²°ìŠ¹ì „ìœ¼ë¡œ ê¼½íê±°ê³ <br />
ë¡¤ì„í•˜ëŠ” ìœ ì €ë“¤ì´ë¼ë©´ ë°±í¼ì„¼íŠ¸ ê³µê°í•  ê²ƒ ê°™ë‹¤.</p>

<p>í•œêµ­ì—ì„œë„ ê°€ì¥ ë‚®ì€ ì‹œë“œë¡œ ì›”ì¦ˆì— ì§„ì¶œí•´<br />
ê°€ì¥ ì•½í•œíŒ€ìœ¼ë¡œ í‰ê°€ë°›ì•˜ê³  ëˆ„êµ¬ë„ ìš°ìŠ¹í• ê±°ë¼ ì˜ˆìƒí•˜ì§€ ëª»í–ˆì„ ê±°ë‹¤.<br />
ê²°ìŠ¹í•˜ëŠ” ê³¼ì •ë„ ì§„ì§œ ìˆœíƒ„ì¹˜ì•Šì•˜ê³ , ë‚˜ëŠ” ê·¸ê³¼ì •ë“¤ì„ ë‹¤ì±™ê²¨ ë³´ì•˜ì—ˆë‹¤.</p>

<p>ì˜¬ë¼ê°€ëŠ” ê³¼ì • ì¤‘ ë°í”„íŠ¸ ì„ ìˆ˜ê°€ í–ˆë˜ ì–˜ê¸°ê°€ ê¸°ì‚¬í™” ë˜ì–´<br />
ê¸°ì‚¬ì˜ ì‘ëª…ìœ¼ë¡œ <strong>â€˜ì¤‘ìš”í•œê±´ êº½ì´ì§€ ì•ŠëŠ” ë§ˆìŒâ€™</strong> ì´ë¼ëŠ” ë§ì´ ë°ˆì´ë˜ì—ˆê³  ëª…ì–¸ì´ë˜ì—ˆë‹¤.</p>

<p>ëˆ„êµ¬ì—ê² ì¥ë‚œì²˜ëŸ¼ë“¤ë¦¬ê³  ë³„ ê²ƒ ì•„ë‹Œ ê²ƒ ì²˜ëŸ¼ ë“¤ë¦´ ìˆ˜ ìˆê² ì§€ë§Œ<br />
ì§€ê¸ˆ ê°œë°œìë¡œ ì»¤ë¦¬ì–´ ì „í™˜í•˜ë ¤ëŠ” ë‚˜ì˜ ë§ˆìŒì´ ê°€ë³ì§€ ì•Šì•˜ê¸° ë•Œë¬¸ì—<br />
ë‚˜ì—ê² ì´ ë¬¸êµ¬ê°€ ê½¤ë‚˜ í¬ê²Œ ë‹¤ê°€ì™”ë‹¤.</p>

<p>ë‹¨ìˆœíˆ ì»¨í…ì¸ ì ìœ¼ë¡œ ì¬ë¯¸ë¡œ ì†Œëª¨í•  ìˆ˜ ìˆì—ˆê² ì§€ë§Œ<br />
ë‚´ ë§ˆìŒì˜ í° ë³€í™”ê°€ ìƒê²¼ê³ , ê·¸ ë™ì•ˆ ë‚˜ëŠ” ë„ˆë¬´ ê°€ë³ê²Œ ê³µë¶€í•˜ì§€ ì•Šì•˜ì„ê¹Œ?<br />
ì •ë§ ì£½ì–´ë¼ ê³ ìƒí•˜ë©´ì„œ ê³µë¶€í•˜ê³ ìˆë‹ˆ? ë¼ëŠ” ë¬¼ìŒë“¤ì´<br />
ê°€ìŠ´ì†ì— ë˜ì ¸ì¡Œê³  ë‚˜ëŠ” ì´ë¥¼ ê³„ê¸°ë¡œ ì¡°ê¸ˆ ë” ì„±ì¥í•˜ë©´ì„œ<br />
ë‚˜ì•„ê°€ì•¼ê² ë‹¤ëŠ” ë§ˆìŒì„ ê°€ì§€ê²Œ ëœ ê²ƒ ê°™ë‹¤.</p>

<p><br /></p>

<p>ì´ìƒ ì„¸ë‹¬ì°¨ ê³µë¶€ ì¤‘ì¸ <br />
ë‚˜ë€ ì‚¬ëŒì˜ íšŒê³ ë¥¼ ì ì–´ë³¸ë‹¤.</p>

<p><br /></p>]]></content><author><name>LEE JAEHYEOK</name></author><category term="TIL" /><category term="TIL" /><category term="ë¶€íŠ¸ìº í”„" /><category term="ì½”ë“œìŠ¤í…Œì´ì¸ " /><summary type="html"><![CDATA[ì–´ëŠë§ ê°€ì„ì„ ì§€ë‚˜ ê²¨ìš¸ì„ í–¥í•´ ë‹¬ë¦¬ê³ ìˆë‹¤. ì‹œê°„ì€ ë©ˆì¶”ì§€ ì•ŠëŠ”ë‹¤.]]></summary></entry><entry><title type="html">Spring) MySQL Local ì—°ë™ í•˜ê¸°</title><link href="http://localhost:4000/spring/2022/11/15/spring-mysql.html" rel="alternate" type="text/html" title="Spring) MySQL Local ì—°ë™ í•˜ê¸°" /><published>2022-11-15T00:00:00+09:00</published><updated>2022-11-15T00:00:00+09:00</updated><id>http://localhost:4000/spring/2022/11/15/spring-mysql</id><content type="html" xml:base="http://localhost:4000/spring/2022/11/15/spring-mysql.html"><![CDATA[<p>ì˜¤ëŠ˜ì€ Springì„ ì´ìš©í•´ MySQLì„ Local í™˜ê²½ì—ì„œ<br />
ì—°ê²°í•˜ì—¬ ì‚¬ìš©í•´ë³´ë ¤ê³ í•œë‹¤.</p>

<p>ê¸°ì¡´ì— H2ë¥¼ ì‚¬ìš©í•´ í…ŒìŠ¤íŠ¸ë¥¼ ì§„í–‰í–ˆì—ˆê³  JPAë¥¼ ì‚¬ìš©í•˜ê¸°ë•Œë¬¸ì—  <br />
ì €ì¥ì†Œë§Œ ë°”ê¿”ì£¼ëŠ” í…ŒìŠ¤íŠ¸ë¥¼ í•´ë³´ë ¤ëŠ” ê²ƒì´ë‹¤.</p>

<p>MySQL WorkBench GUIë¡œ ì‘ì—…í•˜ì˜€ê³ <br />
ë¦¬ì†ŒìŠ¤ëŠ” .yml íŒŒì¼ì„ ì‚¬ìš©í–ˆë‹¤.</p>

<p>ê°œë°œí™˜ê²½ì— ë”°ë¥¸ MySQL ì„¤ì¹˜ì™€ ì‚¬ìš©í™˜ê²½ì€ ì¤€ë¹„ë˜ì–´ìˆë‹¤ê³  ê°€ì •í•˜ê² ë‹¤.</p>

<p><br /></p>

<p>1). bulid.gradle ì„¤ì •</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>runtimeOnly 'mysql:mysql-connector-java'
</code></pre></div></div>

<p>ì²«ë²ˆì§¸ë¡œ ì˜ì¡´ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì¶”ê°€í•´ì¤˜ì•¼í•œë‹¤.</p>

<p><img src="https://lh3.googleusercontent.com/u/0/drive-viewer/AJc5JmT3UmG6D9zRRTBuGTrPPBn1AMzOguxqyJyTCiPbwzSnqYvkwa2lcq7zFy-3TB1VCBhRhCBXyPGBvN2KxBkWBnjq3NhY9Q=w3024-h1614" alt="image" class="align-left" style="max-width: 100%" /></p>

<p>ì¶”ê°€í•˜ê³  Gradle Reloadë¥¼ í•  ê²½ìš° ìœ„ì™€ ê°™ì´<br />
ë¼ì´ë¸ŒëŸ¬ë¦¬ íŒ¨í‚¤ì§€ê°€ ìƒê¸°ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.</p>

<p><br /></p>

<p>2). .yml íŒŒì¼ ì„¤ì •</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">spring</span><span class="pi">:</span>
  <span class="na">jpa</span><span class="pi">:</span>
    <span class="na">hibernate</span><span class="pi">:</span>
      <span class="na">ddl-auto</span><span class="pi">:</span> <span class="s">create-drop</span>  <span class="c1"># ìŠ¤í‚¤ë§ˆ ìë™ ìƒì„±</span>
    <span class="na">show-sql</span><span class="pi">:</span> <span class="no">true</span>      <span class="c1"># SQL ì¿¼ë¦¬ ì¶œë ¥</span>
    <span class="na">properties</span><span class="pi">:</span>
      <span class="na">hibernate</span><span class="pi">:</span>
        <span class="na">format_sql</span><span class="pi">:</span> <span class="no">true</span>  <span class="c1"># SQL pretty print</span>
  <span class="na">datasource</span><span class="pi">:</span>
    <span class="na">driver-class-name</span><span class="pi">:</span> <span class="s">com.mysql.cj.jdbc.Driver</span>
    <span class="na">url</span><span class="pi">:</span> <span class="s">jdbc:mysql://localhost:í¬íŠ¸ë„˜ë²„/ìŠ¤í‚¤ë§ˆì´ë¦„?serverTimezone=Asia/Seoul</span> <span class="c1"># í¬íŠ¸ë„˜ë²„, ìŠ¤í‚¤ë§ˆì´ë¦„</span>
    <span class="na">username</span><span class="pi">:</span>  <span class="c1"># ìœ ì €ë„¤ì„</span>
    <span class="na">password</span><span class="pi">:</span>  <span class="c1"># ë¹„ë°€ë²ˆí˜¸</span>
</code></pre></div></div>

<p>ë‘ë²ˆì§¸ë¡œ ì—°ê²°ì„ìœ„í•œ .ymlíŒŒì¼ ì„¤ì •ì´ë‹¤.<br />
í”„ë¡œì íŠ¸ ì´ë¦„ &gt; main &gt; resources ì—ì„œ í™•ì¸ì´ ê°€ëŠ¥í•˜ê³ <br />
properties í™•ì¥ìë¥¼ application.ymlë¡œ ë³€ê²½í•˜ì˜€ë‹¤.</p>

<p>spring : <br />
jpa : <br />
ì— í•´ë‹¹í•˜ëŠ” ë¶€ë¶„ì€ jpaê´€ë ¨ ì„¤ì •ì´ë‹¤.</p>

<p>ìš°ë¦¬ê°€ ë´ì•¼í•  ë¶€ë¶„ì€<br />
spring :<br />
datasource :<br />
ì´ë¶€ë¶„ì´ê³  í•´ë‹¹ ë¶€ë¶„ì— MySQL ì„¤ì • ì •ë³´ë¥¼ ë„£ì–´ì¤˜ì•¼í•œë‹¤.</p>

<p>ë„£ì–´ì¤˜ì•¼í•  ì •ë³´ëŠ” 4ê°€ì§€ ì´ë‹¤.</p>
<ol>
  <li>í¬íŠ¸ë„˜ë²„</li>
  <li>ìŠ¤í‚¤ë§ˆ ì´ë¦„</li>
  <li>ìœ ì €ë„¤ì„</li>
  <li>ë¹„ë°€ë²ˆí˜¸</li>
</ol>

<p>ì´ë ‡ê²Œ ì´ 4ê°€ì§€ì˜ ì •ë³´ë¥¼ ë„£ì–´ì£¼ë©´ ë˜ê³  í—·ê°ˆë¦¬ëŠ” ë¶„ë“¤ì„ ìœ„í•´<br />
ì•„ë˜ì— ì–´ë””ì„œ ì°¾ëŠ”ì§€ ì ì–´ë³´ê² ë‹¤.</p>

<p><img src="https://lh3.googleusercontent.com/u/0/drive-viewer/AJc5JmTQ8kpsyLHOtqRJe4AWUM2aNJaivLTPJXYRrN0ouL1c4O408flzunjeHgxsWpz-ciRq_28B1-XViwZ9D2zNRMJFtVTE=w1512-h807" alt="image" class="align-left" style="max-width: 100%" /></p>

<p>ì›Œí¬ë°´ì¹˜(MySQL WorkBench)ë¥¼ ì—´ì–´ë³´ë©´<br />
ì»¤ë„¥ì…˜ì— ê´€í•œ ì •ë³´ê°€ ë‚˜ì˜¨ë‹¤.<br />
ì—†ìœ¼ë©´ ì—°ê²°ì„ í•œë²ˆë„ í•˜ì§€ ì•Šì€ ê²ƒì´ê¸°ì—<br />
ì»¤ë„¥ì…˜ì„ ë§Œë“¤ì–´ì£¼ë©´ ëœë‹¤.</p>

<p>ì»¤ë„¥ì…˜ì„ ë”ë¸”í´ë¦­ í•´ë³´ì</p>

<p><img src="https://lh3.googleusercontent.com/u/0/drive-viewer/AJc5JmSYYNi9Ztave6ML9l2HlQz6N0L9Qp9hExMMGC6gWibCjaC77q3_Kr13n0i3FVaKMw3Uw7i2pJEffAYTGQbXcXNJs88a=w3024-h1614" alt="image" class="align-left" style="max-width: 100%" /></p>

<p>ë”ë¸”í´ë¦­ì„ í•˜ë©´ ìœ„ì™€ê°™ì€ íŒì—…ì°½ì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.<br />
ì—¬ê¸°ì„œ ì£¼ì†ŒëŠ” localhost:3306 ì„ ì‚¬ìš©í•œë‹¤ëŠ” ê²ƒì„ ì•Œ ìˆ˜ ìˆê³ <br />
ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ë©´ í•´ë‹¹ ì»¤ë„¥ì…˜ìœ¼ë¡œ ì ‘ì†ì´ ê°€ëŠ¥í•˜ë‹¤.</p>

<p>ì—¬ê¸°ì„œ ì•Œ ìˆ˜ ìˆëŠ” ì •ë³´ëŠ”</p>

<p><strong>í¬íŠ¸ë„˜ë²„ = 3306<br />
ìœ ì €ë„¤ì„ = root<br />
ë¹„ë°€ë²ˆí˜¸ = ë³¸ì¸ì´ ì„¤ì •í•œ í•´ë‹¹ ë¹„ë°€ë²ˆí˜¸</strong></p>

<p>ì´ë ‡ê²Œ ì•Œ ìˆ˜ ìˆë‹¤.</p>

<p>ê·¸ë¦¬ê³  ì ‘ì†ì„ í•œ ë‹¤ìŒì—ëŠ”</p>

<p><img src="https://lh3.googleusercontent.com/u/0/drive-viewer/AJc5JmTl-Yr7RL6BgRLfYwoprmSbmBdVuW57E1ZZZNHIkUzW7qSYqUYhsrV8oxAIaYAwRvmuBETxjvR-HdrKpeLwOww8acgNJQ=w3024-h1614" alt="image" class="align-left" style="max-width: 100%" /></p>

<p>ì „ì²´ì ì¸ í™”ë©´ì„ ë³¼ ìˆ˜ ìˆëŠ” Schemasì— ë“¤ì–´ê°€<br />
ìŠ¤í‚¤ë§ˆë¥¼ ìƒì„±í•´ì£¼ë©´ ëœë‹¤.</p>

<p>ìƒì„±í•œ ìŠ¤í‚¤ë§ˆê°€ ìŠ¤í‚¤ë§ˆì´ë¦„ì´ ë˜ëŠ” ê²ƒì´ë‹¤.<br />
ë‚˜ëŠ” exampleë¡œ ì„¤ì •í–ˆê³ <br />
ì´ë ‡ê²Œ ìµœì¢…ì ìœ¼ë¡œ 4ê°€ì§€ ì •ë³´ë¥¼ ì•Œì•„ë³¼ ìˆ˜ ìˆì—ˆë‹¤.</p>

<p>ì´ë ‡ê²Œ ì •ë¦¬í•´ì„œ ì •ë³´ë¥¼ ì ì–´ë³´ìë©´</p>
<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">datasource</span><span class="pi">:</span>
  <span class="na">driver-class-name</span><span class="pi">:</span> <span class="s">com.mysql.cj.jdbc.Driver</span>
  <span class="na">url</span><span class="pi">:</span> <span class="s">jdbc:mysql://localhost:3306/example?serverTimezone=Asia/Seoul</span> <span class="c1"># í¬íŠ¸:3306 , ìŠ¤í‚¤ë§ˆ:example</span>
  <span class="na">username</span><span class="pi">:</span> <span class="s">root</span>  <span class="c1"># ìœ ì €ë„¤ì„</span>
  <span class="na">password</span><span class="pi">:</span> <span class="s">ë‚´ ë¹„ë°€ë²ˆí˜¸</span> <span class="c1"># ë¹„ë°€ë²ˆí˜¸</span>
</code></pre></div></div>

<p>ì´ë ‡ê²Œ ì„¤ì •í•  ìˆ˜ ìˆì„ ê²ƒì´ë‹¤.</p>

<p>ì—¬ê¸°ì„œ ë¹„ë°€ë²ˆí˜¸ë¥¼ ê¹Œë¨¹ì€ ì‚¬ëŒë“¤ì´ ë§ì€ë°.. ê¹Œë¨¹ì§€ ì•Šë„ë¡ ìœ ì˜í•˜ì<br />
ì²˜ìŒì— mysqlë¥¼ ë‹¤ìš´ë°›ê³  ì„¤ì •í•œ ë¹„ë°€ë²ˆí˜¸ë‹¤.<br />
ì¸í„°ë„·ì— ë¹„ë°€ë²ˆí˜¸ ë¦¬ì…‹ í•˜ëŠ”ë²• ë“±ì´ ìˆìœ¼ë‹ˆ ì°¸ê³ í•´ë³´ì</p>]]></content><author><name>LEE JAEHYEOK</name></author><category term="Spring" /><category term="Spring" /><category term="mysql" /><summary type="html"><![CDATA[ì˜¤ëŠ˜ì€ Springì„ ì´ìš©í•´ MySQLì„ Local í™˜ê²½ì—ì„œ ì—°ê²°í•˜ì—¬ ì‚¬ìš©í•´ë³´ë ¤ê³ í•œë‹¤.]]></summary></entry><entry><title type="html">TIL) Application ë¹Œë“œ, ì‹¤í–‰</title><link href="http://localhost:4000/til/2022/11/15/til.html" rel="alternate" type="text/html" title="TIL) Application ë¹Œë“œ, ì‹¤í–‰" /><published>2022-11-15T00:00:00+09:00</published><updated>2022-11-15T00:00:00+09:00</updated><id>http://localhost:4000/til/2022/11/15/til</id><content type="html" xml:base="http://localhost:4000/til/2022/11/15/til.html"><![CDATA[<p><img src="https://lh3.googleusercontent.com/u/0/drive-viewer/AFDK6gNq0VcIEmAZMz_1paQl-4m8_fIqcR-XIxlvy4GrezxEOvY6tzpT_1uI3JJK_XNFFzX3gFipA7DgprUqDMmQVqM19rSf8Q=w1920-h921" alt="image" class="align-left" style="max-width: 100%" /></p>

<p>ì˜¤ëŠ˜ì€ ì„¹ì…˜ ë§ˆì§€ë§‰ë‚ ì´ë‹¤. <br />
ë²Œì¨ 3ë‹¬ì§¸ë¥¼ ë‹¬ë¦¬ê³  ìˆëŠ” ë¶€íŠ¸ìº í”„</p>

<p>í™•ì‹¤íˆ í˜¼ì ê³µë¶€í•˜ëŠ” ê²ƒë³´ë‹¤ ê°€ì´ë“œë¼ì¸ì´ ì œì‹œë˜ë‹ˆ<br />
ìŠ¤í…ë°”ì´ìŠ¤í…ìœ¼ë¡œ ì„±ì¥í•˜ëŠ” ëª¨ìŠµì´ ëˆˆì— ë³´ì´ë‹ˆ</p>

<p>ë§Œì¡±ìŠ¤ëŸ¬ìš´ ë‚˜ë‚ ì„ ë³´ë‚´ê³  ìˆë‹¤.<br />
ê·¸ëŸ¼ì—ë„ ì•„ì§ ìƒˆë°œì˜ í”¼ ì •ë„ë§Œ ê³µë¶€í–ˆê¸°ì—<br />
ì˜¤ëŠ˜ë„ ê³µë¶€ë¥¼ ì‹œì‘í•´ë³´ì</p>

<hr />

<p>ì˜¤ëŠ˜ì€ ì• í”Œë¦¬ì¼€ì´ì…˜ ë¹Œë“œí•˜ëŠ” ë²•ì„ ì•Œì•„ë³´ë ¤í•œë‹¤.<br />
ì‹¤ì œë¡œ ë‚˜ì¤‘ì— ì„œë²„ì— ë°°í¬ë¥¼ í•´ì•¼í•˜ê¸°ì— ..</p>

<h2 id="ì• í”Œë¦¬ì¼€ì´ì…˜-ë¹Œë“œì‹¤í–‰">ì• í”Œë¦¬ì¼€ì´ì…˜ ë¹Œë“œ/ì‹¤í–‰</h2>

<p>ìš°ë¦¬ëŠ” ì—¬íƒœê¹Œì§€ IntelliJ IDEì˜ ë„ì›€ì„ ë°›ì•„ì„œ<br />
ë¹Œë“œë¥¼ ì§„í–‰í–ˆì—ˆë‹¤.</p>

<p>IDEë¥¼ ì‚¬ìš©í•˜ì§€ì•Šê³  ë¡œì»¬ í™˜ê²½ì´ ì•„ë‹Œ ì„œë²„í™˜ê²½ì—ì„œ ì‹¤í–‰<br />
ê°€ëŠ¥í•˜ê²Œ í•˜ë ¤ë©´ Gradleì´ë‚˜ Mavenê°™ì€ ë¹Œë“œ íˆ´ì„ ì´ìš©í•´ì„œ Spring Boot<br />
ê¸°ë°˜ì˜ ì• í”Œë¦¬ì¼€ì´ì…˜ ì†ŒìŠ¤ ì½”ë“œë¥¼ ë¹Œë“œí•˜ëŠ” ê¸°ë³¸ì ì¸ ë°©ë²•ì„ ì•Œê³ ìˆì–´ì•¼í•œë‹¤.</p>

<p>ìš°ì„  IDEë¥¼ ì´ìš©í•´ ë¹Œë“œí•˜ëŠ” ë°©ë²•ì„ ì•Œì•„ë³´ì<br />
(ìš°ë¦¬ê°€ ë§Œë“  í”„ë¡œì íŠ¸ëŠ” Gradleì´ë‹¤)</p>

<p><br /></p>

<h3 id="ë¹Œë“œ">ë¹Œë“œ</h3>

<p><strong>1). IDEë¥¼ í†µí•œ build</strong></p>

<p><img src="https://lh3.googleusercontent.com/u/0/drive-viewer/AFDK6gNkvOHRKiADoB4F8uygjnopOf4yqKRcMFN3Y0F47e49WVx74nLU_L3f20JxUX0AQCXTBFVgFD6JOgB04D4H2SxJJebxAw=w1920-h921" alt="image" class="align-left" style="max-width: 100%" /></p>

<p>ë‚´ê°€ ë§Œë“  í”„ë¡œì íŠ¸ ì´ë¦„ -&gt; Taske -&gt; bootJar or build ë¥¼<br />
ë”ë¸” í´ë¦­í•´ì„œ ë¹Œë“œí•´ì¤„ ìˆ˜ ìˆë‹¤.</p>

<p><img src="https://lh3.googleusercontent.com/u/0/drive-viewer/AJc5JmSjKwMt-ckmZXkOIp-tqZfr2mCjaNKgrTC6qMK0HNni9P8v92vYxD8qYjRGYLi0wIHQy-4Tf-ysvMVxchljPxkJPytO=w1920-h921" alt="image" class="align-left" style="max-width: 100%" /></p>

<p>ë¹Œë“œê°€ ì™„ë£Œë˜ë©´ Jar íŒŒì¼ì´ ìƒê¸°ëŠ”ë°<br />
ì—¬ê¸°ì„œ plain.jar íŒŒì¼ì€ build taskë¥¼ ì‹¤í–‰í•˜ë©´ ìƒê¸°ëŠ” íŒŒì¼ì´ë‹¤.<br />
ìš°ë¦¬ëŠ” ì‹¤í–‰ ê°€ëŠ¥í•œ Jar íŒŒì¼ì¸ plainì´ ì•ˆë¶™ì€ íŒŒì¼ì„ ì‹¤í–‰ì‹œí‚¤ë©´ ëœë‹¤.</p>

<p><br /></p>

<p><strong>2). í„°ë¯¸ë„ë¡œ build</strong></p>

<p>ì²«ë²ˆì§¸ë¡œ Gradleì´ ì„¤ì¹˜ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸í•´ë³´ì</p>
<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>gradle <span class="nt">-v</span>
</code></pre></div></div>

<p>ë§Œì•½ì— ë²„ì ¼ì´ ì•ˆëœ¨ê³  zsh: command not found: gradle<br />
ì°¾ì„ ìˆ˜ ì—†ë‹¤ê³  í•œë‹¤ë©´, homebrewë¥¼ í†µí•´ gradleì„ ë‹¤ìš´ ë°›ëŠ”ë‹¤.</p>
<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>brew <span class="nb">install </span>gradle
</code></pre></div></div>
<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">==&gt;</span> Downloading https://ghcr.io/v2/homebrew/core/openjdk/17/manifests/17.0.5
<span class="c">######################################################################## 100.0%</span>
<span class="o">==&gt;</span> Downloading https://ghcr.io/v2/homebrew/core/openjdk/17/blobs/sha256:0e2244e35a350256474b6eb6e03d11af5c0270ab7ca4e6bc71
<span class="o">==&gt;</span> Downloading from https://pkg-containers.githubusercontent.com/ghcr1/blobs/sha256:0e2244e35a350256474b6eb6e03d11af5c0270
<span class="c">######################################################################## 100.0%</span>
<span class="o">==&gt;</span> Downloading https://ghcr.io/v2/homebrew/core/gradle/manifests/7.5.1_1
<span class="c">######################################################################## 100.0%</span>
<span class="o">==&gt;</span> Downloading https://ghcr.io/v2/homebrew/core/gradle/blobs/sha256:b8a590221ce177514ddff10c925b892ee856b9a23cc28dc623124b
<span class="o">==&gt;</span> Downloading from https://pkg-containers.githubusercontent.com/ghcr1/blobs/sha256:b8a590221ce177514ddff10c925b892ee856b9
<span class="c">######################################################################## 100.0%</span>
<span class="o">==&gt;</span> Installing dependencies <span class="k">for </span>gradle: openjdk@17
<span class="o">==&gt;</span> Installing gradle dependency: openjdk@17
<span class="o">==&gt;</span> Pouring openjdk@17--17.0.5.arm64_monterey.bottle.tar.gz
ğŸº  /opt/homebrew/Cellar/openjdk@17/17.0.5: 642 files, 307MB
<span class="o">==&gt;</span> Installing gradle
<span class="o">==&gt;</span> Pouring gradle--7.5.1_1.all.bottle.tar.gz
ğŸº  /opt/homebrew/Cellar/gradle/7.5.1_1: 11,340 files, 276.1MB
<span class="o">==&gt;</span> Running <span class="sb">`</span>brew cleanup gradle<span class="sb">`</span>...
Disable this behaviour by setting HOMEBREW_NO_INSTALL_CLEANUP.
Hide these hints with HOMEBREW_NO_ENV_HINTS <span class="o">(</span>see <span class="sb">`</span>man brew<span class="sb">`</span><span class="o">)</span><span class="nb">.</span>
<span class="o">==&gt;</span> <span class="sb">`</span>brew cleanup<span class="sb">`</span> has not been run <span class="k">in </span>the last 30 days, running now...
</code></pre></div></div>

<p>ì´ë ‡ê²Œ ë‹¤ìš´ ë°›ê³  ë‚œë’¤ì— ë‹¤ì‹œ<br />
ë²„ì ¼ì„ ì²´í¬í•´ë³´ë©´ ì„¤ì¹˜ëœ ëª¨ìŠµì„ í™•ì¸í•´ ë³¼ ìˆ˜ ìˆë‹¤.</p>

<p><br /></p>

<p>ì´ì œ Gradleì´ ì„¤ì¹˜ë˜ì—ˆìœ¼ë‹ˆ<br />
ìš°ë¦¬ê°€ ë§Œë“  ì• í”Œë¦¬ì¼€ì´ì…˜ í´ë”ì— ë“¤ì–´ê°€ì„œ<br />
ì•„ë˜ì™€ ê°™ì´ ë¹Œë“œ ëª…ë ¹ì–´ë¥¼ ì…ë ¥í•´ ì£¼ë©´ ë¹Œë“œê°€ ë˜ì–´ì§„ë‹¤.</p>
<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./gradlew build
</code></pre></div></div>

<p><strong>zsh: permission denied: ./gradlew</strong><br />
ë§Œì•½ ëª…ë ¹ì–´ ì…ë ¥ì‹œ ìœ„ì—ì²˜ëŸ¼ ê¶Œí•œ ë¬¸ì œê°€ ë°œìƒí•œë‹¤ë©´</p>

<p>gradlewì˜ ê¶Œí•œì„ 644 -&gt; 755ë¡œ ë³€ê²½í•´ì£¼ì–´ì•¼í•œë‹¤.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ll
</code></pre></div></div>
<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">-rwxr-xr-x</span>   1 ljh  staff   7.9K 11 15 10:44 gradlew
</code></pre></div></div>
<p>í˜„ì¬ ê²½ë¡œì—ì„œë¥¼ llì„ ì…ë ¥í•˜ì—¬ ê¶Œí•œ ìƒíƒœë¥¼ í™•ì¸í•  ìˆ˜ ìˆë‹¤.<br />
ls -l ì„ ì…ë ¥í•˜ì—¬ë„ í™•ì¸ì´ ê°€ëŠ¥í•˜ë‹¤</p>

<p>rwx : 7<br />
r-x : 5<br />
r-x : 5<br />
ì™€ ê°™ì´ ê¶Œí•œì„ ë³€ê²½í•´ì£¼ì–´ì•¼ í•˜ë©°</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">chmod </span>755 gradlew
</code></pre></div></div>
<p>ê¶Œí•œ ë³€ê²½ ëª…ë ¹ì–´ì¸ chmodë¡œ ê¶Œí•œì„ ë³€ê²½í•´ì£¼ë©´</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./gradlew build
</code></pre></div></div>
<p>ëª…ë ¹ì–´ê°€ ì •ìƒì ìœ¼ë¡œ ë¹Œë“œë˜ì–´ì§€ëŠ” ëª¨ìŠµì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.</p>

<p>ë¹Œë“œê°€ ë˜ì–´ì§€ë©´ ìœ„ì— IDEë¥¼ í†µí•´ ë¹Œë“œí–ˆë˜ ê²ƒ ì²˜ëŸ¼<br />
build &gt; libs í´ë”ì— .jar íŒŒì¼ì´ ìƒê¸°ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.</p>

<p><br /></p>

<h3 id="ì‹¤í–‰">ì‹¤í–‰</h3>

<p><strong>í„°ë¯¸ë„ë¡œ Jar íŒŒì¼ ì‹¤í–‰ì‹œí‚¤ê¸°</strong></p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>java <span class="nt">-jar</span> section3-week3-template-build-0.0.1-SNAPSHOT.jar
</code></pre></div></div>
<p>ê¸°ë³¸ì ìœ¼ë¡œ .jaríŒŒì¼ì„ ì‹¤í–‰ì‹œí‚¤ë ¤ë©´<br />
java -jarì„ ì…ë ¥í›„ íŒŒì¼ì´ë¦„ì„ ë„£ì–´ì£¼ë©´<br />
ì• í”Œë¦¬ì¼€ì´ì…˜ì´ IDEì—ì„œ ì‹¤í–‰ë˜ëŠ” ê²ƒ ì²˜ëŸ¼ ì‹¤í–‰ë˜ëŠ” ëª¨ìŠµì„<br />
í„°ë¯¸ë„ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆë‹¤.</p>

<p><br /></p>

<p><strong>í”„ë¡œíŒŒì¼(Profile) ì ìš©</strong></p>

<p>í”„ë¡œíŒŒì¼ ì ìš©ì´ë€.<br />
ìš°ë¦¬ëŠ” ë¡œì»¬í™˜ê²½ì—ì„œ í…ŒìŠ¤íŠ¸í•˜ê¸°ìœ„í•´ H2 DataBaseë¥¼ ì£¼ë¡œ ì‚¬ìš©í•´ì™”ë‹¤.<br />
í•˜ì§€ë§Œ ì„œë²„ì— ë°°í¬í•˜ê±°ë‚˜ ì‹¤ì œ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì ìš©í•˜ëŠ” DataBaseëŠ”<br />
ë‹¤ë¥¸ DataBaseê°€ ì˜¬ ìˆ˜ ìˆë‹¤. ê·¸ë ‡ìê³  ê¸°ì¡´ì— ì„¤ì •í•œ H2 ê´€ë ¨<br />
ë°ì´í„°ë¥¼ ì„œë²„ì— ì˜¬ë¦´ë•Œ ì¼ì¼ì´ ì§€ì›Œì„œ í•˜ê¸°ì—ëŠ” ë¶ˆí¸í•¨ì´ ìˆì–´<br />
ë™ì‹œì— ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡ Springì—ì„œëŠ” í”„ë¡œíŒŒì¼(Profile)ì´ë¼ëŠ” ê¸°ëŠ¥ì„ ì œê³µí•´ì¤€ë‹¤.</p>

<p><img src="https://lh3.googleusercontent.com/u/0/drive-viewer/AFDK6gNVRhs0fF44pgVaBPKUdF2aVOB9HWNny4_gw6wyvlz5td8IXIw3uhTQZuQhQJkFevEKtgvFCnFhwKgV9SJsZdlar03AUA=w1920-h921" alt="image" class="align-left" style="max-width: 100%" /></p>

<p>ìš°ì„  .yml íŒŒì¼ì„ ë¶„ë¦¬í•´ì£¼ì–´ì•¼í•œë‹¤.</p>

<p>application.yml<br />
application-local.yml<br />
application-server.yml</p>

<p>ì´ë ‡ê²Œ ì„¸ê°œë¡œ ë¶„ë¦¬í•´ì£¼ì—ˆê³  ê¸°ì¡´ì— ë¹Œë“œì‹œ ì‚¬ìš©í•˜ëŠ” yml íŒŒì¼ì€<br />
application.yml íŒŒì¼ì´ë‹¤.   í•´ë‹¹ íŒŒì¼ì—ëŠ” ì•„ë¬´ëŸ° ì½”ë“œë„ ë„£ì§€ ì•Šì•˜ê³ </p>

<p>ìš°ë¦¬ëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì‹¤í–‰í•  ë•Œ ì„¤ì •ì— ë”°ë¼ local.yml, server.ymlë¡œ<br />
ë³€ê²½í•´ê°€ë©´ì„œ ì‚¬ìš©ì´ ê°€ëŠ¥í•˜ë‹¤.</p>

<p>local.yml -&gt; h2 ì •ë³´<br />
server.yml -&gt; mysql ì •ë³´<br />
ë‚˜ëŠ” ìœ„ì™€ ê°™ì´ ë“±ë¡í•´ë†“ê³  ì‚¬ìš©í•˜ì˜€ë‹¤.</p>

<p>mysqlì„ ì‚¬ìš©í•œë‹¤ê³  ê°€ì •í•˜ê³  ì„¤ì •ì„ ì§„í–‰í•´ë³´ì</p>

<p><strong>1). yml ì„¤ì • ë³€ê²½</strong></p>
<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">spring</span><span class="pi">:</span>
  <span class="na">profiles</span><span class="pi">:</span>
    <span class="na">active</span><span class="pi">:</span> <span class="s">server</span>
</code></pre></div></div>
<p>application.yml íŒŒì¼ì— ìœ„ì™€ ê°™ì´ ì„¤ì •í•´ì£¼ë©´ ëœë‹¤.</p>

<p><br /></p>

<p><strong>2). êµ¬ì„± í¸ì§‘</strong></p>

<p><img src="https://lh3.googleusercontent.com/u/0/drive-viewer/AJc5JmTrEQ-vD2xirlKWhVpEcb96S87oR1s3Wjb2F_-Xup3XvpXxN0yvNE4Mbe2s79htd5-npeN9wfiVaA8Fow_bGjK8Q1yE=w1920-h921" alt="image" class="align-left" style="max-width: 100%" /></p>

<p>IDEì˜ êµ¬ì„± í¸ì§‘ì—ì„œë„ ìˆ˜ì •í•  ìˆ˜ ìˆë‹¤.<br />
ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì„ íƒ í›„</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>--spring.profiles.active=server
</code></pre></div></div>

<p>ìœ„ì™€ ê°™ì´ ì…ë ¥í•´ì£¼ë©´ ëœë‹¤.</p>

<p><br /></p>

<p>ì„¤ì •ì„ ëëƒˆìœ¼ë©´ ì´ì œ .jar íŒŒì¼ì„ ì‹¤í–‰ì‹œí‚¤ë©´ ëœë‹¤.<br />
ê¸°ì¡´ê³¼ ë™ì¼í•˜ê²Œ ì‹¤í–‰ ì‹œí‚¤ëŠ”ë° ë’¤ì—<br />
â€“spring.profiles.active=server ë¥¼ ì¶”ê°€í•´ì£¼ê³  ì‹¤í–‰ì‹œí‚¤ë©´ëœë‹¤.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>java <span class="nt">-jar</span> section3-week3-homework-build-0.0.1-SNAPSHOT.jar <span class="nt">--spring</span>.profiles.active<span class="o">=</span>server
</code></pre></div></div>

<p><img src="https://lh3.googleusercontent.com/u/0/drive-viewer/AFDK6gPsLVoNTpjR8xJLJAwP4xyDmw8zjaz0XeAdt4QomyJV1uM0dEzTKpcIzikSqw5TAHr1AJt4hrgO47p_ZBfQ-nSK6-9L=w1920-h921" alt="image" class="align-left" style="max-width: 100%" /></p>

<p>ì‹¤í–‰ ì‹œí‚¬ ê²½ìš°</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>The following 1 profile is active: "server"
</code></pre></div></div>

<p>ìœ„ì™€ ê°™ì€ profile ë¬¸êµ¬ê°€ ë°œìƒí•œë‹¤ë©´<br />
ì •ìƒì ìœ¼ë¡œ ì—°ê²°ì´ ë˜ì–´ì¡Œë‹¤ëŠ”ê±¸ í™•ì¸í•  ìˆ˜ ìˆë‹¤.</p>

<p><br /></p>

<h3 id="ì˜¤ëŠ˜-ë§Œë‚œ-error">ì˜¤ëŠ˜ ë§Œë‚œ ERROR</h3>

<p>ì˜¤ëŠ˜ ë§Œë‚œ ì—ëŸ¬ì¤‘ dataSource ê´€ë ¨ ì—ëŸ¬ê°€ ë°œìƒí–ˆì—ˆë‹¤.</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Caused by: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'dataSource' defined in class path resource 
[org/springframework/boot/autoconfigure/jdbc/DataSourceConfiguration$Hikari.class]: Bean instantiation via factory method failed; nested exception 
is org.springframework.beans.BeanInstantiationException: Failed to instantiate [com.zaxxer.hikari.HikariDataSource]: Factory method 'dataSource' 
threw exception; nested exception is java.lang.IllegalStateException: Cannot load driver class: com.mysql.cj.jdbc.Driver
</code></pre></div></div>

<p>í•´ë‹¹ ë‚´ìš©ì€ ì˜ì¡´ë¼ì´ë¸ŒëŸ¬ë¦¬ê°€ ì œëŒ€ë¡œ ì¶”ê°€ë˜ì–´ìˆì§€ ì•Šì•„<br />
ì½ì–´ì˜¤ì§€ ëª»í•˜ëŠ” í˜„ìƒ ê°™ì•˜ê³ </p>

<p>mysql ê³¼ ì—°ë™í•˜ê¸° ë•Œë¬¸ì— msql ì˜ì¡´ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì¶”ê°€í•˜ì˜€ê³ </p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>// mysql ì˜ì¡´ë¼ì´ë¸ŒëŸ¬ë¦¬ ì¶”ê°€
runtimeOnly 'mysql:mysql-connector-java'
</code></pre></div></div>

<p>ì˜ì¡´ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì¶”ê°€í›„</p>

<p><img src="https://lh3.googleusercontent.com/u/0/drive-viewer/AFDK6gMae5HizPF6syR7eBuQLmncWHLBOE-0y7fGS6RiuafbOdpIvYrLsxbcRv0EYY1bWe3X9WHdhj0HgRifbnEzk-a7Q04Z=w1920-h921" alt="image" class="align-left" style="max-width: 100%" /></p>

<p>ìœ„ì™€ ê°™ì´ ë¼ì´ë¸ŒëŸ¬ë¦¬ íŒ¨í‚¤ì§€ê°€ ìƒê¸°ë©´<br />
í•´ë‹¹ ì˜¤ë¥˜ëŠ” í•´ê²°ì´ ê°€ëŠ¥í•  ê²ƒ ì´ë‹¤.</p>

<hr />

<p>ì˜¤ëŠ˜ì€ ì´ë ‡ê²Œ í„°ë¯¸ë„ë¡œ build í•˜ëŠ” ë²•ê³¼ execution í•˜ëŠ”<br />
ë°©ë²•ì„ ì•Œì•„ ë³´ì•˜ë‹¤. ì•„ë§ˆë„ ë‚˜ì¤‘ì— ì„œë²„ì— ì´ëŸ°ì‹ìœ¼ë¡œ<br />
ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì‹¤í–‰ ì‹œì¼œë†“ê³  ìš´ì˜í•˜ëŠ”ê²Œ ì•„ë‹ê¹Œ? ë¼ëŠ” ìƒê°ì„ í•´ë³¸ë‹¤.</p>

<p>ì˜¤ëŠ˜ ê³µë¶€ë„ ì—¬ê¸°ì„œ ë !!</p>

<p><br /></p>

<p><span style="color:#994C00"><strong>ì˜¤ëŠ˜ì˜ ì»¤í”¼ëŸ‰</strong></span>: â˜•ï¸ â˜•ï¸ â˜•ï¸<br />
<strong>ì˜¤ëŠ˜ì˜ ì ì‹¬</strong>: ê¹€ì¹˜ì°Œê°œ, ê¹€ë°¥</p>]]></content><author><name>LEE JAEHYEOK</name></author><category term="TIL" /><category term="TIL" /><category term="ë¶€íŠ¸ìº í”„" /><category term="ì½”ë“œìŠ¤í…Œì´ì¸ " /><summary type="html"><![CDATA[]]></summary></entry><entry><title type="html">TIL) API Documentation 2</title><link href="http://localhost:4000/til/2022/11/14/til.html" rel="alternate" type="text/html" title="TIL) API Documentation 2" /><published>2022-11-14T00:00:00+09:00</published><updated>2022-11-14T00:00:00+09:00</updated><id>http://localhost:4000/til/2022/11/14/til</id><content type="html" xml:base="http://localhost:4000/til/2022/11/14/til.html"><![CDATA[<p>í•œ ì£¼ê°€ ëë‚˜ê³  ìƒˆë¡œìš´ ì£¼ê°€ ì‹œì‘ë˜ì—ˆë‹¤.</p>

<p><img src="https://lh3.googleusercontent.com/u/0/drive-viewer/AFDK6gOXnXDoCRH7AtlOncucaI0nI7RqC9GMkm0ZG-VhgIXazy7m5tTSccABV_f-3G5RjFSfN1ojWWOJzPxeYeKp4Ycs2Ykj=w1920-h921" alt="image" class="align-left" style="max-width: 65%" /></p>

<p>Spring í•µì‹¬ ê¸°ìˆ ì„ ë°°ìš°ëŠ” ì„¹ì…˜ì´ ê±°ì˜ ë§‰ë°”ì§€ë¡œ ë‹¤ê°€ì™”ë‹¤.<br />
ë‚´ê°€ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ê¸°ìˆ ì€ ì •ë§ ì ì€ ê²ƒ ê°™ì€ë°</p>

<p>ë²Œì¨ ì–´ëŠë§ ì„¹ì…˜ ëì— ë‹¤ë‹¤ë¥´ë‹¤ë‹ˆâ€¦<br />
ì‹œê°„ì´ ì§„ì§œ ë¹ ë¥´ë‹¤ê³  ëŠë¼ëŠ” ë°˜ë©´, ì¢€ ë” ì—´ì‹¬íˆí•´ì„œ <br />
ì§€ì‹ì„ ì±„ì›Œ ë„£ì–´ì•¼ ë‚´ ëª©ì ì§€ê¹Œì§€ ë„ë‹¬í•  ìˆ˜ ìˆì„ ê²ƒ ê°™ë‹¤ëŠ” ìƒê°ì´ ë“ ë‹¤.</p>

<hr />

<p>ì˜¤ëŠ˜ì€ Spring Rest Docsë¥¼ í™œìš©í•´ë³´ëŠ” ì‹œê°„ì´ë‹¤.</p>

<p>ì €ë²ˆì£¼ì— ê°„ë‹¨í•˜ê²Œ ì‚¬ìš©ë°©ë²•ì„ ë°°ì› ê³ <br />
ì˜¤ëŠ˜ì€ Controllerì˜ ëª¨ë“  APIë¥¼ ë¬¸ì„œí™” ì‹œì¼œë³´ë ¤í•œë‹¤.</p>

<h2 id="api-ìë™-ë¬¸ì„œí™”-ì—°ìŠµ">API ìë™ ë¬¸ì„œí™” ì—°ìŠµ</h2>

<p>ì €ë²ˆì£¼ì—ëŠ” POSTì™€ PACTHì— ëŒ€í•œ<br />
ìë™ ë¬¸ì„œí™”ë¥¼ ì§„í–‰í–ˆë‹¤.</p>

<p>ì§€ê¸ˆ ë§Œë“¤ê³  ìˆëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œëŠ” GET, DELETE<br />
APIë§Œ ìë™í™” ì‹œì¼œì£¼ë©´ ë§ˆë¬´ë¦¬ê°€ ëœë‹¤.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">static</span> <span class="n">org</span><span class="o">.</span><span class="na">mockito</span><span class="o">.</span><span class="na">BDDMockito</span><span class="o">.</span><span class="na">given</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">org</span><span class="o">.</span><span class="na">mockito</span><span class="o">.</span><span class="na">Mockito</span><span class="o">.</span><span class="na">doNothing</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">org</span><span class="o">.</span><span class="na">springframework</span><span class="o">.</span><span class="na">restdocs</span><span class="o">.</span><span class="na">mockmvc</span><span class="o">.</span><span class="na">RestDocumentationRequestBuilders</span><span class="o">.*;</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">org</span><span class="o">.</span><span class="na">springframework</span><span class="o">.</span><span class="na">restdocs</span><span class="o">.</span><span class="na">request</span><span class="o">.</span><span class="na">RequestDocumentation</span><span class="o">.</span><span class="na">parameterWithName</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">org</span><span class="o">.</span><span class="na">springframework</span><span class="o">.</span><span class="na">test</span><span class="o">.</span><span class="na">web</span><span class="o">.</span><span class="na">servlet</span><span class="o">.</span><span class="na">result</span><span class="o">.</span><span class="na">MockMvcResultMatchers</span><span class="o">.</span><span class="na">jsonPath</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">org</span><span class="o">.</span><span class="na">springframework</span><span class="o">.</span><span class="na">test</span><span class="o">.</span><span class="na">web</span><span class="o">.</span><span class="na">servlet</span><span class="o">.</span><span class="na">result</span><span class="o">.</span><span class="na">MockMvcResultMatchers</span><span class="o">.</span><span class="na">status</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">static</span> <span class="n">org</span><span class="o">.</span><span class="na">springframework</span><span class="o">.</span><span class="na">restdocs</span><span class="o">.</span><span class="na">payload</span><span class="o">.</span><span class="na">PayloadDocumentation</span><span class="o">.*;</span> <span class="c1">//responseFields(); , fieldWithPath() ì‚¬ìš©</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">org</span><span class="o">.</span><span class="na">springframework</span><span class="o">.</span><span class="na">restdocs</span><span class="o">.</span><span class="na">mockmvc</span><span class="o">.</span><span class="na">MockMvcRestDocumentation</span><span class="o">.</span><span class="na">document</span><span class="o">;</span> <span class="c1">// document();</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">org</span><span class="o">.</span><span class="na">springframework</span><span class="o">.</span><span class="na">restdocs</span><span class="o">.</span><span class="na">request</span><span class="o">.</span><span class="na">RequestDocumentation</span><span class="o">.</span><span class="na">pathParameters</span><span class="o">;</span> <span class="c1">// pathParameters();</span>
</code></pre></div></div>
<p>ì‹œì‘ ì „ ìš°ë¦¬ê°€ ì‚¬ìš©í•˜ê¸° ìœ„í•œ ê¸°ìˆ ì— ëŒ€í•œ<br />
importë¥¼ ì§„í–‰í•´ì¤€ë‹¤.</p>

<p>ìœ ì˜ ê¹Šê²Œ ë³¼ ê²ƒì€ RestDocs êµ¬ì„±ì„ ìœ„í•œ APIë“¤ì´ë‹¤.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="nd">@AutoConfigureRestDocs</span>
<span class="nd">@WebMvcTest</span><span class="o">(</span><span class="nc">MemberController</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
<span class="nd">@MockBean</span><span class="o">(</span><span class="nc">JpaMetamodelMappingContext</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">DocumentationTest</span> <span class="o">{</span>
    <span class="nd">@Autowired</span>
    <span class="kd">private</span> <span class="nc">MockMvc</span> <span class="n">mockMvc</span><span class="o">;</span>

    <span class="nd">@MockBean</span>
    <span class="kd">private</span> <span class="nc">MemberService</span> <span class="n">memberService</span><span class="o">;</span>

    <span class="nd">@MockBean</span>
    <span class="kd">private</span> <span class="nc">MemberMapper</span> <span class="n">mapper</span><span class="o">;</span>

    <span class="nd">@Autowired</span>
    <span class="kd">private</span> <span class="nc">Gson</span> <span class="n">gson</span><span class="o">;</span>
    
    <span class="o">...</span>
    
<span class="o">}</span>
</code></pre></div></div>
<p>ê¸°ë³¸ì ì¸ ìœ„ì¡´ì„± ì£¼ì…ê³¼ Class ì• ë…¸í…Œì´ì…˜ì„ ì…‹íŒ… í•œ ë‹¤ìŒ<br />
Test ì½”ë“œë¥¼ ì‘ì„±í•´ API ìë™í™”í•˜ì—¬ ë§Œë“¤ì–´ ì¤„ ìˆ˜ ìˆë‹¤.</p>

<p>@Test ì½”ë“œ ì‘ì„± ì‹œ ìš°ë¦¬ê°€ ì´ì „ ë¶€í„° í•™ìŠµí•´ì™”ë˜<br />
Mockitoë¥¼ ì´ìš©í•´ Slice ê³„ì¸µë³„ í…ŒìŠ¤íŠ¸ë¥¼ ë§Œë“¤ì–´ ì¤„ ìˆ˜ê°€ ìˆë‹¤.</p>

<p>Controllerì˜ ê³„ì¸µ ë³„ í…ŒìŠ¤íŠ¸ë¥¼ ìœ„í•´<br />
Serviceì˜ì—­ê³¼ì˜ ì—°ê²°ëœ ë¶€ë¶„ì„ Mock ê°ì²´ë¥¼ ë°˜í™˜ì‹œì¼œ<br />
ì‹¤ì œ ë°ì´í„°ê°€ ë“¤ì–´ê°„ ê²ƒ ì²˜ëŸ¼ í…ŒìŠ¤íŠ¸í•˜ëŠ” ë°©ë²•ì´ë‹¤.</p>

<p>ë‚´ê°€ ì´ ë§Œë“¤ì–´ì•¼í•  APIëŠ” 3ê°œì´ê³ <br />
ë©¤ë²„ ì¡°íšŒ, ë©¤ë²„ ì „ì²´ì¡°íšŒ, ë©¤ë²„ ì‚­ì œ ì´ë ‡ê²Œ ëœë‹¤.</p>

<p><strong>1). GET</strong></p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Test</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">getMemberTest</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
    <span class="nc">MemberDto</span><span class="o">.</span><span class="na">response</span> <span class="n">response</span> <span class="o">=</span> <span class="nc">StubData</span><span class="o">.</span><span class="na">MockMember</span><span class="o">.</span><span class="na">getSingleResponseBody</span><span class="o">();</span>
    <span class="kt">long</span> <span class="n">memberid</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="na">getMemberId</span><span class="o">();</span>

    <span class="c1">// findMember(); Mock ì²˜ë¦¬í•˜ê¸° , ë°˜í™˜ í•„ìš”x (ìƒˆë¡œìš´ ê°ì²´)</span>
    <span class="n">given</span><span class="o">(</span><span class="n">memberService</span><span class="o">.</span><span class="na">findMember</span><span class="o">(</span><span class="nc">Mockito</span><span class="o">.</span><span class="na">anyLong</span><span class="o">())).</span><span class="na">willReturn</span><span class="o">(</span><span class="k">new</span> <span class="nc">Member</span><span class="o">());</span>

    <span class="c1">// memberToMemberResponse(); Mock ì²˜ë¦¬í•˜ê¸° , ë°˜ìˆ˜í•„ìˆ˜ íƒ€ì… = MemberDto.response</span>
    <span class="n">given</span><span class="o">(</span><span class="n">mapper</span><span class="o">.</span><span class="na">memberToMemberResponse</span><span class="o">(</span><span class="nc">Mockito</span><span class="o">.</span><span class="na">any</span><span class="o">())).</span><span class="na">willReturn</span><span class="o">(</span><span class="n">response</span><span class="o">);</span>

    <span class="nc">ResultActions</span> <span class="n">actions</span> <span class="o">=</span> <span class="n">mockMvc</span><span class="o">.</span><span class="na">perform</span><span class="o">(</span>
            <span class="n">get</span><span class="o">(</span><span class="s">"/v11/members/{member-id}"</span><span class="o">,</span> <span class="n">memberid</span><span class="o">)</span>
                    <span class="o">.</span><span class="na">accept</span><span class="o">(</span><span class="nc">MediaType</span><span class="o">.</span><span class="na">APPLICATION_JSON</span><span class="o">)</span>
    <span class="o">);</span>

    <span class="n">actions</span>
            <span class="o">.</span><span class="na">andExpect</span><span class="o">(</span><span class="n">status</span><span class="o">().</span><span class="na">isOk</span><span class="o">())</span>
            <span class="o">.</span><span class="na">andExpect</span><span class="o">(</span><span class="n">jsonPath</span><span class="o">(</span><span class="s">"$.data.memberId"</span><span class="o">).</span><span class="na">value</span><span class="o">(</span><span class="s">"1"</span><span class="o">))</span>
            <span class="o">.</span><span class="na">andExpect</span><span class="o">(</span><span class="n">jsonPath</span><span class="o">(</span><span class="s">"$.data.email"</span><span class="o">).</span><span class="na">value</span><span class="o">(</span><span class="s">"dhfif718@gmail.com"</span><span class="o">))</span>
            <span class="o">.</span><span class="na">andExpect</span><span class="o">(</span><span class="n">jsonPath</span><span class="o">(</span><span class="s">"$.data.name"</span><span class="o">).</span><span class="na">value</span><span class="o">(</span><span class="s">"ì´ì¬í˜"</span><span class="o">))</span>
            <span class="o">.</span><span class="na">andExpect</span><span class="o">(</span><span class="n">jsonPath</span><span class="o">(</span><span class="s">"$.data.phone"</span><span class="o">).</span><span class="na">value</span><span class="o">(</span><span class="s">"010-1234-5678"</span><span class="o">))</span>
            <span class="o">.</span><span class="na">andDo</span><span class="o">(</span><span class="n">document</span><span class="o">(</span><span class="s">"get-findMember"</span><span class="o">,</span>
                    <span class="n">getRequestPreProcessor</span><span class="o">(),</span>
                    <span class="n">getResponsePreProcessor</span><span class="o">(),</span>
                    <span class="n">pathParameters</span><span class="o">(</span>
                            <span class="n">parameterWithName</span><span class="o">(</span><span class="s">"member-id"</span><span class="o">).</span><span class="na">description</span><span class="o">(</span><span class="s">"íšŒì› ì‹ë³„ì"</span><span class="o">)</span>
                    <span class="o">),</span>
                    <span class="n">responseFields</span><span class="o">(</span>
                            <span class="nc">List</span><span class="o">.</span><span class="na">of</span><span class="o">(</span>
                                    <span class="n">fieldWithPath</span><span class="o">(</span><span class="s">"data"</span><span class="o">).</span><span class="na">type</span><span class="o">(</span><span class="nc">JsonFieldType</span><span class="o">.</span><span class="na">OBJECT</span><span class="o">).</span><span class="na">description</span><span class="o">(</span><span class="s">"ê²°ê³¼ ë°ì´í„°"</span><span class="o">),</span>
                                    <span class="n">fieldWithPath</span><span class="o">(</span><span class="s">"data.memberId"</span><span class="o">).</span><span class="na">type</span><span class="o">(</span><span class="nc">JsonFieldType</span><span class="o">.</span><span class="na">NUMBER</span><span class="o">).</span><span class="na">description</span><span class="o">(</span><span class="s">"íšŒì› ì‹ë³„ì"</span><span class="o">),</span>
                                    <span class="n">fieldWithPath</span><span class="o">(</span><span class="s">"data.email"</span><span class="o">).</span><span class="na">type</span><span class="o">(</span><span class="nc">JsonFieldType</span><span class="o">.</span><span class="na">STRING</span><span class="o">).</span><span class="na">description</span><span class="o">(</span><span class="s">"ì´ë©”ì¼"</span><span class="o">),</span>
                                    <span class="n">fieldWithPath</span><span class="o">(</span><span class="s">"data.name"</span><span class="o">).</span><span class="na">type</span><span class="o">(</span><span class="nc">JsonFieldType</span><span class="o">.</span><span class="na">STRING</span><span class="o">).</span><span class="na">description</span><span class="o">(</span><span class="s">"ì´ë¦„"</span><span class="o">),</span>
                                    <span class="n">fieldWithPath</span><span class="o">(</span><span class="s">"data.phone"</span><span class="o">).</span><span class="na">type</span><span class="o">(</span><span class="nc">JsonFieldType</span><span class="o">.</span><span class="na">STRING</span><span class="o">).</span><span class="na">description</span><span class="o">(</span><span class="s">"ì „í™” ë²ˆí˜¸"</span><span class="o">),</span>
                                    <span class="n">fieldWithPath</span><span class="o">(</span><span class="s">"data.memberStatus"</span><span class="o">).</span><span class="na">type</span><span class="o">(</span><span class="nc">JsonFieldType</span><span class="o">.</span><span class="na">STRING</span><span class="o">).</span><span class="na">description</span><span class="o">(</span><span class="s">"íšŒì› ìƒíƒœ: í™œë™ì¤‘/íœ´ë©´ìƒíƒœ/íƒˆí‡´ìƒíƒœ"</span><span class="o">),</span>
                                    <span class="n">fieldWithPath</span><span class="o">(</span><span class="s">"data.stamp"</span><span class="o">).</span><span class="na">type</span><span class="o">(</span><span class="nc">JsonFieldType</span><span class="o">.</span><span class="na">NUMBER</span><span class="o">).</span><span class="na">description</span><span class="o">(</span><span class="s">"ìŠ¤íƒ¬í”„ ê°¯ìˆ˜"</span><span class="o">)</span>
                            <span class="o">)</span>
                    <span class="o">)</span>
            <span class="o">));</span>
<span class="o">}</span>
</code></pre></div></div>
<p>í¬ê²Œ ë‹¬ë¼ì§„ì ì€ ì—†ë‹¤.<br />
andDoë¥¼ í†µí•´ ê²€ì¦ê³¼ ë™ì‹œì— API ìë™í™”ë¥¼ ìœ„í•œ<br />
ì—¬ëŸ¬ê°€ì§€ íŒŒë¼ë¯¸í„°ë“¤ì„ ë„˜ê²¨ì£¼ê³  ìˆë‹¤.</p>

<p>GET ìš”ì²­ì´ê¸°ë•Œë¬¸ì— requestFields();ì— ëŒ€í•œ<br />
ì‘ì„±ì€ ë”°ë¡œí•˜ì§€ ì•Šì•˜ë‹¤.</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"data"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"memberId"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
    </span><span class="nl">"email"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"dhfif718@gmail.com"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"name"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"ì´ì¬í˜"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"phone"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"010-1234-5678"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"memberStatus"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"í™œë™ì¤‘"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"stamp"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>
<p>ìµœì¢… ì ìœ¼ë¡œ responseFieldsì˜ Json í˜•íƒœëŠ” ìœ„ì™€ ê°™ì´ ì´ë£¨ì–´ì§„ë‹¤.<br />
í˜„ì¬ëŠ” dataë¼ëŠ” Objectì•ˆì— í•œì¢…ë¥˜ì˜ ë°ì´í„°ê°€ ë“¤ì–´ê°€ ìˆë‹¤.</p>

<p><br /></p>

<p>ë§Œì•½ ì „ì²´ì¡°íšŒë¥¼ ìœ„í•´<br />
dataì•ˆì— ë°°ì—´ë¡œ ë°ì´í„°ê°€ ì¡´ì¬í•œë‹¤ë©´ ì–´ë–»ê²Œ<br />
í‘œì‹œë¥¼ í•´ì£¼ì–´ì•¼í• ê¹Œ?</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">responseFields</span><span class="o">(</span>
        <span class="nc">List</span><span class="o">.</span><span class="na">of</span><span class="o">(</span>
                <span class="n">fieldWithPath</span><span class="o">(</span><span class="s">"data.[].memberId"</span><span class="o">).</span><span class="na">type</span><span class="o">(</span><span class="nc">JsonFieldType</span><span class="o">.</span><span class="na">NUMBER</span><span class="o">).</span><span class="na">description</span><span class="o">(</span><span class="s">"íšŒì› ì‹ë³„ì"</span><span class="o">),</span>
                <span class="n">fieldWithPath</span><span class="o">(</span><span class="s">"data.[].email"</span><span class="o">).</span><span class="na">type</span><span class="o">(</span><span class="nc">JsonFieldType</span><span class="o">.</span><span class="na">STRING</span><span class="o">).</span><span class="na">description</span><span class="o">(</span><span class="s">"ì´ë©”ì¼"</span><span class="o">),</span>
                <span class="n">fieldWithPath</span><span class="o">(</span><span class="s">"data.[].name"</span><span class="o">).</span><span class="na">type</span><span class="o">(</span><span class="nc">JsonFieldType</span><span class="o">.</span><span class="na">STRING</span><span class="o">).</span><span class="na">description</span><span class="o">(</span><span class="s">"ì´ë¦„"</span><span class="o">),</span>
                <span class="n">fieldWithPath</span><span class="o">(</span><span class="s">"data.[].phone"</span><span class="o">).</span><span class="na">type</span><span class="o">(</span><span class="nc">JsonFieldType</span><span class="o">.</span><span class="na">STRING</span><span class="o">).</span><span class="na">description</span><span class="o">(</span><span class="s">"ì „í™” ë²ˆí˜¸"</span><span class="o">),</span>
                <span class="n">fieldWithPath</span><span class="o">(</span><span class="s">"data.[].memberStatus"</span><span class="o">).</span><span class="na">type</span><span class="o">(</span><span class="nc">JsonFieldType</span><span class="o">.</span><span class="na">STRING</span><span class="o">).</span><span class="na">description</span><span class="o">(</span><span class="s">"íšŒì› ìƒíƒœ: í™œë™ì¤‘/íœ´ë©´ìƒíƒœ/íƒˆí‡´ìƒíƒœ"</span><span class="o">),</span>
                <span class="n">fieldWithPath</span><span class="o">(</span><span class="s">"data.[].stamp"</span><span class="o">).</span><span class="na">type</span><span class="o">(</span><span class="nc">JsonFieldType</span><span class="o">.</span><span class="na">NUMBER</span><span class="o">).</span><span class="na">description</span><span class="o">(</span><span class="s">"ìŠ¤íƒ¬í”„ ê°¯ìˆ˜"</span><span class="o">),</span>
        <span class="o">)</span>
<span class="o">)</span>
</code></pre></div></div>
<p>responseFieldsì˜ ìœ„ì™€ ê°™ì´ data.[].ì„ ì´ìš©í•´  <br />
ë°°ì—´ì— í•´ë‹¹í•˜ëŠ” ë‚´ìš©ì„ í‘œì‹œí•´ì¤„ ìˆ˜ ìˆë‹¤.</p>

<p>ë˜í•œ</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">responseFields</span><span class="o">(</span>
        <span class="nc">List</span><span class="o">.</span><span class="na">of</span><span class="o">(</span>
                <span class="n">fieldWithPath</span><span class="o">(</span><span class="s">"data"</span><span class="o">).</span><span class="na">type</span><span class="o">(</span><span class="nc">JsonFieldType</span><span class="o">.</span><span class="na">ARRAY</span><span class="o">).</span><span class="na">description</span><span class="o">(</span><span class="s">"ê²°ê³¼ ë°ì´í„°"</span><span class="o">).</span><span class="na">optional</span><span class="o">(),</span>
                <span class="n">fieldWithPath</span><span class="o">(</span><span class="s">"data[].memberId"</span><span class="o">).</span><span class="na">type</span><span class="o">(</span><span class="nc">JsonFieldType</span><span class="o">.</span><span class="na">NUMBER</span><span class="o">).</span><span class="na">description</span><span class="o">(</span><span class="s">"íšŒì› ì‹ë³„ì"</span><span class="o">),</span>
                <span class="n">fieldWithPath</span><span class="o">(</span><span class="s">"data[].email"</span><span class="o">).</span><span class="na">type</span><span class="o">(</span><span class="nc">JsonFieldType</span><span class="o">.</span><span class="na">STRING</span><span class="o">).</span><span class="na">description</span><span class="o">(</span><span class="s">"ì´ë©”ì¼"</span><span class="o">),</span>
                <span class="n">fieldWithPath</span><span class="o">(</span><span class="s">"data[].name"</span><span class="o">).</span><span class="na">type</span><span class="o">(</span><span class="nc">JsonFieldType</span><span class="o">.</span><span class="na">STRING</span><span class="o">).</span><span class="na">description</span><span class="o">(</span><span class="s">"ì´ë¦„"</span><span class="o">),</span>
                <span class="n">fieldWithPath</span><span class="o">(</span><span class="s">"data[].phone"</span><span class="o">).</span><span class="na">type</span><span class="o">(</span><span class="nc">JsonFieldType</span><span class="o">.</span><span class="na">STRING</span><span class="o">).</span><span class="na">description</span><span class="o">(</span><span class="s">"ì „í™” ë²ˆí˜¸"</span><span class="o">),</span>
                <span class="n">fieldWithPath</span><span class="o">(</span><span class="s">"data[].memberStatus"</span><span class="o">).</span><span class="na">type</span><span class="o">(</span><span class="nc">JsonFieldType</span><span class="o">.</span><span class="na">STRING</span><span class="o">).</span><span class="na">description</span><span class="o">(</span><span class="s">"íšŒì› ìƒíƒœ: í™œë™ì¤‘/íœ´ë©´ìƒíƒœ/íƒˆí‡´ìƒíƒœ"</span><span class="o">),</span>
                <span class="n">fieldWithPath</span><span class="o">(</span><span class="s">"data[].stamp"</span><span class="o">).</span><span class="na">type</span><span class="o">(</span><span class="nc">JsonFieldType</span><span class="o">.</span><span class="na">NUMBER</span><span class="o">).</span><span class="na">description</span><span class="o">(</span><span class="s">"ìŠ¤íƒ¬í”„ ê°¯ìˆ˜"</span><span class="o">),</span>
        <span class="o">)</span>
<span class="o">)</span>
</code></pre></div></div>
<p>ìœ„ì™€ ê°™ì´ë„ í‘œê¸°í•  ìˆ˜ ìˆë‹¤.</p>

<p>ì—¬ê¸°ì„œ í•œê°€ì§€ ì°¸ê³ í•´ì•¼í•  ì ì€
JsonFieldType.OBJECT = data : {}<br />
JsonFieldType.ARRAY = data : []  <br />
ê³¼ ê°™ì´ í‘œê¸°í•  ë•Œ ì‚¬ìš©í•œë‹¤ëŠ” ì ì´ë‹¤.</p>

<p>í•˜ë‚˜ì˜ ë©¤ë²„ë§Œ ì¡°íšŒí–ˆì„ë•Œ OBJECTë¥¼ ì‚¬ìš©í•œ ì´ìœ ì™€<br />
ì—¬ëŸ¬ ë©¤ë²„ë¥¼ ì¡°íšŒí–ˆì„ë•Œ ARRAYë¥¼ ì‚¬ìš©í•œ ì´ìœ ì´ë‹¤.</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"data"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"memberId"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
    </span><span class="nl">"email"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"dhfif718@gmail.com"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"name"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"ì´ì¬í˜"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"phone"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"010-1234-5678"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"memberStatus"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"í™œë™ì¤‘"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"stamp"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="w">
  </span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"memberId"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
    </span><span class="nl">"email"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"tmdghwlq@naver.com"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"name"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"ì—¼ìŠ¹í˜¸"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"phone"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"010-2000-4000"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"memberStatus"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"í™œë™ì¤‘"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"stamp"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="w">
  </span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"memberId"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w">
    </span><span class="nl">"email"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"dragonwon@nate.com"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"name"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"ì •ìš©ì›"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"phone"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"010-7777-4587"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"memberStatus"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"í™œë™ì¤‘"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"stamp"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="w">
  </span><span class="p">}</span><span class="w"> </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>ì‹¤ì œë¡œ buildí•˜ì—¬ ìƒì„±ëœ response-bodyë¥¼ í™•ì¸í•´ë³´ë©´<br />
ìš°ë¦¬ê°€ ìµœì¢…ì ìœ¼ë¡œ ë°˜í™˜í•œ ë°ì´í„°ì— ë”°ë¥¸ ë°°ì—´ì´<br />
ìœ„ì™€ ê°™ì´ ì˜í‘œì‹œë˜ëŠ” ëª¨ìŠµì„ í™•ì¸í•´ ë³¼ ìˆ˜ ìˆë‹¤.</p>

<p>ì´ë ‡ê²Œ ë³µì¡í•œ êµ¬ì¡°ì˜ Jsoní˜•íƒœì¼ì§€ë¼ë„<br />
ë°°ì—´ì— ëŒ€í•œ ìœ„ì¹˜ë§Œ ì˜ ì§€ì •í•´ì£¼ë©´ @Test ì»´íŒŒì¼ì‹œ ì •ìƒì ìœ¼ë¡œ<br />
ì‹¤í–‰ë˜ì–´ ìŠ¤ë‹ˆí•ì´ ì˜ ë§Œë“¤ì–´ ì§€ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.</p>

<p><br /></p>

<p><strong>2). DELETE</strong></p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Test</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">deleteMemberTest</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
    <span class="kt">long</span> <span class="n">memberId</span> <span class="o">=</span> <span class="mi">1L</span><span class="o">;</span>

    <span class="c1">// deleteMember(); Mock ì²˜ë¦¬í•˜ê¸°, ë°˜í™˜íƒ€ì… = void</span>
    <span class="n">doNothing</span><span class="o">().</span><span class="na">when</span><span class="o">(</span><span class="n">memberService</span><span class="o">).</span><span class="na">deleteMember</span><span class="o">(</span><span class="n">memberId</span><span class="o">);</span>

    <span class="nc">ResultActions</span> <span class="n">actions</span> <span class="o">=</span> <span class="n">mockMvc</span><span class="o">.</span><span class="na">perform</span><span class="o">(</span>
            <span class="n">delete</span><span class="o">(</span><span class="s">"/v11/members/{member-id}"</span><span class="o">,</span> <span class="n">memberId</span><span class="o">)</span>
                    <span class="o">.</span><span class="na">accept</span><span class="o">(</span><span class="nc">MediaType</span><span class="o">.</span><span class="na">APPLICATION_JSON</span><span class="o">)</span>
    <span class="o">);</span>

    <span class="n">actions</span>
            <span class="o">.</span><span class="na">andExpect</span><span class="o">(</span><span class="n">status</span><span class="o">().</span><span class="na">isNoContent</span><span class="o">())</span>
            <span class="o">.</span><span class="na">andDo</span><span class="o">(</span><span class="n">document</span><span class="o">(</span>
                    <span class="s">"delete-member"</span><span class="o">,</span>
                    <span class="n">getRequestPreProcessor</span><span class="o">(),</span>
                    <span class="n">getResponsePreProcessor</span><span class="o">(),</span>
                    <span class="n">pathParameters</span><span class="o">(</span>
                            <span class="n">parameterWithName</span><span class="o">(</span><span class="s">"member-id"</span><span class="o">).</span><span class="na">description</span><span class="o">(</span><span class="s">"íšŒì› ì‹ë³„ì"</span><span class="o">)</span>
                    <span class="o">)</span>
            <span class="o">));</span>
<span class="o">}</span>
</code></pre></div></div>
<p>DeleteëŠ” ì‚¬ì‹¤ ë”ìš±ë” ê°„ë‹¨í•˜ë‹¤.<br />
requestFieldsì™€ responseFieldsì˜ ë”°ë¡œ ë§Œë“¤ì–´ì¤„<br />
í•„ìš”ê°€ ì—†ê¸° ë•Œë¬¸ì— parameterì— ëŒ€í•œ API ë‚´ìš©ë§Œ ì ì–´ì£¼ë©´ëœë‹¤..</p>

<p>ì´ë ‡ê²Œ ì˜¤ëŠ˜ì€ GET,DELETEì— ëŒ€í•œ<br />
API ë¬¸ì„œ ìë™í™”ë¥¼ ì§„í–‰í–ˆë‹¤.</p>

<p><br /></p>

<h2 id="ì˜¤ëŠ˜-ë§ˆì£¼í•œ-error">ì˜¤ëŠ˜ ë§ˆì£¼í•œ ERROR</h2>

<p>1). ë¬¸ì œ í™•ì¸<br />
GET, DELETEì— ëŒ€í•œ í…ŒìŠ¤íŠ¸ì¼€ì´ìŠ¤ëŠ” í†µê³¼í•œ ìƒíƒœë¡œ<br />
gradle buildí•˜ëŠ” ê³¼ì • ì¤‘ ë¬¸ì œê°€ ë°œìƒí–ˆë‹¤.</p>

<p>ì²«ë²ˆì§¸ëŠ” ì•„ë˜ì™€ ê°™ì€ ì˜¤ë¥˜ ì½”ë“œê°€ ë°œìƒ</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">There</span> <span class="n">were</span> <span class="n">failing</span> <span class="n">tests</span><span class="o">.</span> <span class="nc">See</span> <span class="n">the</span> <span class="n">report</span> <span class="nl">at:</span> <span class="nl">file:</span><span class="c1">///Users/ljh/Desktop/myprogram/CodeStates/be-homework-api-documentation/build/reports/tests/test/index.html</span>
</code></pre></div></div>

<p>ë‘ë²ˆì§¸ëŠ” resourcesì˜ index.html íŒŒì¼ì´ ìƒê¸°ì§€ ì•Šì•˜ë‹¤.</p>

<p><img src="https://lh3.googleusercontent.com/u/0/drive-viewer/AFDK6gMjr35Sq1Q_a5w8FeW6-h0MrJhp27At6mtmeNDPdy7Vt_Ypfia_OLvp8OjFswdwaRI3nxa-Cvww99s3zBMEEy_jQBxi=w1920-h921" alt="image" class="align-left" style="max-width: 100%" /></p>

<p>ì²«ë²ˆì§¸ ë¬¸ì œë¡œ ì¸í•´ íŒŒì¼ ìƒì„±ì´ ë˜ì§€ ì•Šì€ ë“¯ í–ˆë‹¤.</p>

<p><br /></p>

<p>2). ë¬¸ì œ í•´ê²°<br />
ì²«ë²ˆì§¸ ì˜¤ë¥˜ ì½”ë“œë¥¼ ì²œì²œíˆ ë³´ë‹ˆ  í…ŒìŠ¤íŠ¸ë¥¼ ì‹¤íŒ¨í–ˆìœ¼ë‹ˆ<br />
í•´ë‹¹ê²½ë¡œì— ë“¤ì–´ê°€ì„œ ë³´ë¼ëŠ” ê²ƒ ê°™ì•˜ë‹¤.</p>

<p><img src="https://lh3.googleusercontent.com/u/0/drive-viewer/AFDK6gNEdF_s4q2MG1_Td-VloiVybdGvYGUqHewVUU_L9Rbbqq45xouzGpvldtATTmL0KjTJ9V_ds1JEsC8_UclbIK5tZVMOgg=w1920-h921" alt="image" class="align-left" style="max-width: 100%" /></p>

<p>í•´ë‹¹ ê²½ë¡œì— ë“¤ì–´ê°€ì„œ index.html íŒŒì¼ì„ ì—´ì–´ë³´ì•˜ë‹¤.</p>

<p><img src="https://lh3.googleusercontent.com/u/0/drive-viewer/AFDK6gMAh6qcJXhFrBUv5fVdmlay6LC7TIDSpP9naAOl97GCFV9bR5kjFhWtyExFHdc_m0yiA8zkbZYSHda_SyeuxH_TbW84=w1920-h921" alt="image" class="align-left" style="max-width: 100%" /></p>

<p>ì—´ì–´ë³´ì•˜ë”ë‹ˆ Test Summaryë¼ëŠ”<br />
í…ŒìŠ¤íŠ¸ ê²°ê³¼ì— ëŒ€í•œ ìš”ì•½ì„ ë‚˜íƒ€ë‚´ì£¼ëŠ” í™”ë©´ì´ ìˆì—ˆê³ </p>

<p>MemberControllerTest4ì˜ getMembersTest() ë©”ì„œë“œê°€<br />
í…ŒìŠ¤íŠ¸ë¥¼ í†µê³¼í•˜ì§€ ëª»í–ˆêµ¬ë‚˜ë¼ê³  ì•Œì•„ì°¨ë ¸ë‹¤.</p>

<p>í•´ë‹¹ ë¬¸ì œëŠ” ë‚´ê°€ GET, DELETEë¥¼ ì¶”ê°€í•˜ë©´ì„œ<br />
ê¸°ì¡´ì— ë‘” í…ŒìŠ¤íŠ¸ì½”ë“œì— ì˜í–¥ì´ ê°”ì—ˆê³ <br />
ì˜¤ë¥˜ë¥¼ ìˆ˜ì •í•˜ê³  ë‹¤ì‹œ gradle buildë¥¼ í•˜ë‹ˆ</p>

<p><img src="https://lh3.googleusercontent.com/u/0/drive-viewer/AFDK6gMIqLDdClsJaEodvMjJXyFMOE1Ats6JM6us5Nwq8nB--Jr620vXRnfWD_RaqptDSvECTD2WLT4H7bNj9_9dGzzC7tDn=w1920-h921" alt="image" class="align-left" style="max-width: 100%" /></p>

<p>index.hmtl íŒŒì¼ì´ ìƒì„±ëœ ëª¨ìŠµì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤ !!</p>

<hr />

<p>ì˜¤ëŠ˜ì€ API ìë™í™”ë¥¼ ìœ„í•œ<br />
Spring Rest Docsë¥¼ ì—°ìŠµí•´ë³´ëŠ” ì‹œê°„ì„ ê°€ì¡Œë‹¤.<br />
ì´ëŸ°ì‹ìœ¼ë¡œ í…ŒìŠ¤íŠ¸ì½”ë“œì™€ ì—°ê²°í•´<br />
API ë¬¸ì„œë¥¼ ë§Œë“¤ ìˆ˜ ìˆë‹¤ëŠ”ê²Œ ë„ˆë¬´ ì¢‹ì€ ê¸°ìˆ ì¸ ê²ƒ ê°™ë‹¤ëŠ” ìƒê°ì´ë“ ë‹¤.</p>

<p>ì‚¬ì‹¤ ì´ì „ê¹Œì§€ë§Œí•´ë„ ìˆ˜ë™ìœ¼ë¡œ ì‚¬ëŒì´ ë‹¤ì ì–´ì„œ ê´€ë¦¬í•˜ëŠ” ì¤„ ì•Œì•˜ëŠ”ë°<br />
ì´ë ‡ê²Œ ì¢‹ì€ ë°©ë²•ìœ¼ë¡œ ê´€ë¦¬ë¥¼ í•  ìˆ˜ ìˆë‹¤ëŠ” ì ì—ì„œ<br />
ì¢‹ì€ ê¸°ìˆ ì„ ë°°ìš´ ê²ƒ ê°™ì•„ ë¿Œë“¯í•œ ëŠë‚Œì´ ë“¤ì—ˆë‹¤.</p>

<p>ì˜¤ëŠ˜ ê³µë¶€ë„ ì—¬ê¸°ì„œ ë !!</p>

<p><br /></p>

<p><span style="color:#994C00"><strong>ì˜¤ëŠ˜ì˜ ì»¤í”¼ëŸ‰</strong></span>: â˜•ï¸ â˜•ï¸ â˜•ï¸<br />
<strong>ì˜¤ëŠ˜ì˜ ì ì‹¬</strong>: ì‚¼ê²¹ì‚´, ë¼ë©´, ë°¥</p>]]></content><author><name>LEE JAEHYEOK</name></author><category term="TIL" /><category term="TIL" /><category term="ë¶€íŠ¸ìº í”„" /><category term="ì½”ë“œìŠ¤í…Œì´ì¸ " /><summary type="html"><![CDATA[í•œ ì£¼ê°€ ëë‚˜ê³  ìƒˆë¡œìš´ ì£¼ê°€ ì‹œì‘ë˜ì—ˆë‹¤.]]></summary></entry><entry><title type="html">TIL) API Documentation 1</title><link href="http://localhost:4000/til/2022/11/11/til.html" rel="alternate" type="text/html" title="TIL) API Documentation 1" /><published>2022-11-11T00:00:00+09:00</published><updated>2022-11-11T00:00:00+09:00</updated><id>http://localhost:4000/til/2022/11/11/til</id><content type="html" xml:base="http://localhost:4000/til/2022/11/11/til.html"><![CDATA[<p>ìš”ë²ˆì£¼ë„ í•œì£¼ê°€ ì§€ë‚˜ê°„ë‹¤.<br />
ì–¼ë§ˆ ê³µë¶€í•œ ê²ƒ ê°™ì€ëŠë‚Œì´ ì•„ë‹Œë° ë²Œì¨<br />
ì›”ìš”ì¼ì´ì§€ë‚˜ ê¸ˆìš”ì¼ì´ ë˜ì—ˆë‹¤.</p>

<p><img src="https://lh3.googleusercontent.com/u/0/drive-viewer/AJc5JmQk4K8CSftTVVdvYx3CCxrYZD4T2BrAhtXL4imWit5EO503BT7GHs58m2U-u9Ff8-jqsP6WkToRyaKKm_g388y_S6IT=w3024-h1620" alt="image" class="align-left" style="max-width: 100%" /></p>

<p>ì €ë²ˆì£¼ì— ë³¸ ë¦¬ê·¸ì˜¤ë¸Œë ˆì „ë“œ ì›”ì¦ˆ ê²°ìŠ¹ì „ì„ ê°ëª…ê¹Šê²Œ ë³´ì•„ì„œ ê·¸ëŸ°ì§€  <br />
ë‚´ ë§ˆìŒ í•œì¼ ì— ë¶ˆì•ˆí•˜ê³  ì•ˆì •ì ì´ì§€ ëª»í•œ ì§€ê¸ˆì˜ ì‚¶ì—<br />
ë§ì´ ì§€ì³í•˜ê³  ìˆì—ˆëŠ”ë°, ë§ì€ ìœ„ë¡œê°€ ë˜ì—ˆë‹¤.</p>

<p>â€˜ì¤‘ìš”í•œê±´ êº½ì´ì§€ ì•ŠëŠ” ë§ˆìŒâ€™ ì°¸ ì˜ ë§Œë“  ë¬¸êµ¬ì¸ ê²ƒ ê°™ë‹¤.<br />
ë‚˜ë„ êº½ì´ì§€ ì•Šê³  ë‚˜ì•„ê°€ëŠ” ëª¨ìŠµì„ ë°œê²¬í•  ìˆ˜ìˆë„ë¡<br />
ë”ìš±ë” ë…¸ë ¥í•´ë³´ì•„ì•¼ê² ë‹¤.</p>

<hr />
<p>3ì¼ê°„ JUnitì— ëŒ€í•œ ê³µë¶€ë¥¼ í–ˆë‹¤. <br />
ì—¬ëŸ¬ APIë¥¼ ì‚¬ìš©í•´ë³´ë©´ì„œ ê³„ì¸µë³„ë¡œ ë‹¨ë…ìœ¼ë¡œ<br />
í…ŒìŠ¤íŠ¸í•  ìˆ˜ ìˆëŠ” Mockitoë¼ëŠ” ì¢‹ì€ APIë¥¼ ë°°ì› ë‹¤.</p>

<p>ì˜¤ëŠ˜ì€ ì´ê²ƒì— ì—°ì¥ì„ ìƒì¸ API ë¬¸ì„œí™”ì— ëŒ€í•´ ê³µë¶€í•´ë³´ëŠ” ë‚ ì´ë‹¤.</p>

<p><br /></p>

<h2 id="spring-rest-docs">Spring Rest Docs</h2>

<p>API ë¬¸ì„œí™”ë¼ê³ í•˜ë©´<br />
í´ë¼ì´ì–¸íŠ¸ì—ì„œ REST API ë°±ì—”ë“œ ì• í”Œë¦¬ì¼€ì´ì—<br />
ìš”ì²­ì„ ì „ì†¡í•˜ê¸° ìœ„í•´ì„œ ì•Œì•„ ë˜ëŠ” ìš”ì²­ ì •ë¥¼ ë¬¸ì„œë¡œ ì •ë¦¬í•œ ê²ƒì´ë‹¤.<br />
(URI, request body, query parameter ë“±..)</p>

<p>Spring Rest DocsëŠ” ì´ ë¬¸ì„œë¥¼ ìë™ìœ¼ë¡œ ë§Œë“¤ì–´ì£¼ëŠ” APIì´ë‹¤.<br />
ê¸°ì¡´ì—ëŠ” Swagger ì˜¤í”ˆ APIë¥¼ ë§ì´ ì´ìš©í•˜ì˜€ë‹¤ê³  í•œë‹¤.</p>

<p>Spring Rest Docs ë¬¸ì„œ ìƒì„± íë¦„<br />
í…ŒìŠ¤íŠ¸ ì½”ë“œ ì‘ì„±</p>
<ol>
  <li>test í…ŒìŠ¤í¬ ì‹¤í–‰</li>
  <li>í…ŒìŠ¤íŠ¸ ê²°ê³¼ Passed / Failed 1ë²ˆìœ¼ë¡œ ë³µê·€</li>
  <li>API ë¬¸ì„œ ìŠ¤ë‹ˆí« ìƒì„±(.adoc)</li>
  <li>API ë¬¸ì„œ ìƒì„±(.adoc)</li>
  <li>API ë¬¸ì„œ -&gt; HTMLë¡œ ë³€í™˜</li>
</ol>

<p>ìœ„ì™€ ê°™ì€ íë¦„ìœ¼ë¡œ API ë¬¸ì„œê°€ ìƒì„±ë˜ë©°<br />
í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ì— í†µê³¼í•œ í…ŒìŠ¤íŠ¸ì˜ API ë¬¸ì„œ <strong>ìŠ¤ë‹ˆí•</strong>ì´ ìƒì„±ëœë‹¤.<br />
*ìŠ¤ë‹ˆí•: ë¬¸ì„œì˜ ì¼ë¶€ ì¡°ê°ì´ë¼ ìƒê°í•˜ë©´ ëœë‹¤.</p>

<p>Spring Rest Docsë¥¼ ì‚¬ìš©í•˜ê¸° ìœ„í•´ ì‚¬ì „ ì‘ì—…ì„ í•˜ì—¬ì•¼í•œë‹¤.<br />
build.gradleì˜ ì„¤ì •í•´ì£¼ì</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">plugins</span> <span class="o">{</span>
	<span class="n">id</span> <span class="s">"org.asciidoctor.jvm.convert"</span> <span class="n">version</span> <span class="s">"3.3.2"</span>
        <span class="o">...</span>
<span class="o">}</span>

<span class="o">...</span>

<span class="n">ext</span> <span class="o">{</span>
	<span class="n">set</span><span class="o">(</span><span class="err">'</span><span class="n">snippetsDir</span><span class="err">'</span><span class="o">,</span> <span class="n">file</span><span class="o">(</span><span class="s">"build/generated-snippets"</span><span class="o">))</span>    <span class="c1">// ìŠ¤ë‹ˆí« ìƒì„± ê²½ë¡œ ì„¤ì •</span>
<span class="o">}</span>

<span class="n">configurations</span> <span class="o">{</span>
	<span class="n">asciidoctorExtensions</span> <span class="c1">// AsciiDoctor ì˜ì¡´ê·¸ë£¹ ì§€ì •            </span>
<span class="o">}</span>

<span class="n">dependencies</span> <span class="o">{</span>
    <span class="c1">// ì˜ì¡´ë¼ì´ë¸ŒëŸ¬ë¦¬ ì¶”ê°€ </span>
	<span class="n">testImplementation</span> <span class="err">'</span><span class="n">org</span><span class="o">.</span><span class="na">springframework</span><span class="o">.</span><span class="na">restdocs</span><span class="o">:</span><span class="n">spring</span><span class="o">-</span><span class="n">restdocs</span><span class="o">-</span><span class="n">mockmvc</span><span class="err">'</span>                         
	<span class="n">asciidoctorExtensions</span> <span class="err">'</span><span class="n">org</span><span class="o">.</span><span class="na">springframework</span><span class="o">.</span><span class="na">restdocs</span><span class="o">:</span><span class="n">spring</span><span class="o">-</span><span class="n">restdocs</span><span class="o">-</span><span class="n">asciidoctor</span><span class="err">'</span>
        <span class="o">...</span>
<span class="o">}</span>

<span class="c1">// test taskì‹¤í–‰ ì‹œ, API ë¬¸ì„œ ìƒì„± ìŠ¤ë‹ˆí• ê²½ë¡œë¥¼ ì„¤ì •</span>
<span class="n">tasks</span><span class="o">.</span><span class="na">named</span><span class="o">(</span><span class="err">'</span><span class="n">test</span><span class="err">'</span><span class="o">)</span> <span class="o">{</span>
	<span class="n">outputs</span><span class="o">.</span><span class="na">dir</span> <span class="n">snippetsDir</span>
	<span class="nf">useJUnitPlatform</span><span class="o">()</span>
<span class="o">}</span>

<span class="c1">// Asciidoctor ê¸°ëŠ¥ì„ ì‚¬ìš©í•˜ê¸° ìœ„í•œ ì„¤ì •</span>
<span class="n">tasks</span><span class="o">.</span><span class="na">named</span><span class="o">(</span><span class="err">'</span><span class="n">asciidoctor</span><span class="err">'</span><span class="o">)</span> <span class="o">{</span>
	<span class="n">configurations</span> <span class="s">"asciidoctorExtensions"</span>
	<span class="n">inputs</span><span class="o">.</span><span class="na">dir</span> <span class="n">snippetsDir</span>
	<span class="n">dependsOn</span> <span class="n">test</span>
<span class="o">}</span>

<span class="c1">// index.html copy</span>
<span class="n">task</span> <span class="nf">copyDocument</span><span class="o">(</span><span class="nl">type:</span> <span class="nc">Copy</span><span class="o">)</span> <span class="o">{</span>
	<span class="n">dependsOn</span> <span class="n">asciidoctor</span>         
	<span class="n">from</span> <span class="nf">file</span><span class="o">(</span><span class="s">"${asciidoctor.outputDir}"</span><span class="o">)</span>  
	<span class="n">into</span> <span class="nf">file</span><span class="o">(</span><span class="s">"src/main/resources/static/docs"</span><span class="o">)</span>  
<span class="o">}</span>

<span class="c1">// copyDocumentê°€ ë¨¼ì € ì‹¤í–‰ë˜ë„ë¡ ì„¤ì •</span>
<span class="n">build</span> <span class="o">{</span>
	<span class="n">dependsOn</span> <span class="n">copyDocument</span> 
<span class="o">}</span>

<span class="c1">// bootJar task ì„¤ì •</span>
<span class="n">bootJar</span> <span class="o">{</span>
	<span class="n">dependsOn</span> <span class="n">copyDocument</span>   
	<span class="nf">from</span> <span class="o">(</span><span class="s">"${asciidoctor.outputDir}"</span><span class="o">)</span> <span class="o">{</span> 
		<span class="n">into</span> <span class="err">'</span><span class="kd">static</span><span class="o">/</span><span class="n">docs</span><span class="err">'</span>    
	<span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>build.gradle ì„¤ì •ì´ ëë‚¬ë‹¤ë©´ ì´ì œ ì½”ë“œë¥¼ ì‘ì„±í•´ë³´ì</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@WebMvcTest</span><span class="o">(</span><span class="nc">MemberController</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
<span class="nd">@MockBean</span><span class="o">(</span><span class="nc">JpaMetamodelMappingContext</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
<span class="c1">//@Transactional</span>
<span class="c1">//@SpringBootTest</span>
<span class="c1">//@AutoConfigureMockMvc</span>
<span class="nd">@AutoConfigureRestDocs</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MemberControllerRestDocsTest</span> <span class="o">{</span>
    <span class="nd">@Autowired</span>
    <span class="kd">private</span> <span class="nc">MockMvc</span> <span class="n">mockMvc</span><span class="o">;</span>

    <span class="nd">@MockBean</span>
    <span class="kd">private</span> <span class="nc">MemberService</span> <span class="n">memberService</span><span class="o">;</span>

    <span class="nd">@MockBean</span>
    <span class="kd">private</span> <span class="nc">MemberMapper</span> <span class="n">mapper</span><span class="o">;</span>

    <span class="nd">@Autowired</span>
    <span class="kd">private</span> <span class="nc">Gson</span> <span class="n">gson</span><span class="o">;</span>

    <span class="nd">@Test</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">postMemberTest</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
        <span class="nc">MemberDto</span><span class="o">.</span><span class="na">Post</span> <span class="n">post</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">MemberDto</span><span class="o">.</span><span class="na">Post</span><span class="o">(</span><span class="s">"dhfif718@naver.com"</span><span class="o">,</span> <span class="s">"ì´ì¬í˜"</span><span class="o">,</span> <span class="s">"010-1234-5678"</span><span class="o">);</span>
        <span class="nc">String</span> <span class="n">content</span> <span class="o">=</span> <span class="n">gson</span><span class="o">.</span><span class="na">toJson</span><span class="o">(</span><span class="n">post</span><span class="o">);</span>

        <span class="nc">MemberDto</span><span class="o">.</span><span class="na">response</span> <span class="n">responseDto</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">MemberDto</span><span class="o">.</span><span class="na">response</span><span class="o">(</span>
                <span class="mi">1L</span><span class="o">,</span>
                <span class="s">"dhfif718@naver.com"</span><span class="o">,</span>
                <span class="s">"ì´ì¬í˜"</span><span class="o">,</span>
                <span class="s">"010-1234-5678"</span><span class="o">,</span>
                <span class="nc">Member</span><span class="o">.</span><span class="na">MemberStatus</span><span class="o">.</span><span class="na">MEMBER_ACTIVE</span><span class="o">,</span>
                <span class="k">new</span> <span class="nf">Stamp</span><span class="o">()</span>
        <span class="o">);</span>

        <span class="n">given</span><span class="o">(</span><span class="n">mapper</span><span class="o">.</span><span class="na">memberPostToMember</span><span class="o">(</span><span class="nc">Mockito</span><span class="o">.</span><span class="na">any</span><span class="o">(</span><span class="nc">MemberDto</span><span class="o">.</span><span class="na">Post</span><span class="o">.</span><span class="na">class</span><span class="o">))).</span><span class="na">willReturn</span><span class="o">(</span><span class="k">new</span> <span class="nc">Member</span><span class="o">());</span>
        <span class="n">given</span><span class="o">(</span><span class="n">memberService</span><span class="o">.</span><span class="na">createMember</span><span class="o">(</span><span class="nc">Mockito</span><span class="o">.</span><span class="na">any</span><span class="o">(</span><span class="nc">Member</span><span class="o">.</span><span class="na">class</span><span class="o">))).</span><span class="na">willReturn</span><span class="o">(</span><span class="k">new</span> <span class="nc">Member</span><span class="o">());</span>
        <span class="n">given</span><span class="o">(</span><span class="n">mapper</span><span class="o">.</span><span class="na">memberToMemberResponse</span><span class="o">(</span><span class="nc">Mockito</span><span class="o">.</span><span class="na">any</span><span class="o">(</span><span class="nc">Member</span><span class="o">.</span><span class="na">class</span><span class="o">))).</span><span class="na">willReturn</span><span class="o">(</span><span class="n">responseDto</span><span class="o">);</span>

        <span class="nc">ResultActions</span> <span class="n">actions</span> <span class="o">=</span> <span class="n">mockMvc</span><span class="o">.</span><span class="na">perform</span><span class="o">(</span>
                <span class="n">post</span><span class="o">(</span><span class="s">"/api/members"</span><span class="o">)</span>
                        <span class="o">.</span><span class="na">accept</span><span class="o">(</span><span class="nc">MediaType</span><span class="o">.</span><span class="na">APPLICATION_JSON</span><span class="o">)</span>
                        <span class="o">.</span><span class="na">contentType</span><span class="o">(</span><span class="nc">MediaType</span><span class="o">.</span><span class="na">APPLICATION_JSON</span><span class="o">)</span>
                        <span class="o">.</span><span class="na">content</span><span class="o">(</span><span class="n">content</span><span class="o">)</span>
        <span class="o">);</span>


        <span class="n">actions</span>
                <span class="o">.</span><span class="na">andExpect</span><span class="o">(</span><span class="n">status</span><span class="o">().</span><span class="na">isCreated</span><span class="o">())</span>
                <span class="o">.</span><span class="na">andExpect</span><span class="o">(</span><span class="n">jsonPath</span><span class="o">(</span><span class="s">"$.data.email"</span><span class="o">).</span><span class="na">value</span><span class="o">(</span><span class="n">post</span><span class="o">.</span><span class="na">getEmail</span><span class="o">()))</span>
                <span class="o">.</span><span class="na">andExpect</span><span class="o">(</span><span class="n">jsonPath</span><span class="o">(</span><span class="s">"$.data.name"</span><span class="o">).</span><span class="na">value</span><span class="o">(</span><span class="n">post</span><span class="o">.</span><span class="na">getName</span><span class="o">()))</span>
                <span class="o">.</span><span class="na">andExpect</span><span class="o">(</span><span class="n">jsonPath</span><span class="o">(</span><span class="s">"$.data.phone"</span><span class="o">).</span><span class="na">value</span><span class="o">(</span><span class="n">post</span><span class="o">.</span><span class="na">getPhone</span><span class="o">()))</span>

                <span class="o">.</span><span class="na">andDo</span><span class="o">(</span><span class="n">document</span><span class="o">(</span>
                        <span class="s">"post-member"</span><span class="o">,</span>
                        <span class="n">getRequestPreProcessor</span><span class="o">(),</span>
                        <span class="n">getResponsePreProcessor</span><span class="o">(),</span>
                        <span class="n">requestFields</span><span class="o">(</span>
                                <span class="nc">List</span><span class="o">.</span><span class="na">of</span><span class="o">(</span>
                                        <span class="n">fieldWithPath</span><span class="o">(</span><span class="s">"email"</span><span class="o">).</span><span class="na">type</span><span class="o">(</span><span class="nc">JsonFieldType</span><span class="o">.</span><span class="na">STRING</span><span class="o">).</span><span class="na">description</span><span class="o">(</span><span class="s">"ì´ë©”ì¼"</span><span class="o">),</span>
                                        <span class="n">fieldWithPath</span><span class="o">(</span><span class="s">"name"</span><span class="o">).</span><span class="na">type</span><span class="o">(</span><span class="nc">JsonFieldType</span><span class="o">.</span><span class="na">STRING</span><span class="o">).</span><span class="na">description</span><span class="o">(</span><span class="s">"ì´ë¦„"</span><span class="o">),</span>
                                        <span class="n">fieldWithPath</span><span class="o">(</span><span class="s">"phone"</span><span class="o">).</span><span class="na">type</span><span class="o">(</span><span class="nc">JsonFieldType</span><span class="o">.</span><span class="na">STRING</span><span class="o">).</span><span class="na">description</span><span class="o">(</span><span class="s">"íœ´ëŒ€í° ë²ˆí˜¸"</span><span class="o">)</span>
                                <span class="o">)</span>
                        <span class="o">),</span>
                        <span class="n">responseFields</span><span class="o">(</span>
                                <span class="nc">List</span><span class="o">.</span><span class="na">of</span><span class="o">(</span>
                                        <span class="n">fieldWithPath</span><span class="o">(</span><span class="s">"data"</span><span class="o">).</span><span class="na">type</span><span class="o">(</span><span class="nc">JsonFieldType</span><span class="o">.</span><span class="na">OBJECT</span><span class="o">).</span><span class="na">description</span><span class="o">(</span><span class="s">"ê²°ê³¼ ë°ì´í„°"</span><span class="o">),</span>
                                        <span class="n">fieldWithPath</span><span class="o">(</span><span class="s">"data.memberId"</span><span class="o">).</span><span class="na">type</span><span class="o">(</span><span class="nc">JsonFieldType</span><span class="o">.</span><span class="na">NUMBER</span><span class="o">).</span><span class="na">description</span><span class="o">(</span><span class="s">"íšŒì› ì‹ë³„ì"</span><span class="o">),</span>
                                        <span class="n">fieldWithPath</span><span class="o">(</span><span class="s">"data.email"</span><span class="o">).</span><span class="na">type</span><span class="o">(</span><span class="nc">JsonFieldType</span><span class="o">.</span><span class="na">STRING</span><span class="o">).</span><span class="na">description</span><span class="o">(</span><span class="s">"ì´ë©”ì¼"</span><span class="o">),</span>
                                        <span class="n">fieldWithPath</span><span class="o">(</span><span class="s">"data.name"</span><span class="o">).</span><span class="na">type</span><span class="o">(</span><span class="nc">JsonFieldType</span><span class="o">.</span><span class="na">STRING</span><span class="o">).</span><span class="na">description</span><span class="o">(</span><span class="s">"ì´ë¦„"</span><span class="o">),</span>
                                        <span class="n">fieldWithPath</span><span class="o">(</span><span class="s">"data.phone"</span><span class="o">).</span><span class="na">type</span><span class="o">(</span><span class="nc">JsonFieldType</span><span class="o">.</span><span class="na">STRING</span><span class="o">).</span><span class="na">description</span><span class="o">(</span><span class="s">"íœ´ëŒ€í° ë²ˆí˜¸"</span><span class="o">),</span>
                                        <span class="n">fieldWithPath</span><span class="o">(</span><span class="s">"data.memberStatus"</span><span class="o">).</span><span class="na">type</span><span class="o">(</span><span class="nc">JsonFieldType</span><span class="o">.</span><span class="na">STRING</span><span class="o">).</span><span class="na">description</span><span class="o">(</span><span class="s">"íšŒì› ìƒíƒœ"</span><span class="o">),</span>
                                        <span class="n">fieldWithPath</span><span class="o">(</span><span class="s">"data.stamp"</span><span class="o">).</span><span class="na">type</span><span class="o">(</span><span class="nc">JsonFieldType</span><span class="o">.</span><span class="na">NUMBER</span><span class="o">).</span><span class="na">description</span><span class="o">(</span><span class="s">"ìŠ¤íƒ¬í”„ ê°¯ìˆ˜"</span><span class="o">)</span>
                                <span class="o">)</span>
                        <span class="o">)</span>
                <span class="o">));</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>ê¸°ì¡´ ì½”ë“œì™€ ë‹¬ë¼ì§„ì ì€ 
@WebMvcTest(MemberController.class)          <br />
@MockBean(JpaMetamodelMappingContext.class)  <br />
ì–´ë…¸í…Œì´ì…˜ìœ¼ë¡œ ë³€ê²½í•˜ì˜€ë‹¤ëŠ” ì ì´ë‹¤.<br />
ì´ì „ì— SpringBootTestì™€ AutoConfigureMockMvcë¥¼ ì‚¬ìš©í–ˆë˜ ë¶€ë¶„ì„<br />
ë³€ê²½í•˜ì˜€ë‹¤. WebMveTestë¡œ ë³€ê²½ í•¨ìœ¼ë¡œì¨ Controller ê³„ì¸µì— ì‚¬ìš©í•˜ëŠ”<br />
Beanë§Œ ë“±ë¡í•˜ê¸°ë•Œë¬¸ì— ìƒëŒ€ì ìœ¼ë¡œ ì†ë„ê°€ ë¹ ë¥´ë‹¤ê³  í•œë‹¤.</p>

<p>ë˜í•œ, @AutoConfigureRestDocs ì–´ë…¸í…Œì´ì…˜ì„ ë¶™ì—¬ì£¼ì—ˆê³ <br />
.andDo(docment())ë¥¼ ì´ìš©í•´ Rest Docsì— í•„ìš”í•œ ì •ë³´ë¥¼ ë³´ë‚´ì£¼ì—ˆë‹¤.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">static</span> <span class="n">org</span><span class="o">.</span><span class="na">springframework</span><span class="o">.</span><span class="na">restdocs</span><span class="o">.</span><span class="na">payload</span><span class="o">.</span><span class="na">PayloadDocumentation</span><span class="o">.*;</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">org</span><span class="o">.</span><span class="na">springframework</span><span class="o">.</span><span class="na">restdocs</span><span class="o">.</span><span class="na">mockmvc</span><span class="o">.</span><span class="na">MockMvcRestDocumentation</span><span class="o">.</span><span class="na">document</span><span class="o">;</span>
</code></pre></div></div>
<p>document(), fieldWithPath(), requestFields() <br />
í•„ìš”í•œ ì •ë³´ë¥¼ ë§Œë“œëŠ” ê³¼ì •ì—ì„œ ìœ„ apië¥¼ ì‚¬ìš©í•˜ê¸°ìœ„í•´ì„ <br />
PayloadDocumentation, MockMvcRestDocumentationì„ import í•´ì£¼ì–´ì•¼í•œë‹¤.</p>

<p>ê·¸ë¦¬ê³  patch í•¸ë“¤ëŸ¬ ë©”ì„œë“œì— ëŒ€í•´ path parameterë¥¼ ì´ìš©í•  ê²½ìš°</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">static</span> <span class="n">org</span><span class="o">.</span><span class="na">springframework</span><span class="o">.</span><span class="na">restdocs</span><span class="o">.</span><span class="na">request</span><span class="o">.</span><span class="na">RequestDocumentation</span><span class="o">.</span><span class="na">pathParameters</span><span class="o">;</span>
</code></pre></div></div>
<p>ë¥¼ ìŠ¤íƒœí‹±ìœ¼ë¡œ import í•´ì£¼ë©´ ì‚¬ìš©ì´ ê°€ëŠ¥í•˜ë‹¤.</p>

<p><br /></p>

<p>Document()ì˜ ë§¤ê°œë³€ìˆ˜ë¡œ ì „ë‹¬í•˜ê¸°ìœ„í•´ <br />
OperationRequestPreprocessor<br />
OperationResponsePreprocessor<br />
í´ë˜ìŠ¤ë¥¼ ì´ìš©í•´ ì¸í„°í˜ì´ìŠ¤ì•ˆì— ì •ì  ë©”ì„œë“œë¥¼ ë§Œë“¤ì–´ êµ¬í˜„í•˜ì˜€ë‹¤.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">ApiDocumentUtils</span> <span class="o">{</span>
    <span class="kd">static</span> <span class="nc">OperationRequestPreprocessor</span> <span class="nf">getRequestPreProcessor</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="nf">preprocessRequest</span><span class="o">(</span><span class="n">prettyPrint</span><span class="o">());</span>
    <span class="o">}</span>

    <span class="kd">static</span> <span class="nc">OperationResponsePreprocessor</span> <span class="nf">getResponsePreProcessor</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="nf">preprocessResponse</span><span class="o">(</span><span class="n">prettyPrint</span><span class="o">());</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>
<p>getRequestPreProcessor() <br />
getResponsePreProcessor()<br />
ì•„ë¦¬ëŠ” ë©”ì„œë“œë¥¼ ë§Œë“¤ì—ˆê³  í•´ë‹¹ ë‚´ìš©ì—” OperationPreprocessor í´ë˜ìŠ¤ì˜<br />
ë©”ì„œë“œì¸ prettyPrint()ë¡œ ê°ì²´ë¥¼ ì£¼ì…í•´ì£¼ì—ˆë‹¤.</p>

<p>API ë¬¸ì„œë¥¼ ìƒì„± ì „ ì „ì²˜ë¦¬ë¥¼ ìˆ˜í–‰í•˜ëŠ” ê¸°ëŠ¥ì´ë¼ëŠ”ë°<br />
í•´ë‹¹ ë‚´ìš©ì— ëŒ€í•´ì„œëŠ” ì¡°ê¸ˆë” ê¹Šì€ í•™ìŠµì´ í•„ìš”í•´ ë³´ì¸ë‹¤.</p>

<p>ë˜í•œ Document() ë§¤ê°œë³€ìˆ˜ì¸<br />
requestFieldsì™€ responseFieldsë¥¼ List.ofë¡œ <br />
ë¬¸ì„œí™” ì‹œí‚¬ ë‚´ìš©ì„ ì„¤ëª…ê³¼ í•¨ê»˜ ë‹´ì•„ ì „ë‹¬í•˜ë„ë¡<br />
ë‚´ìš©ì„ ì‘ì„±í•˜ì˜€ë‹¤.</p>

<p><br /></p>

<p>ì—¬ê¸°ê¹Œì§€ ì‘ì„±í›„ í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ë¥¼ ì‹¤í–‰í•˜ë©´</p>

<p><img src="https://lh3.googleusercontent.com/u/0/drive-viewer/AJc5JmQkvJ4wiPE1h_7rk6WxVw-45PCgHTiM7tPBoXPQp9BI9-0QNhkyLJ9dvyFDgh1FIcoc9NAzwN1MqviHV234SBgKq-Fudw=w3024-h1620" alt="image" class="align-left" style="max-width: 100%" /></p>

<p>ìš°ë¦¬ê°€ build.graldeì—ì„œ extë¡œ ì„¤ì •í•´ë†“ì€ ê²½ë¡œ<br />
build/generated-snippets ì•ˆì— ìŠ¤ë‹ˆí• ì‹ë³„ìë¡œ<br />
post-memberë¡œ ì§€ì •í•´ì—¬ í•´ë‹¹ í´ë”ì•ˆì— .adoc íŒŒì¼ì´ ìƒê¸´ ëª¨ìŠµì„ ë³¼ ìˆ˜ ìˆë‹¤.</p>

<p>ì‹¤ì œ ë‚´ìš©ì„ í™•ì¸í•´ë³´ë©´ ìš°ë¦¬ê°€ ì›í•˜ëŠ”<br />
API ë‚´ìš©ë“¤ì´ ë‹´ê²¨ì ¸ìˆë‹¤.</p>

<p>ê·¸ë¦¬ê³  Gradle í”„ë¡œì íŠ¸ì˜ ê²½ìš°<br />
src/docs/asciidoc í´ë” ê²½ë¡œì—ì„œ index.adoc íŒŒì¼ì„ ìƒì„±í•œë‹¤.</p>

<p><img src="https://lh3.googleusercontent.com/u/0/drive-viewer/AJc5JmSP6yS5JEcQYvdmCiJBkQnCg6AjwPkGkEPL4LLA99PvGdapaJxSgq3S0yUGWaItGJc-VGK1hETfSnrBJQuxYueo82_6=w3024-h1620" alt="image" class="align-left" style="max-width: 100%" /></p>

<p>index.adocíŒŒì¼ì— Asciidoc ë¬¸ë²•ìœ¼ë¡œ<br />
í…œí”Œë¦¿ ì½”ë“œë¥¼ ë„£ì–´ Gradleì˜ :build, :bootJarì„  <br />
ì‹¤í–‰ì‹œì¼œì£¼ë©´ index.html</p>

<p>gradleì˜ ì„¤ì •í–ˆë˜ task copyDocumentì˜ ê²½ë¡œì¸<br />
src/main/resources/static/docs ì•ˆì— index.html íŒŒì¼ë¡œ  <br />
ìš°ë¦¬ì˜ APIë¬¸ì„œê°€ ë³€í™˜ëœ ëª¨ìŠµì„ ë³¼ ìˆ˜ ìˆë‹¤.</p>

<p>ê·¸ë¦¬ê³  ìµœì¢…ì ìœ¼ë¡œ Spring Bootë¥¼ ì‹¤í–‰ì‹œì¼œ<br />
index.htmlì— ì ‘ê·¼í•´ë³´ë©´</p>

<p><img src="https://lh3.googleusercontent.com/u/0/drive-viewer/AJc5JmRVSbop-au0zBS7T5VYwEbIIprDpuG7rQJQI3FpLPJncTS0N-xC6MLCi11JQdcFK3cWv2I50pjxUYkTgLFp5FArYVMaog=w3024-h1620" alt="image" class="align-left" style="max-width: 100%" /></p>

<p>ìš°ë¦¬ê°€ ì›í•˜ëŠ” ëª¨ìŠµëŒ€ë¡œ API ë¬¸ì„œê°€ ì‘ì„±ëœ ëª¨ìŠµì„ í™•ì¸í•´ ë³¼ ìˆ˜ ìˆë‹¤.<br />
(í•´ë‹¹ í…œí”Œë¦¿ ì½”ë“œëŠ” ì½”ë“œìŠ¤í…Œì´ì¸  êµìœ¡ìë£Œë¡œ ì œê³µëœ í…œí”Œë¦¿ì´ë¯€ë¡œ<br />
í…œí”Œë¦¿ ì½”ë“œëŠ” ë”°ë¡œ ì˜¬ë¦¬ì§€ ì•Šê² ìŠµë‹ˆë‹¤!)</p>

<hr />

<p>ì´ë ‡ê²Œ ì˜¤ëŠ˜ì€ ê°„ë‹¨í•œ ê²ƒ ê°™ìœ¼ë©´ì„œë„ ì–´ë ¤ìš´â€¦<br />
SpringRestDocsë¥¼ ì‚¬ìš©í•˜ëŠ” ë²•ì„ ì•Œì•„ë³´ì•˜ê³ </p>

<p>ì´ˆê¸° ì…‹íŒ…ë§Œ gradleì— ì˜ í•´ë†“ê³  í…œí”Œë¦¿ ì½”ë“œë§Œ ì¤€ë¹„ë˜ì–´ìˆë‹¤ë©´<br />
í¬ê²Œ ì–´ë ¤ìš´ì ì€ ì—†ì—ˆë˜ ê²ƒ ê°™ë‹¤.</p>

<p>ë§¤ìš° ìœ ìµí–ˆë˜ Testì¼€ì´ìŠ¤ë¥¼ ì´ìš©í•œ API ìë™í™” ì‘ì—….<br />
ì—„ì²­ ì‹ ê¸°í•˜ê³  ì¬ë°Œì—ˆë‹¤.</p>

<p>ì˜¤ëŠ˜ ê³µë¶€ëŠ” ì—¬ê¸°ì„œ ë !!</p>

<p><br /></p>

<p><span style="color:#994C00"><strong>ì˜¤ëŠ˜ì˜ ì»¤í”¼ëŸ‰</strong></span>: â˜•ï¸ â˜•ï¸<br />
<strong>ì˜¤ëŠ˜ì˜ ì ì‹¬</strong>: í•«ë„ê·¸, ë¹µ</p>]]></content><author><name>LEE JAEHYEOK</name></author><category term="TIL" /><category term="TIL" /><category term="ë¶€íŠ¸ìº í”„" /><category term="ì½”ë“œìŠ¤í…Œì´ì¸ " /><summary type="html"><![CDATA[ìš”ë²ˆì£¼ë„ í•œì£¼ê°€ ì§€ë‚˜ê°„ë‹¤. ì–¼ë§ˆ ê³µë¶€í•œ ê²ƒ ê°™ì€ëŠë‚Œì´ ì•„ë‹Œë° ë²Œì¨ ì›”ìš”ì¼ì´ì§€ë‚˜ ê¸ˆìš”ì¼ì´ ë˜ì—ˆë‹¤.]]></summary></entry><entry><title type="html">TIL) JUnit 3</title><link href="http://localhost:4000/til/2022/11/10/til.html" rel="alternate" type="text/html" title="TIL) JUnit 3" /><published>2022-11-10T00:00:00+09:00</published><updated>2022-11-10T00:00:00+09:00</updated><id>http://localhost:4000/til/2022/11/10/til</id><content type="html" xml:base="http://localhost:4000/til/2022/11/10/til.html"><![CDATA[<p><img src="https://lh3.googleusercontent.com/u/0/drive-viewer/AFDK6gPEtAIsYVHYZngjJKd7DhE7QvwO4nT5RQrbx3n7Hgtx83b5wSHcAK9fgNs42_a12-wjBXSB7EmmaORw8NUf4CEwXDJY2g=w1920-h921" alt="image" class="align-left" style="max-width: 100%" /></p>

<p>ë“œì´ì–´ JUnit ê´€ë ¨í•´ì„œ ë§ˆì§€ë§‰ ì‹œê°„ì´ë‹¤.<br />
í…ŒìŠ¤íŠ¸ í”„ë¡œê·¸ë¨ì„ ì‘ì„±í•˜ëŠ” ì—°ìŠµë„ í‹ˆí‹ˆíˆ í•´ë‘¬ì•¼<br />
ê¹Œë¨¹ì§€ ì•Šê³  ê³„ì¸µë³„ í…ŒìŠ¤íŠ¸ê°€ ì›í™œí•˜ê²Œ ì˜ ë  ê²ƒ ê°™ë‹¤.</p>

<p>ìƒˆë¡œìš´ê±¸ ì•Œë©´ì•Œìˆ˜ë¡ ì¬ë¯¸ìˆì§€ë§Œ<br />
ë‚´ ë‡Œìš©ëŸ‰ì˜ ì´ˆê³¼ë¡œ,,, ì „ì— ë°°ì› ë˜ ë‚´ìš©ë“¤ì´ ìŠ¬ìŠ¬<br />
íœ˜ë°œë˜ê¸° ì‹œì‘í•œë‹¤ ã…‹ã…‹â€¦</p>

<p>ë³µìŠµ í•˜ëŠ”ì‹œê°„ë„ ë§ˆë ¨í•´ì•¼ í•  ê²ƒ ê°™ì€ ëŠë‚Œì´ë‹¤</p>

<hr />

<p>ì–´ì œëŠ” <a href="https://mycatlikeschuru.github.io/til/2022/11/09/til.html">ê³„ì¸µë³„ í…ŒìŠ¤íŠ¸</a>ì— ëŒ€í•´ì„œ ê°„ë‹¨í•˜ê²Œ í¬ìŠ¤íŒ… í•´ë³´ì•˜ë‹¤.<br />
ì‚¬ì‹¤ ê³„ì¸µë³„ í…ŒìŠ¤íŠ¸ë¼ê³  ì‘ì„±ì„ í–ˆì§€ë§Œ<br />
ì§„ì •í•œ Slice í…ŒìŠ¤íŠ¸ê°€ ë˜ëŠ” í”„ë¡œê·¸ë¨ì´ ì•„ë‹ˆì˜€ê³ <br />
ê³„ì¸µë³„ í…ŒìŠ¤íŠ¸ë¥¼ ìœ„í•œ ë¬¸ë²•ì„ ì‚¬ì „ì— ê³µë¶€í•œëŠ ì‹œê°„ì´ì—ˆë‹¤.</p>

<p>ì˜¤ëŠ˜ì€ ì •ë§ ì• í”Œë¦¬ì¼€ì´ì…˜ ê³„ì¸µë³„ë¡œ í…ŒìŠ¤íŠ¸ë¥¼<br />
ì§„í–‰í•˜ë ¤ë©´ ì–´ë–»ê²Œí•´ì•¼í•˜ëŠ”ì§€?</p>

<p>í…ŒìŠ¤íŒ… ê¸°ìˆ ì— ëŒ€í•´ ë°°ì›Œë³´ëŠ” ì‹œê°„ì´ë‹¤.</p>

<h2 id="mockito">Mockito</h2>

<p>ì˜¤ëŠ˜ ê³µë¶€í•  apiëŠ” Mockitoë¼ëŠ” í…ŒìŠ¤íŠ¸ë¥¼ ìœ„í•œ apiì´ë‹¤.</p>

<p>ìš°ë¦¬ê°€ í‰ìƒì‹œì— Mockì´ë¼ê³ í•˜ë©´ ê°€ì§œë¥¼ ì–˜ê¸°í•œë‹¤.<br />
ëª©ì—…í°ê³¼ ê°™ì´ ì‹¤ì œ ê¸°ëŠ¥ì€ ì—†ì§€ëŠ” ëª¨ì–‘ë§ŒìˆëŠ” ê°€ì§œì´ë‹¤.</p>

<p>ì´ì™€ ê°™ì€ ê¸°ìˆ ë¡œ ê°ì²´ë¥¼ ê°€ì§œë¡œ ë§Œë“¤ì–´ ê³„ì¸µë³„ í…ŒìŠ¤íŠ¸í•˜ëŠ” ë°©ë²•ì´ë‹¤.</p>

<p>ë„ˆë¬´ë‚˜ê²Œ ë‹¹ì—°í•˜ê²Œë„ ë‹¤ë¥¸ ê³„ì¸µì„ ì ‘ê·¼í•˜ì§€ ì•Šìœ¼ë‹ˆ<br />
í…ŒìŠ¤íŠ¸ì‹œê°„ì´ í™•ì‹¤íˆ ë¹¨ë¼ì§€ê²Œë˜ë©°<br />
ê³„ì¸µë³„ë¡œ í…ŒìŠ¤íŠ¸ë¥¼ í•´ë³¼ ìˆ˜ ìˆë‹¤ëŠ” ì¥ì ì´ ìˆë‹¤.</p>

<h3 id="controller-ê³„ì¸µ-slice-test">Controller ê³„ì¸µ Slice Test</h3>

<p><img src="https://lh3.googleusercontent.com/u/0/drive-viewer/AJc5JmTnXpBWUcCganXkdulhuUs7yIiBV4jduubimbBhkIH1II-o-KZ6mUljknzsuWm-0Hf-czO1b7FkvAxK-aJEpMiHDGar9Q=w1920-h921" alt="image" class="align-left" style="max-width: 100%" /></p>

<p>ê°„ë‹¨í•˜ê²Œ Controller ê³„ì¸µë§Œ ë‘ê³  ì–˜ê¸°í•´ë³´ì<br />
ì–´ì œ <a href="https://mycatlikeschuru.github.io/til/2022/11/09/til.html">JUnit 2</a> ì±•í„°ì—ì„œ í…ŒìŠ¤íŠ¸í•´ë³´ì•˜ë˜ê±´<br />
ì™¼ìª½ì—ì„œ ë³´ëŠ” ê²ƒê³¼ ê°™ì€ í˜•íƒœì˜ â€˜í†µí•© í…ŒìŠ¤íŠ¸â€™ë¼ê³  ë³¼ ìˆ˜ ìˆë‹¤.</p>

<p>ì´ìœ ëŠ” í•¸ë“¤ëŸ¬ë©”ì„œë“œë¥¼ í˜¸ì¶œí•´ Service -&gt; Repository ê¹Œì§€<br />
ì ‘ê·¼í•´ Controller ê³„ì¸µì´ ì˜ ì‹¤í–‰ë˜ëŠ”ì§€ë¥¼ ì•Œì•„ë³´ì•˜ê¸° ë•Œë¬¸ì´ë‹¤.</p>

<p>ì´ì œ ìš°ë¦¬ê°€ í•´ë³¼ê±°ëŠ” Mock ê°ì²´ë¥¼ ë§Œë“¤ì–´<br />
Testë¥¼ í˜¸ì¶œí•˜ë©´ Controller ê³„ì¸µë§Œ ë…ë‹¨ì ìœ¼ë¡œ<br />
í…ŒìŠ¤íŠ¸í•  ìˆ˜ ìˆëŠ” ë°©ë²•ì´ë‹¤.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Transactional</span>
<span class="nd">@SpringBootTest</span>
<span class="nd">@AutoConfigureMockMvc</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MemberControllerHomeworkTest</span> <span class="o">{</span>
    <span class="nd">@Autowired</span>
    <span class="kd">private</span> <span class="nc">MockMvc</span> <span class="n">mockMvc</span><span class="o">;</span>

    <span class="nd">@Autowired</span>
    <span class="kd">private</span> <span class="nc">Gson</span> <span class="n">gson</span><span class="o">;</span>

    <span class="nd">@MockBean</span> <span class="c1">// ì¶”ê°€ë¶€ë¶„</span>
    <span class="kd">private</span> <span class="nc">MemberService</span> <span class="n">memberService</span><span class="o">;</span>

    <span class="nd">@Autowired</span> <span class="c1">// mppaer ì‚¬ìš©ì„ ìœ„í•œ ì¶”ê°€</span>
    <span class="kd">private</span> <span class="nc">MemberMapper</span> <span class="n">mapper</span><span class="o">;</span>

    <span class="nd">@Test</span>
    <span class="kt">void</span> <span class="nf">postMemberTest</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
        <span class="o">...</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>
<p>ì½”ë“œë¥¼ ì˜ˆì œë¡œ ì‚´í´ë³´ì</p>

<p>ì´ì „ê³¼ ë‹¬ë¼ì§„ì ì€ @MockBeanì´ ì¶”ê°€ë˜ì—ˆë‹¤ëŠ” ì ì´ë‹¤.<br />
SpringBootë¥¼ ì‚¬ìš©í•˜ëŠ” ì–´ë…¸í…Œì´ì…˜ì„ ë‹¬ì•„ì£¼ì—ˆê¸°ë•Œë¬¸ì—</p>

<p>@MockBeanì„ í•„ë“œë³€ìˆ˜ì— ë¶™ì—¬ì£¼ë©´<br />
í•´ë‹¹ ê°ì²´ì— Beanê³¼ ê°™ì€ íƒ€ì…ì˜ ê°ì²´ê°€ DIëœë‹¤.</p>

<p>ì¦‰ MemberService í´ë˜ìŠ¤ ê°ì²´ê°€ ì£¼ì…ë˜ë¯€ë¡œ<br />
ìš°ë¦¬ëŠ” ê°€ì§œë¡œ ë§Œë“¤ì–´ì§„ memberService ê°ì²´ë¡œ ë©”ì„œë“œë“¤ì„ í˜¸ì¶œí•  ìˆ˜ ìˆë‹¤.</p>

<p>@Test í”„ë¡œê·¸ë¨ì„ ì‘ì„±í•´ë³´ì</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Test</span>
<span class="kt">void</span> <span class="nf">postMemberTest</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
    <span class="nc">MemberDto</span><span class="o">.</span><span class="na">Post</span> <span class="n">post</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">MemberDto</span><span class="o">.</span><span class="na">Post</span><span class="o">(</span>
            <span class="s">"dhfif718@naver.com"</span><span class="o">,</span>
            <span class="s">"ì´ì¬í˜"</span><span class="o">,</span>
            <span class="s">"010-1234-5678"</span>
    <span class="o">);</span>

    <span class="nc">Member</span> <span class="n">member</span> <span class="o">=</span> <span class="n">mapper</span><span class="o">.</span><span class="na">memberPostToMember</span><span class="o">(</span><span class="n">post</span><span class="o">);</span>
    <span class="n">member</span><span class="o">.</span><span class="na">setStamp</span><span class="o">(</span><span class="k">new</span> <span class="nc">Stamp</span><span class="o">());</span>

    <span class="n">given</span><span class="o">(</span><span class="n">memberService</span><span class="o">.</span><span class="na">createMember</span><span class="o">(</span><span class="nc">Mockito</span><span class="o">.</span><span class="na">any</span><span class="o">(</span><span class="nc">Member</span><span class="o">.</span><span class="na">class</span><span class="o">))).</span><span class="na">willReturn</span><span class="o">(</span><span class="n">member</span><span class="o">);</span>

    <span class="nc">String</span> <span class="n">content</span> <span class="o">=</span> <span class="n">gson</span><span class="o">.</span><span class="na">toJson</span><span class="o">(</span><span class="n">post</span><span class="o">);</span>

    <span class="nc">ResultActions</span> <span class="n">actions</span> <span class="o">=</span> <span class="n">mockMvc</span><span class="o">.</span><span class="na">perform</span><span class="o">(</span>
            <span class="n">post</span><span class="o">(</span><span class="s">"/api/members"</span><span class="o">)</span>
                    <span class="o">.</span><span class="na">accept</span><span class="o">(</span><span class="nc">MediaType</span><span class="o">.</span><span class="na">APPLICATION_JSON</span><span class="o">)</span>
                    <span class="o">.</span><span class="na">contentType</span><span class="o">(</span><span class="nc">MediaType</span><span class="o">.</span><span class="na">APPLICATION_JSON</span><span class="o">)</span>
                    <span class="o">.</span><span class="na">content</span><span class="o">(</span><span class="n">content</span><span class="o">)</span>
    <span class="o">);</span>

    <span class="nc">MvcResult</span> <span class="n">result</span> <span class="o">=</span> <span class="n">actions</span>
            <span class="o">.</span><span class="na">andExpect</span><span class="o">(</span><span class="n">status</span><span class="o">().</span><span class="na">isCreated</span><span class="o">())</span>
            <span class="o">.</span><span class="na">andExpect</span><span class="o">(</span><span class="n">jsonPath</span><span class="o">(</span><span class="s">"$.data.email"</span><span class="o">).</span><span class="na">value</span><span class="o">(</span><span class="n">post</span><span class="o">.</span><span class="na">getEmail</span><span class="o">()))</span>
            <span class="o">.</span><span class="na">andExpect</span><span class="o">(</span><span class="n">jsonPath</span><span class="o">(</span><span class="s">"$.data.name"</span><span class="o">).</span><span class="na">value</span><span class="o">(</span><span class="n">post</span><span class="o">.</span><span class="na">getName</span><span class="o">()))</span>
            <span class="o">.</span><span class="na">andExpect</span><span class="o">(</span><span class="n">jsonPath</span><span class="o">(</span><span class="s">"$.data.phone"</span><span class="o">).</span><span class="na">value</span><span class="o">(</span><span class="n">post</span><span class="o">.</span><span class="na">getPhone</span><span class="o">()))</span>
            <span class="o">.</span><span class="na">andReturn</span><span class="o">();</span>
<span class="o">}</span>
</code></pre></div></div>
<p>ëŒ€ë¶€ë¶„ì€ ìë°” ë¬¸ë²•ì ì¸ ìš”ì†Œì´ê³ <br />
ì¤‘ìš”í•œ ë¶€ë¶„ì€ given(); api ìª½ì´ë‹¤.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">static</span> <span class="n">org</span><span class="o">.</span><span class="na">mockito</span><span class="o">.</span><span class="na">BDDMockito</span><span class="o">.</span><span class="na">given</span><span class="o">;</span>
</code></pre></div></div>
<p>í•´ë‹¹ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ import í•´ì•¼ ì‚¬ìš©ì´ ê°€ëŠ¥í•˜ê³ </p>

<p>given(); ë©”ì„œë“œë¥¼ í†µí•´ì„œ ìš°ë¦¬ëŠ” ê°€ì§œ ê°ì²´ë¥¼ ë§Œë“¤ ìˆ˜ ìˆë‹¤.</p>

<p>given() : ê°€ì§œë¡œ ë§Œë“¤ ë©”ì„œë“œ ì§€ì •<br />
willRetrun() : ê°€ì§œë¡œ ë§Œë“  ë°˜í™˜ ê°’ ì§€ì •<br />
ì´ë ‡ê²Œ ìƒê°í•˜ë©´ ê°„ë‹¨ í•  ê²ƒ ê°™ë‹¤.</p>

<p>ì—¬ê¸°ì„œ @MockBeanì„ í†µí•´ ì˜ì¡´ì„± ì£¼ì…ë°›ì€ ê°ì²´ì˜<br />
memberSerive.createMember()ë¥¼ given()ì•ˆì— ë„£ì–´ì£¼ì—ˆê³ <br />
í•´ë‹¹ .createMember()ì˜ ë§¤ê°œë³€ìˆ˜ê°€ Member.class íƒ€ì…ì´ë¯€ë¡œ<br />
Mockito.any(Member.class) ë¼ê³  ì„¤ì •ì„ í•´ë‘ì—ˆë‹¤.</p>

<p>ì—¬ê¸°ì„œ ë§Œì•½ ë‹¤ë¥¸ íƒ€ì…ì¼ ê²½ìš°ì—<br />
Mockito.anyInt()<br />
Mockito.anyLong()<br />
Mockito.anyString()<br />
ë“± ì—¬ëŸ¬ê°€ì§€ ë©”ì„œë“œë“¤ë„ ì œê³µí•˜ê³  ìˆë‹¤.</p>

<p><br /></p>

<p>í…ŒìŠ¤íŠ¸ ì½”ë“œë¥¼ ì´ë ‡ê²Œ ì‘ì„±í•˜ë©´<br />
ê°€ì§œê°ì²´ë¡œ ë¦¬í„´ê°’ì„ ìš°ë¦¬ê°€ ì •í•´ì„œ ë„˜ê²¨ì¤„ ìˆ˜ ìˆë‹¤.<br />
Controller ê³„ì¸µ í”„ë¡œê·¸ë¨ì„ ë´ë³´ì</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@PostMapping</span>
<span class="kd">public</span> <span class="nc">ResponseEntity</span> <span class="nf">postMember</span><span class="o">(</span><span class="nd">@Valid</span> <span class="nd">@RequestBody</span> <span class="nc">MemberDto</span><span class="o">.</span><span class="na">Post</span> <span class="n">requestBody</span><span class="o">)</span> <span class="o">{</span>
    <span class="nc">Member</span> <span class="n">member</span> <span class="o">=</span> <span class="n">mapper</span><span class="o">.</span><span class="na">memberPostToMember</span><span class="o">(</span><span class="n">requestBody</span><span class="o">);</span>
    <span class="n">member</span><span class="o">.</span><span class="na">setStamp</span><span class="o">(</span><span class="k">new</span> <span class="nc">Stamp</span><span class="o">());</span> <span class="c1">// homework solution ì¶”ê°€</span>

    <span class="nc">Member</span> <span class="n">createdMember</span> <span class="o">=</span> <span class="n">memberService</span><span class="o">.</span><span class="na">createMember</span><span class="o">(</span><span class="n">member</span><span class="o">);</span>

    <span class="k">return</span> <span class="k">new</span> <span class="nc">ResponseEntity</span><span class="o">&lt;&gt;(</span>
            <span class="k">new</span> <span class="nc">SingleResponseDto</span><span class="o">&lt;&gt;(</span><span class="n">mapper</span><span class="o">.</span><span class="na">memberToMemberResponse</span><span class="o">(</span><span class="n">createdMember</span><span class="o">)),</span>
            <span class="nc">HttpStatus</span><span class="o">.</span><span class="na">CREATED</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div></div>
<p>ìœ„ì—ì„œ ë³´ë“¯ì´ memberService.createMember(member);<br />
ë©”ì„œë“œë¥¼ í˜¸ì¶œí•˜ëŠ” ì‹œì ì—ì„œ ìš°ë¦¬ì˜ ê°€ì§œ ê°ì²´ì˜ ë°˜í™˜ê°’ì´<br />
ëŒ€ì‹  createdMember ê°ì²´ë¡œ í• ë‹¹ë˜ê²Œ ë˜ì–´ì§„ë‹¤.</p>

<p>ê·¸ë ‡ê²Œ ë˜ë©´ Service ê³„ì¸µì„ ì ‘ê·¼í•˜ì§€ì•Šê³ <br />
ìš°ë¦¬ê°€ ë§Œë“  Mockìœ¼ë¡œë§Œìœ¼ë¡œ Controllerë¥¼ í…ŒìŠ¤íŠ¸ í•´ ë³¼ ìˆ˜ ìˆëŠ” ê²ƒì´ë‹¤.</p>

<p><br /></p>

<h3 id="service-ê³„ì¸µ-slice-test">Service ê³„ì¸µ Slice Test</h3>

<p>Controller ê³„ì¸µì„ í…ŒìŠ¤íŠ¸í•  ë•Œì—ëŠ” SpringBootTestë¥¼ ì´ìš©í–ˆë‹¤.<br />
ìŠ¤í”„ë§ ë¶€íŠ¸ë¥¼ ì‹¤í–‰ì‹œí‚¤ëŠ” ì‹œê°„ë„ í¬í•¨í•˜ë©´<br />
ì‹œê°„ì´ ëŠë ¤ì§ˆ ìˆ˜ ìˆëŠ” ë‹¨ì ì´ ìˆì§€ë§Œ Controller ê³„ì¸µì€<br />
spring web servlet ê¸°ìˆ ì„ ì‚¬ìš©í•˜ê¸°ì— í¬í•¨ì‹œì¼°ì—ˆë‹¤.</p>

<p>í•˜ì§€ë§Œ Service ê³„ì¸µì€ SpringBoot ì—†ì´ë„<br />
Mockito APIë¥¼ ì´ìš©í•´ Serivce ê³„ì¸µë§Œ í…ŒìŠ¤íŠ¸ê°€ ê°€ëŠ¥í•˜ë‹¤.</p>

<p><img src="https://lh3.googleusercontent.com/u/0/drive-viewer/AJc5JmT11Owrzo9GJ8WW4G2Oo2z7sh78eNqCI7yo5XbMPJ_0mlZQKHtsqqku8nDD_99cQhCgmaZ-OBsms1m9QJdQuPEvf_ijUw=w3024-h1620" alt="image" class="align-left" style="max-width: 100%" /></p>

<p>ìœ„ì™€ ê°™ì´ í…ŒìŠ¤íŠ¸ê°€ ì´ë£¨ì–´ì§€ê³ <br />
Repository ê³„ì¸µê³¼ì˜ ì—°ê²°ë„ ëŠê³  Mock ê°ì²´ë¡œë§Œ<br />
í…ŒìŠ¤íŠ¸ë¥¼ í•  ìˆ˜ ìˆë‹¤ëŠ” ì ì´ ì¤‘ìš”í•˜ë‹¤.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@ExtendWith</span><span class="o">(</span><span class="nc">MockitoExtension</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MemberServiceMockTest</span> <span class="o">{</span>

    <span class="nd">@Mock</span>
    <span class="kd">private</span> <span class="nc">MemberRepository</span> <span class="n">memberRepository</span><span class="o">;</span>


    <span class="nd">@InjectMocks</span>
    <span class="kd">private</span> <span class="nc">MemberService</span> <span class="n">memberService</span><span class="o">;</span>

    <span class="nd">@Test</span>
    <span class="kt">void</span> <span class="nf">createMemberTest</span><span class="o">()</span>  <span class="o">{</span>
        <span class="o">...</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>
<p>Controllerê³¼ëŠ” ë‹¤ë¥´ê²Œ @ExtendWith ì–´ë…¸í…Œì´ì…˜ì„ ì´ìš©í•´<br />
Mockito APIë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.</p>

<p>ì—¬ê¸°ì„œ ìš°ë¦¬ê°€ í…ŒìŠ¤íŠ¸í•  ê³„ì¸µì€ memberService ê³„ì¸µì´ê³ <br />
ê°€ì§œë¡œ ë§Œë“¤ì–´ì•¼í•  ê°ì²´ëŠ” memberRepositoryì´ë‹¤</p>

<p>ê·¸ëŸ° ê°œë…ì—ì„œ @Mockì„ memberRepositoryì— ë¶™ì´ê³  <br />
@InjectMocksë¥¼ memberServiceì— ë¶™ì—¬ì£¼ë©´</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Transactional</span>
<span class="nd">@Service</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MemberService</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="nc">MemberRepository</span> <span class="n">memberRepository</span><span class="o">;</span>
    <span class="kd">public</span> <span class="nf">MemberService</span><span class="o">(</span><span class="nc">MemberRepository</span> <span class="n">memberRepository</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">memberRepository</span> <span class="o">=</span> <span class="n">memberRepository</span><span class="o">;</span>
    <span class="o">}</span>
    
    <span class="o">...</span>
</code></pre></div></div>
<p>Service ê³„ì¸µì˜ Repositoryì— Mockê°ì²´ê°€<br />
ìë™ìœ¼ë¡œ ì˜ì¡´ì„± ì£¼ì…ì´ëœë‹¤.</p>

<p>ê·¸ë¦¬í•˜ì—¬ ìš°ë¦¬ê°€ Repositoryë¥¼ Mock ê°ì²´ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ê²ƒì´ë‹¤.</p>

<p><br /></p>

<p>ì´ì œ í…ŒìŠ¤íŠ¸ ì˜ˆì œì½”ë“œë¥¼ ë´ë³´ì</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Test</span>
<span class="kt">void</span> <span class="nf">createMemberTest</span><span class="o">()</span>  <span class="o">{</span>
        <span class="nc">Member</span> <span class="n">member</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Member</span><span class="o">(</span><span class="s">"dhfif718@naver.com"</span><span class="o">,</span><span class="s">"ì´ì¬í˜"</span><span class="o">,</span><span class="s">"010-1234-5678"</span><span class="o">);</span>

        <span class="n">given</span><span class="o">(</span><span class="n">memberRepository</span><span class="o">.</span><span class="na">findByEmail</span><span class="o">(</span><span class="n">member</span><span class="o">.</span><span class="na">getEmail</span><span class="o">())).</span><span class="na">willReturn</span><span class="o">(</span><span class="nc">Optional</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="n">member</span><span class="o">));</span>
        <span class="c1">//given(memberRepository.findByEmail(Mockito.anyString())).willReturn(Optional.of(member));</span>

        <span class="n">assertThrows</span><span class="o">(</span><span class="nc">BusinessLogicException</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="o">()</span> <span class="o">-&gt;</span> <span class="n">memberService</span><span class="o">.</span><span class="na">createMember</span><span class="o">(</span><span class="n">member</span><span class="o">));</span>
    <span class="o">}</span>
</code></pre></div></div>

<p>ê²€ì¦ì„ ì–´ë–»ê²Œí•˜ëŠ”ì§€ì— ë”°ë¼ ë‹¬ë¦¬ì§€ê² ì§€ë§Œ<br />
Member ê°ì²´ë¥¼ ìƒì„±í•˜ëŠ” serive í´ë˜ìŠ¤ ë©”ì„œë“œë¥¼ í…ŒìŠ¤íŠ¸í•˜ê¸°ìœ„í•´<br />
ìƒˆë¡œìš´ Member ê°ì²´ë¥¼ ë§Œë“¤ì–´ ê²€ì¦í•  ê²ƒì´ë‹¤.</p>

<p>given()ìœ¼ë¡œ Controller ê³„ì¸µì—ì„œ í–ˆë˜ê²ƒê³¼ ë™ì¼í•˜ê²Œ<br />
ê°€ì§œë¡œë§Œë“¤ ë©”ì„œë“œì˜ í˜•ì‹ê³¼ ë§¤ê°œíƒ€ì…ì„ ì…ë ¥í•´ì¤€ë‹¤ìŒ<br />
ë¦¬í„´ê°’ìœ¼ë¡œ ì–´ë–¤ ê°ì²´ë¥¼ ë°›ì„ì§€ ì •í•´ì£¼ë©´ëœë‹¤.</p>

<p>ìµœì¢…ì ìœ¼ë¡œ ë™ì¼í•œ Memberê°€ ë°œê²¬ë˜ì–´<br />
Exceptionì„ ì¡ì•„ ê²€ì¦í•˜ëŠ” í”„ë¡œê·¸ë¨ìœ¼ë¡œ ì‘ì„±í•˜ì˜€ë‹¤.</p>

<p>ìš°ë¦¬ê°€ ì˜ë¼ì¤˜ì•¼í•˜ëŠ”ë¶€ë¶„ì€ Repositroyì˜ findByEmail();ë¡œ ì •ì˜í•œ ë¶€ë¶„ì´ë‹¤.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="nc">Member</span> <span class="nf">createMember</span><span class="o">(</span><span class="nc">Member</span> <span class="n">member</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">verifyExistsEmail</span><span class="o">(</span><span class="n">member</span><span class="o">.</span><span class="na">getEmail</span><span class="o">());</span>
    <span class="nc">Member</span> <span class="n">savedMember</span> <span class="o">=</span> <span class="n">memberRepository</span><span class="o">.</span><span class="na">save</span><span class="o">(</span><span class="n">member</span><span class="o">);</span>

    <span class="k">return</span> <span class="n">savedMember</span><span class="o">;</span>
<span class="o">}</span>
<span class="kd">private</span> <span class="kt">void</span> <span class="nf">verifyExistsEmail</span><span class="o">(</span><span class="nc">String</span> <span class="n">email</span><span class="o">)</span> <span class="o">{</span>
    <span class="nc">Optional</span><span class="o">&lt;</span><span class="nc">Member</span><span class="o">&gt;</span> <span class="n">member</span> <span class="o">=</span> <span class="n">memberRepository</span><span class="o">.</span><span class="na">findByEmail</span><span class="o">(</span><span class="n">email</span><span class="o">);</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">member</span><span class="o">.</span><span class="na">isPresent</span><span class="o">())</span>
    <span class="k">throw</span> <span class="k">new</span> <span class="nf">BusinessLogicException</span><span class="o">(</span><span class="nc">ExceptionCode</span><span class="o">.</span><span class="na">MEMBER_EXISTS</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div></div>
<p>MemberService ë¡œì§ì€ ë„ˆë¬´ ê°„ë‹¨í•˜ê²Œ<br />
ê¸°ì¡´ memberì™€ emailì„ ë¹„êµí•´ ê°™ì€ emailì´ ì¡´ì¬í•˜ë©´<br />
throw Exceptionì„ í•˜ê²Œ ë˜ì–´ìˆë‹¤.</p>

<p>ìš°ë¦¬ëŠ” ìœ„ì—ì„œ ë©”ì„œë“œ í˜¸ì¶œí• ë•Œì˜ ë§¤ê°œë³€ìˆ˜ â€œdhfif718@naver.comâ€ê³¼<br />
ê²°ê³¼ë¡œ ë°˜í™˜ëœ ê°ì²´ì˜ email â€œdhfif718@naver.comâ€ ê²°ê³¼ì ìœ¼ë¡œ ê°™ê¸° ë•Œë¬¸ì—<br />
if(member.isPresent()) ì¡°ê±´ì— ì„±ë¦½ë˜<br />
Exceptionì„ ë˜ì§€ê²Œë˜ì–´ Serivce ë¡œì§ì„ ê²€ì¦í•´ë³¼ ìˆ˜ ìˆë‹¤.</p>

<p>ìì—°ìŠ¤ëŸ½ê²Œ ì˜ˆì™¸ê°€ ë˜ì ¸ì§€ë¯€ë¡œ í•´ë‹¹ Service ë¡œì§ì€ ì¢…ë£Œë˜ê³ <br />
.save()ê¹Œì§€ ê²€ì¦í•  í•„ìš”ê°€ ì—†ì–´ì§„ë‹¤.<br />
saveë¥¼ ê²€ì¦í•˜ëŠ” ê²ƒì€ ì‚¬ì‹¤ ë¹„ì§€ë‹ˆìŠ¤ë¡œì§ì„ ê²€ì¦í•˜ëŠ” ê²ƒë³´ë‹¨<br />
Repositoryë¥¼ ê²€ì¦í•˜ëŠ” ê²ƒì— ê°€ê¹ê¸° ë•Œë¬¸ì—<br />
Serivce ê³„ì¸µì—ì„œ ê²€ì¦í•˜ëŠ” ë¡œì§ì„ êµ³ì´ ì‘ì„±í•˜ì§€ ì•Šì•„ë„ ë  ê²ƒ ê°™ë‹¤.</p>

<p><br /></p>

<h3 id="ì˜¤ëŠ˜-ë§Œë‚œ-ì—ëŸ¬">ì˜¤ëŠ˜ ë§Œë‚œ ì—ëŸ¬</h3>

<p>ì´ë ‡ê²Œ ìœ„ì—ì„œ Controllerê³¼ Service ê³„ì¸µì„ ë¶„ë¦¬í•´ì„œ<br />
ë”°ë¡œ ë”°ë¡œ í…ŒìŠ¤íŠ¸í•  ìˆ˜ ìˆê²Œ í”„ë¡œê·¸ë¨ì„ ì‘ì„±í•˜ê³ <br />
ì •ìƒì ìœ¼ë¡œ ìˆ˜í–‰ë˜ëŠ” ëª¨ìŠµì„ ë³¼ ìˆ˜ ìˆì—ˆë‹¤.</p>

<p>Mockitoë¼ëŠ” APIë¥¼ ì²˜ìŒ ì‚¬ìš©í•˜ë‹¤ë³´ë‹ˆ<br />
ì—¬ëŸ¬ê°€ì§€ ì—ëŸ¬ë“¤ì„ ë§Œë‚¬ê³  ê·¸ì¤‘ì— ê¸°ì–µë‚¨ëŠ” ì—ëŸ¬ë¥¼ ì ì–´ë³¸ë‹¤.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Test</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">cancelOrderTest</span><span class="o">(){</span>
    <span class="nc">Order</span> <span class="n">order</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Order</span><span class="o">();</span>
    <span class="kt">long</span> <span class="n">orderId</span> <span class="o">=</span> <span class="mi">1L</span><span class="o">;</span>
    <span class="nc">Optional</span><span class="o">&lt;</span><span class="nc">Order</span><span class="o">&gt;</span> <span class="n">findOrder</span> <span class="o">=</span> <span class="nc">Optional</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="n">order</span><span class="o">);</span>
    <span class="n">given</span><span class="o">(</span><span class="n">orderRepository</span><span class="o">.</span><span class="na">findById</span><span class="o">(</span><span class="n">order</span><span class="o">.</span><span class="na">getOrderId</span><span class="o">())).</span><span class="na">willReturn</span><span class="o">(</span><span class="n">findOrder</span><span class="o">);</span>
    <span class="n">assertThrows</span><span class="o">(</span><span class="nc">BusinessLogicException</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="o">()</span> <span class="o">-&gt;</span> <span class="n">orderService</span><span class="o">.</span><span class="na">cancelOrder</span><span class="o">(</span><span class="n">orderId</span><span class="o">));</span>
<span class="o">}</span>
</code></pre></div></div>
<p>ìœ„ì™€ ê°™ì´ í…ŒìŠ¤íŠ¸ ì½”ë“œë¥¼ ì‘ì„±í›„ ì‹¤í–‰ì‹œì¼œ ë³´ì•˜ëŠ”ë°</p>

<p><img src="https://lh3.googleusercontent.com/u/0/drive-viewer/AJc5JmTitd8kl31KKTTaIB7nQrL7AvxwT54hIPaJEcnmdlC5BhBrezzcRcqyhYeyWzO1aK7O1OYjVG_yqk2EYkUVRD6lZHWCiw=w3024-h1620" alt="image" class="align-left" style="max-width: 100%" /></p>

<p>misusing.PotentialStubbingProblem ì´ë¼ëŠ” ì—ëŸ¬ë¥¼ ë§Œë‚¬ë‹¤.<br />
ì ì¬ì ì¸ Stubbing ë¬¸ì œë¼ë©´ì„œ ì˜ˆì™¸ê°€ ì¡í˜”ë‹¤.</p>

<p>ì½”ë“œë¥¼ ì—´ì‹¬íˆ ë³´ë‹¤ë³´ë‹ˆ..<br />
given()ì•ˆì˜ ë§¤ê°œë³€ìˆ˜ë¡œ order.getOrderId()ë¥¼ ë„£ì–´ì£¼ê³  ìˆì—ˆê³ <br />
cancelOrder();ë©”ì„œë“œ í˜¸ì¶œí•˜ëŠ” ë§¤ê°œë³€ìˆ˜ì—ëŠ” orderIdë¥¼ ë„£ì–´ì£¼ê³  ìˆì—ˆë‹¤.</p>

<p>ì—¬ê¸°ì„œ orderê°ì²´ê°€ ë§Œë“¤ì–´ì§ˆë•Œ Longíƒ€ì…ìœ¼ë¡œ nullë¡œ ë§Œë“¤ì–´ì¡Œê³ <br />
íƒ€ì…ì´ ì˜ëª»ë“¤ì–´ê°„ ìƒíƒœë¡œ í…ŒìŠ¤íŠ¸ ì½”ë“œë¥¼ ì‹¤í–‰í•˜ë‹ˆê¹Œ ìœ„ì™€ ê°™ì€ ì—ëŸ¬ê°€ ë°œìƒí–ˆë‹¤.</p>

<p>í•´ê²°ì€</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">given</span><span class="o">(</span><span class="n">orderRepository</span><span class="o">.</span><span class="na">findById</span><span class="o">(</span><span class="nc">Mockito</span><span class="o">.</span><span class="na">anyLong</span><span class="o">())).</span><span class="na">willReturn</span><span class="o">(</span><span class="n">findOrder</span><span class="o">);</span>
</code></pre></div></div>
<p>ìœ„ì™€ ê°™ì´ íƒ€ì…ì„ Mockito.anyLong()ì„ ë¶™ì—¬ì„œ í•´ê²°ì´ ê°€ëŠ¥í•˜ê³ <br />
order.serOrderId(orderId);ë¥¼ í†µí•´ì„œ ê°’ì„ ë„£ì–´ì£¼ì–´ë„<br />
ë¬¸ì œê°€ í•´ê²°ì´ ê°€ëŠ¥í•˜ë‹¤.</p>

<hr />

<p>ì˜¤ëŠ˜ ê³µë¶€ëŠ” ì—¬ê¸°ê¹Œì§€ í–ˆê³ <br />
JUnitê´€ë ¨í•´ì„œ Slice í…ŒìŠ¤íŠ¸ì— ëŒ€í•´ ìì„¸íˆ ë°°ìš¸ ìˆ˜ ìˆì–´ì„œ<br />
ë„ˆë¬´ ìœ ìµí•œ ì‹œê°„ì´ì˜€ë‹¤.</p>

<p>í•œê°€ì§€ ì•„ì‰¬ìš´ì ì€ ë§ì€ apiì¤‘ì—ì„œë„ í•œì •ì ì¸ ê²ƒë§Œ ì‚¬ìš©í•´ë³´ì•˜ê¸°ì—<br />
ì§€ì‹ì¸µì´ ì–•ì€ì ..?ì´ ì¡°ê¸ˆ ì•„ì‰¬ì› ê³ <br />
ì´í›„ì— í”„ë¡œì íŠ¸í•˜ê¸°ì „ì— í…ŒìŠ¤íŠ¸ ê´€ë ¨ ì—¬ëŸ¬ ë©”ì„œë“œë“¤ì„ ê³µë¶€í•œë‹¤ìŒ<br />
í…ŒìŠ¤íŠ¸ ì½”ë“œë¥¼ ì‘ì„±í•´ë´ì•¼ê² ë‹¤.</p>

<p>ì˜¤ëŠ˜ ê³µë¶€ëŠ” ì—¬ê¸°ì„œ ë !</p>

<p><br /></p>

<p><span style="color:#994C00"><strong>ì˜¤ëŠ˜ì˜ ì»¤í”¼ëŸ‰</strong></span>: â˜•ï¸ â˜•ï¸ â˜•ï¸<br />
<strong>ì˜¤ëŠ˜ì˜ ì ì‹¬</strong>: ì¹´ë ˆ, ë¼ë©´, ë°¥</p>]]></content><author><name>LEE JAEHYEOK</name></author><category term="TIL" /><category term="TIL" /><category term="ë¶€íŠ¸ìº í”„" /><category term="ì½”ë“œìŠ¤í…Œì´ì¸ " /><summary type="html"><![CDATA[]]></summary></entry></feed>