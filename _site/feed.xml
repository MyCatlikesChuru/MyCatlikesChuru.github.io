<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="4.3.0">Jekyll</generator><link href="http://localhost:4000/feed.xml" rel="self" type="application/atom+xml" /><link href="http://localhost:4000/" rel="alternate" type="text/html" /><updated>2022-11-15T18:04:47+09:00</updated><id>http://localhost:4000/feed.xml</id><title type="html">LeeJellan</title><subtitle>ì•ˆë…•í•˜ì„¸ìš”!ğŸ™‚ IT,ì—¬í–‰,ê¸°íƒ€ ë“± ê¸°ë¡ì„ ë‚¨ê¸°ê¸°ìœ„í•œ ë¸”ë¡œê·¸ ì…ë‹ˆë‹¤ !</subtitle><author><name>LEE JAEHYEOK</name></author><entry><title type="html">TIL) Application ë¹Œë“œ, ì‹¤í–‰</title><link href="http://localhost:4000/til/2022/11/15/til.html" rel="alternate" type="text/html" title="TIL) Application ë¹Œë“œ, ì‹¤í–‰" /><published>2022-11-15T00:00:00+09:00</published><updated>2022-11-15T00:00:00+09:00</updated><id>http://localhost:4000/til/2022/11/15/til</id><content type="html" xml:base="http://localhost:4000/til/2022/11/15/til.html"><![CDATA[<p><img src="https://lh3.googleusercontent.com/u/0/drive-viewer/AFDK6gNq0VcIEmAZMz_1paQl-4m8_fIqcR-XIxlvy4GrezxEOvY6tzpT_1uI3JJK_XNFFzX3gFipA7DgprUqDMmQVqM19rSf8Q=w1920-h921" alt="image" class="align-left" style="max-width: 100%" /></p>

<p>ì˜¤ëŠ˜ì€ ì„¹ì…˜ ë§ˆì§€ë§‰ë‚ ì´ë‹¤. <br />
ë²Œì¨ 3ë‹¬ì§¸ë¥¼ ë‹¬ë¦¬ê³  ìˆëŠ” ë¶€íŠ¸ìº í”„</p>

<p>í™•ì‹¤íˆ í˜¼ì ê³µë¶€í•˜ëŠ” ê²ƒë³´ë‹¤ ê°€ì´ë“œë¼ì¸ì´ ì œì‹œë˜ë‹ˆ<br />
ìŠ¤í…ë°”ì´ìŠ¤í…ìœ¼ë¡œ ì„±ì¥í•˜ëŠ” ëª¨ìŠµì´ ëˆˆì— ë³´ì´ë‹ˆ</p>

<p>ë§Œì¡±ìŠ¤ëŸ¬ìš´ ë‚˜ë‚ ì„ ë³´ë‚´ê³  ìˆë‹¤.<br />
ê·¸ëŸ¼ì—ë„ ì•„ì§ ìƒˆë°œì˜ í”¼ ì •ë„ë§Œ ê³µë¶€í–ˆê¸°ì—<br />
ì˜¤ëŠ˜ë„ ê³µë¶€ë¥¼ ì‹œì‘í•´ë³´ì</p>

<hr />

<p>ì˜¤ëŠ˜ì€ ì• í”Œë¦¬ì¼€ì´ì…˜ ë¹Œë“œí•˜ëŠ” ë²•ì„ ì•Œì•„ë³´ë ¤í•œë‹¤.<br />
ì‹¤ì œë¡œ ë‚˜ì¤‘ì— ì„œë²„ì— ë°°í¬ë¥¼ í•´ì•¼í•˜ê¸°ì— ..</p>

<h2 id="ì• í”Œë¦¬ì¼€ì´ì…˜-ë¹Œë“œì‹¤í–‰">ì• í”Œë¦¬ì¼€ì´ì…˜ ë¹Œë“œ/ì‹¤í–‰</h2>

<p>ìš°ë¦¬ëŠ” ì—¬íƒœê¹Œì§€ IntelliJ IDEì˜ ë„ì›€ì„ ë°›ì•„ì„œ<br />
ë¹Œë“œë¥¼ ì§„í–‰í–ˆì—ˆë‹¤.</p>

<p>IDEë¥¼ ì‚¬ìš©í•˜ì§€ì•Šê³  ë¡œì»¬ í™˜ê²½ì´ ì•„ë‹Œ ì„œë²„í™˜ê²½ì—ì„œ ì‹¤í–‰<br />
ê°€ëŠ¥í•˜ê²Œ í•˜ë ¤ë©´ Gradleì´ë‚˜ Mavenê°™ì€ ë¹Œë“œ íˆ´ì„ ì´ìš©í•´ì„œ Spring Boot<br />
ê¸°ë°˜ì˜ ì• í”Œë¦¬ì¼€ì´ì…˜ ì†ŒìŠ¤ ì½”ë“œë¥¼ ë¹Œë“œí•˜ëŠ” ê¸°ë³¸ì ì¸ ë°©ë²•ì„ ì•Œê³ ìˆì–´ì•¼í•œë‹¤.</p>

<p>ìš°ì„  IDEë¥¼ ì´ìš©í•´ ë¹Œë“œí•˜ëŠ” ë°©ë²•ì„ ì•Œì•„ë³´ì<br />
(ìš°ë¦¬ê°€ ë§Œë“  í”„ë¡œì íŠ¸ëŠ” Gradleì´ë‹¤)</p>

<p><br /></p>

<h3 id="ë¹Œë“œ">ë¹Œë“œ</h3>

<p><strong>1). IDEë¥¼ í†µí•œ build</strong></p>

<p><img src="https://lh3.googleusercontent.com/u/0/drive-viewer/AFDK6gNkvOHRKiADoB4F8uygjnopOf4yqKRcMFN3Y0F47e49WVx74nLU_L3f20JxUX0AQCXTBFVgFD6JOgB04D4H2SxJJebxAw=w1920-h921" alt="image" class="align-left" style="max-width: 100%" /></p>

<p>ë‚´ê°€ ë§Œë“  í”„ë¡œì íŠ¸ ì´ë¦„ -&gt; Taske -&gt; bootJar or build ë¥¼<br />
ë”ë¸” í´ë¦­í•´ì„œ ë¹Œë“œí•´ì¤„ ìˆ˜ ìˆë‹¤.</p>

<p><img src="https://lh3.googleusercontent.com/u/0/drive-viewer/AJc5JmSjKwMt-ckmZXkOIp-tqZfr2mCjaNKgrTC6qMK0HNni9P8v92vYxD8qYjRGYLi0wIHQy-4Tf-ysvMVxchljPxkJPytO=w1920-h921" alt="image" class="align-left" style="max-width: 100%" /></p>

<p>ë¹Œë“œê°€ ì™„ë£Œë˜ë©´ Jar íŒŒì¼ì´ ìƒê¸°ëŠ”ë°<br />
ì—¬ê¸°ì„œ plain.jar íŒŒì¼ì€ build taskë¥¼ ì‹¤í–‰í•˜ë©´ ìƒê¸°ëŠ” íŒŒì¼ì´ë‹¤.<br />
ìš°ë¦¬ëŠ” ì‹¤í–‰ ê°€ëŠ¥í•œ Jar íŒŒì¼ì¸ plainì´ ì•ˆë¶™ì€ íŒŒì¼ì„ ì‹¤í–‰ì‹œí‚¤ë©´ ëœë‹¤.</p>

<p><br /></p>

<p><strong>2). í„°ë¯¸ë„ë¡œ build</strong></p>

<p>ì²«ë²ˆì§¸ë¡œ Gradleì´ ì„¤ì¹˜ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸í•´ë³´ì</p>
<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>gradle <span class="nt">-v</span>
</code></pre></div></div>

<p>ë§Œì•½ì— ë²„ì ¼ì´ ì•ˆëœ¨ê³  zsh: command not found: gradle<br />
ì°¾ì„ ìˆ˜ ì—†ë‹¤ê³  í•œë‹¤ë©´, homebrewë¥¼ í†µí•´ gradleì„ ë‹¤ìš´ ë°›ëŠ”ë‹¤.</p>
<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>brew <span class="nb">install </span>gradle
</code></pre></div></div>
<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">==&gt;</span> Downloading https://ghcr.io/v2/homebrew/core/openjdk/17/manifests/17.0.5
<span class="c">######################################################################## 100.0%</span>
<span class="o">==&gt;</span> Downloading https://ghcr.io/v2/homebrew/core/openjdk/17/blobs/sha256:0e2244e35a350256474b6eb6e03d11af5c0270ab7ca4e6bc71
<span class="o">==&gt;</span> Downloading from https://pkg-containers.githubusercontent.com/ghcr1/blobs/sha256:0e2244e35a350256474b6eb6e03d11af5c0270
<span class="c">######################################################################## 100.0%</span>
<span class="o">==&gt;</span> Downloading https://ghcr.io/v2/homebrew/core/gradle/manifests/7.5.1_1
<span class="c">######################################################################## 100.0%</span>
<span class="o">==&gt;</span> Downloading https://ghcr.io/v2/homebrew/core/gradle/blobs/sha256:b8a590221ce177514ddff10c925b892ee856b9a23cc28dc623124b
<span class="o">==&gt;</span> Downloading from https://pkg-containers.githubusercontent.com/ghcr1/blobs/sha256:b8a590221ce177514ddff10c925b892ee856b9
<span class="c">######################################################################## 100.0%</span>
<span class="o">==&gt;</span> Installing dependencies <span class="k">for </span>gradle: openjdk@17
<span class="o">==&gt;</span> Installing gradle dependency: openjdk@17
<span class="o">==&gt;</span> Pouring openjdk@17--17.0.5.arm64_monterey.bottle.tar.gz
ğŸº  /opt/homebrew/Cellar/openjdk@17/17.0.5: 642 files, 307MB
<span class="o">==&gt;</span> Installing gradle
<span class="o">==&gt;</span> Pouring gradle--7.5.1_1.all.bottle.tar.gz
ğŸº  /opt/homebrew/Cellar/gradle/7.5.1_1: 11,340 files, 276.1MB
<span class="o">==&gt;</span> Running <span class="sb">`</span>brew cleanup gradle<span class="sb">`</span>...
Disable this behaviour by setting HOMEBREW_NO_INSTALL_CLEANUP.
Hide these hints with HOMEBREW_NO_ENV_HINTS <span class="o">(</span>see <span class="sb">`</span>man brew<span class="sb">`</span><span class="o">)</span><span class="nb">.</span>
<span class="o">==&gt;</span> <span class="sb">`</span>brew cleanup<span class="sb">`</span> has not been run <span class="k">in </span>the last 30 days, running now...
</code></pre></div></div>

<p>ì´ë ‡ê²Œ ë‹¤ìš´ ë°›ê³  ë‚œë’¤ì— ë‹¤ì‹œ<br />
ë²„ì ¼ì„ ì²´í¬í•´ë³´ë©´ ì„¤ì¹˜ëœ ëª¨ìŠµì„ í™•ì¸í•´ ë³¼ ìˆ˜ ìˆë‹¤.</p>

<p><br /></p>

<p>ì´ì œ Gradleì´ ì„¤ì¹˜ë˜ì—ˆìœ¼ë‹ˆ<br />
ìš°ë¦¬ê°€ ë§Œë“  ì• í”Œë¦¬ì¼€ì´ì…˜ í´ë”ì— ë“¤ì–´ê°€ì„œ<br />
ì•„ë˜ì™€ ê°™ì´ ë¹Œë“œ ëª…ë ¹ì–´ë¥¼ ì…ë ¥í•´ ì£¼ë©´ ë¹Œë“œê°€ ë˜ì–´ì§„ë‹¤.</p>
<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./gradlew build
</code></pre></div></div>

<p><strong>zsh: permission denied: ./gradlew</strong><br />
ë§Œì•½ ëª…ë ¹ì–´ ì…ë ¥ì‹œ ìœ„ì—ì²˜ëŸ¼ ê¶Œí•œ ë¬¸ì œê°€ ë°œìƒí•œë‹¤ë©´</p>

<p>gradlewì˜ ê¶Œí•œì„ 644 -&gt; 755ë¡œ ë³€ê²½í•´ì£¼ì–´ì•¼í•œë‹¤.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ll
</code></pre></div></div>
<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">-rwxr-xr-x</span>   1 ljh  staff   7.9K 11 15 10:44 gradlew
</code></pre></div></div>
<p>í˜„ì¬ ê²½ë¡œì—ì„œë¥¼ llì„ ì…ë ¥í•˜ì—¬ ê¶Œí•œ ìƒíƒœë¥¼ í™•ì¸í•  ìˆ˜ ìˆë‹¤.<br />
ls -l ì„ ì…ë ¥í•˜ì—¬ë„ í™•ì¸ì´ ê°€ëŠ¥í•˜ë‹¤</p>

<p>rwx : 7<br />
r-x : 5<br />
r-x : 5<br />
ì™€ ê°™ì´ ê¶Œí•œì„ ë³€ê²½í•´ì£¼ì–´ì•¼ í•˜ë©°</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">chmod </span>755 gradlew
</code></pre></div></div>
<p>ê¶Œí•œ ë³€ê²½ ëª…ë ¹ì–´ì¸ chmodë¡œ ê¶Œí•œì„ ë³€ê²½í•´ì£¼ë©´</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./gradlew build
</code></pre></div></div>
<p>ëª…ë ¹ì–´ê°€ ì •ìƒì ìœ¼ë¡œ ë¹Œë“œë˜ì–´ì§€ëŠ” ëª¨ìŠµì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.</p>

<p>ë¹Œë“œê°€ ë˜ì–´ì§€ë©´ ìœ„ì— IDEë¥¼ í†µí•´ ë¹Œë“œí–ˆë˜ ê²ƒ ì²˜ëŸ¼<br />
build &gt; libs í´ë”ì— .jar íŒŒì¼ì´ ìƒê¸°ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.</p>

<p><br /></p>

<h3 id="ì‹¤í–‰">ì‹¤í–‰</h3>

<p><strong>í„°ë¯¸ë„ë¡œ Jar íŒŒì¼ ì‹¤í–‰ì‹œí‚¤ê¸°</strong></p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>java <span class="nt">-jar</span> section3-week3-template-build-0.0.1-SNAPSHOT.jar
</code></pre></div></div>
<p>ê¸°ë³¸ì ìœ¼ë¡œ .jaríŒŒì¼ì„ ì‹¤í–‰ì‹œí‚¤ë ¤ë©´<br />
java -jarì„ ì…ë ¥í›„ íŒŒì¼ì´ë¦„ì„ ë„£ì–´ì£¼ë©´<br />
ì• í”Œë¦¬ì¼€ì´ì…˜ì´ IDEì—ì„œ ì‹¤í–‰ë˜ëŠ” ê²ƒ ì²˜ëŸ¼ ì‹¤í–‰ë˜ëŠ” ëª¨ìŠµì„<br />
í„°ë¯¸ë„ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆë‹¤.</p>

<p><br /></p>

<p><strong>í”„ë¡œíŒŒì¼(Profile) ì ìš©</strong></p>

<p>í”„ë¡œíŒŒì¼ ì ìš©ì´ë€.<br />
ìš°ë¦¬ëŠ” ë¡œì»¬í™˜ê²½ì—ì„œ í…ŒìŠ¤íŠ¸í•˜ê¸°ìœ„í•´ H2 DataBaseë¥¼ ì£¼ë¡œ ì‚¬ìš©í•´ì™”ë‹¤.<br />
í•˜ì§€ë§Œ ì„œë²„ì— ë°°í¬í•˜ê±°ë‚˜ ì‹¤ì œ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì ìš©í•˜ëŠ” DataBaseëŠ”<br />
ë‹¤ë¥¸ DataBaseê°€ ì˜¬ ìˆ˜ ìˆë‹¤. ê·¸ë ‡ìê³  ê¸°ì¡´ì— ì„¤ì •í•œ H2 ê´€ë ¨<br />
ë°ì´í„°ë¥¼ ì„œë²„ì— ì˜¬ë¦´ë•Œ ì¼ì¼ì´ ì§€ì›Œì„œ í•˜ê¸°ì—ëŠ” ë¶ˆí¸í•¨ì´ ìˆì–´<br />
ë™ì‹œì— ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡ Springì—ì„œëŠ” í”„ë¡œíŒŒì¼(Profile)ì´ë¼ëŠ” ê¸°ëŠ¥ì„ ì œê³µí•´ì¤€ë‹¤.</p>

<p><img src="https://lh3.googleusercontent.com/u/0/drive-viewer/AFDK6gNVRhs0fF44pgVaBPKUdF2aVOB9HWNny4_gw6wyvlz5td8IXIw3uhTQZuQhQJkFevEKtgvFCnFhwKgV9SJsZdlar03AUA=w1920-h921" alt="image" class="align-left" style="max-width: 100%" /></p>

<p>ìš°ì„  .yml íŒŒì¼ì„ ë¶„ë¦¬í•´ì£¼ì–´ì•¼í•œë‹¤.</p>

<p>application.yml<br />
application-local.yml<br />
application-server.yml</p>

<p>ì´ë ‡ê²Œ ì„¸ê°œë¡œ ë¶„ë¦¬í•´ì£¼ì—ˆê³  ê¸°ì¡´ì— ë¹Œë“œì‹œ ì‚¬ìš©í•˜ëŠ” yml íŒŒì¼ì€<br />
application.yml íŒŒì¼ì´ë‹¤.   í•´ë‹¹ íŒŒì¼ì—ëŠ” ì•„ë¬´ëŸ° ì½”ë“œë„ ë„£ì§€ ì•Šì•˜ê³ </p>

<p>ìš°ë¦¬ëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì‹¤í–‰í•  ë•Œ ì„¤ì •ì— ë”°ë¼ local.yml, server.ymlë¡œ<br />
ë³€ê²½í•´ê°€ë©´ì„œ ì‚¬ìš©ì´ ê°€ëŠ¥í•˜ë‹¤.</p>

<p>local.yml -&gt; h2 ì •ë³´<br />
server.yml -&gt; mysql ì •ë³´<br />
ë‚˜ëŠ” ìœ„ì™€ ê°™ì´ ë“±ë¡í•´ë†“ê³  ì‚¬ìš©í•˜ì˜€ë‹¤.</p>

<p>mysqlì„ ì‚¬ìš©í•œë‹¤ê³  ê°€ì •í•˜ê³  ì„¤ì •ì„ ì§„í–‰í•´ë³´ì</p>

<p><strong>1). yml ì„¤ì • ë³€ê²½</strong></p>
<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">spring</span><span class="pi">:</span>
  <span class="na">profiles</span><span class="pi">:</span>
    <span class="na">active</span><span class="pi">:</span> <span class="s">server</span>
</code></pre></div></div>
<p>application.yml íŒŒì¼ì— ìœ„ì™€ ê°™ì´ ì„¤ì •í•´ì£¼ë©´ ëœë‹¤.</p>

<p><br /></p>

<p><strong>2). êµ¬ì„± í¸ì§‘</strong></p>

<p><img src="https://lh3.googleusercontent.com/u/0/drive-viewer/AJc5JmTrEQ-vD2xirlKWhVpEcb96S87oR1s3Wjb2F_-Xup3XvpXxN0yvNE4Mbe2s79htd5-npeN9wfiVaA8Fow_bGjK8Q1yE=w1920-h921" alt="image" class="align-left" style="max-width: 100%" /></p>

<p>IDEì˜ êµ¬ì„± í¸ì§‘ì—ì„œë„ ìˆ˜ì •í•  ìˆ˜ ìˆë‹¤.<br />
ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì„ íƒ í›„</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>--spring.profiles.active=server
</code></pre></div></div>

<p>ìœ„ì™€ ê°™ì´ ì…ë ¥í•´ì£¼ë©´ ëœë‹¤.</p>

<p><br /></p>

<p>ì„¤ì •ì„ ëëƒˆìœ¼ë©´ ì´ì œ .jar íŒŒì¼ì„ ì‹¤í–‰ì‹œí‚¤ë©´ ëœë‹¤.<br />
ê¸°ì¡´ê³¼ ë™ì¼í•˜ê²Œ ì‹¤í–‰ ì‹œí‚¤ëŠ”ë° ë’¤ì—<br />
â€“spring.profiles.active=server ë¥¼ ì¶”ê°€í•´ì£¼ê³  ì‹¤í–‰ì‹œí‚¤ë©´ëœë‹¤.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>java <span class="nt">-jar</span> section3-week3-homework-build-0.0.1-SNAPSHOT.jar <span class="nt">--spring</span>.profiles.active<span class="o">=</span>server
</code></pre></div></div>

<p><img src="https://lh3.googleusercontent.com/u/0/drive-viewer/AFDK6gPsLVoNTpjR8xJLJAwP4xyDmw8zjaz0XeAdt4QomyJV1uM0dEzTKpcIzikSqw5TAHr1AJt4hrgO47p_ZBfQ-nSK6-9L=w1920-h921" alt="image" class="align-left" style="max-width: 100%" /></p>

<p>ì‹¤í–‰ ì‹œí‚¬ ê²½ìš°</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>The following 1 profile is active: "server"
</code></pre></div></div>

<p>ìœ„ì™€ ê°™ì€ profile ë¬¸êµ¬ê°€ ë°œìƒí•œë‹¤ë©´<br />
ì •ìƒì ìœ¼ë¡œ ì—°ê²°ì´ ë˜ì–´ì¡Œë‹¤ëŠ”ê±¸ í™•ì¸í•  ìˆ˜ ìˆë‹¤.</p>

<p><br /></p>

<h3 id="ì˜¤ëŠ˜-ë§Œë‚œ-error">ì˜¤ëŠ˜ ë§Œë‚œ ERROR</h3>

<p>ì˜¤ëŠ˜ ë§Œë‚œ ì—ëŸ¬ì¤‘ dataSource ê´€ë ¨ ì—ëŸ¬ê°€ ë°œìƒí–ˆì—ˆë‹¤.</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Caused by: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'dataSource' defined in class path resource 
[org/springframework/boot/autoconfigure/jdbc/DataSourceConfiguration$Hikari.class]: Bean instantiation via factory method failed; nested exception 
is org.springframework.beans.BeanInstantiationException: Failed to instantiate [com.zaxxer.hikari.HikariDataSource]: Factory method 'dataSource' 
threw exception; nested exception is java.lang.IllegalStateException: Cannot load driver class: com.mysql.cj.jdbc.Driver
</code></pre></div></div>

<p>í•´ë‹¹ ë‚´ìš©ì€ ì˜ì¡´ë¼ì´ë¸ŒëŸ¬ë¦¬ê°€ ì œëŒ€ë¡œ ì¶”ê°€ë˜ì–´ìˆì§€ ì•Šì•„<br />
ì½ì–´ì˜¤ì§€ ëª»í•˜ëŠ” í˜„ìƒ ê°™ì•˜ê³ </p>

<p>mysql ê³¼ ì—°ë™í•˜ê¸° ë•Œë¬¸ì— msql ì˜ì¡´ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì¶”ê°€í•˜ì˜€ê³ </p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>// mysql ì˜ì¡´ë¼ì´ë¸ŒëŸ¬ë¦¬ ì¶”ê°€
runtimeOnly 'mysql:mysql-connector-java'
</code></pre></div></div>

<p>ì˜ì¡´ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì¶”ê°€í›„</p>

<p><img src="https://lh3.googleusercontent.com/u/0/drive-viewer/AFDK6gMae5HizPF6syR7eBuQLmncWHLBOE-0y7fGS6RiuafbOdpIvYrLsxbcRv0EYY1bWe3X9WHdhj0HgRifbnEzk-a7Q04Z=w1920-h921" alt="image" class="align-left" style="max-width: 100%" /></p>

<p>ìœ„ì™€ ê°™ì´ ë¼ì´ë¸ŒëŸ¬ë¦¬ íŒ¨í‚¤ì§€ê°€ ìƒê¸°ë©´<br />
í•´ë‹¹ ì˜¤ë¥˜ëŠ” í•´ê²°ì´ ê°€ëŠ¥í•  ê²ƒ ì´ë‹¤.</p>

<hr />

<p>ì˜¤ëŠ˜ì€ ì´ë ‡ê²Œ í„°ë¯¸ë„ë¡œ build í•˜ëŠ” ë²•ê³¼ execution í•˜ëŠ”<br />
ë°©ë²•ì„ ì•Œì•„ ë³´ì•˜ë‹¤. ì•„ë§ˆë„ ë‚˜ì¤‘ì— ì„œë²„ì— ì´ëŸ°ì‹ìœ¼ë¡œ<br />
ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì‹¤í–‰ ì‹œì¼œë†“ê³  ìš´ì˜í•˜ëŠ”ê²Œ ì•„ë‹ê¹Œ? ë¼ëŠ” ìƒê°ì„ í•´ë³¸ë‹¤.</p>

<p>ì˜¤ëŠ˜ ê³µë¶€ë„ ì—¬ê¸°ì„œ ë !!</p>

<p><br /></p>

<p><span style="color:#994C00"><strong>ì˜¤ëŠ˜ì˜ ì»¤í”¼ëŸ‰</strong></span>: â˜•ï¸ â˜•ï¸ â˜•ï¸<br />
<strong>ì˜¤ëŠ˜ì˜ ì ì‹¬</strong>: ê¹€ì¹˜ì°Œê°œ, ê¹€ë°¥</p>]]></content><author><name>LEE JAEHYEOK</name></author><category term="TIL" /><category term="TIL" /><category term="ë¶€íŠ¸ìº í”„" /><category term="ì½”ë“œìŠ¤í…Œì´ì¸ " /><summary type="html"><![CDATA[]]></summary></entry><entry><title type="html">TIL) API Documentation 2</title><link href="http://localhost:4000/til/2022/11/14/til.html" rel="alternate" type="text/html" title="TIL) API Documentation 2" /><published>2022-11-14T00:00:00+09:00</published><updated>2022-11-14T00:00:00+09:00</updated><id>http://localhost:4000/til/2022/11/14/til</id><content type="html" xml:base="http://localhost:4000/til/2022/11/14/til.html"><![CDATA[<p>í•œ ì£¼ê°€ ëë‚˜ê³  ìƒˆë¡œìš´ ì£¼ê°€ ì‹œì‘ë˜ì—ˆë‹¤.</p>

<p><img src="https://lh3.googleusercontent.com/u/0/drive-viewer/AFDK6gOXnXDoCRH7AtlOncucaI0nI7RqC9GMkm0ZG-VhgIXazy7m5tTSccABV_f-3G5RjFSfN1ojWWOJzPxeYeKp4Ycs2Ykj=w1920-h921" alt="image" class="align-left" style="max-width: 65%" /></p>

<p>Spring í•µì‹¬ ê¸°ìˆ ì„ ë°°ìš°ëŠ” ì„¹ì…˜ì´ ê±°ì˜ ë§‰ë°”ì§€ë¡œ ë‹¤ê°€ì™”ë‹¤.<br />
ë‚´ê°€ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ê¸°ìˆ ì€ ì •ë§ ì ì€ ê²ƒ ê°™ì€ë°</p>

<p>ë²Œì¨ ì–´ëŠë§ ì„¹ì…˜ ëì— ë‹¤ë‹¤ë¥´ë‹¤ë‹ˆâ€¦<br />
ì‹œê°„ì´ ì§„ì§œ ë¹ ë¥´ë‹¤ê³  ëŠë¼ëŠ” ë°˜ë©´, ì¢€ ë” ì—´ì‹¬íˆí•´ì„œ <br />
ì§€ì‹ì„ ì±„ì›Œ ë„£ì–´ì•¼ ë‚´ ëª©ì ì§€ê¹Œì§€ ë„ë‹¬í•  ìˆ˜ ìˆì„ ê²ƒ ê°™ë‹¤ëŠ” ìƒê°ì´ ë“ ë‹¤.</p>

<hr />

<p>ì˜¤ëŠ˜ì€ Spring Rest Docsë¥¼ í™œìš©í•´ë³´ëŠ” ì‹œê°„ì´ë‹¤.</p>

<p>ì €ë²ˆì£¼ì— ê°„ë‹¨í•˜ê²Œ ì‚¬ìš©ë°©ë²•ì„ ë°°ì› ê³ <br />
ì˜¤ëŠ˜ì€ Controllerì˜ ëª¨ë“  APIë¥¼ ë¬¸ì„œí™” ì‹œì¼œë³´ë ¤í•œë‹¤.</p>

<h2 id="api-ìë™-ë¬¸ì„œí™”-ì—°ìŠµ">API ìë™ ë¬¸ì„œí™” ì—°ìŠµ</h2>

<p>ì €ë²ˆì£¼ì—ëŠ” POSTì™€ PACTHì— ëŒ€í•œ<br />
ìë™ ë¬¸ì„œí™”ë¥¼ ì§„í–‰í–ˆë‹¤.</p>

<p>ì§€ê¸ˆ ë§Œë“¤ê³  ìˆëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œëŠ” GET, DELETE<br />
APIë§Œ ìë™í™” ì‹œì¼œì£¼ë©´ ë§ˆë¬´ë¦¬ê°€ ëœë‹¤.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">static</span> <span class="n">org</span><span class="o">.</span><span class="na">mockito</span><span class="o">.</span><span class="na">BDDMockito</span><span class="o">.</span><span class="na">given</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">org</span><span class="o">.</span><span class="na">mockito</span><span class="o">.</span><span class="na">Mockito</span><span class="o">.</span><span class="na">doNothing</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">org</span><span class="o">.</span><span class="na">springframework</span><span class="o">.</span><span class="na">restdocs</span><span class="o">.</span><span class="na">mockmvc</span><span class="o">.</span><span class="na">RestDocumentationRequestBuilders</span><span class="o">.*;</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">org</span><span class="o">.</span><span class="na">springframework</span><span class="o">.</span><span class="na">restdocs</span><span class="o">.</span><span class="na">request</span><span class="o">.</span><span class="na">RequestDocumentation</span><span class="o">.</span><span class="na">parameterWithName</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">org</span><span class="o">.</span><span class="na">springframework</span><span class="o">.</span><span class="na">test</span><span class="o">.</span><span class="na">web</span><span class="o">.</span><span class="na">servlet</span><span class="o">.</span><span class="na">result</span><span class="o">.</span><span class="na">MockMvcResultMatchers</span><span class="o">.</span><span class="na">jsonPath</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">org</span><span class="o">.</span><span class="na">springframework</span><span class="o">.</span><span class="na">test</span><span class="o">.</span><span class="na">web</span><span class="o">.</span><span class="na">servlet</span><span class="o">.</span><span class="na">result</span><span class="o">.</span><span class="na">MockMvcResultMatchers</span><span class="o">.</span><span class="na">status</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">static</span> <span class="n">org</span><span class="o">.</span><span class="na">springframework</span><span class="o">.</span><span class="na">restdocs</span><span class="o">.</span><span class="na">payload</span><span class="o">.</span><span class="na">PayloadDocumentation</span><span class="o">.*;</span> <span class="c1">//responseFields(); , fieldWithPath() ì‚¬ìš©</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">org</span><span class="o">.</span><span class="na">springframework</span><span class="o">.</span><span class="na">restdocs</span><span class="o">.</span><span class="na">mockmvc</span><span class="o">.</span><span class="na">MockMvcRestDocumentation</span><span class="o">.</span><span class="na">document</span><span class="o">;</span> <span class="c1">// document();</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">org</span><span class="o">.</span><span class="na">springframework</span><span class="o">.</span><span class="na">restdocs</span><span class="o">.</span><span class="na">request</span><span class="o">.</span><span class="na">RequestDocumentation</span><span class="o">.</span><span class="na">pathParameters</span><span class="o">;</span> <span class="c1">// pathParameters();</span>
</code></pre></div></div>
<p>ì‹œì‘ ì „ ìš°ë¦¬ê°€ ì‚¬ìš©í•˜ê¸° ìœ„í•œ ê¸°ìˆ ì— ëŒ€í•œ<br />
importë¥¼ ì§„í–‰í•´ì¤€ë‹¤.</p>

<p>ìœ ì˜ ê¹Šê²Œ ë³¼ ê²ƒì€ RestDocs êµ¬ì„±ì„ ìœ„í•œ APIë“¤ì´ë‹¤.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="nd">@AutoConfigureRestDocs</span>
<span class="nd">@WebMvcTest</span><span class="o">(</span><span class="nc">MemberController</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
<span class="nd">@MockBean</span><span class="o">(</span><span class="nc">JpaMetamodelMappingContext</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">DocumentationTest</span> <span class="o">{</span>
    <span class="nd">@Autowired</span>
    <span class="kd">private</span> <span class="nc">MockMvc</span> <span class="n">mockMvc</span><span class="o">;</span>

    <span class="nd">@MockBean</span>
    <span class="kd">private</span> <span class="nc">MemberService</span> <span class="n">memberService</span><span class="o">;</span>

    <span class="nd">@MockBean</span>
    <span class="kd">private</span> <span class="nc">MemberMapper</span> <span class="n">mapper</span><span class="o">;</span>

    <span class="nd">@Autowired</span>
    <span class="kd">private</span> <span class="nc">Gson</span> <span class="n">gson</span><span class="o">;</span>
    
    <span class="o">...</span>
    
<span class="o">}</span>
</code></pre></div></div>
<p>ê¸°ë³¸ì ì¸ ìœ„ì¡´ì„± ì£¼ì…ê³¼ Class ì• ë…¸í…Œì´ì…˜ì„ ì…‹íŒ… í•œ ë‹¤ìŒ<br />
Test ì½”ë“œë¥¼ ì‘ì„±í•´ API ìë™í™”í•˜ì—¬ ë§Œë“¤ì–´ ì¤„ ìˆ˜ ìˆë‹¤.</p>

<p>@Test ì½”ë“œ ì‘ì„± ì‹œ ìš°ë¦¬ê°€ ì´ì „ ë¶€í„° í•™ìŠµí•´ì™”ë˜<br />
Mockitoë¥¼ ì´ìš©í•´ Slice ê³„ì¸µë³„ í…ŒìŠ¤íŠ¸ë¥¼ ë§Œë“¤ì–´ ì¤„ ìˆ˜ê°€ ìˆë‹¤.</p>

<p>Controllerì˜ ê³„ì¸µ ë³„ í…ŒìŠ¤íŠ¸ë¥¼ ìœ„í•´<br />
Serviceì˜ì—­ê³¼ì˜ ì—°ê²°ëœ ë¶€ë¶„ì„ Mock ê°ì²´ë¥¼ ë°˜í™˜ì‹œì¼œ<br />
ì‹¤ì œ ë°ì´í„°ê°€ ë“¤ì–´ê°„ ê²ƒ ì²˜ëŸ¼ í…ŒìŠ¤íŠ¸í•˜ëŠ” ë°©ë²•ì´ë‹¤.</p>

<p>ë‚´ê°€ ì´ ë§Œë“¤ì–´ì•¼í•  APIëŠ” 3ê°œì´ê³ <br />
ë©¤ë²„ ì¡°íšŒ, ë©¤ë²„ ì „ì²´ì¡°íšŒ, ë©¤ë²„ ì‚­ì œ ì´ë ‡ê²Œ ëœë‹¤.</p>

<p><strong>1). GET</strong></p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Test</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">getMemberTest</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
    <span class="nc">MemberDto</span><span class="o">.</span><span class="na">response</span> <span class="n">response</span> <span class="o">=</span> <span class="nc">StubData</span><span class="o">.</span><span class="na">MockMember</span><span class="o">.</span><span class="na">getSingleResponseBody</span><span class="o">();</span>
    <span class="kt">long</span> <span class="n">memberid</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="na">getMemberId</span><span class="o">();</span>

    <span class="c1">// findMember(); Mock ì²˜ë¦¬í•˜ê¸° , ë°˜í™˜ í•„ìš”x (ìƒˆë¡œìš´ ê°ì²´)</span>
    <span class="n">given</span><span class="o">(</span><span class="n">memberService</span><span class="o">.</span><span class="na">findMember</span><span class="o">(</span><span class="nc">Mockito</span><span class="o">.</span><span class="na">anyLong</span><span class="o">())).</span><span class="na">willReturn</span><span class="o">(</span><span class="k">new</span> <span class="nc">Member</span><span class="o">());</span>

    <span class="c1">// memberToMemberResponse(); Mock ì²˜ë¦¬í•˜ê¸° , ë°˜ìˆ˜í•„ìˆ˜ íƒ€ì… = MemberDto.response</span>
    <span class="n">given</span><span class="o">(</span><span class="n">mapper</span><span class="o">.</span><span class="na">memberToMemberResponse</span><span class="o">(</span><span class="nc">Mockito</span><span class="o">.</span><span class="na">any</span><span class="o">())).</span><span class="na">willReturn</span><span class="o">(</span><span class="n">response</span><span class="o">);</span>

    <span class="nc">ResultActions</span> <span class="n">actions</span> <span class="o">=</span> <span class="n">mockMvc</span><span class="o">.</span><span class="na">perform</span><span class="o">(</span>
            <span class="n">get</span><span class="o">(</span><span class="s">"/v11/members/{member-id}"</span><span class="o">,</span> <span class="n">memberid</span><span class="o">)</span>
                    <span class="o">.</span><span class="na">accept</span><span class="o">(</span><span class="nc">MediaType</span><span class="o">.</span><span class="na">APPLICATION_JSON</span><span class="o">)</span>
    <span class="o">);</span>

    <span class="n">actions</span>
            <span class="o">.</span><span class="na">andExpect</span><span class="o">(</span><span class="n">status</span><span class="o">().</span><span class="na">isOk</span><span class="o">())</span>
            <span class="o">.</span><span class="na">andExpect</span><span class="o">(</span><span class="n">jsonPath</span><span class="o">(</span><span class="s">"$.data.memberId"</span><span class="o">).</span><span class="na">value</span><span class="o">(</span><span class="s">"1"</span><span class="o">))</span>
            <span class="o">.</span><span class="na">andExpect</span><span class="o">(</span><span class="n">jsonPath</span><span class="o">(</span><span class="s">"$.data.email"</span><span class="o">).</span><span class="na">value</span><span class="o">(</span><span class="s">"dhfif718@gmail.com"</span><span class="o">))</span>
            <span class="o">.</span><span class="na">andExpect</span><span class="o">(</span><span class="n">jsonPath</span><span class="o">(</span><span class="s">"$.data.name"</span><span class="o">).</span><span class="na">value</span><span class="o">(</span><span class="s">"ì´ì¬í˜"</span><span class="o">))</span>
            <span class="o">.</span><span class="na">andExpect</span><span class="o">(</span><span class="n">jsonPath</span><span class="o">(</span><span class="s">"$.data.phone"</span><span class="o">).</span><span class="na">value</span><span class="o">(</span><span class="s">"010-1234-5678"</span><span class="o">))</span>
            <span class="o">.</span><span class="na">andDo</span><span class="o">(</span><span class="n">document</span><span class="o">(</span><span class="s">"get-findMember"</span><span class="o">,</span>
                    <span class="n">getRequestPreProcessor</span><span class="o">(),</span>
                    <span class="n">getResponsePreProcessor</span><span class="o">(),</span>
                    <span class="n">pathParameters</span><span class="o">(</span>
                            <span class="n">parameterWithName</span><span class="o">(</span><span class="s">"member-id"</span><span class="o">).</span><span class="na">description</span><span class="o">(</span><span class="s">"íšŒì› ì‹ë³„ì"</span><span class="o">)</span>
                    <span class="o">),</span>
                    <span class="n">responseFields</span><span class="o">(</span>
                            <span class="nc">List</span><span class="o">.</span><span class="na">of</span><span class="o">(</span>
                                    <span class="n">fieldWithPath</span><span class="o">(</span><span class="s">"data"</span><span class="o">).</span><span class="na">type</span><span class="o">(</span><span class="nc">JsonFieldType</span><span class="o">.</span><span class="na">OBJECT</span><span class="o">).</span><span class="na">description</span><span class="o">(</span><span class="s">"ê²°ê³¼ ë°ì´í„°"</span><span class="o">),</span>
                                    <span class="n">fieldWithPath</span><span class="o">(</span><span class="s">"data.memberId"</span><span class="o">).</span><span class="na">type</span><span class="o">(</span><span class="nc">JsonFieldType</span><span class="o">.</span><span class="na">NUMBER</span><span class="o">).</span><span class="na">description</span><span class="o">(</span><span class="s">"íšŒì› ì‹ë³„ì"</span><span class="o">),</span>
                                    <span class="n">fieldWithPath</span><span class="o">(</span><span class="s">"data.email"</span><span class="o">).</span><span class="na">type</span><span class="o">(</span><span class="nc">JsonFieldType</span><span class="o">.</span><span class="na">STRING</span><span class="o">).</span><span class="na">description</span><span class="o">(</span><span class="s">"ì´ë©”ì¼"</span><span class="o">),</span>
                                    <span class="n">fieldWithPath</span><span class="o">(</span><span class="s">"data.name"</span><span class="o">).</span><span class="na">type</span><span class="o">(</span><span class="nc">JsonFieldType</span><span class="o">.</span><span class="na">STRING</span><span class="o">).</span><span class="na">description</span><span class="o">(</span><span class="s">"ì´ë¦„"</span><span class="o">),</span>
                                    <span class="n">fieldWithPath</span><span class="o">(</span><span class="s">"data.phone"</span><span class="o">).</span><span class="na">type</span><span class="o">(</span><span class="nc">JsonFieldType</span><span class="o">.</span><span class="na">STRING</span><span class="o">).</span><span class="na">description</span><span class="o">(</span><span class="s">"ì „í™” ë²ˆí˜¸"</span><span class="o">),</span>
                                    <span class="n">fieldWithPath</span><span class="o">(</span><span class="s">"data.memberStatus"</span><span class="o">).</span><span class="na">type</span><span class="o">(</span><span class="nc">JsonFieldType</span><span class="o">.</span><span class="na">STRING</span><span class="o">).</span><span class="na">description</span><span class="o">(</span><span class="s">"íšŒì› ìƒíƒœ: í™œë™ì¤‘/íœ´ë©´ìƒíƒœ/íƒˆí‡´ìƒíƒœ"</span><span class="o">),</span>
                                    <span class="n">fieldWithPath</span><span class="o">(</span><span class="s">"data.stamp"</span><span class="o">).</span><span class="na">type</span><span class="o">(</span><span class="nc">JsonFieldType</span><span class="o">.</span><span class="na">NUMBER</span><span class="o">).</span><span class="na">description</span><span class="o">(</span><span class="s">"ìŠ¤íƒ¬í”„ ê°¯ìˆ˜"</span><span class="o">)</span>
                            <span class="o">)</span>
                    <span class="o">)</span>
            <span class="o">));</span>
<span class="o">}</span>
</code></pre></div></div>
<p>í¬ê²Œ ë‹¬ë¼ì§„ì ì€ ì—†ë‹¤.<br />
andDoë¥¼ í†µí•´ ê²€ì¦ê³¼ ë™ì‹œì— API ìë™í™”ë¥¼ ìœ„í•œ<br />
ì—¬ëŸ¬ê°€ì§€ íŒŒë¼ë¯¸í„°ë“¤ì„ ë„˜ê²¨ì£¼ê³  ìˆë‹¤.</p>

<p>GET ìš”ì²­ì´ê¸°ë•Œë¬¸ì— requestFields();ì— ëŒ€í•œ<br />
ì‘ì„±ì€ ë”°ë¡œí•˜ì§€ ì•Šì•˜ë‹¤.</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"data"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"memberId"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
    </span><span class="nl">"email"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"dhfif718@gmail.com"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"name"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"ì´ì¬í˜"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"phone"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"010-1234-5678"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"memberStatus"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"í™œë™ì¤‘"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"stamp"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>
<p>ìµœì¢… ì ìœ¼ë¡œ responseFieldsì˜ Json í˜•íƒœëŠ” ìœ„ì™€ ê°™ì´ ì´ë£¨ì–´ì§„ë‹¤.<br />
í˜„ì¬ëŠ” dataë¼ëŠ” Objectì•ˆì— í•œì¢…ë¥˜ì˜ ë°ì´í„°ê°€ ë“¤ì–´ê°€ ìˆë‹¤.</p>

<p><br /></p>

<p>ë§Œì•½ ì „ì²´ì¡°íšŒë¥¼ ìœ„í•´<br />
dataì•ˆì— ë°°ì—´ë¡œ ë°ì´í„°ê°€ ì¡´ì¬í•œë‹¤ë©´ ì–´ë–»ê²Œ<br />
í‘œì‹œë¥¼ í•´ì£¼ì–´ì•¼í• ê¹Œ?</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">responseFields</span><span class="o">(</span>
        <span class="nc">List</span><span class="o">.</span><span class="na">of</span><span class="o">(</span>
                <span class="n">fieldWithPath</span><span class="o">(</span><span class="s">"data.[].memberId"</span><span class="o">).</span><span class="na">type</span><span class="o">(</span><span class="nc">JsonFieldType</span><span class="o">.</span><span class="na">NUMBER</span><span class="o">).</span><span class="na">description</span><span class="o">(</span><span class="s">"íšŒì› ì‹ë³„ì"</span><span class="o">),</span>
                <span class="n">fieldWithPath</span><span class="o">(</span><span class="s">"data.[].email"</span><span class="o">).</span><span class="na">type</span><span class="o">(</span><span class="nc">JsonFieldType</span><span class="o">.</span><span class="na">STRING</span><span class="o">).</span><span class="na">description</span><span class="o">(</span><span class="s">"ì´ë©”ì¼"</span><span class="o">),</span>
                <span class="n">fieldWithPath</span><span class="o">(</span><span class="s">"data.[].name"</span><span class="o">).</span><span class="na">type</span><span class="o">(</span><span class="nc">JsonFieldType</span><span class="o">.</span><span class="na">STRING</span><span class="o">).</span><span class="na">description</span><span class="o">(</span><span class="s">"ì´ë¦„"</span><span class="o">),</span>
                <span class="n">fieldWithPath</span><span class="o">(</span><span class="s">"data.[].phone"</span><span class="o">).</span><span class="na">type</span><span class="o">(</span><span class="nc">JsonFieldType</span><span class="o">.</span><span class="na">STRING</span><span class="o">).</span><span class="na">description</span><span class="o">(</span><span class="s">"ì „í™” ë²ˆí˜¸"</span><span class="o">),</span>
                <span class="n">fieldWithPath</span><span class="o">(</span><span class="s">"data.[].memberStatus"</span><span class="o">).</span><span class="na">type</span><span class="o">(</span><span class="nc">JsonFieldType</span><span class="o">.</span><span class="na">STRING</span><span class="o">).</span><span class="na">description</span><span class="o">(</span><span class="s">"íšŒì› ìƒíƒœ: í™œë™ì¤‘/íœ´ë©´ìƒíƒœ/íƒˆí‡´ìƒíƒœ"</span><span class="o">),</span>
                <span class="n">fieldWithPath</span><span class="o">(</span><span class="s">"data.[].stamp"</span><span class="o">).</span><span class="na">type</span><span class="o">(</span><span class="nc">JsonFieldType</span><span class="o">.</span><span class="na">NUMBER</span><span class="o">).</span><span class="na">description</span><span class="o">(</span><span class="s">"ìŠ¤íƒ¬í”„ ê°¯ìˆ˜"</span><span class="o">),</span>
        <span class="o">)</span>
<span class="o">)</span>
</code></pre></div></div>
<p>responseFieldsì˜ ìœ„ì™€ ê°™ì´ data.[].ì„ ì´ìš©í•´  <br />
ë°°ì—´ì— í•´ë‹¹í•˜ëŠ” ë‚´ìš©ì„ í‘œì‹œí•´ì¤„ ìˆ˜ ìˆë‹¤.</p>

<p>ë˜í•œ</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">responseFields</span><span class="o">(</span>
        <span class="nc">List</span><span class="o">.</span><span class="na">of</span><span class="o">(</span>
                <span class="n">fieldWithPath</span><span class="o">(</span><span class="s">"data"</span><span class="o">).</span><span class="na">type</span><span class="o">(</span><span class="nc">JsonFieldType</span><span class="o">.</span><span class="na">ARRAY</span><span class="o">).</span><span class="na">description</span><span class="o">(</span><span class="s">"ê²°ê³¼ ë°ì´í„°"</span><span class="o">).</span><span class="na">optional</span><span class="o">(),</span>
                <span class="n">fieldWithPath</span><span class="o">(</span><span class="s">"data[].memberId"</span><span class="o">).</span><span class="na">type</span><span class="o">(</span><span class="nc">JsonFieldType</span><span class="o">.</span><span class="na">NUMBER</span><span class="o">).</span><span class="na">description</span><span class="o">(</span><span class="s">"íšŒì› ì‹ë³„ì"</span><span class="o">),</span>
                <span class="n">fieldWithPath</span><span class="o">(</span><span class="s">"data[].email"</span><span class="o">).</span><span class="na">type</span><span class="o">(</span><span class="nc">JsonFieldType</span><span class="o">.</span><span class="na">STRING</span><span class="o">).</span><span class="na">description</span><span class="o">(</span><span class="s">"ì´ë©”ì¼"</span><span class="o">),</span>
                <span class="n">fieldWithPath</span><span class="o">(</span><span class="s">"data[].name"</span><span class="o">).</span><span class="na">type</span><span class="o">(</span><span class="nc">JsonFieldType</span><span class="o">.</span><span class="na">STRING</span><span class="o">).</span><span class="na">description</span><span class="o">(</span><span class="s">"ì´ë¦„"</span><span class="o">),</span>
                <span class="n">fieldWithPath</span><span class="o">(</span><span class="s">"data[].phone"</span><span class="o">).</span><span class="na">type</span><span class="o">(</span><span class="nc">JsonFieldType</span><span class="o">.</span><span class="na">STRING</span><span class="o">).</span><span class="na">description</span><span class="o">(</span><span class="s">"ì „í™” ë²ˆí˜¸"</span><span class="o">),</span>
                <span class="n">fieldWithPath</span><span class="o">(</span><span class="s">"data[].memberStatus"</span><span class="o">).</span><span class="na">type</span><span class="o">(</span><span class="nc">JsonFieldType</span><span class="o">.</span><span class="na">STRING</span><span class="o">).</span><span class="na">description</span><span class="o">(</span><span class="s">"íšŒì› ìƒíƒœ: í™œë™ì¤‘/íœ´ë©´ìƒíƒœ/íƒˆí‡´ìƒíƒœ"</span><span class="o">),</span>
                <span class="n">fieldWithPath</span><span class="o">(</span><span class="s">"data[].stamp"</span><span class="o">).</span><span class="na">type</span><span class="o">(</span><span class="nc">JsonFieldType</span><span class="o">.</span><span class="na">NUMBER</span><span class="o">).</span><span class="na">description</span><span class="o">(</span><span class="s">"ìŠ¤íƒ¬í”„ ê°¯ìˆ˜"</span><span class="o">),</span>
        <span class="o">)</span>
<span class="o">)</span>
</code></pre></div></div>
<p>ìœ„ì™€ ê°™ì´ë„ í‘œê¸°í•  ìˆ˜ ìˆë‹¤.</p>

<p>ì—¬ê¸°ì„œ í•œê°€ì§€ ì°¸ê³ í•´ì•¼í•  ì ì€
JsonFieldType.OBJECT = data : {}<br />
JsonFieldType.ARRAY = data : []  <br />
ê³¼ ê°™ì´ í‘œê¸°í•  ë•Œ ì‚¬ìš©í•œë‹¤ëŠ” ì ì´ë‹¤.</p>

<p>í•˜ë‚˜ì˜ ë©¤ë²„ë§Œ ì¡°íšŒí–ˆì„ë•Œ OBJECTë¥¼ ì‚¬ìš©í•œ ì´ìœ ì™€<br />
ì—¬ëŸ¬ ë©¤ë²„ë¥¼ ì¡°íšŒí–ˆì„ë•Œ ARRAYë¥¼ ì‚¬ìš©í•œ ì´ìœ ì´ë‹¤.</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"data"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"memberId"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
    </span><span class="nl">"email"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"dhfif718@gmail.com"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"name"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"ì´ì¬í˜"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"phone"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"010-1234-5678"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"memberStatus"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"í™œë™ì¤‘"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"stamp"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="w">
  </span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"memberId"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
    </span><span class="nl">"email"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"tmdghwlq@naver.com"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"name"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"ì—¼ìŠ¹í˜¸"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"phone"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"010-2000-4000"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"memberStatus"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"í™œë™ì¤‘"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"stamp"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="w">
  </span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"memberId"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w">
    </span><span class="nl">"email"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"dragonwon@nate.com"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"name"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"ì •ìš©ì›"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"phone"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"010-7777-4587"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"memberStatus"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"í™œë™ì¤‘"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"stamp"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="w">
  </span><span class="p">}</span><span class="w"> </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>ì‹¤ì œë¡œ buildí•˜ì—¬ ìƒì„±ëœ response-bodyë¥¼ í™•ì¸í•´ë³´ë©´<br />
ìš°ë¦¬ê°€ ìµœì¢…ì ìœ¼ë¡œ ë°˜í™˜í•œ ë°ì´í„°ì— ë”°ë¥¸ ë°°ì—´ì´<br />
ìœ„ì™€ ê°™ì´ ì˜í‘œì‹œë˜ëŠ” ëª¨ìŠµì„ í™•ì¸í•´ ë³¼ ìˆ˜ ìˆë‹¤.</p>

<p>ì´ë ‡ê²Œ ë³µì¡í•œ êµ¬ì¡°ì˜ Jsoní˜•íƒœì¼ì§€ë¼ë„<br />
ë°°ì—´ì— ëŒ€í•œ ìœ„ì¹˜ë§Œ ì˜ ì§€ì •í•´ì£¼ë©´ @Test ì»´íŒŒì¼ì‹œ ì •ìƒì ìœ¼ë¡œ<br />
ì‹¤í–‰ë˜ì–´ ìŠ¤ë‹ˆí•ì´ ì˜ ë§Œë“¤ì–´ ì§€ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.</p>

<p><br /></p>

<p><strong>2). DELETE</strong></p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Test</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">deleteMemberTest</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
    <span class="kt">long</span> <span class="n">memberId</span> <span class="o">=</span> <span class="mi">1L</span><span class="o">;</span>

    <span class="c1">// deleteMember(); Mock ì²˜ë¦¬í•˜ê¸°, ë°˜í™˜íƒ€ì… = void</span>
    <span class="n">doNothing</span><span class="o">().</span><span class="na">when</span><span class="o">(</span><span class="n">memberService</span><span class="o">).</span><span class="na">deleteMember</span><span class="o">(</span><span class="n">memberId</span><span class="o">);</span>

    <span class="nc">ResultActions</span> <span class="n">actions</span> <span class="o">=</span> <span class="n">mockMvc</span><span class="o">.</span><span class="na">perform</span><span class="o">(</span>
            <span class="n">delete</span><span class="o">(</span><span class="s">"/v11/members/{member-id}"</span><span class="o">,</span> <span class="n">memberId</span><span class="o">)</span>
                    <span class="o">.</span><span class="na">accept</span><span class="o">(</span><span class="nc">MediaType</span><span class="o">.</span><span class="na">APPLICATION_JSON</span><span class="o">)</span>
    <span class="o">);</span>

    <span class="n">actions</span>
            <span class="o">.</span><span class="na">andExpect</span><span class="o">(</span><span class="n">status</span><span class="o">().</span><span class="na">isNoContent</span><span class="o">())</span>
            <span class="o">.</span><span class="na">andDo</span><span class="o">(</span><span class="n">document</span><span class="o">(</span>
                    <span class="s">"delete-member"</span><span class="o">,</span>
                    <span class="n">getRequestPreProcessor</span><span class="o">(),</span>
                    <span class="n">getResponsePreProcessor</span><span class="o">(),</span>
                    <span class="n">pathParameters</span><span class="o">(</span>
                            <span class="n">parameterWithName</span><span class="o">(</span><span class="s">"member-id"</span><span class="o">).</span><span class="na">description</span><span class="o">(</span><span class="s">"íšŒì› ì‹ë³„ì"</span><span class="o">)</span>
                    <span class="o">)</span>
            <span class="o">));</span>
<span class="o">}</span>
</code></pre></div></div>
<p>DeleteëŠ” ì‚¬ì‹¤ ë”ìš±ë” ê°„ë‹¨í•˜ë‹¤.<br />
requestFieldsì™€ responseFieldsì˜ ë”°ë¡œ ë§Œë“¤ì–´ì¤„<br />
í•„ìš”ê°€ ì—†ê¸° ë•Œë¬¸ì— parameterì— ëŒ€í•œ API ë‚´ìš©ë§Œ ì ì–´ì£¼ë©´ëœë‹¤..</p>

<p>ì´ë ‡ê²Œ ì˜¤ëŠ˜ì€ GET,DELETEì— ëŒ€í•œ<br />
API ë¬¸ì„œ ìë™í™”ë¥¼ ì§„í–‰í–ˆë‹¤.</p>

<p><br /></p>

<h2 id="ì˜¤ëŠ˜-ë§ˆì£¼í•œ-error">ì˜¤ëŠ˜ ë§ˆì£¼í•œ ERROR</h2>

<p>1). ë¬¸ì œ í™•ì¸<br />
GET, DELETEì— ëŒ€í•œ í…ŒìŠ¤íŠ¸ì¼€ì´ìŠ¤ëŠ” í†µê³¼í•œ ìƒíƒœë¡œ<br />
gradle buildí•˜ëŠ” ê³¼ì • ì¤‘ ë¬¸ì œê°€ ë°œìƒí–ˆë‹¤.</p>

<p>ì²«ë²ˆì§¸ëŠ” ì•„ë˜ì™€ ê°™ì€ ì˜¤ë¥˜ ì½”ë“œê°€ ë°œìƒ</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">There</span> <span class="n">were</span> <span class="n">failing</span> <span class="n">tests</span><span class="o">.</span> <span class="nc">See</span> <span class="n">the</span> <span class="n">report</span> <span class="nl">at:</span> <span class="nl">file:</span><span class="c1">///Users/ljh/Desktop/myprogram/CodeStates/be-homework-api-documentation/build/reports/tests/test/index.html</span>
</code></pre></div></div>

<p>ë‘ë²ˆì§¸ëŠ” resourcesì˜ index.html íŒŒì¼ì´ ìƒê¸°ì§€ ì•Šì•˜ë‹¤.</p>

<p><img src="https://lh3.googleusercontent.com/u/0/drive-viewer/AFDK6gMjr35Sq1Q_a5w8FeW6-h0MrJhp27At6mtmeNDPdy7Vt_Ypfia_OLvp8OjFswdwaRI3nxa-Cvww99s3zBMEEy_jQBxi=w1920-h921" alt="image" class="align-left" style="max-width: 100%" /></p>

<p>ì²«ë²ˆì§¸ ë¬¸ì œë¡œ ì¸í•´ íŒŒì¼ ìƒì„±ì´ ë˜ì§€ ì•Šì€ ë“¯ í–ˆë‹¤.</p>

<p><br /></p>

<p>2). ë¬¸ì œ í•´ê²°<br />
ì²«ë²ˆì§¸ ì˜¤ë¥˜ ì½”ë“œë¥¼ ì²œì²œíˆ ë³´ë‹ˆ  í…ŒìŠ¤íŠ¸ë¥¼ ì‹¤íŒ¨í–ˆìœ¼ë‹ˆ<br />
í•´ë‹¹ê²½ë¡œì— ë“¤ì–´ê°€ì„œ ë³´ë¼ëŠ” ê²ƒ ê°™ì•˜ë‹¤.</p>

<p><img src="https://lh3.googleusercontent.com/u/0/drive-viewer/AFDK6gNEdF_s4q2MG1_Td-VloiVybdGvYGUqHewVUU_L9Rbbqq45xouzGpvldtATTmL0KjTJ9V_ds1JEsC8_UclbIK5tZVMOgg=w1920-h921" alt="image" class="align-left" style="max-width: 100%" /></p>

<p>í•´ë‹¹ ê²½ë¡œì— ë“¤ì–´ê°€ì„œ index.html íŒŒì¼ì„ ì—´ì–´ë³´ì•˜ë‹¤.</p>

<p><img src="https://lh3.googleusercontent.com/u/0/drive-viewer/AFDK6gMAh6qcJXhFrBUv5fVdmlay6LC7TIDSpP9naAOl97GCFV9bR5kjFhWtyExFHdc_m0yiA8zkbZYSHda_SyeuxH_TbW84=w1920-h921" alt="image" class="align-left" style="max-width: 100%" /></p>

<p>ì—´ì–´ë³´ì•˜ë”ë‹ˆ Test Summaryë¼ëŠ”<br />
í…ŒìŠ¤íŠ¸ ê²°ê³¼ì— ëŒ€í•œ ìš”ì•½ì„ ë‚˜íƒ€ë‚´ì£¼ëŠ” í™”ë©´ì´ ìˆì—ˆê³ </p>

<p>MemberControllerTest4ì˜ getMembersTest() ë©”ì„œë“œê°€<br />
í…ŒìŠ¤íŠ¸ë¥¼ í†µê³¼í•˜ì§€ ëª»í–ˆêµ¬ë‚˜ë¼ê³  ì•Œì•„ì°¨ë ¸ë‹¤.</p>

<p>í•´ë‹¹ ë¬¸ì œëŠ” ë‚´ê°€ GET, DELETEë¥¼ ì¶”ê°€í•˜ë©´ì„œ<br />
ê¸°ì¡´ì— ë‘” í…ŒìŠ¤íŠ¸ì½”ë“œì— ì˜í–¥ì´ ê°”ì—ˆê³ <br />
ì˜¤ë¥˜ë¥¼ ìˆ˜ì •í•˜ê³  ë‹¤ì‹œ gradle buildë¥¼ í•˜ë‹ˆ</p>

<p><img src="https://lh3.googleusercontent.com/u/0/drive-viewer/AFDK6gMIqLDdClsJaEodvMjJXyFMOE1Ats6JM6us5Nwq8nB--Jr620vXRnfWD_RaqptDSvECTD2WLT4H7bNj9_9dGzzC7tDn=w1920-h921" alt="image" class="align-left" style="max-width: 100%" /></p>

<p>index.hmtl íŒŒì¼ì´ ìƒì„±ëœ ëª¨ìŠµì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤ !!</p>

<hr />

<p>ì˜¤ëŠ˜ì€ API ìë™í™”ë¥¼ ìœ„í•œ<br />
Spring Rest Docsë¥¼ ì—°ìŠµí•´ë³´ëŠ” ì‹œê°„ì„ ê°€ì¡Œë‹¤.<br />
ì´ëŸ°ì‹ìœ¼ë¡œ í…ŒìŠ¤íŠ¸ì½”ë“œì™€ ì—°ê²°í•´<br />
API ë¬¸ì„œë¥¼ ë§Œë“¤ ìˆ˜ ìˆë‹¤ëŠ”ê²Œ ë„ˆë¬´ ì¢‹ì€ ê¸°ìˆ ì¸ ê²ƒ ê°™ë‹¤ëŠ” ìƒê°ì´ë“ ë‹¤.</p>

<p>ì‚¬ì‹¤ ì´ì „ê¹Œì§€ë§Œí•´ë„ ìˆ˜ë™ìœ¼ë¡œ ì‚¬ëŒì´ ë‹¤ì ì–´ì„œ ê´€ë¦¬í•˜ëŠ” ì¤„ ì•Œì•˜ëŠ”ë°<br />
ì´ë ‡ê²Œ ì¢‹ì€ ë°©ë²•ìœ¼ë¡œ ê´€ë¦¬ë¥¼ í•  ìˆ˜ ìˆë‹¤ëŠ” ì ì—ì„œ<br />
ì¢‹ì€ ê¸°ìˆ ì„ ë°°ìš´ ê²ƒ ê°™ì•„ ë¿Œë“¯í•œ ëŠë‚Œì´ ë“¤ì—ˆë‹¤.</p>

<p>ì˜¤ëŠ˜ ê³µë¶€ë„ ì—¬ê¸°ì„œ ë !!</p>

<p><br /></p>

<p><span style="color:#994C00"><strong>ì˜¤ëŠ˜ì˜ ì»¤í”¼ëŸ‰</strong></span>: â˜•ï¸ â˜•ï¸ â˜•ï¸<br />
<strong>ì˜¤ëŠ˜ì˜ ì ì‹¬</strong>: ì‚¼ê²¹ì‚´, ë¼ë©´, ë°¥</p>]]></content><author><name>LEE JAEHYEOK</name></author><category term="TIL" /><category term="TIL" /><category term="ë¶€íŠ¸ìº í”„" /><category term="ì½”ë“œìŠ¤í…Œì´ì¸ " /><summary type="html"><![CDATA[í•œ ì£¼ê°€ ëë‚˜ê³  ìƒˆë¡œìš´ ì£¼ê°€ ì‹œì‘ë˜ì—ˆë‹¤.]]></summary></entry><entry><title type="html">TIL) API Documentation 1</title><link href="http://localhost:4000/til/2022/11/11/til.html" rel="alternate" type="text/html" title="TIL) API Documentation 1" /><published>2022-11-11T00:00:00+09:00</published><updated>2022-11-11T00:00:00+09:00</updated><id>http://localhost:4000/til/2022/11/11/til</id><content type="html" xml:base="http://localhost:4000/til/2022/11/11/til.html"><![CDATA[<p>ìš”ë²ˆì£¼ë„ í•œì£¼ê°€ ì§€ë‚˜ê°„ë‹¤.<br />
ì–¼ë§ˆ ê³µë¶€í•œ ê²ƒ ê°™ì€ëŠë‚Œì´ ì•„ë‹Œë° ë²Œì¨<br />
ì›”ìš”ì¼ì´ì§€ë‚˜ ê¸ˆìš”ì¼ì´ ë˜ì—ˆë‹¤.</p>

<p><img src="https://lh3.googleusercontent.com/u/0/drive-viewer/AJc5JmQk4K8CSftTVVdvYx3CCxrYZD4T2BrAhtXL4imWit5EO503BT7GHs58m2U-u9Ff8-jqsP6WkToRyaKKm_g388y_S6IT=w3024-h1620" alt="image" class="align-left" style="max-width: 100%" /></p>

<p>ì €ë²ˆì£¼ì— ë³¸ ë¦¬ê·¸ì˜¤ë¸Œë ˆì „ë“œ ì›”ì¦ˆ ê²°ìŠ¹ì „ì„ ê°ëª…ê¹Šê²Œ ë³´ì•„ì„œ ê·¸ëŸ°ì§€  <br />
ë‚´ ë§ˆìŒ í•œì¼ ì— ë¶ˆì•ˆí•˜ê³  ì•ˆì •ì ì´ì§€ ëª»í•œ ì§€ê¸ˆì˜ ì‚¶ì—<br />
ë§ì´ ì§€ì³í•˜ê³  ìˆì—ˆëŠ”ë°, ë§ì€ ìœ„ë¡œê°€ ë˜ì—ˆë‹¤.</p>

<p>â€˜ì¤‘ìš”í•œê±´ êº½ì´ì§€ ì•ŠëŠ” ë§ˆìŒâ€™ ì°¸ ì˜ ë§Œë“  ë¬¸êµ¬ì¸ ê²ƒ ê°™ë‹¤.<br />
ë‚˜ë„ êº½ì´ì§€ ì•Šê³  ë‚˜ì•„ê°€ëŠ” ëª¨ìŠµì„ ë°œê²¬í•  ìˆ˜ìˆë„ë¡<br />
ë”ìš±ë” ë…¸ë ¥í•´ë³´ì•„ì•¼ê² ë‹¤.</p>

<hr />
<p>3ì¼ê°„ JUnitì— ëŒ€í•œ ê³µë¶€ë¥¼ í–ˆë‹¤. <br />
ì—¬ëŸ¬ APIë¥¼ ì‚¬ìš©í•´ë³´ë©´ì„œ ê³„ì¸µë³„ë¡œ ë‹¨ë…ìœ¼ë¡œ<br />
í…ŒìŠ¤íŠ¸í•  ìˆ˜ ìˆëŠ” Mockitoë¼ëŠ” ì¢‹ì€ APIë¥¼ ë°°ì› ë‹¤.</p>

<p>ì˜¤ëŠ˜ì€ ì´ê²ƒì— ì—°ì¥ì„ ìƒì¸ API ë¬¸ì„œí™”ì— ëŒ€í•´ ê³µë¶€í•´ë³´ëŠ” ë‚ ì´ë‹¤.</p>

<p><br /></p>

<h2 id="spring-rest-docs">Spring Rest Docs</h2>

<p>API ë¬¸ì„œí™”ë¼ê³ í•˜ë©´<br />
í´ë¼ì´ì–¸íŠ¸ì—ì„œ REST API ë°±ì—”ë“œ ì• í”Œë¦¬ì¼€ì´ì—<br />
ìš”ì²­ì„ ì „ì†¡í•˜ê¸° ìœ„í•´ì„œ ì•Œì•„ ë˜ëŠ” ìš”ì²­ ì •ë¥¼ ë¬¸ì„œë¡œ ì •ë¦¬í•œ ê²ƒì´ë‹¤.<br />
(URI, request body, query parameter ë“±..)</p>

<p>Spring Rest DocsëŠ” ì´ ë¬¸ì„œë¥¼ ìë™ìœ¼ë¡œ ë§Œë“¤ì–´ì£¼ëŠ” APIì´ë‹¤.<br />
ê¸°ì¡´ì—ëŠ” Swagger ì˜¤í”ˆ APIë¥¼ ë§ì´ ì´ìš©í•˜ì˜€ë‹¤ê³  í•œë‹¤.</p>

<p>Spring Rest Docs ë¬¸ì„œ ìƒì„± íë¦„<br />
í…ŒìŠ¤íŠ¸ ì½”ë“œ ì‘ì„±</p>
<ol>
  <li>test í…ŒìŠ¤í¬ ì‹¤í–‰</li>
  <li>í…ŒìŠ¤íŠ¸ ê²°ê³¼ Passed / Failed 1ë²ˆìœ¼ë¡œ ë³µê·€</li>
  <li>API ë¬¸ì„œ ìŠ¤ë‹ˆí« ìƒì„±(.adoc)</li>
  <li>API ë¬¸ì„œ ìƒì„±(.adoc)</li>
  <li>API ë¬¸ì„œ -&gt; HTMLë¡œ ë³€í™˜</li>
</ol>

<p>ìœ„ì™€ ê°™ì€ íë¦„ìœ¼ë¡œ API ë¬¸ì„œê°€ ìƒì„±ë˜ë©°<br />
í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ì— í†µê³¼í•œ í…ŒìŠ¤íŠ¸ì˜ API ë¬¸ì„œ <strong>ìŠ¤ë‹ˆí•</strong>ì´ ìƒì„±ëœë‹¤.<br />
*ìŠ¤ë‹ˆí•: ë¬¸ì„œì˜ ì¼ë¶€ ì¡°ê°ì´ë¼ ìƒê°í•˜ë©´ ëœë‹¤.</p>

<p>Spring Rest Docsë¥¼ ì‚¬ìš©í•˜ê¸° ìœ„í•´ ì‚¬ì „ ì‘ì—…ì„ í•˜ì—¬ì•¼í•œë‹¤.<br />
build.gradleì˜ ì„¤ì •í•´ì£¼ì</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">plugins</span> <span class="o">{</span>
	<span class="n">id</span> <span class="s">"org.asciidoctor.jvm.convert"</span> <span class="n">version</span> <span class="s">"3.3.2"</span>
        <span class="o">...</span>
<span class="o">}</span>

<span class="o">...</span>

<span class="n">ext</span> <span class="o">{</span>
	<span class="n">set</span><span class="o">(</span><span class="err">'</span><span class="n">snippetsDir</span><span class="err">'</span><span class="o">,</span> <span class="n">file</span><span class="o">(</span><span class="s">"build/generated-snippets"</span><span class="o">))</span>    <span class="c1">// ìŠ¤ë‹ˆí« ìƒì„± ê²½ë¡œ ì„¤ì •</span>
<span class="o">}</span>

<span class="n">configurations</span> <span class="o">{</span>
	<span class="n">asciidoctorExtensions</span> <span class="c1">// AsciiDoctor ì˜ì¡´ê·¸ë£¹ ì§€ì •            </span>
<span class="o">}</span>

<span class="n">dependencies</span> <span class="o">{</span>
    <span class="c1">// ì˜ì¡´ë¼ì´ë¸ŒëŸ¬ë¦¬ ì¶”ê°€ </span>
	<span class="n">testImplementation</span> <span class="err">'</span><span class="n">org</span><span class="o">.</span><span class="na">springframework</span><span class="o">.</span><span class="na">restdocs</span><span class="o">:</span><span class="n">spring</span><span class="o">-</span><span class="n">restdocs</span><span class="o">-</span><span class="n">mockmvc</span><span class="err">'</span>                         
	<span class="n">asciidoctorExtensions</span> <span class="err">'</span><span class="n">org</span><span class="o">.</span><span class="na">springframework</span><span class="o">.</span><span class="na">restdocs</span><span class="o">:</span><span class="n">spring</span><span class="o">-</span><span class="n">restdocs</span><span class="o">-</span><span class="n">asciidoctor</span><span class="err">'</span>
        <span class="o">...</span>
<span class="o">}</span>

<span class="c1">// test taskì‹¤í–‰ ì‹œ, API ë¬¸ì„œ ìƒì„± ìŠ¤ë‹ˆí• ê²½ë¡œë¥¼ ì„¤ì •</span>
<span class="n">tasks</span><span class="o">.</span><span class="na">named</span><span class="o">(</span><span class="err">'</span><span class="n">test</span><span class="err">'</span><span class="o">)</span> <span class="o">{</span>
	<span class="n">outputs</span><span class="o">.</span><span class="na">dir</span> <span class="n">snippetsDir</span>
	<span class="nf">useJUnitPlatform</span><span class="o">()</span>
<span class="o">}</span>

<span class="c1">// Asciidoctor ê¸°ëŠ¥ì„ ì‚¬ìš©í•˜ê¸° ìœ„í•œ ì„¤ì •</span>
<span class="n">tasks</span><span class="o">.</span><span class="na">named</span><span class="o">(</span><span class="err">'</span><span class="n">asciidoctor</span><span class="err">'</span><span class="o">)</span> <span class="o">{</span>
	<span class="n">configurations</span> <span class="s">"asciidoctorExtensions"</span>
	<span class="n">inputs</span><span class="o">.</span><span class="na">dir</span> <span class="n">snippetsDir</span>
	<span class="n">dependsOn</span> <span class="n">test</span>
<span class="o">}</span>

<span class="c1">// index.html copy</span>
<span class="n">task</span> <span class="nf">copyDocument</span><span class="o">(</span><span class="nl">type:</span> <span class="nc">Copy</span><span class="o">)</span> <span class="o">{</span>
	<span class="n">dependsOn</span> <span class="n">asciidoctor</span>         
	<span class="n">from</span> <span class="nf">file</span><span class="o">(</span><span class="s">"${asciidoctor.outputDir}"</span><span class="o">)</span>  
	<span class="n">into</span> <span class="nf">file</span><span class="o">(</span><span class="s">"src/main/resources/static/docs"</span><span class="o">)</span>  
<span class="o">}</span>

<span class="c1">// copyDocumentê°€ ë¨¼ì € ì‹¤í–‰ë˜ë„ë¡ ì„¤ì •</span>
<span class="n">build</span> <span class="o">{</span>
	<span class="n">dependsOn</span> <span class="n">copyDocument</span> 
<span class="o">}</span>

<span class="c1">// bootJar task ì„¤ì •</span>
<span class="n">bootJar</span> <span class="o">{</span>
	<span class="n">dependsOn</span> <span class="n">copyDocument</span>   
	<span class="nf">from</span> <span class="o">(</span><span class="s">"${asciidoctor.outputDir}"</span><span class="o">)</span> <span class="o">{</span> 
		<span class="n">into</span> <span class="err">'</span><span class="kd">static</span><span class="o">/</span><span class="n">docs</span><span class="err">'</span>    
	<span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>build.gradle ì„¤ì •ì´ ëë‚¬ë‹¤ë©´ ì´ì œ ì½”ë“œë¥¼ ì‘ì„±í•´ë³´ì</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@WebMvcTest</span><span class="o">(</span><span class="nc">MemberController</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
<span class="nd">@MockBean</span><span class="o">(</span><span class="nc">JpaMetamodelMappingContext</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
<span class="c1">//@Transactional</span>
<span class="c1">//@SpringBootTest</span>
<span class="c1">//@AutoConfigureMockMvc</span>
<span class="nd">@AutoConfigureRestDocs</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MemberControllerRestDocsTest</span> <span class="o">{</span>
    <span class="nd">@Autowired</span>
    <span class="kd">private</span> <span class="nc">MockMvc</span> <span class="n">mockMvc</span><span class="o">;</span>

    <span class="nd">@MockBean</span>
    <span class="kd">private</span> <span class="nc">MemberService</span> <span class="n">memberService</span><span class="o">;</span>

    <span class="nd">@MockBean</span>
    <span class="kd">private</span> <span class="nc">MemberMapper</span> <span class="n">mapper</span><span class="o">;</span>

    <span class="nd">@Autowired</span>
    <span class="kd">private</span> <span class="nc">Gson</span> <span class="n">gson</span><span class="o">;</span>

    <span class="nd">@Test</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">postMemberTest</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
        <span class="nc">MemberDto</span><span class="o">.</span><span class="na">Post</span> <span class="n">post</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">MemberDto</span><span class="o">.</span><span class="na">Post</span><span class="o">(</span><span class="s">"dhfif718@naver.com"</span><span class="o">,</span> <span class="s">"ì´ì¬í˜"</span><span class="o">,</span> <span class="s">"010-1234-5678"</span><span class="o">);</span>
        <span class="nc">String</span> <span class="n">content</span> <span class="o">=</span> <span class="n">gson</span><span class="o">.</span><span class="na">toJson</span><span class="o">(</span><span class="n">post</span><span class="o">);</span>

        <span class="nc">MemberDto</span><span class="o">.</span><span class="na">response</span> <span class="n">responseDto</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">MemberDto</span><span class="o">.</span><span class="na">response</span><span class="o">(</span>
                <span class="mi">1L</span><span class="o">,</span>
                <span class="s">"dhfif718@naver.com"</span><span class="o">,</span>
                <span class="s">"ì´ì¬í˜"</span><span class="o">,</span>
                <span class="s">"010-1234-5678"</span><span class="o">,</span>
                <span class="nc">Member</span><span class="o">.</span><span class="na">MemberStatus</span><span class="o">.</span><span class="na">MEMBER_ACTIVE</span><span class="o">,</span>
                <span class="k">new</span> <span class="nf">Stamp</span><span class="o">()</span>
        <span class="o">);</span>

        <span class="n">given</span><span class="o">(</span><span class="n">mapper</span><span class="o">.</span><span class="na">memberPostToMember</span><span class="o">(</span><span class="nc">Mockito</span><span class="o">.</span><span class="na">any</span><span class="o">(</span><span class="nc">MemberDto</span><span class="o">.</span><span class="na">Post</span><span class="o">.</span><span class="na">class</span><span class="o">))).</span><span class="na">willReturn</span><span class="o">(</span><span class="k">new</span> <span class="nc">Member</span><span class="o">());</span>
        <span class="n">given</span><span class="o">(</span><span class="n">memberService</span><span class="o">.</span><span class="na">createMember</span><span class="o">(</span><span class="nc">Mockito</span><span class="o">.</span><span class="na">any</span><span class="o">(</span><span class="nc">Member</span><span class="o">.</span><span class="na">class</span><span class="o">))).</span><span class="na">willReturn</span><span class="o">(</span><span class="k">new</span> <span class="nc">Member</span><span class="o">());</span>
        <span class="n">given</span><span class="o">(</span><span class="n">mapper</span><span class="o">.</span><span class="na">memberToMemberResponse</span><span class="o">(</span><span class="nc">Mockito</span><span class="o">.</span><span class="na">any</span><span class="o">(</span><span class="nc">Member</span><span class="o">.</span><span class="na">class</span><span class="o">))).</span><span class="na">willReturn</span><span class="o">(</span><span class="n">responseDto</span><span class="o">);</span>

        <span class="nc">ResultActions</span> <span class="n">actions</span> <span class="o">=</span> <span class="n">mockMvc</span><span class="o">.</span><span class="na">perform</span><span class="o">(</span>
                <span class="n">post</span><span class="o">(</span><span class="s">"/api/members"</span><span class="o">)</span>
                        <span class="o">.</span><span class="na">accept</span><span class="o">(</span><span class="nc">MediaType</span><span class="o">.</span><span class="na">APPLICATION_JSON</span><span class="o">)</span>
                        <span class="o">.</span><span class="na">contentType</span><span class="o">(</span><span class="nc">MediaType</span><span class="o">.</span><span class="na">APPLICATION_JSON</span><span class="o">)</span>
                        <span class="o">.</span><span class="na">content</span><span class="o">(</span><span class="n">content</span><span class="o">)</span>
        <span class="o">);</span>


        <span class="n">actions</span>
                <span class="o">.</span><span class="na">andExpect</span><span class="o">(</span><span class="n">status</span><span class="o">().</span><span class="na">isCreated</span><span class="o">())</span>
                <span class="o">.</span><span class="na">andExpect</span><span class="o">(</span><span class="n">jsonPath</span><span class="o">(</span><span class="s">"$.data.email"</span><span class="o">).</span><span class="na">value</span><span class="o">(</span><span class="n">post</span><span class="o">.</span><span class="na">getEmail</span><span class="o">()))</span>
                <span class="o">.</span><span class="na">andExpect</span><span class="o">(</span><span class="n">jsonPath</span><span class="o">(</span><span class="s">"$.data.name"</span><span class="o">).</span><span class="na">value</span><span class="o">(</span><span class="n">post</span><span class="o">.</span><span class="na">getName</span><span class="o">()))</span>
                <span class="o">.</span><span class="na">andExpect</span><span class="o">(</span><span class="n">jsonPath</span><span class="o">(</span><span class="s">"$.data.phone"</span><span class="o">).</span><span class="na">value</span><span class="o">(</span><span class="n">post</span><span class="o">.</span><span class="na">getPhone</span><span class="o">()))</span>

                <span class="o">.</span><span class="na">andDo</span><span class="o">(</span><span class="n">document</span><span class="o">(</span>
                        <span class="s">"post-member"</span><span class="o">,</span>
                        <span class="n">getRequestPreProcessor</span><span class="o">(),</span>
                        <span class="n">getResponsePreProcessor</span><span class="o">(),</span>
                        <span class="n">requestFields</span><span class="o">(</span>
                                <span class="nc">List</span><span class="o">.</span><span class="na">of</span><span class="o">(</span>
                                        <span class="n">fieldWithPath</span><span class="o">(</span><span class="s">"email"</span><span class="o">).</span><span class="na">type</span><span class="o">(</span><span class="nc">JsonFieldType</span><span class="o">.</span><span class="na">STRING</span><span class="o">).</span><span class="na">description</span><span class="o">(</span><span class="s">"ì´ë©”ì¼"</span><span class="o">),</span>
                                        <span class="n">fieldWithPath</span><span class="o">(</span><span class="s">"name"</span><span class="o">).</span><span class="na">type</span><span class="o">(</span><span class="nc">JsonFieldType</span><span class="o">.</span><span class="na">STRING</span><span class="o">).</span><span class="na">description</span><span class="o">(</span><span class="s">"ì´ë¦„"</span><span class="o">),</span>
                                        <span class="n">fieldWithPath</span><span class="o">(</span><span class="s">"phone"</span><span class="o">).</span><span class="na">type</span><span class="o">(</span><span class="nc">JsonFieldType</span><span class="o">.</span><span class="na">STRING</span><span class="o">).</span><span class="na">description</span><span class="o">(</span><span class="s">"íœ´ëŒ€í° ë²ˆí˜¸"</span><span class="o">)</span>
                                <span class="o">)</span>
                        <span class="o">),</span>
                        <span class="n">responseFields</span><span class="o">(</span>
                                <span class="nc">List</span><span class="o">.</span><span class="na">of</span><span class="o">(</span>
                                        <span class="n">fieldWithPath</span><span class="o">(</span><span class="s">"data"</span><span class="o">).</span><span class="na">type</span><span class="o">(</span><span class="nc">JsonFieldType</span><span class="o">.</span><span class="na">OBJECT</span><span class="o">).</span><span class="na">description</span><span class="o">(</span><span class="s">"ê²°ê³¼ ë°ì´í„°"</span><span class="o">),</span>
                                        <span class="n">fieldWithPath</span><span class="o">(</span><span class="s">"data.memberId"</span><span class="o">).</span><span class="na">type</span><span class="o">(</span><span class="nc">JsonFieldType</span><span class="o">.</span><span class="na">NUMBER</span><span class="o">).</span><span class="na">description</span><span class="o">(</span><span class="s">"íšŒì› ì‹ë³„ì"</span><span class="o">),</span>
                                        <span class="n">fieldWithPath</span><span class="o">(</span><span class="s">"data.email"</span><span class="o">).</span><span class="na">type</span><span class="o">(</span><span class="nc">JsonFieldType</span><span class="o">.</span><span class="na">STRING</span><span class="o">).</span><span class="na">description</span><span class="o">(</span><span class="s">"ì´ë©”ì¼"</span><span class="o">),</span>
                                        <span class="n">fieldWithPath</span><span class="o">(</span><span class="s">"data.name"</span><span class="o">).</span><span class="na">type</span><span class="o">(</span><span class="nc">JsonFieldType</span><span class="o">.</span><span class="na">STRING</span><span class="o">).</span><span class="na">description</span><span class="o">(</span><span class="s">"ì´ë¦„"</span><span class="o">),</span>
                                        <span class="n">fieldWithPath</span><span class="o">(</span><span class="s">"data.phone"</span><span class="o">).</span><span class="na">type</span><span class="o">(</span><span class="nc">JsonFieldType</span><span class="o">.</span><span class="na">STRING</span><span class="o">).</span><span class="na">description</span><span class="o">(</span><span class="s">"íœ´ëŒ€í° ë²ˆí˜¸"</span><span class="o">),</span>
                                        <span class="n">fieldWithPath</span><span class="o">(</span><span class="s">"data.memberStatus"</span><span class="o">).</span><span class="na">type</span><span class="o">(</span><span class="nc">JsonFieldType</span><span class="o">.</span><span class="na">STRING</span><span class="o">).</span><span class="na">description</span><span class="o">(</span><span class="s">"íšŒì› ìƒíƒœ"</span><span class="o">),</span>
                                        <span class="n">fieldWithPath</span><span class="o">(</span><span class="s">"data.stamp"</span><span class="o">).</span><span class="na">type</span><span class="o">(</span><span class="nc">JsonFieldType</span><span class="o">.</span><span class="na">NUMBER</span><span class="o">).</span><span class="na">description</span><span class="o">(</span><span class="s">"ìŠ¤íƒ¬í”„ ê°¯ìˆ˜"</span><span class="o">)</span>
                                <span class="o">)</span>
                        <span class="o">)</span>
                <span class="o">));</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>ê¸°ì¡´ ì½”ë“œì™€ ë‹¬ë¼ì§„ì ì€ 
@WebMvcTest(MemberController.class)          <br />
@MockBean(JpaMetamodelMappingContext.class)  <br />
ì–´ë…¸í…Œì´ì…˜ìœ¼ë¡œ ë³€ê²½í•˜ì˜€ë‹¤ëŠ” ì ì´ë‹¤.<br />
ì´ì „ì— SpringBootTestì™€ AutoConfigureMockMvcë¥¼ ì‚¬ìš©í–ˆë˜ ë¶€ë¶„ì„<br />
ë³€ê²½í•˜ì˜€ë‹¤. WebMveTestë¡œ ë³€ê²½ í•¨ìœ¼ë¡œì¨ Controller ê³„ì¸µì— ì‚¬ìš©í•˜ëŠ”<br />
Beanë§Œ ë“±ë¡í•˜ê¸°ë•Œë¬¸ì— ìƒëŒ€ì ìœ¼ë¡œ ì†ë„ê°€ ë¹ ë¥´ë‹¤ê³  í•œë‹¤.</p>

<p>ë˜í•œ, @AutoConfigureRestDocs ì–´ë…¸í…Œì´ì…˜ì„ ë¶™ì—¬ì£¼ì—ˆê³ <br />
.andDo(docment())ë¥¼ ì´ìš©í•´ Rest Docsì— í•„ìš”í•œ ì •ë³´ë¥¼ ë³´ë‚´ì£¼ì—ˆë‹¤.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">static</span> <span class="n">org</span><span class="o">.</span><span class="na">springframework</span><span class="o">.</span><span class="na">restdocs</span><span class="o">.</span><span class="na">payload</span><span class="o">.</span><span class="na">PayloadDocumentation</span><span class="o">.*;</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">org</span><span class="o">.</span><span class="na">springframework</span><span class="o">.</span><span class="na">restdocs</span><span class="o">.</span><span class="na">mockmvc</span><span class="o">.</span><span class="na">MockMvcRestDocumentation</span><span class="o">.</span><span class="na">document</span><span class="o">;</span>
</code></pre></div></div>
<p>document(), fieldWithPath(), requestFields() <br />
í•„ìš”í•œ ì •ë³´ë¥¼ ë§Œë“œëŠ” ê³¼ì •ì—ì„œ ìœ„ apië¥¼ ì‚¬ìš©í•˜ê¸°ìœ„í•´ì„ <br />
PayloadDocumentation, MockMvcRestDocumentationì„ import í•´ì£¼ì–´ì•¼í•œë‹¤.</p>

<p>ê·¸ë¦¬ê³  patch í•¸ë“¤ëŸ¬ ë©”ì„œë“œì— ëŒ€í•´ path parameterë¥¼ ì´ìš©í•  ê²½ìš°</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">static</span> <span class="n">org</span><span class="o">.</span><span class="na">springframework</span><span class="o">.</span><span class="na">restdocs</span><span class="o">.</span><span class="na">request</span><span class="o">.</span><span class="na">RequestDocumentation</span><span class="o">.</span><span class="na">pathParameters</span><span class="o">;</span>
</code></pre></div></div>
<p>ë¥¼ ìŠ¤íƒœí‹±ìœ¼ë¡œ import í•´ì£¼ë©´ ì‚¬ìš©ì´ ê°€ëŠ¥í•˜ë‹¤.</p>

<p><br /></p>

<p>Document()ì˜ ë§¤ê°œë³€ìˆ˜ë¡œ ì „ë‹¬í•˜ê¸°ìœ„í•´ <br />
OperationRequestPreprocessor<br />
OperationResponsePreprocessor<br />
í´ë˜ìŠ¤ë¥¼ ì´ìš©í•´ ì¸í„°í˜ì´ìŠ¤ì•ˆì— ì •ì  ë©”ì„œë“œë¥¼ ë§Œë“¤ì–´ êµ¬í˜„í•˜ì˜€ë‹¤.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">ApiDocumentUtils</span> <span class="o">{</span>
    <span class="kd">static</span> <span class="nc">OperationRequestPreprocessor</span> <span class="nf">getRequestPreProcessor</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="nf">preprocessRequest</span><span class="o">(</span><span class="n">prettyPrint</span><span class="o">());</span>
    <span class="o">}</span>

    <span class="kd">static</span> <span class="nc">OperationResponsePreprocessor</span> <span class="nf">getResponsePreProcessor</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="nf">preprocessResponse</span><span class="o">(</span><span class="n">prettyPrint</span><span class="o">());</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>
<p>getRequestPreProcessor() <br />
getResponsePreProcessor()<br />
ì•„ë¦¬ëŠ” ë©”ì„œë“œë¥¼ ë§Œë“¤ì—ˆê³  í•´ë‹¹ ë‚´ìš©ì—” OperationPreprocessor í´ë˜ìŠ¤ì˜<br />
ë©”ì„œë“œì¸ prettyPrint()ë¡œ ê°ì²´ë¥¼ ì£¼ì…í•´ì£¼ì—ˆë‹¤.</p>

<p>API ë¬¸ì„œë¥¼ ìƒì„± ì „ ì „ì²˜ë¦¬ë¥¼ ìˆ˜í–‰í•˜ëŠ” ê¸°ëŠ¥ì´ë¼ëŠ”ë°<br />
í•´ë‹¹ ë‚´ìš©ì— ëŒ€í•´ì„œëŠ” ì¡°ê¸ˆë” ê¹Šì€ í•™ìŠµì´ í•„ìš”í•´ ë³´ì¸ë‹¤.</p>

<p>ë˜í•œ Document() ë§¤ê°œë³€ìˆ˜ì¸<br />
requestFieldsì™€ responseFieldsë¥¼ List.ofë¡œ <br />
ë¬¸ì„œí™” ì‹œí‚¬ ë‚´ìš©ì„ ì„¤ëª…ê³¼ í•¨ê»˜ ë‹´ì•„ ì „ë‹¬í•˜ë„ë¡<br />
ë‚´ìš©ì„ ì‘ì„±í•˜ì˜€ë‹¤.</p>

<p><br /></p>

<p>ì—¬ê¸°ê¹Œì§€ ì‘ì„±í›„ í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ë¥¼ ì‹¤í–‰í•˜ë©´</p>

<p><img src="https://lh3.googleusercontent.com/u/0/drive-viewer/AJc5JmQkvJ4wiPE1h_7rk6WxVw-45PCgHTiM7tPBoXPQp9BI9-0QNhkyLJ9dvyFDgh1FIcoc9NAzwN1MqviHV234SBgKq-Fudw=w3024-h1620" alt="image" class="align-left" style="max-width: 100%" /></p>

<p>ìš°ë¦¬ê°€ build.graldeì—ì„œ extë¡œ ì„¤ì •í•´ë†“ì€ ê²½ë¡œ<br />
build/generated-snippets ì•ˆì— ìŠ¤ë‹ˆí• ì‹ë³„ìë¡œ<br />
post-memberë¡œ ì§€ì •í•´ì—¬ í•´ë‹¹ í´ë”ì•ˆì— .adoc íŒŒì¼ì´ ìƒê¸´ ëª¨ìŠµì„ ë³¼ ìˆ˜ ìˆë‹¤.</p>

<p>ì‹¤ì œ ë‚´ìš©ì„ í™•ì¸í•´ë³´ë©´ ìš°ë¦¬ê°€ ì›í•˜ëŠ”<br />
API ë‚´ìš©ë“¤ì´ ë‹´ê²¨ì ¸ìˆë‹¤.</p>

<p>ê·¸ë¦¬ê³  Gradle í”„ë¡œì íŠ¸ì˜ ê²½ìš°<br />
src/docs/asciidoc í´ë” ê²½ë¡œì—ì„œ index.adoc íŒŒì¼ì„ ìƒì„±í•œë‹¤.</p>

<p><img src="https://lh3.googleusercontent.com/u/0/drive-viewer/AJc5JmSP6yS5JEcQYvdmCiJBkQnCg6AjwPkGkEPL4LLA99PvGdapaJxSgq3S0yUGWaItGJc-VGK1hETfSnrBJQuxYueo82_6=w3024-h1620" alt="image" class="align-left" style="max-width: 100%" /></p>

<p>index.adocíŒŒì¼ì— Asciidoc ë¬¸ë²•ìœ¼ë¡œ<br />
í…œí”Œë¦¿ ì½”ë“œë¥¼ ë„£ì–´ Gradleì˜ :build, :bootJarì„  <br />
ì‹¤í–‰ì‹œì¼œì£¼ë©´ index.html</p>

<p>gradleì˜ ì„¤ì •í–ˆë˜ task copyDocumentì˜ ê²½ë¡œì¸<br />
src/main/resources/static/docs ì•ˆì— index.html íŒŒì¼ë¡œ  <br />
ìš°ë¦¬ì˜ APIë¬¸ì„œê°€ ë³€í™˜ëœ ëª¨ìŠµì„ ë³¼ ìˆ˜ ìˆë‹¤.</p>

<p>ê·¸ë¦¬ê³  ìµœì¢…ì ìœ¼ë¡œ Spring Bootë¥¼ ì‹¤í–‰ì‹œì¼œ<br />
index.htmlì— ì ‘ê·¼í•´ë³´ë©´</p>

<p><img src="https://lh3.googleusercontent.com/u/0/drive-viewer/AJc5JmRVSbop-au0zBS7T5VYwEbIIprDpuG7rQJQI3FpLPJncTS0N-xC6MLCi11JQdcFK3cWv2I50pjxUYkTgLFp5FArYVMaog=w3024-h1620" alt="image" class="align-left" style="max-width: 100%" /></p>

<p>ìš°ë¦¬ê°€ ì›í•˜ëŠ” ëª¨ìŠµëŒ€ë¡œ API ë¬¸ì„œê°€ ì‘ì„±ëœ ëª¨ìŠµì„ í™•ì¸í•´ ë³¼ ìˆ˜ ìˆë‹¤.<br />
(í•´ë‹¹ í…œí”Œë¦¿ ì½”ë“œëŠ” ì½”ë“œìŠ¤í…Œì´ì¸  êµìœ¡ìë£Œë¡œ ì œê³µëœ í…œí”Œë¦¿ì´ë¯€ë¡œ<br />
í…œí”Œë¦¿ ì½”ë“œëŠ” ë”°ë¡œ ì˜¬ë¦¬ì§€ ì•Šê² ìŠµë‹ˆë‹¤!)</p>

<hr />

<p>ì´ë ‡ê²Œ ì˜¤ëŠ˜ì€ ê°„ë‹¨í•œ ê²ƒ ê°™ìœ¼ë©´ì„œë„ ì–´ë ¤ìš´â€¦<br />
SpringRestDocsë¥¼ ì‚¬ìš©í•˜ëŠ” ë²•ì„ ì•Œì•„ë³´ì•˜ê³ </p>

<p>ì´ˆê¸° ì…‹íŒ…ë§Œ gradleì— ì˜ í•´ë†“ê³  í…œí”Œë¦¿ ì½”ë“œë§Œ ì¤€ë¹„ë˜ì–´ìˆë‹¤ë©´<br />
í¬ê²Œ ì–´ë ¤ìš´ì ì€ ì—†ì—ˆë˜ ê²ƒ ê°™ë‹¤.</p>

<p>ë§¤ìš° ìœ ìµí–ˆë˜ Testì¼€ì´ìŠ¤ë¥¼ ì´ìš©í•œ API ìë™í™” ì‘ì—….<br />
ì—„ì²­ ì‹ ê¸°í•˜ê³  ì¬ë°Œì—ˆë‹¤.</p>

<p>ì˜¤ëŠ˜ ê³µë¶€ëŠ” ì—¬ê¸°ì„œ ë !!</p>

<p><br /></p>

<p><span style="color:#994C00"><strong>ì˜¤ëŠ˜ì˜ ì»¤í”¼ëŸ‰</strong></span>: â˜•ï¸ â˜•ï¸<br />
<strong>ì˜¤ëŠ˜ì˜ ì ì‹¬</strong>: í•«ë„ê·¸, ë¹µ</p>]]></content><author><name>LEE JAEHYEOK</name></author><category term="TIL" /><category term="TIL" /><category term="ë¶€íŠ¸ìº í”„" /><category term="ì½”ë“œìŠ¤í…Œì´ì¸ " /><summary type="html"><![CDATA[ìš”ë²ˆì£¼ë„ í•œì£¼ê°€ ì§€ë‚˜ê°„ë‹¤. ì–¼ë§ˆ ê³µë¶€í•œ ê²ƒ ê°™ì€ëŠë‚Œì´ ì•„ë‹Œë° ë²Œì¨ ì›”ìš”ì¼ì´ì§€ë‚˜ ê¸ˆìš”ì¼ì´ ë˜ì—ˆë‹¤.]]></summary></entry><entry><title type="html">TIL) JUnit 3</title><link href="http://localhost:4000/til/2022/11/10/til.html" rel="alternate" type="text/html" title="TIL) JUnit 3" /><published>2022-11-10T00:00:00+09:00</published><updated>2022-11-10T00:00:00+09:00</updated><id>http://localhost:4000/til/2022/11/10/til</id><content type="html" xml:base="http://localhost:4000/til/2022/11/10/til.html"><![CDATA[<p><img src="https://lh3.googleusercontent.com/u/0/drive-viewer/AFDK6gPEtAIsYVHYZngjJKd7DhE7QvwO4nT5RQrbx3n7Hgtx83b5wSHcAK9fgNs42_a12-wjBXSB7EmmaORw8NUf4CEwXDJY2g=w1920-h921" alt="image" class="align-left" style="max-width: 100%" /></p>

<p>ë“œì´ì–´ JUnit ê´€ë ¨í•´ì„œ ë§ˆì§€ë§‰ ì‹œê°„ì´ë‹¤.<br />
í…ŒìŠ¤íŠ¸ í”„ë¡œê·¸ë¨ì„ ì‘ì„±í•˜ëŠ” ì—°ìŠµë„ í‹ˆí‹ˆíˆ í•´ë‘¬ì•¼<br />
ê¹Œë¨¹ì§€ ì•Šê³  ê³„ì¸µë³„ í…ŒìŠ¤íŠ¸ê°€ ì›í™œí•˜ê²Œ ì˜ ë  ê²ƒ ê°™ë‹¤.</p>

<p>ìƒˆë¡œìš´ê±¸ ì•Œë©´ì•Œìˆ˜ë¡ ì¬ë¯¸ìˆì§€ë§Œ<br />
ë‚´ ë‡Œìš©ëŸ‰ì˜ ì´ˆê³¼ë¡œ,,, ì „ì— ë°°ì› ë˜ ë‚´ìš©ë“¤ì´ ìŠ¬ìŠ¬<br />
íœ˜ë°œë˜ê¸° ì‹œì‘í•œë‹¤ ã…‹ã…‹â€¦</p>

<p>ë³µìŠµ í•˜ëŠ”ì‹œê°„ë„ ë§ˆë ¨í•´ì•¼ í•  ê²ƒ ê°™ì€ ëŠë‚Œì´ë‹¤</p>

<hr />

<p>ì–´ì œëŠ” <a href="https://mycatlikeschuru.github.io/til/2022/11/09/til.html">ê³„ì¸µë³„ í…ŒìŠ¤íŠ¸</a>ì— ëŒ€í•´ì„œ ê°„ë‹¨í•˜ê²Œ í¬ìŠ¤íŒ… í•´ë³´ì•˜ë‹¤.<br />
ì‚¬ì‹¤ ê³„ì¸µë³„ í…ŒìŠ¤íŠ¸ë¼ê³  ì‘ì„±ì„ í–ˆì§€ë§Œ<br />
ì§„ì •í•œ Slice í…ŒìŠ¤íŠ¸ê°€ ë˜ëŠ” í”„ë¡œê·¸ë¨ì´ ì•„ë‹ˆì˜€ê³ <br />
ê³„ì¸µë³„ í…ŒìŠ¤íŠ¸ë¥¼ ìœ„í•œ ë¬¸ë²•ì„ ì‚¬ì „ì— ê³µë¶€í•œëŠ ì‹œê°„ì´ì—ˆë‹¤.</p>

<p>ì˜¤ëŠ˜ì€ ì •ë§ ì• í”Œë¦¬ì¼€ì´ì…˜ ê³„ì¸µë³„ë¡œ í…ŒìŠ¤íŠ¸ë¥¼<br />
ì§„í–‰í•˜ë ¤ë©´ ì–´ë–»ê²Œí•´ì•¼í•˜ëŠ”ì§€?</p>

<p>í…ŒìŠ¤íŒ… ê¸°ìˆ ì— ëŒ€í•´ ë°°ì›Œë³´ëŠ” ì‹œê°„ì´ë‹¤.</p>

<h2 id="mockito">Mockito</h2>

<p>ì˜¤ëŠ˜ ê³µë¶€í•  apiëŠ” Mockitoë¼ëŠ” í…ŒìŠ¤íŠ¸ë¥¼ ìœ„í•œ apiì´ë‹¤.</p>

<p>ìš°ë¦¬ê°€ í‰ìƒì‹œì— Mockì´ë¼ê³ í•˜ë©´ ê°€ì§œë¥¼ ì–˜ê¸°í•œë‹¤.<br />
ëª©ì—…í°ê³¼ ê°™ì´ ì‹¤ì œ ê¸°ëŠ¥ì€ ì—†ì§€ëŠ” ëª¨ì–‘ë§ŒìˆëŠ” ê°€ì§œì´ë‹¤.</p>

<p>ì´ì™€ ê°™ì€ ê¸°ìˆ ë¡œ ê°ì²´ë¥¼ ê°€ì§œë¡œ ë§Œë“¤ì–´ ê³„ì¸µë³„ í…ŒìŠ¤íŠ¸í•˜ëŠ” ë°©ë²•ì´ë‹¤.</p>

<p>ë„ˆë¬´ë‚˜ê²Œ ë‹¹ì—°í•˜ê²Œë„ ë‹¤ë¥¸ ê³„ì¸µì„ ì ‘ê·¼í•˜ì§€ ì•Šìœ¼ë‹ˆ<br />
í…ŒìŠ¤íŠ¸ì‹œê°„ì´ í™•ì‹¤íˆ ë¹¨ë¼ì§€ê²Œë˜ë©°<br />
ê³„ì¸µë³„ë¡œ í…ŒìŠ¤íŠ¸ë¥¼ í•´ë³¼ ìˆ˜ ìˆë‹¤ëŠ” ì¥ì ì´ ìˆë‹¤.</p>

<h3 id="controller-ê³„ì¸µ-slice-test">Controller ê³„ì¸µ Slice Test</h3>

<p><img src="https://lh3.googleusercontent.com/u/0/drive-viewer/AJc5JmTnXpBWUcCganXkdulhuUs7yIiBV4jduubimbBhkIH1II-o-KZ6mUljknzsuWm-0Hf-czO1b7FkvAxK-aJEpMiHDGar9Q=w1920-h921" alt="image" class="align-left" style="max-width: 100%" /></p>

<p>ê°„ë‹¨í•˜ê²Œ Controller ê³„ì¸µë§Œ ë‘ê³  ì–˜ê¸°í•´ë³´ì<br />
ì–´ì œ <a href="https://mycatlikeschuru.github.io/til/2022/11/09/til.html">JUnit 2</a> ì±•í„°ì—ì„œ í…ŒìŠ¤íŠ¸í•´ë³´ì•˜ë˜ê±´<br />
ì™¼ìª½ì—ì„œ ë³´ëŠ” ê²ƒê³¼ ê°™ì€ í˜•íƒœì˜ â€˜í†µí•© í…ŒìŠ¤íŠ¸â€™ë¼ê³  ë³¼ ìˆ˜ ìˆë‹¤.</p>

<p>ì´ìœ ëŠ” í•¸ë“¤ëŸ¬ë©”ì„œë“œë¥¼ í˜¸ì¶œí•´ Service -&gt; Repository ê¹Œì§€<br />
ì ‘ê·¼í•´ Controller ê³„ì¸µì´ ì˜ ì‹¤í–‰ë˜ëŠ”ì§€ë¥¼ ì•Œì•„ë³´ì•˜ê¸° ë•Œë¬¸ì´ë‹¤.</p>

<p>ì´ì œ ìš°ë¦¬ê°€ í•´ë³¼ê±°ëŠ” Mock ê°ì²´ë¥¼ ë§Œë“¤ì–´<br />
Testë¥¼ í˜¸ì¶œí•˜ë©´ Controller ê³„ì¸µë§Œ ë…ë‹¨ì ìœ¼ë¡œ<br />
í…ŒìŠ¤íŠ¸í•  ìˆ˜ ìˆëŠ” ë°©ë²•ì´ë‹¤.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Transactional</span>
<span class="nd">@SpringBootTest</span>
<span class="nd">@AutoConfigureMockMvc</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MemberControllerHomeworkTest</span> <span class="o">{</span>
    <span class="nd">@Autowired</span>
    <span class="kd">private</span> <span class="nc">MockMvc</span> <span class="n">mockMvc</span><span class="o">;</span>

    <span class="nd">@Autowired</span>
    <span class="kd">private</span> <span class="nc">Gson</span> <span class="n">gson</span><span class="o">;</span>

    <span class="nd">@MockBean</span> <span class="c1">// ì¶”ê°€ë¶€ë¶„</span>
    <span class="kd">private</span> <span class="nc">MemberService</span> <span class="n">memberService</span><span class="o">;</span>

    <span class="nd">@Autowired</span> <span class="c1">// mppaer ì‚¬ìš©ì„ ìœ„í•œ ì¶”ê°€</span>
    <span class="kd">private</span> <span class="nc">MemberMapper</span> <span class="n">mapper</span><span class="o">;</span>

    <span class="nd">@Test</span>
    <span class="kt">void</span> <span class="nf">postMemberTest</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
        <span class="o">...</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>
<p>ì½”ë“œë¥¼ ì˜ˆì œë¡œ ì‚´í´ë³´ì</p>

<p>ì´ì „ê³¼ ë‹¬ë¼ì§„ì ì€ @MockBeanì´ ì¶”ê°€ë˜ì—ˆë‹¤ëŠ” ì ì´ë‹¤.<br />
SpringBootë¥¼ ì‚¬ìš©í•˜ëŠ” ì–´ë…¸í…Œì´ì…˜ì„ ë‹¬ì•„ì£¼ì—ˆê¸°ë•Œë¬¸ì—</p>

<p>@MockBeanì„ í•„ë“œë³€ìˆ˜ì— ë¶™ì—¬ì£¼ë©´<br />
í•´ë‹¹ ê°ì²´ì— Beanê³¼ ê°™ì€ íƒ€ì…ì˜ ê°ì²´ê°€ DIëœë‹¤.</p>

<p>ì¦‰ MemberService í´ë˜ìŠ¤ ê°ì²´ê°€ ì£¼ì…ë˜ë¯€ë¡œ<br />
ìš°ë¦¬ëŠ” ê°€ì§œë¡œ ë§Œë“¤ì–´ì§„ memberService ê°ì²´ë¡œ ë©”ì„œë“œë“¤ì„ í˜¸ì¶œí•  ìˆ˜ ìˆë‹¤.</p>

<p>@Test í”„ë¡œê·¸ë¨ì„ ì‘ì„±í•´ë³´ì</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Test</span>
<span class="kt">void</span> <span class="nf">postMemberTest</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
    <span class="nc">MemberDto</span><span class="o">.</span><span class="na">Post</span> <span class="n">post</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">MemberDto</span><span class="o">.</span><span class="na">Post</span><span class="o">(</span>
            <span class="s">"dhfif718@naver.com"</span><span class="o">,</span>
            <span class="s">"ì´ì¬í˜"</span><span class="o">,</span>
            <span class="s">"010-1234-5678"</span>
    <span class="o">);</span>

    <span class="nc">Member</span> <span class="n">member</span> <span class="o">=</span> <span class="n">mapper</span><span class="o">.</span><span class="na">memberPostToMember</span><span class="o">(</span><span class="n">post</span><span class="o">);</span>
    <span class="n">member</span><span class="o">.</span><span class="na">setStamp</span><span class="o">(</span><span class="k">new</span> <span class="nc">Stamp</span><span class="o">());</span>

    <span class="n">given</span><span class="o">(</span><span class="n">memberService</span><span class="o">.</span><span class="na">createMember</span><span class="o">(</span><span class="nc">Mockito</span><span class="o">.</span><span class="na">any</span><span class="o">(</span><span class="nc">Member</span><span class="o">.</span><span class="na">class</span><span class="o">))).</span><span class="na">willReturn</span><span class="o">(</span><span class="n">member</span><span class="o">);</span>

    <span class="nc">String</span> <span class="n">content</span> <span class="o">=</span> <span class="n">gson</span><span class="o">.</span><span class="na">toJson</span><span class="o">(</span><span class="n">post</span><span class="o">);</span>

    <span class="nc">ResultActions</span> <span class="n">actions</span> <span class="o">=</span> <span class="n">mockMvc</span><span class="o">.</span><span class="na">perform</span><span class="o">(</span>
            <span class="n">post</span><span class="o">(</span><span class="s">"/api/members"</span><span class="o">)</span>
                    <span class="o">.</span><span class="na">accept</span><span class="o">(</span><span class="nc">MediaType</span><span class="o">.</span><span class="na">APPLICATION_JSON</span><span class="o">)</span>
                    <span class="o">.</span><span class="na">contentType</span><span class="o">(</span><span class="nc">MediaType</span><span class="o">.</span><span class="na">APPLICATION_JSON</span><span class="o">)</span>
                    <span class="o">.</span><span class="na">content</span><span class="o">(</span><span class="n">content</span><span class="o">)</span>
    <span class="o">);</span>

    <span class="nc">MvcResult</span> <span class="n">result</span> <span class="o">=</span> <span class="n">actions</span>
            <span class="o">.</span><span class="na">andExpect</span><span class="o">(</span><span class="n">status</span><span class="o">().</span><span class="na">isCreated</span><span class="o">())</span>
            <span class="o">.</span><span class="na">andExpect</span><span class="o">(</span><span class="n">jsonPath</span><span class="o">(</span><span class="s">"$.data.email"</span><span class="o">).</span><span class="na">value</span><span class="o">(</span><span class="n">post</span><span class="o">.</span><span class="na">getEmail</span><span class="o">()))</span>
            <span class="o">.</span><span class="na">andExpect</span><span class="o">(</span><span class="n">jsonPath</span><span class="o">(</span><span class="s">"$.data.name"</span><span class="o">).</span><span class="na">value</span><span class="o">(</span><span class="n">post</span><span class="o">.</span><span class="na">getName</span><span class="o">()))</span>
            <span class="o">.</span><span class="na">andExpect</span><span class="o">(</span><span class="n">jsonPath</span><span class="o">(</span><span class="s">"$.data.phone"</span><span class="o">).</span><span class="na">value</span><span class="o">(</span><span class="n">post</span><span class="o">.</span><span class="na">getPhone</span><span class="o">()))</span>
            <span class="o">.</span><span class="na">andReturn</span><span class="o">();</span>
<span class="o">}</span>
</code></pre></div></div>
<p>ëŒ€ë¶€ë¶„ì€ ìë°” ë¬¸ë²•ì ì¸ ìš”ì†Œì´ê³ <br />
ì¤‘ìš”í•œ ë¶€ë¶„ì€ given(); api ìª½ì´ë‹¤.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">static</span> <span class="n">org</span><span class="o">.</span><span class="na">mockito</span><span class="o">.</span><span class="na">BDDMockito</span><span class="o">.</span><span class="na">given</span><span class="o">;</span>
</code></pre></div></div>
<p>í•´ë‹¹ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ import í•´ì•¼ ì‚¬ìš©ì´ ê°€ëŠ¥í•˜ê³ </p>

<p>given(); ë©”ì„œë“œë¥¼ í†µí•´ì„œ ìš°ë¦¬ëŠ” ê°€ì§œ ê°ì²´ë¥¼ ë§Œë“¤ ìˆ˜ ìˆë‹¤.</p>

<p>given() : ê°€ì§œë¡œ ë§Œë“¤ ë©”ì„œë“œ ì§€ì •<br />
willRetrun() : ê°€ì§œë¡œ ë§Œë“  ë°˜í™˜ ê°’ ì§€ì •<br />
ì´ë ‡ê²Œ ìƒê°í•˜ë©´ ê°„ë‹¨ í•  ê²ƒ ê°™ë‹¤.</p>

<p>ì—¬ê¸°ì„œ @MockBeanì„ í†µí•´ ì˜ì¡´ì„± ì£¼ì…ë°›ì€ ê°ì²´ì˜<br />
memberSerive.createMember()ë¥¼ given()ì•ˆì— ë„£ì–´ì£¼ì—ˆê³ <br />
í•´ë‹¹ .createMember()ì˜ ë§¤ê°œë³€ìˆ˜ê°€ Member.class íƒ€ì…ì´ë¯€ë¡œ<br />
Mockito.any(Member.class) ë¼ê³  ì„¤ì •ì„ í•´ë‘ì—ˆë‹¤.</p>

<p>ì—¬ê¸°ì„œ ë§Œì•½ ë‹¤ë¥¸ íƒ€ì…ì¼ ê²½ìš°ì—<br />
Mockito.anyInt()<br />
Mockito.anyLong()<br />
Mockito.anyString()<br />
ë“± ì—¬ëŸ¬ê°€ì§€ ë©”ì„œë“œë“¤ë„ ì œê³µí•˜ê³  ìˆë‹¤.</p>

<p><br /></p>

<p>í…ŒìŠ¤íŠ¸ ì½”ë“œë¥¼ ì´ë ‡ê²Œ ì‘ì„±í•˜ë©´<br />
ê°€ì§œê°ì²´ë¡œ ë¦¬í„´ê°’ì„ ìš°ë¦¬ê°€ ì •í•´ì„œ ë„˜ê²¨ì¤„ ìˆ˜ ìˆë‹¤.<br />
Controller ê³„ì¸µ í”„ë¡œê·¸ë¨ì„ ë´ë³´ì</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@PostMapping</span>
<span class="kd">public</span> <span class="nc">ResponseEntity</span> <span class="nf">postMember</span><span class="o">(</span><span class="nd">@Valid</span> <span class="nd">@RequestBody</span> <span class="nc">MemberDto</span><span class="o">.</span><span class="na">Post</span> <span class="n">requestBody</span><span class="o">)</span> <span class="o">{</span>
    <span class="nc">Member</span> <span class="n">member</span> <span class="o">=</span> <span class="n">mapper</span><span class="o">.</span><span class="na">memberPostToMember</span><span class="o">(</span><span class="n">requestBody</span><span class="o">);</span>
    <span class="n">member</span><span class="o">.</span><span class="na">setStamp</span><span class="o">(</span><span class="k">new</span> <span class="nc">Stamp</span><span class="o">());</span> <span class="c1">// homework solution ì¶”ê°€</span>

    <span class="nc">Member</span> <span class="n">createdMember</span> <span class="o">=</span> <span class="n">memberService</span><span class="o">.</span><span class="na">createMember</span><span class="o">(</span><span class="n">member</span><span class="o">);</span>

    <span class="k">return</span> <span class="k">new</span> <span class="nc">ResponseEntity</span><span class="o">&lt;&gt;(</span>
            <span class="k">new</span> <span class="nc">SingleResponseDto</span><span class="o">&lt;&gt;(</span><span class="n">mapper</span><span class="o">.</span><span class="na">memberToMemberResponse</span><span class="o">(</span><span class="n">createdMember</span><span class="o">)),</span>
            <span class="nc">HttpStatus</span><span class="o">.</span><span class="na">CREATED</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div></div>
<p>ìœ„ì—ì„œ ë³´ë“¯ì´ memberService.createMember(member);<br />
ë©”ì„œë“œë¥¼ í˜¸ì¶œí•˜ëŠ” ì‹œì ì—ì„œ ìš°ë¦¬ì˜ ê°€ì§œ ê°ì²´ì˜ ë°˜í™˜ê°’ì´<br />
ëŒ€ì‹  createdMember ê°ì²´ë¡œ í• ë‹¹ë˜ê²Œ ë˜ì–´ì§„ë‹¤.</p>

<p>ê·¸ë ‡ê²Œ ë˜ë©´ Service ê³„ì¸µì„ ì ‘ê·¼í•˜ì§€ì•Šê³ <br />
ìš°ë¦¬ê°€ ë§Œë“  Mockìœ¼ë¡œë§Œìœ¼ë¡œ Controllerë¥¼ í…ŒìŠ¤íŠ¸ í•´ ë³¼ ìˆ˜ ìˆëŠ” ê²ƒì´ë‹¤.</p>

<p><br /></p>

<h3 id="service-ê³„ì¸µ-slice-test">Service ê³„ì¸µ Slice Test</h3>

<p>Controller ê³„ì¸µì„ í…ŒìŠ¤íŠ¸í•  ë•Œì—ëŠ” SpringBootTestë¥¼ ì´ìš©í–ˆë‹¤.<br />
ìŠ¤í”„ë§ ë¶€íŠ¸ë¥¼ ì‹¤í–‰ì‹œí‚¤ëŠ” ì‹œê°„ë„ í¬í•¨í•˜ë©´<br />
ì‹œê°„ì´ ëŠë ¤ì§ˆ ìˆ˜ ìˆëŠ” ë‹¨ì ì´ ìˆì§€ë§Œ Controller ê³„ì¸µì€<br />
spring web servlet ê¸°ìˆ ì„ ì‚¬ìš©í•˜ê¸°ì— í¬í•¨ì‹œì¼°ì—ˆë‹¤.</p>

<p>í•˜ì§€ë§Œ Service ê³„ì¸µì€ SpringBoot ì—†ì´ë„<br />
Mockito APIë¥¼ ì´ìš©í•´ Serivce ê³„ì¸µë§Œ í…ŒìŠ¤íŠ¸ê°€ ê°€ëŠ¥í•˜ë‹¤.</p>

<p><img src="https://lh3.googleusercontent.com/u/0/drive-viewer/AJc5JmT11Owrzo9GJ8WW4G2Oo2z7sh78eNqCI7yo5XbMPJ_0mlZQKHtsqqku8nDD_99cQhCgmaZ-OBsms1m9QJdQuPEvf_ijUw=w3024-h1620" alt="image" class="align-left" style="max-width: 100%" /></p>

<p>ìœ„ì™€ ê°™ì´ í…ŒìŠ¤íŠ¸ê°€ ì´ë£¨ì–´ì§€ê³ <br />
Repository ê³„ì¸µê³¼ì˜ ì—°ê²°ë„ ëŠê³  Mock ê°ì²´ë¡œë§Œ<br />
í…ŒìŠ¤íŠ¸ë¥¼ í•  ìˆ˜ ìˆë‹¤ëŠ” ì ì´ ì¤‘ìš”í•˜ë‹¤.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@ExtendWith</span><span class="o">(</span><span class="nc">MockitoExtension</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MemberServiceMockTest</span> <span class="o">{</span>

    <span class="nd">@Mock</span>
    <span class="kd">private</span> <span class="nc">MemberRepository</span> <span class="n">memberRepository</span><span class="o">;</span>


    <span class="nd">@InjectMocks</span>
    <span class="kd">private</span> <span class="nc">MemberService</span> <span class="n">memberService</span><span class="o">;</span>

    <span class="nd">@Test</span>
    <span class="kt">void</span> <span class="nf">createMemberTest</span><span class="o">()</span>  <span class="o">{</span>
        <span class="o">...</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>
<p>Controllerê³¼ëŠ” ë‹¤ë¥´ê²Œ @ExtendWith ì–´ë…¸í…Œì´ì…˜ì„ ì´ìš©í•´<br />
Mockito APIë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.</p>

<p>ì—¬ê¸°ì„œ ìš°ë¦¬ê°€ í…ŒìŠ¤íŠ¸í•  ê³„ì¸µì€ memberService ê³„ì¸µì´ê³ <br />
ê°€ì§œë¡œ ë§Œë“¤ì–´ì•¼í•  ê°ì²´ëŠ” memberRepositoryì´ë‹¤</p>

<p>ê·¸ëŸ° ê°œë…ì—ì„œ @Mockì„ memberRepositoryì— ë¶™ì´ê³  <br />
@InjectMocksë¥¼ memberServiceì— ë¶™ì—¬ì£¼ë©´</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Transactional</span>
<span class="nd">@Service</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MemberService</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="nc">MemberRepository</span> <span class="n">memberRepository</span><span class="o">;</span>
    <span class="kd">public</span> <span class="nf">MemberService</span><span class="o">(</span><span class="nc">MemberRepository</span> <span class="n">memberRepository</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">memberRepository</span> <span class="o">=</span> <span class="n">memberRepository</span><span class="o">;</span>
    <span class="o">}</span>
    
    <span class="o">...</span>
</code></pre></div></div>
<p>Service ê³„ì¸µì˜ Repositoryì— Mockê°ì²´ê°€<br />
ìë™ìœ¼ë¡œ ì˜ì¡´ì„± ì£¼ì…ì´ëœë‹¤.</p>

<p>ê·¸ë¦¬í•˜ì—¬ ìš°ë¦¬ê°€ Repositoryë¥¼ Mock ê°ì²´ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ê²ƒì´ë‹¤.</p>

<p><br /></p>

<p>ì´ì œ í…ŒìŠ¤íŠ¸ ì˜ˆì œì½”ë“œë¥¼ ë´ë³´ì</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Test</span>
<span class="kt">void</span> <span class="nf">createMemberTest</span><span class="o">()</span>  <span class="o">{</span>
        <span class="nc">Member</span> <span class="n">member</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Member</span><span class="o">(</span><span class="s">"dhfif718@naver.com"</span><span class="o">,</span><span class="s">"ì´ì¬í˜"</span><span class="o">,</span><span class="s">"010-1234-5678"</span><span class="o">);</span>

        <span class="n">given</span><span class="o">(</span><span class="n">memberRepository</span><span class="o">.</span><span class="na">findByEmail</span><span class="o">(</span><span class="n">member</span><span class="o">.</span><span class="na">getEmail</span><span class="o">())).</span><span class="na">willReturn</span><span class="o">(</span><span class="nc">Optional</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="n">member</span><span class="o">));</span>
        <span class="c1">//given(memberRepository.findByEmail(Mockito.anyString())).willReturn(Optional.of(member));</span>

        <span class="n">assertThrows</span><span class="o">(</span><span class="nc">BusinessLogicException</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="o">()</span> <span class="o">-&gt;</span> <span class="n">memberService</span><span class="o">.</span><span class="na">createMember</span><span class="o">(</span><span class="n">member</span><span class="o">));</span>
    <span class="o">}</span>
</code></pre></div></div>

<p>ê²€ì¦ì„ ì–´ë–»ê²Œí•˜ëŠ”ì§€ì— ë”°ë¼ ë‹¬ë¦¬ì§€ê² ì§€ë§Œ<br />
Member ê°ì²´ë¥¼ ìƒì„±í•˜ëŠ” serive í´ë˜ìŠ¤ ë©”ì„œë“œë¥¼ í…ŒìŠ¤íŠ¸í•˜ê¸°ìœ„í•´<br />
ìƒˆë¡œìš´ Member ê°ì²´ë¥¼ ë§Œë“¤ì–´ ê²€ì¦í•  ê²ƒì´ë‹¤.</p>

<p>given()ìœ¼ë¡œ Controller ê³„ì¸µì—ì„œ í–ˆë˜ê²ƒê³¼ ë™ì¼í•˜ê²Œ<br />
ê°€ì§œë¡œë§Œë“¤ ë©”ì„œë“œì˜ í˜•ì‹ê³¼ ë§¤ê°œíƒ€ì…ì„ ì…ë ¥í•´ì¤€ë‹¤ìŒ<br />
ë¦¬í„´ê°’ìœ¼ë¡œ ì–´ë–¤ ê°ì²´ë¥¼ ë°›ì„ì§€ ì •í•´ì£¼ë©´ëœë‹¤.</p>

<p>ìµœì¢…ì ìœ¼ë¡œ ë™ì¼í•œ Memberê°€ ë°œê²¬ë˜ì–´<br />
Exceptionì„ ì¡ì•„ ê²€ì¦í•˜ëŠ” í”„ë¡œê·¸ë¨ìœ¼ë¡œ ì‘ì„±í•˜ì˜€ë‹¤.</p>

<p>ìš°ë¦¬ê°€ ì˜ë¼ì¤˜ì•¼í•˜ëŠ”ë¶€ë¶„ì€ Repositroyì˜ findByEmail();ë¡œ ì •ì˜í•œ ë¶€ë¶„ì´ë‹¤.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="nc">Member</span> <span class="nf">createMember</span><span class="o">(</span><span class="nc">Member</span> <span class="n">member</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">verifyExistsEmail</span><span class="o">(</span><span class="n">member</span><span class="o">.</span><span class="na">getEmail</span><span class="o">());</span>
    <span class="nc">Member</span> <span class="n">savedMember</span> <span class="o">=</span> <span class="n">memberRepository</span><span class="o">.</span><span class="na">save</span><span class="o">(</span><span class="n">member</span><span class="o">);</span>

    <span class="k">return</span> <span class="n">savedMember</span><span class="o">;</span>
<span class="o">}</span>
<span class="kd">private</span> <span class="kt">void</span> <span class="nf">verifyExistsEmail</span><span class="o">(</span><span class="nc">String</span> <span class="n">email</span><span class="o">)</span> <span class="o">{</span>
    <span class="nc">Optional</span><span class="o">&lt;</span><span class="nc">Member</span><span class="o">&gt;</span> <span class="n">member</span> <span class="o">=</span> <span class="n">memberRepository</span><span class="o">.</span><span class="na">findByEmail</span><span class="o">(</span><span class="n">email</span><span class="o">);</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">member</span><span class="o">.</span><span class="na">isPresent</span><span class="o">())</span>
    <span class="k">throw</span> <span class="k">new</span> <span class="nf">BusinessLogicException</span><span class="o">(</span><span class="nc">ExceptionCode</span><span class="o">.</span><span class="na">MEMBER_EXISTS</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div></div>
<p>MemberService ë¡œì§ì€ ë„ˆë¬´ ê°„ë‹¨í•˜ê²Œ<br />
ê¸°ì¡´ memberì™€ emailì„ ë¹„êµí•´ ê°™ì€ emailì´ ì¡´ì¬í•˜ë©´<br />
throw Exceptionì„ í•˜ê²Œ ë˜ì–´ìˆë‹¤.</p>

<p>ìš°ë¦¬ëŠ” ìœ„ì—ì„œ ë©”ì„œë“œ í˜¸ì¶œí• ë•Œì˜ ë§¤ê°œë³€ìˆ˜ â€œdhfif718@naver.comâ€ê³¼<br />
ê²°ê³¼ë¡œ ë°˜í™˜ëœ ê°ì²´ì˜ email â€œdhfif718@naver.comâ€ ê²°ê³¼ì ìœ¼ë¡œ ê°™ê¸° ë•Œë¬¸ì—<br />
if(member.isPresent()) ì¡°ê±´ì— ì„±ë¦½ë˜<br />
Exceptionì„ ë˜ì§€ê²Œë˜ì–´ Serivce ë¡œì§ì„ ê²€ì¦í•´ë³¼ ìˆ˜ ìˆë‹¤.</p>

<p>ìì—°ìŠ¤ëŸ½ê²Œ ì˜ˆì™¸ê°€ ë˜ì ¸ì§€ë¯€ë¡œ í•´ë‹¹ Service ë¡œì§ì€ ì¢…ë£Œë˜ê³ <br />
.save()ê¹Œì§€ ê²€ì¦í•  í•„ìš”ê°€ ì—†ì–´ì§„ë‹¤.<br />
saveë¥¼ ê²€ì¦í•˜ëŠ” ê²ƒì€ ì‚¬ì‹¤ ë¹„ì§€ë‹ˆìŠ¤ë¡œì§ì„ ê²€ì¦í•˜ëŠ” ê²ƒë³´ë‹¨<br />
Repositoryë¥¼ ê²€ì¦í•˜ëŠ” ê²ƒì— ê°€ê¹ê¸° ë•Œë¬¸ì—<br />
Serivce ê³„ì¸µì—ì„œ ê²€ì¦í•˜ëŠ” ë¡œì§ì„ êµ³ì´ ì‘ì„±í•˜ì§€ ì•Šì•„ë„ ë  ê²ƒ ê°™ë‹¤.</p>

<p><br /></p>

<h3 id="ì˜¤ëŠ˜-ë§Œë‚œ-ì—ëŸ¬">ì˜¤ëŠ˜ ë§Œë‚œ ì—ëŸ¬</h3>

<p>ì´ë ‡ê²Œ ìœ„ì—ì„œ Controllerê³¼ Service ê³„ì¸µì„ ë¶„ë¦¬í•´ì„œ<br />
ë”°ë¡œ ë”°ë¡œ í…ŒìŠ¤íŠ¸í•  ìˆ˜ ìˆê²Œ í”„ë¡œê·¸ë¨ì„ ì‘ì„±í•˜ê³ <br />
ì •ìƒì ìœ¼ë¡œ ìˆ˜í–‰ë˜ëŠ” ëª¨ìŠµì„ ë³¼ ìˆ˜ ìˆì—ˆë‹¤.</p>

<p>Mockitoë¼ëŠ” APIë¥¼ ì²˜ìŒ ì‚¬ìš©í•˜ë‹¤ë³´ë‹ˆ<br />
ì—¬ëŸ¬ê°€ì§€ ì—ëŸ¬ë“¤ì„ ë§Œë‚¬ê³  ê·¸ì¤‘ì— ê¸°ì–µë‚¨ëŠ” ì—ëŸ¬ë¥¼ ì ì–´ë³¸ë‹¤.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Test</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">cancelOrderTest</span><span class="o">(){</span>
    <span class="nc">Order</span> <span class="n">order</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Order</span><span class="o">();</span>
    <span class="kt">long</span> <span class="n">orderId</span> <span class="o">=</span> <span class="mi">1L</span><span class="o">;</span>
    <span class="nc">Optional</span><span class="o">&lt;</span><span class="nc">Order</span><span class="o">&gt;</span> <span class="n">findOrder</span> <span class="o">=</span> <span class="nc">Optional</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="n">order</span><span class="o">);</span>
    <span class="n">given</span><span class="o">(</span><span class="n">orderRepository</span><span class="o">.</span><span class="na">findById</span><span class="o">(</span><span class="n">order</span><span class="o">.</span><span class="na">getOrderId</span><span class="o">())).</span><span class="na">willReturn</span><span class="o">(</span><span class="n">findOrder</span><span class="o">);</span>
    <span class="n">assertThrows</span><span class="o">(</span><span class="nc">BusinessLogicException</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="o">()</span> <span class="o">-&gt;</span> <span class="n">orderService</span><span class="o">.</span><span class="na">cancelOrder</span><span class="o">(</span><span class="n">orderId</span><span class="o">));</span>
<span class="o">}</span>
</code></pre></div></div>
<p>ìœ„ì™€ ê°™ì´ í…ŒìŠ¤íŠ¸ ì½”ë“œë¥¼ ì‘ì„±í›„ ì‹¤í–‰ì‹œì¼œ ë³´ì•˜ëŠ”ë°</p>

<p><img src="https://lh3.googleusercontent.com/u/0/drive-viewer/AJc5JmTitd8kl31KKTTaIB7nQrL7AvxwT54hIPaJEcnmdlC5BhBrezzcRcqyhYeyWzO1aK7O1OYjVG_yqk2EYkUVRD6lZHWCiw=w3024-h1620" alt="image" class="align-left" style="max-width: 100%" /></p>

<p>misusing.PotentialStubbingProblem ì´ë¼ëŠ” ì—ëŸ¬ë¥¼ ë§Œë‚¬ë‹¤.<br />
ì ì¬ì ì¸ Stubbing ë¬¸ì œë¼ë©´ì„œ ì˜ˆì™¸ê°€ ì¡í˜”ë‹¤.</p>

<p>ì½”ë“œë¥¼ ì—´ì‹¬íˆ ë³´ë‹¤ë³´ë‹ˆ..<br />
given()ì•ˆì˜ ë§¤ê°œë³€ìˆ˜ë¡œ order.getOrderId()ë¥¼ ë„£ì–´ì£¼ê³  ìˆì—ˆê³ <br />
cancelOrder();ë©”ì„œë“œ í˜¸ì¶œí•˜ëŠ” ë§¤ê°œë³€ìˆ˜ì—ëŠ” orderIdë¥¼ ë„£ì–´ì£¼ê³  ìˆì—ˆë‹¤.</p>

<p>ì—¬ê¸°ì„œ orderê°ì²´ê°€ ë§Œë“¤ì–´ì§ˆë•Œ Longíƒ€ì…ìœ¼ë¡œ nullë¡œ ë§Œë“¤ì–´ì¡Œê³ <br />
íƒ€ì…ì´ ì˜ëª»ë“¤ì–´ê°„ ìƒíƒœë¡œ í…ŒìŠ¤íŠ¸ ì½”ë“œë¥¼ ì‹¤í–‰í•˜ë‹ˆê¹Œ ìœ„ì™€ ê°™ì€ ì—ëŸ¬ê°€ ë°œìƒí–ˆë‹¤.</p>

<p>í•´ê²°ì€</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">given</span><span class="o">(</span><span class="n">orderRepository</span><span class="o">.</span><span class="na">findById</span><span class="o">(</span><span class="nc">Mockito</span><span class="o">.</span><span class="na">anyLong</span><span class="o">())).</span><span class="na">willReturn</span><span class="o">(</span><span class="n">findOrder</span><span class="o">);</span>
</code></pre></div></div>
<p>ìœ„ì™€ ê°™ì´ íƒ€ì…ì„ Mockito.anyLong()ì„ ë¶™ì—¬ì„œ í•´ê²°ì´ ê°€ëŠ¥í•˜ê³ <br />
order.serOrderId(orderId);ë¥¼ í†µí•´ì„œ ê°’ì„ ë„£ì–´ì£¼ì–´ë„<br />
ë¬¸ì œê°€ í•´ê²°ì´ ê°€ëŠ¥í•˜ë‹¤.</p>

<hr />

<p>ì˜¤ëŠ˜ ê³µë¶€ëŠ” ì—¬ê¸°ê¹Œì§€ í–ˆê³ <br />
JUnitê´€ë ¨í•´ì„œ Slice í…ŒìŠ¤íŠ¸ì— ëŒ€í•´ ìì„¸íˆ ë°°ìš¸ ìˆ˜ ìˆì–´ì„œ<br />
ë„ˆë¬´ ìœ ìµí•œ ì‹œê°„ì´ì˜€ë‹¤.</p>

<p>í•œê°€ì§€ ì•„ì‰¬ìš´ì ì€ ë§ì€ apiì¤‘ì—ì„œë„ í•œì •ì ì¸ ê²ƒë§Œ ì‚¬ìš©í•´ë³´ì•˜ê¸°ì—<br />
ì§€ì‹ì¸µì´ ì–•ì€ì ..?ì´ ì¡°ê¸ˆ ì•„ì‰¬ì› ê³ <br />
ì´í›„ì— í”„ë¡œì íŠ¸í•˜ê¸°ì „ì— í…ŒìŠ¤íŠ¸ ê´€ë ¨ ì—¬ëŸ¬ ë©”ì„œë“œë“¤ì„ ê³µë¶€í•œë‹¤ìŒ<br />
í…ŒìŠ¤íŠ¸ ì½”ë“œë¥¼ ì‘ì„±í•´ë´ì•¼ê² ë‹¤.</p>

<p>ì˜¤ëŠ˜ ê³µë¶€ëŠ” ì—¬ê¸°ì„œ ë !</p>

<p><br /></p>

<p><span style="color:#994C00"><strong>ì˜¤ëŠ˜ì˜ ì»¤í”¼ëŸ‰</strong></span>: â˜•ï¸ â˜•ï¸ â˜•ï¸<br />
<strong>ì˜¤ëŠ˜ì˜ ì ì‹¬</strong>: ì¹´ë ˆ, ë¼ë©´, ë°¥</p>]]></content><author><name>LEE JAEHYEOK</name></author><category term="TIL" /><category term="TIL" /><category term="ë¶€íŠ¸ìº í”„" /><category term="ì½”ë“œìŠ¤í…Œì´ì¸ " /><summary type="html"><![CDATA[]]></summary></entry><entry><title type="html">TIL) JUnit 2</title><link href="http://localhost:4000/til/2022/11/09/til.html" rel="alternate" type="text/html" title="TIL) JUnit 2" /><published>2022-11-09T00:00:00+09:00</published><updated>2022-11-09T00:00:00+09:00</updated><id>http://localhost:4000/til/2022/11/09/til</id><content type="html" xml:base="http://localhost:4000/til/2022/11/09/til.html"><![CDATA[<p><img src="https://lh3.googleusercontent.com/drive-viewer/AJc5JmR_RuNelXZR9wXYkkDNPxOHlFm1gfwD72mlxFWutdJvtLpD7ODhrLzTuczuHNHObb4Iq-3wmnCTJcm2yUGGaGj76Ho1Xw=w3024-h1728" alt="image" class="align-left" style="max-width: 100%" /></p>

<p>ëŠ˜ìƒ ê°™ì€ì¼ì˜ ë°˜ë³µì´ë‹¤.<br />
ì§€ë£¨í•˜ë©´ì„œë„ í–‰ë³µí•œ ì¼ìƒì˜ ë°˜ë³µì´ë‹¤.</p>

<p>ë°˜ë³µì ì¸ í•™ìŠµì— ì§€ì¹˜ê¸°ë„ í•˜ì§€ë§Œ<br />
ìƒˆë¡œìš´ ì§€ì‹ìŠµë“ì˜ ì¦ê±°ì›€ì´ ë„ˆë¬´í¬ê¸°ë•Œë¬¸ì—<br />
ì˜¤ëŠ˜ë„ ì—´ì‹¬íˆ ê³µë¶€í•´ë³´ë ¤í•œë‹¤.</p>

<hr />

<p>ì–´ì œëŠ” Testë¼ëŠ” ê°œë…ê³¼<br />
Spring Bootì˜ Default í”„ë ˆì›Œí¬ì¸ JUnitì— ëŒ€í•´ì„œë„<br />
ê°„ë‹¨íˆ ì‚¬ìš©í•˜ëŠ” í´ë˜ìŠ¤ì™€ ì–´ë…¸í…Œì´ì…˜ë“±ì„ ì•Œì•„ë³´ì•˜ë‹¤.</p>

<p>ì˜¤ëŠ˜ì€ ì›¹ì• í”Œë¦¬ì¼€ì´ì…˜ ê³„ì¸µë³„ë¡œ í…ŒìŠ¤íŠ¸í•˜ëŠ”<br />
ìŠ¬ë¼ì´ìŠ¤ í…ŒìŠ¤íŠ¸ì—ëŒ€í•´ ì•Œì•„ë³¼ ì˜ˆì •ì´ë‹¤.</p>

<h2 id="controller-ê³„ì¸µ-í…ŒìŠ¤íŠ¸">Controller ê³„ì¸µ í…ŒìŠ¤íŠ¸</h2>
<p>Controller ê³„ì¸µì„ í…ŒìŠ¤íŠ¸í•˜ê¸°ìœ„í•´ì„œëŠ”<br />
ê¸°ë³¸ì ìœ¼ë¡œ Postmanìœ¼ë¡œ í•¸ë“¤ëŸ¬ ë§¤ì„œë“œë¥¼ í˜¸ì¶œí•˜ì—¬<br />
JSON ê°ì²´ë¥¼ ì£¼ê³  ì‘ë‹µë°›ëŠ” ë°©ì‹ì„ ì‚¬ìš©í–ˆì—ˆë‹¤.</p>

<p>í•˜ì§€ë§Œ ì´ëª¨ë“  ê²ƒë„ ìë™í™”ì‹œí‚¤ê³  ë”ìš± í”„ë¡œê·¸ë˜ë¨¸ë‹µê²Œ í…ŒìŠ¤íŠ¸í•˜ê¸°ìœ„í•´ì„ <br />
í…ŒìŠ¤íŠ¸ ì½”ë“œë¡œ Controller ê³„ì¸µì„ í…ŒìŠ¤íŠ¸í•´ë³¼ í•„ìš”ê°€ ìˆë‹¤.</p>

<h3 id="mockmvc">MockMvc</h3>

<p><strong>@AutoConfigureMockMvc</strong> ì–´ë…¸í…Œì´ì…˜ì€ Controller í…ŒìŠ¤íŠ¸ë¥¼ ìœ„í•œ ì• í”Œë¦¬ì¼€ì´ì…˜ì˜<br />
ìë™ êµ¬ì„± ì‘ì—…ì„ í•´ì¤€ë‹¤. ì´ì¤‘ ìš°ë¦¬ëŠ” MockMvc ê°™ì€ í´ë˜ìŠ¤ì˜ ê¸°ëŠ¥ì„ ì‚¬ìš©í•  ê²ƒì´ë‹¤.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@SpringBootTest</span>    
<span class="nd">@AutoConfigureMockMvc</span>  
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">ControllerTest</span> <span class="o">{</span>
    <span class="nd">@Autowired</span>
    <span class="kd">private</span> <span class="nc">MockMvc</span> <span class="n">mockMvc</span><span class="o">;</span>
    
    <span class="nd">@Test</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">postTest</span><span class="o">()</span> <span class="o">{</span>
        <span class="o">...</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>
<p>í…ŒìŠ¤íŠ¸ íŒŒì¼ì˜ @SpringBootTest ì–´ë…¸í…Œì´ì…˜ ë¶™ì—¬<br />
Application Contextë¥¼ ìƒì„±í•˜ê³ <br />
MockMvcí´ë˜ìŠ¤ë¥¼ ì‚¬ìš©í•˜ê¸° ìœ„í•œ ì–´ë…¸í…Œì´ì…˜ @AutoConfigureMockMvcë¥¼<br />
ë¶™ì—¬ì¤€ ë‹¤ìŒ @Autowiredë¡œ ì˜ì¡´ì„± ì£¼ì…ì„ ì‹œì¼œì£¼ë©´ ëœë‹¤.</p>

<p>ê·¸ë ‡ê²Œ ë˜ë©´ .perfrom(); ì´ë¼ëŠ” ë©”ì„œë“œë¥¼ ì‚¬ìš©í•˜ì—¬<br />
POST, GET, DELETE, PATCH ë“±<br />
í•¸ë“¤ëŸ¬ ë©”ì„œë“œë“¤ì„ ììœ ë¡­ê²Œ ì´ìš©í•  ìˆ˜ ìˆê²Œ ë˜ì–´ì§„ë‹¤.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">ResultActions</span> <span class="n">actions</span> <span class="o">=</span>
        <span class="n">mockMvc</span><span class="o">.</span><span class="na">perform</span><span class="o">(</span>                       
            <span class="n">post</span><span class="o">(</span><span class="s">"/api/coffees"</span><span class="o">)</span> 
                <span class="o">.</span><span class="na">accept</span><span class="o">(</span><span class="nc">MediaType</span><span class="o">.</span><span class="na">APPLICATION_JSON</span><span class="o">)</span> 
                <span class="o">.</span><span class="na">contentType</span><span class="o">(</span><span class="nc">MediaType</span><span class="o">.</span><span class="na">APPLICATION_JSON</span><span class="o">)</span> 
                <span class="o">.</span><span class="na">content</span><span class="o">(</span><span class="n">content</span><span class="o">)</span> 
        <span class="o">);</span>
</code></pre></div></div>
<p>ê°„ë‹¨í•œ ì½”ë“œ ì˜ˆì œë¥¼ ì‚´í´ë³´ì performì„ í†µí•´<br />
uriì™€ í•¸ë“¤ëŸ¬ ë©”ì„œë“œ ë°©ì‹ ì„¤ì •ì„í•´ì£¼ê³ <br />
ì‘ë‹µë°›ì„ ê°ì²´ íƒ€ì… .accept();<br />
ì „ì†¡í•  ì»¨í…ì¸  íƒ€ì… .contentType();<br />
ì „ì†¡í•  ì»¨í…ì¸  .content();<br />
ë¥¼ í˜¸ì¶œí•˜ì—¬ ê°ê°ì˜ ë‚´ìš©ë“¤ì„ ë‹´ì•„ì£¼ë©´ Controllerì—ì„œ ì‘ì„±í•œ<br />
apiê°€ í˜¸ì¶œë˜ê²Œ ë˜ì–´ì§„ë‹¤.</p>

<p>ì—¬ê¸°ì„œ ë°˜í™˜ëœ ê°ì²´ëŠ” <strong>ResultActions</strong>ì´ë¼ëŠ” íƒ€ì…ìœ¼ë¡œ ë°˜í™˜ë˜ë©´<br />
í›„ì— ê²€ì¦í•˜ëŠ” ìš©ë„ë¡œ ì‚¬ìš©ë˜ì–´ì§„ë‹¤.</p>

<p>í•¸ë“¤ëŸ¬ ë©”ì„œë“œ(post(),get(),patech())ë¥¼ ì‚¬ìš©í•˜ê¸° ìœ„í•´ì„œëŠ”</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">static</span> <span class="n">org</span><span class="o">.</span><span class="na">springframework</span><span class="o">.</span><span class="na">test</span><span class="o">.</span><span class="na">web</span><span class="o">.</span><span class="na">servlet</span><span class="o">.</span><span class="na">request</span><span class="o">.</span><span class="na">MockMvcRequestBuilders</span><span class="o">.*;</span>
</code></pre></div></div>

<p>MockMvcRequestBulidersë¥¼ importí•´ì•¼ ì‚¬ìš©ì´ ê°€ëŠ¥í•˜ë‹¤.</p>

<p><br /></p>

<h3 id="json-ê°ì²´-ë°›ê¸°">Json ê°ì²´ ë°›ê¸°</h3>

<p>ì—¬ê¸°ì„œ ìš°ë¦¬ëŠ” JSON ê°ì²´ë¥¼ ì£¼ê³ ë°›ëŠ” ê²ƒìœ¼ë¡œ ì„¤ì •í–ˆê³ <br />
Json ê°ì²´ë¥¼ ë§Œë“¤ê¸° ìœ„í•´ Google Json ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©í–ˆë‹¤.</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">implementation</span> <span class="err">'</span><span class="n">com</span><span class="o">.</span><span class="na">google</span><span class="o">.</span><span class="na">code</span><span class="o">.</span><span class="na">gson</span><span class="o">:</span><span class="nl">gson:</span><span class="mf">2.8</span><span class="o">.</span><span class="mi">7</span><span class="err">'</span>
</code></pre></div></div>

<p>ì‚¬ìš©ë²•ì€ ê°„ë‹¨í•˜ë‹¤.</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Autowired</span>
<span class="kd">private</span> <span class="nc">Gson</span> <span class="n">gson</span><span class="o">;</span>
</code></pre></div></div>
<p>í•„ë“œì˜ Gson ê°ì²´ë¥¼ ì£¼ì…ë°›ë„ë¡ ì„¤ì • í›„</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">CoffeeDto</span><span class="o">.</span><span class="na">Post</span> <span class="n">post</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Coffee</span><span class="o">.</span><span class="na">Post</span><span class="o">(</span>
        <span class="s">"ì•„ë©”ë¦¬ì¹´ë…¸"</span><span class="o">,</span>
        <span class="s">"Americano"</span><span class="o">,</span>
        <span class="mi">4500</span>
<span class="o">);</span>
<span class="nc">String</span> <span class="n">content</span> <span class="o">=</span> <span class="n">gson</span><span class="o">.</span><span class="na">toJson</span><span class="o">(</span><span class="n">post</span><span class="o">);</span>
</code></pre></div></div>
<p>ìš°ë¦¬ê°€ Dto ìš©ë„ë¡œ ë§Œë“¤ì—ˆë˜ í´ë˜ìŠ¤ì˜<br />
í•´ë‹¹ íƒ€ì…ì˜ ë§ëŠ” ê°ì²´ë¥¼ gson.toJson(); ì•ˆì— ë„£ì–´ì£¼ë©´<br />
String íƒ€ì…ìœ¼ë¡œ ë°˜í™˜ë˜ê²Œ ë˜ì–´ì§„ë‹¤.</p>

<p>ê·¸ë ‡ê²Œ ë°˜í™˜ëœ ê°ì²´ë¡œ .content();ì•ˆì— ë‹´ì—ì£¼ê²Œ ë˜ë©´ ëì´ë‹¤.</p>

<p><br /></p>

<h3 id="mvcresult">MvcResult</h3>
<p>ìœ„ì—ì„œ ì–¸ê¸‰í–ˆë˜ ResultAction íƒ€ì…ì˜ ê°ì²´ë¡œ<br />
ì—¬ëŸ¬ê°€ì§€ ê²€ì¦ ë©”ì„œë“œë“¤ì„ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">MvcResult</span> <span class="n">result</span> <span class="o">=</span> <span class="n">actions</span>
        <span class="o">.</span><span class="na">andExpect</span><span class="o">(</span><span class="n">status</span><span class="o">().</span><span class="na">isCreated</span><span class="o">())</span>
        <span class="o">.</span><span class="na">andExpect</span><span class="o">(</span><span class="n">jsonPath</span><span class="o">(</span><span class="s">"$.data.korName"</span><span class="o">).</span><span class="na">value</span><span class="o">(</span><span class="n">post</span><span class="o">.</span><span class="na">getKorName</span><span class="o">()))</span>
        <span class="o">.</span><span class="na">andExpect</span><span class="o">(</span><span class="n">jsonPath</span><span class="o">(</span><span class="s">"$.data.engName"</span><span class="o">).</span><span class="na">value</span><span class="o">(</span><span class="n">post</span><span class="o">.</span><span class="na">getEngName</span><span class="o">()))</span>
        <span class="o">.</span><span class="na">andExpect</span><span class="o">(</span><span class="n">jsonPath</span><span class="o">(</span><span class="s">"$.data.price"</span><span class="o">).</span><span class="na">value</span><span class="o">(</span><span class="n">post</span><span class="o">.</span><span class="na">getPrice</span><span class="o">()))</span>
        <span class="o">.</span><span class="na">andReturn</span><span class="o">();</span>
</code></pre></div></div>
<p>.andExpect(); ë©”ì„œë“œë¡œ ê²€ì¦ì„ í•  ìˆ˜ ìˆë‹¤.<br />
actionsê°ì²´ëŠ” ResultAction íƒ€ì…ì´ë©°</p>

<p>status().isCreated() -&gt; ì‘ë‹µ ìƒíƒœì— ëŒ€í•œ ê²€ì¦ (OK,NOT FOUND ë“±ë“±..)<br />
jsonPath().value() -&gt; ì‘ë‹µë°›ì€ Json ê°ì²´ì˜ ë°ì´í„°ë¥¼ ê²€ì¦</p>

<p>ì¶”ê°€ë¡œ .andReturn(); ë©”ì„œë“œë¥¼ ì‚¬ìš©í•˜ê²Œë˜ë©´<br />
MvcResult í´ë˜ìŠ¤ íƒ€ì…ìœ¼ë¡œ ë°˜í™˜ë˜ëŠ”ë°<br />
í•´ë‹¹ í´ë˜ìŠ¤ì˜ ë©”ì„œë“œë¡œ Json ê°ì²´ë¥¼ ë¬¸ìì—´ë¡œ ì¶œë ¥í•˜ëŠ” ê²ƒë„ ê°€ëŠ¥í•˜ë‹¤.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">result</span><span class="o">.</span><span class="na">getResponse</span><span class="o">().</span><span class="na">getContentAsString</span><span class="o">());</span>
</code></pre></div></div>
<p>ìœ„ì™€ ê°™ì´ getResponse().getContentAsString(); ë©”ì„œë“œë¥¼<br />
ì´ìš©í•˜ì—¬ ì‹¤ì œ ì–´ë–»ê²Œ ì‘ë‹µë°›ì•˜ëŠ”ì§€ ì¶œë ¥í•´ë³¼ ìˆ˜ ìˆë‹¤</p>

<p><br /></p>

<h2 id="service-ê³„ì¸µ-í…ŒìŠ¤íŠ¸">Service ê³„ì¸µ í…ŒìŠ¤íŠ¸</h2>

<p>ë°ì´í„° ì—‘ì„¸ìŠ¤ ê³„ì¸µì„ í…ŒìŠ¤íŠ¸í•˜ê¸° ìœ„í•´ì„œëŠ”<br />
í•œ ê°€ì§€ ê·œì¹™ì´ìˆë‹¤.</p>

<p>DBì˜ ìƒíƒœë¥¼ í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ ì‹¤í–‰ ì´ì „ìœ¼ë¡œ ë˜ëŒë ¤ ë†“ëŠ”ë‹¤.<br />
ë¼ëŠ” ê·œì¹™ì´ ìˆë‹¤.</p>

<p>ì´ìœ ëŠ” ë§í•˜ì§€ ì•Šì•„ë„ ì•Œ ìˆ˜ ìˆë‹¤.<br />
í…ŒìŠ¤íŠ¸ì¼€ì´ìŠ¤ ì‹¤í–‰ì„í•˜ëŠ” ë°ì´í„°ë¥¼ ë‚¨ê²¨ë‘˜ ì´ìœ ê°€ ì—†ê¸° ë•Œë¬¸ì´ë‹¤.</p>

<p>ê°€ì¥ ì›ì´ˆì ì¸ ë°©ë²•ìœ¼ë¡œëŠ” <br />
@BeforeEach - í…ŒìŠ¤íŠ¸ ë ˆì½”ë“œ ìƒì„± , @AfterEach - í…ŒìŠ¤íŠ¸ ë ˆì½”ë“œ ì‚­ì œ<br />
ì •ë„ ìƒê°í•´ë³¼ ìˆ˜ ìˆì„ ê²ƒ ê°™ë‹¤. í•˜ì§€ë§Œ ë°ì´í„° ìƒì„± í›„<br />
ë¡œì§ì—ì„œ ì˜ˆì™¸ê°€ ë°œìƒí•˜ê±°ë‚˜í•˜ë©´ ë°ì´í„°ê°€ ì”ì¡´í•˜ëŠ” ë¬¸ì œê°€ ìƒê¸¸ ìˆ˜ë„ ìˆë‹¤.</p>

<p>@Transactional ì• ë…¸í…Œì´ì…˜ì„ í…ŒìŠ¤íŠ¸ í´ë˜ìŠ¤ì—<br />
ë¶™ì—¬ë†“ê³  Testë¥¼ ì§„í–‰í•˜ë©´, í…ŒìŠ¤íŠ¸ ì™„ë£Œí›„ rollback();ì´<br />
ë˜ì–´ì§€ê¸° ë•Œë¬¸ì— í¸ë¦¬í•˜ê²Œ í…ŒìŠ¤íŠ¸ë¥¼ í•  ìˆ˜ ìˆë‹¤.</p>

<h3 id="datajpatest">@DataJpaTest</h3>
<p>Springì—ì„œ ë°ì´í„° ì—‘ì„¸ìŠ¤ ê³„ì¸µì„ í…ŒìŠ¤íŠ¸ í•˜ê¸° ìœ„í•´<br />
ë§Œë“¤ì–´ë‘” ì–´ë…¸í…Œì´ì…˜ì´ë‹¤.</p>

<p>í•´ë‹¹ ì–´ë…¸í…Œì´ì…˜ì„ ì¶”ê°€í•¨ìœ¼ë¡œì¨, Jpa ê¸°ìˆ ì„ ì‚¬ìš©í•˜ëŠ”<br />
Repositoryì˜ ê¸°ëŠ¥ì„ ì •ìƒì ìœ¼ë¡œ ì‚¬ìš©í•˜ê¸° ìœ„í•œ<br />
Configurationì„ Springì´ ìë™ìœ¼ë¡œ í•´ì£¼ê²Œ ëœë‹¤.<br />
ê·¸ë¦¬ê³  í•´ë‹¹ ì–´ë…¸í…Œì´ì…˜ì€ @Transactionalì„ í¬í•¨í•˜ê³  ìˆê¸°ì—<br />
ìœ„ì—ì„œ ì„¤ëª…í–ˆë˜ rollback ì²˜ë¦¬ê¹Œì§€ ë˜ì–´ì§„ë‹¤.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@DataJpaTest</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">CoffeeRepositoryTest</span> <span class="o">{</span>
    <span class="nd">@Autowired</span>
    <span class="kd">private</span> <span class="nc">CoffeeRepository</span> <span class="n">coffeeRepository</span><span class="o">;</span>

    <span class="nd">@Test</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">test1</span><span class="o">(){</span>
        <span class="o">...</span>
    <span class="o">}</span>
    
    <span class="nd">@Test</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">test2</span><span class="o">(){</span>
        <span class="o">...</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>
<p>ì‚¬ìš© ë°©ë²•ì€ Controllerë³´ë‹¤ ê°„ë‹¨í•˜ë‹¤. <br />
JPAë¥¼ ìƒì†ë°›ëŠ” Repositoryë¥¼ ì˜ì¡´ì„± ì£¼ì…ì‹œí‚¨ ê°ì²´ë¥¼ ì´ìš©í•˜ê³ </p>

<p>@DataJpaTestë¥¼ í´ë˜ìŠ¤ë ˆë²¨ì— ë¶™ì—¬ì£¼ë©´<br />
íŠ¸ëœì­ì…˜ì´ ë³´ì¥ëœ Service ê³„ì¸µ í…ŒìŠ¤íŠ¸ê°€ ê°€ëŠ¥í•œ<br />
Test í´ë˜ìŠ¤ê°€ ë§Œë“¤ì–´ ì§„ë‹¤.</p>

<p><br /></p>

<hr />

<p>ì˜¤ëŠ˜ì€ Controller ê³„ì¸µì„ í…ŒìŠ¤íŠ¸ í•˜ê¸°ìœ„í•œ<br />
ì—¬ëŸ¬ê°€ì§€ APIë“¤ì„ ì•Œì•„ë³´ì•˜ë‹¤.<br />
í™•ì‹¤íˆ Postmanìœ¼ë¡œ í…ŒìŠ¤íŠ¸í• ë•ŒëŠ” ëˆˆìœ¼ë¡œ ë³´ì´ì§€ë§Œ<br />
í”„ë¡œê·¸ë¨ìœ¼ë¡œ í…ŒìŠ¤íŠ¸í• ë•Œ ì˜ˆì™¸ë°œìƒì´ë¼ë“ ì§€, ì˜¤ë¥˜ë°œìƒì´ ìƒê¸°ë©´<br />
í•œëˆˆì— ë¬¸ì œíŒŒì•…í•˜ëŠ”ê²Œ ì‰½ì§€ëŠ” ì•Šì€ ê²ƒ ê°™ê³ <br />
ì—°ìŠµì´ í•„ìš”í•  ê²ƒ ê°™ë‹¤.</p>

<p>ì˜¤ëŠ˜ ê³µë¶€ë„ ì—¬ê¸°ì„œ ë !</p>

<p><br /></p>

<p><span style="color:#994C00"><strong>ì˜¤ëŠ˜ì˜ ì»¤í”¼ëŸ‰</strong></span>: â˜•ï¸ â˜•ï¸ â˜•ï¸<br />
<strong>ì˜¤ëŠ˜ì˜ ì ì‹¬</strong>: ê¹€ì¹˜ì°Œê°œ, ë°¥</p>]]></content><author><name>LEE JAEHYEOK</name></author><category term="TIL" /><category term="TIL" /><category term="ë¶€íŠ¸ìº í”„" /><category term="ì½”ë“œìŠ¤í…Œì´ì¸ " /><summary type="html"><![CDATA[]]></summary></entry><entry><title type="html">TIL) JUnit 1</title><link href="http://localhost:4000/til/2022/11/08/til.html" rel="alternate" type="text/html" title="TIL) JUnit 1" /><published>2022-11-08T00:00:00+09:00</published><updated>2022-11-08T00:00:00+09:00</updated><id>http://localhost:4000/til/2022/11/08/til</id><content type="html" xml:base="http://localhost:4000/til/2022/11/08/til.html"><![CDATA[<p>ì˜¤ëŠ˜ë”°ë¼ ëˆˆì„ ëœ¨ê¸°ê°€ í˜ë“¤ì—ˆë‹¤.</p>

<p><img src="https://lh3.googleusercontent.com/drive-viewer/AJc5JmRtGpeYtviYIzfeRp5N9UsAFv4DyoXncCtpBv_yEBy2yHuy6nlv2NoLtIhafrvn3BC3SJSlY-XIggHVKpNsrfQ-cfUeRQ=w1512-h808" alt="image" class="align-left" style="max-width: 100%" /></p>

<p>ì˜¤ëœë§Œì— ì ì—ì„œ ì´ê²¨ë‚´ì§€ ëª»í•˜ëŠ” ì•„ì¹¨ì´ì—ˆë‹¤â€¦<br />
ì •ë§ í•œê²°ê°™ê¸°ëŠ” ì§„ì§œ ì–´ë µë‹¤ëŠ” ìƒê°ë„ ë“¤ê³ <br />
ì°¸ ë‚˜ì•½í•˜êµ¬ë‚˜ë¼ëŠ” ìƒê°ë„ ë“ ë‹¤.</p>

<p>ê·¸ë˜ë„ ì˜¤ëŠ˜ì€ ë¹„êµì  ì‰¬ìš´ ì£¼ì œì´ê¸° ë•Œë¬¸ì—<br />
ì—´ì‹¬íˆ ê³µë¶€í•´ë³´ì !!</p>

<hr />
<p>ì–´ì œëŠ” íŠ¸ëœì­ì…˜ì— ëŒ€í•´ ì•Œì•„ë³´ì•˜ë‹¤.<br />
ê¸°ë³¸ì ìœ¼ë¡œ ì„ ì–¸í˜• ë°©ì‹ì„ ì´ìš©í•´ë³´ì•˜ë‹¤. ì†ì„±ì— ëŒ€í•´ì„œëŠ”<br />
ê¹Šì€ ê³µë¶€ê°€ ì´ë£¨ì–´ì§€ì§€ëŠ” ì•Šì•˜ë‹¤.<br />
íŠ¸ëœì­ì…˜ì˜ ê¸°ë³¸ ë™ì‘ì›ë¦¬ì™€ ì ìš©ì‹œ ì–´ë–»ê²Œ ì²˜ë¦¬ê°€ë˜ëŠ”ì§€?<br />
ì •ë„ í™•ì¸ì„ í•´ë³´ì•˜ë‹¤.</p>

<p>ì˜¤ëŠ˜ì€ ë¹„êµì  ë‚œì´ë„ê°€ ì‰¬ìš´ ì£¼ì œì¸ Testingì— ëŒ€í•´ ê³µë¶€í•´ë³¼ ì˜ˆì •ì´ë‹¤.</p>

<h2 id="test">TEST</h2>
<p>í…ŒìŠ¤íŠ¸ëŠ” ì—¬ëŸ¬ê°€ì§€ ë¶„ì•¼ì—ì„œ ë§ì´ ë“¤ì–´ë´¤ì„ ê²ƒ ê°™ë‹¤.<br />
ë¬´ì—ˆì´ë“ ì§€ ì¶œì‹œí•˜ê¸°ì „ì—ëŠ” ê²€ì¦ê³¼ í…ŒìŠ¤íŠ¸ê°€ ê±°ì³ì§„ë‹¤.</p>

<p>í”„ë¡œê·¸ë¨ì—ì„œì˜ í…ŒìŠ¤íŠ¸ëŠ” ë‚´ê°€ ì‘ì„±í•œ ë¡œì§ì— ëŒ€í•œ<br />
ê²€ì¦ì´ê³ , ì—¬ëŸ¬ê°€ì§€ ì˜ˆì™¸ìƒí™©ì„ ê°€ì •í•´ í…ŒìŠ¤íŠ¸ë¥¼ ì§„í–‰í•´ë³¼ ìˆ˜ ìˆë‹¤.</p>

<h3 id="unit-test">Unit Test</h3>
<p>ë‹¨ìœ„í…ŒìŠ¤íŠ¸ë¼ê³  ì§ì—­í•  ìˆ˜ ìˆë‹¤.<br />
ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ëŠ” ì´ë¦„ì—ì„œ ì˜¤ë“¯ì´ ë‹¨ìœ„ë¥¼ ì •í•´ í…ŒìŠ¤íŠ¸ë¥¼ ì§„í–‰í•œëŠ” ê²ƒì´ë‹¤.<br />
ë¹„ì§€ë‹ˆìŠ¤ ë¡œì§ì—ì„œ ì‚¬ìš©í•˜ëŠ” í´ë˜ìŠ¤ë“¤ì´ ë…ë¦½ì ìœ¼ë¡œ í…ŒìŠ¤íŠ¸í•˜ê¸°<br />
ê°€ì¥ ì¢‹ì€ ëŒ€ìƒì´ê¸° ë•Œë¬¸ì— ë‹¨ìœ„í…ŒìŠ¤íŠ¸ë¼ê³  ë¶€ë¥´ëŠ” ê²½ìš°ê°€ ë§ë‹¤.</p>

<p>ìš°ë¦¬ê°€ ì‘ì„±í•œ ë©”ì„œë“œ ë‹¨ìœ„ë¡œ í…ŒìŠ¤íŠ¸ë¥¼ í•œë‹¤ê³  ìƒê°í•˜ë©´ ë  ê²ƒ ê°™ë‹¤.<br />
ê·¸ ì™¸ì— ì „ì²´ë‹¨ìœ„ë¡œ ë³´ì•˜ì„ ë•Œ ì—¬ëŸ¬ í…ŒìŠ¤íŠ¸ê°€ ìˆë‹¤.</p>

<ol>
  <li>ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸
-&gt; í´ë¼ì´ì–¸íŠ¸, ì• í”Œë¦¬ì¼€ì´ì…˜, DB ê¹Œì§€ í…ŒìŠ¤íŠ¸í•˜ëŠ” ê³¼ì •</li>
  <li>í†µí•© í…ŒìŠ¤íŠ¸
-&gt; ì• í”Œë¦¬ì¼€ì´ì…˜, DBê¹Œì§€ í…ŒìŠ¤íŠ¸í•˜ëŠ” ê³¼ì •</li>
  <li>ìŠ¬ë¼ì´ë“œ í…ŒìŠ¤íŠ¸
-&gt; ì• í”Œë¦¬ì¼€ì´ì…˜ íŠ¹ì • ê³„ì¸µì„ ìª¼ê°œì–´ì„œ í•˜ëŠ” í…ŒìŠ¤íŠ¸</li>
</ol>

<p><br /></p>

<h3 id="test-express">Test Express</h3>
<p>Given-When-Then ë°©ì‹ìœ¼ë¡œ í‘œí˜„ì„ í•œë‹¤.<br />
BDD(Behavior Driven Development)ë¼ëŠ” í…ŒìŠ¤íŠ¸ ë°©ì‹ì˜ ìš©ì–´ì´ë‹¤.</p>

<p><strong>Given</strong><br />
-&gt; í…ŒìŠ¤íŠ¸ë¥¼ ìœ„í•œ ì¤€ë¹„ê³¼ì •ì„ ëª…ì‹œ<br />
-&gt; í…ŒìŠ¤íŠ¸ì— í•„ìš”í•œ ì „ì œ ì¡°ê±´ë“¤ì´ í¬í•¨ëœë‹¤.</p>

<p><strong>When</strong><br />
-&gt; í…ŒìŠ¤íŠ¸í•  ë™ì‘ì„ ì§€ì •í•œë‹¤.<br />
-&gt; í…ŒìŠ¤íŠ¸í•  ë©”ì„œë“œ í˜¸ì¶œì„ í•˜ëŠ” ë¶€ë¶„ì´ë‹¤.</p>

<p><strong>Then</strong><br />
-&gt; í…ŒìŠ¤íŠ¸ì˜ ê²°ê³¼ë¥¼ ê²€ì¦í•˜ëŠ” ì˜ì˜ì´ë‹¤.<br />
-&gt; Assertionê³¼ ê°™ì€ í´ë˜ìŠ¤ë¡œ ê²€ì¦ì„í•˜ëŠ” ë¶€ë¶„ì´ë‹¤.</p>

<p><br /></p>

<h3 id="junit">JUnit</h3>
<p>ìš°ë¦¬ëŠ” Javaì–¸ì–´ë¡œ ë§Œë“¤ì–´ì§„ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ í…ŒìŠ¤íŠ¸í•˜ê¸°ìœ„í•´ì„œ<br />
ì˜¤í”ˆ ì†ŒìŠ¤ í…ŒìŠ¤íŠ¸ í”„ë ˆì„ì›Œí¬ì¸ JUnitì„ ì‚¬ìš©í•˜ê²Œ ëœë‹¤.<br />
(Spring Bootì˜ Default í…ŒìŠ¤íŠ¸ í”„ë ˆì„ì›Œí¬ê°€ Junitì´ë‹¤)</p>

<p><img src="https://lh3.googleusercontent.com/drive-viewer/AJc5JmTUGtth7qi-Z3xGykSHbxfz7SkPIuHfT_kXClFjYRN9M2CbsLZ4nY0Eu-CfahjOSV00vSWx_g5kPmxUZDMn9iQdpfKttQ=w3024-h1728" alt="image" class="align-left" style="max-width: 100%" /></p>

<p>ìœ„ ì‚¬ì§„ê³¼ ê°™ì´ ìŠ¤í”„ë§ í”„ë¡œì íŠ¸ë¥¼ ë§Œë“¤ ê²½ìš°<br />
test íŒ¨í‚¤ì§€ê°€ ìƒê¸´ë‹¤ ì•ˆì— íŒ¨í‚¤ì§€ë¥¼ ë§Œë“¤ì–´ ë‹¤ì–‘í•œ <br />
í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ë¥¼ ë§Œë“¤ì–´ ë¡œì§ì„ ê²€ì¦í•´ë³¼ ìˆ˜ ìˆë‹¤.</p>

<p>ê¸°ë³¸ì ì¸ ì‚¬ìš©ë°©ë²•ì€ ê°„ë‹¨í•˜ë‹¤.</p>

<p>í´ë˜ìŠ¤ë¥¼ ë§Œë“¤ì–´<br />
ë§¤ì„œë“œì— @Test ì–´ë…¸í…Œì´ì…˜ì„ ë¶™ì—¬ í…ŒìŠ¤íŠ¸ í•´ë³¼ ìˆ˜ ìˆë‹¤.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">JunitTest</span> <span class="o">{</span>
    
    <span class="nd">@Test</span>
    <span class="nd">@DisplayName</span><span class="o">(</span><span class="s">"Test 1"</span><span class="o">)</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">assertionTest</span><span class="o">(){</span>
        <span class="o">...</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>ì–´ë…¸í…Œì´ì…˜ì— ëŒ€í•´ ê³µë¶€í•œ ê²ƒë“¤ì„ ì ì–´ë³¸ë‹¤</p>

<p>@BeforeEach<br />
-&gt; í…ŒìŠ¤íŠ¸ ì‹¤í–‰ì¤‘ ë¨¼ì € ì‹¤í–‰ë˜ì–´ì§€ëŠ” ë©”ì„œë“œì— ë¶™ì—¬ì¤€ë‹¤.<br />
-&gt; ê°í…ŒìŠ¤íŠ¸ ë§¤ì„œë“œê°€ ì‹¤í–‰ë˜ê¸°ì „ ì‹¤í–‰í•œë‹¤.</p>

<p>@BeforeAll<br />
-&gt; í…ŒìŠ¤íŠ¸ ì‹¤í–‰ì¤‘ ë”±í•œë²ˆë§Œ ì‹¤í–‰ë˜ì–´ì§€ëŠ” ë©”ì„œë“œì— ë¶™ì—¬ì¤€ë‹¤.<br />
-&gt; Test í´ë˜ìŠ¤ ì‹¤í–‰ì „ í•œë²ˆë§Œ ì‹¤í–‰ëœë‹¤.<br />
-&gt; ê·¸ëŸ¬ë¯€ë¡œ ì •ì  ë©”ì„œë“œì—¬ì•¼ í•œë‹¤ (static)</p>

<p>@AfterEach<br />
-&gt; í…ŒìŠ¤íŠ¸ ì‹¤í–‰ì¤‘ ì‹¤í–‰ì™„ë£Œí›„ ì‹¤í–‰ë˜ì–´ì§€ëŠ” ë©”ì„œë“œì— ë¶™ì—¬ì¤€ë‹¤.<br />
-&gt; ê°í…ŒìŠ¤íŠ¸ ë©”ì„œë“œê°€ ì‹¤í–‰ë˜ê³ ë‚œí›„ ì‹¤í–‰í•œë‹¤.</p>

<p>@AfterAll<br />
-&gt; ìœ„ì— ë‚´ìš©ê³¼ ê°™ìœ¼ë‹ˆ ì°¸ì¡°</p>

<p>@DisplayName(â€œâ€)<br />
-&gt; ë©”ì„œë“œì— ë¶™ì—¬ì£¼ë©´, í•´ë‹¹ ì–´ë…¸í…Œì´ì…˜ì˜ ì´ë¦„ì„ ì»¤ìŠ¤í„°ë§ˆì´ì§• í•  ìˆ˜ ìˆë‹¤.</p>

<p>@SpringBootTest<br />
-&gt; í…ŒìŠ¤íŠ¸ í´ë˜ìŠ¤ì— ë¶™ì—¬ì¤€ë‹¤ <br />
-&gt; í…ŒìŠ¤íŠ¸ì‹¤í–‰ì‹œ, ìŠ¤í”„ë§ì„ ë„ìš´ë‹¤ìŒ ìŠ¤í”„ë§ì„ ì‚¬ìš©í•  ìˆ˜ ìˆê²Œëœë‹¤.<br />
-&gt; ì¦‰, ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ ì»¨í…Œì´ë„ˆì— ë‹´ì•„ë‘” ë¹ˆë“¤ì„ ì£¼ì…í•  ìˆ˜ ìˆë‹¤.</p>

<p>@TestConfiguration<br />
-&gt; í…ŒìŠ¤íŠ¸ ì•ˆì—ì„œ ë‚´ë¶€ í´ë˜ìŠ¤ë¥¼ ë§Œë“¤ì–´ì„œ ì‚¬ìš©í•˜ë©´ì„œ ì´ ì–´ë…¸íƒœì´ì…˜ì„ ë¶™ì´ë©´ <br />
ìŠ¤í”„ë§ ë¶€íŠ¸ê°€ ìë™ìœ¼ë¡œ ë§Œë“¤ì–´ì£¼ëŠ” ë¹ˆë“¤ì— ì¶”ê°€ë¡œ í•„ìš”í•œ ìŠ¤í”„ë§ ë¹ˆë“¤ì„ ë“±ë¡í•˜ê³  í…ŒìŠ¤íŠ¸ë¥¼ ìˆ˜í–‰í•  ìˆ˜ ìˆë‹¤.</p>

<p>@AutoConfigureMockMvc<br />
-&gt; MockMvc ê¸°ëŠ¥ì„ ì‚¬ìš©í•˜ê¸°ìœ„í•œ ì• ë…¸í…Œì´ì…˜ <br />
-&gt; Controller ìŠ¬ë¼ì´ìŠ¤ í…ŒìŠ¤íŠ¸ë¥¼ ì§„í–‰í•œë‹¤ê³  ê°€ì •í•˜ë©´ <br />
Controller í…ŒìŠ¤íŠ¸ë¥¼ ìœ„í•œ ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ìë™ êµ¬ì„± ì‘ì—…ì„ í•´ì¤€ë‹¤.<br />
-&gt; ì£¼ì…ë°›ì€ ê°ì²´ëŠ” .perform()ì„ ì´ìš©í•´ httpë§¤ì„¸ë” ìš”ì²­ê°€ëŠ¥</p>

<p><br /></p>

<p>ì‚¬ìš© ë°©ë²•ì„ ì•Œì•˜ìœ¼ë‹ˆ ì´ì œ ê²€ì¦í•˜ëŠ” ë°©ë²•ë„ ì•Œì•„ì•¼í•œë‹¤.<br />
ê²€ì¦í• ë•Œ ì‚¬ìš©í•˜ëŠ” í´ë˜ìŠ¤ë“¤ì´ ì—¬ëŸ¬ê°€ì§€ ìˆë‹¤.</p>

<p>1). Assertions í´ë˜ìŠ¤<br />
-&gt; assertJ íŒ¨í‚¤ì§€ì˜ í´ë˜ìŠ¤ë¥¼ ê°€ì ¸ì™€ì•¼ ì‚¬ìš©ê°€ëŠ¥<br />
-&gt; .assertThat(); ê°™ì€ ë§¤ì„œë“œë¡œ ê²€ì¦í•´ì£¼ëŠ” ê¸°ëŠ¥ë“¤ì„ ì œê³µí•´ì¤Œ</p>

<p>.assertThat();<br />
-&gt; ë‹¤ì–‘í•œ ê²€ì¦ ë©”ì„œë“œë“¤ì„ ì œê³µ</p>

<p>.assertThatThrownBy();<br />
-&gt; assertThatê³¼ ë™ì¼í•˜ê²Œ ë©”ì„œë“œë¥¼ ì œê³µí•˜ì§€ë§Œ ì˜ˆì™¸ë¥¼ í™•ì¸í•  ìˆ˜ ìˆë‹¤.</p>

<p>.isTure();<br />
-&gt; ì•ì˜ ë‚´ìš©ì´ ì°¸ì´ë©´ í…ŒìŠ¤íŠ¸ ì„±ê³µ</p>

<p>.isFalse();<br />
-&gt; ì•ì˜ ë‚´ìš©ì´ ê±°ì§“ì´ë©´ í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨</p>

<p>.isEqualTo<br />
-&gt; ê°’ì´ ë™ì¼í•˜ë©´ í…ŒìŠ¤íŠ¸ ì„±ê³µ</p>

<p>2.) Assertions í´ë˜ìŠ¤<br />
-&gt; jupiter íŒ¨í‚¤ì§€ì˜ í´ë˜ìŠ¤ë¥¼ ê°€ì ¸ì™€ì•¼ ì‚¬ìš©ê°€ëŠ¥</p>

<p>.assertEquals();<br />
-&gt; ê¸°ëŒ€ê°’ì´ ì‹¤ì œê°’ê³¼ ê°™ì€ì§€ ë¹„êµ<br />
-&gt; ì¢Œì¸¡ì´ ê¸°ëŒ€ê°’, ìš°ì¸¡ì´ ì‹¤ì œê°’<br />
-&gt; ex) assertEquals(â€œaâ€,â€aâ€);</p>

<p>.assertNotNull();<br />
-&gt; Nullê°’ì´ ì•„ë‹ˆë©´ ê²€ì¦ í†µê³¼, ì•„ë‹ˆë©´ Fail<br />
-&gt; ex) assertNotNull(ë³€ìˆ˜, ë§¤ì„¸ì§€);</p>

<p>.assertThrows();<br />
-&gt; ê¸°ëŒ€í•˜ëŠ” Exceptioníƒ€ì…ê³¼ ë‚´ìš©ì„ ì…ë ¥í•œë‹¤.  <br />
-&gt; ê¸°ëŒ€í•˜ëŠ”ê°’ì´ Exception íƒ€ì…ê³¼ ë§ì§€ ì•Šì„ ê²½ìš°ì—ëŠ” í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨<br />
ë°˜ëŒ€ë¡œ íƒ€ì…ê³¼ ê°™ì„ê²½ìš°ì—ëŠ” ì„±ê³µ<br />
-&gt; ex) assertThrows(NullPointerException.class, ()-&gt; í˜¸ì¶œë©”ì„œë“œ));</p>

<p>2). Assumption í´ë˜ìŠ¤<br />
.assumeTrue();<br />
-&gt; íŠ¹ì • ì¡°ê±´ì—ì„œ ì„ íƒì ì¸ í…ŒìŠ¤íŠ¸ê°€ í•„ìš”í• ë•Œ ì‚¬ìš©</p>

<p>4). MatcherAssert í´ë˜ìŠ¤<br />
   -&gt; JUnit ê¸°ë°˜ì˜ Assertion í”„ë ˆì„ì›Œí¬ì´ë‹¤.<br />
   -&gt; ìì—°ìŠ¤ëŸ¬ìš´ ë¬¸ì¥ìœ¼ë¡œ ì´ì–´ì§€ëŠ” íŠ¹ì„±ì´ìˆì–´ ê°€ë…ì„± í–¥ìƒì´ í¬ë‹¤.<br />
   -&gt; hamcrest íŒ¨í‚¤ì§€ì— ìˆìŒ</p>

<p>.assertThat();<br />
-&gt; ë‹¤ì–‘í•œ ê²€ì¦ ë©”ì„œë“œë¥¼ ì œê³µí•´ì¤Œ<br />
-&gt; ex) .assertThat(a, is(equalTo(null)));<br />
.is();<br />
.equalTo();<br />
.notNullValue();</p>

<p><br /></p>

<p>ì´ ì™¸ì—ë„ JUnit ê¸°ë°˜ìœ¼ë¡œ ë§Œë“¤ì–´ì§„ í”„ë ˆì„ì›Œí¬ì—ì„œ<br />
ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” í´ë˜ìŠ¤ì™€ ë©”ì„œë“œë“¤ì´ ë§ì´ ìˆê³ <br />
ì´ ë¶€ë¶„ì€ ì§€ì†ì ìœ¼ë¡œ í…ŒìŠ¤íŠ¸í”„ë¡œê·¸ë¨ ì‘ì„±í•˜ë©´ì„œ ìŠµê´€ì„ ë“¤ì´ë©´ì„œ<br />
ì§€ì‹ì˜ ë²”ìœ„ë¥¼ ëŠ˜ë ¤ì•¼í•  ê²ƒ ê°™ë‹¤.</p>

<hr />

<p><br /></p>

<p><span style="color:#994C00"><strong>ì˜¤ëŠ˜ì˜ ì»¤í”¼ëŸ‰</strong></span>: â˜•ï¸ â˜•ï¸<br />
<strong>ì˜¤ëŠ˜ì˜ ì ì‹¬</strong>: ì¹´ë ˆ,ë°¥</p>]]></content><author><name>LEE JAEHYEOK</name></author><category term="TIL" /><category term="TIL" /><category term="ë¶€íŠ¸ìº í”„" /><category term="ì½”ë“œìŠ¤í…Œì´ì¸ " /><summary type="html"><![CDATA[ì˜¤ëŠ˜ë”°ë¼ ëˆˆì„ ëœ¨ê¸°ê°€ í˜ë“¤ì—ˆë‹¤.]]></summary></entry><entry><title type="html">TIL) Spring Transaction 2 , Event ë¹„ë™ê¸° ì ìš©</title><link href="http://localhost:4000/til/2022/11/07/til.html" rel="alternate" type="text/html" title="TIL) Spring Transaction 2 , Event ë¹„ë™ê¸° ì ìš©" /><published>2022-11-07T00:00:00+09:00</published><updated>2022-11-07T00:00:00+09:00</updated><id>http://localhost:4000/til/2022/11/07/til</id><content type="html" xml:base="http://localhost:4000/til/2022/11/07/til.html"><![CDATA[<p>ë‚ ì”¨ë„ ì„ ì„ í•˜ë‹ˆ ê¸°ë¶„ì¢‹ì€ ì›”ìš”ì¼ ì‹œì‘ì´ë‹¤.</p>

<p><img src="https://lh3.googleusercontent.com/drive-viewer/AJc5JmRr5ZBvzQfDcRqVd7ewr_sKrKf_aakwdPGUG0DNrGrEVbVty1HB4i1wRBumj0m52CTkK1XwtsJG106ORwGHwywrqfZjUg=w1920-h921" alt="image" class="align-left" style="max-width: 100%" /></p>

<p>ì£¼ë§ì— ê³µë¶€í•˜ëŠ”ê²Œ ìŠµê´€ì´ ë˜ì–´ì§€ë‹¤ë³´ë‹ˆ<br />
ê²Œì„ì„í•˜ëŠ” ë¹ˆë„ìˆ˜ê°€ ë¶€ì© ì¤„ì—ˆë‹¤.<br />
í•˜ë£¨ë„ ë¹ ì§ì—†ì´í•˜ë˜ ë‚´ê°€ ì£¼ë§ì— ì•„ì£¼ ì ê¹ì •ë„ë§Œ í•˜ëŠ” ì¾Œê±°ë¥¼ ì´ë¤˜ë‹¤.</p>

<p>ì˜¤ëŠ˜ ê³µë¶€í•œ ê²ƒë„ ì •ë¦¬í•˜ê³  ì´ì™¸ ê³µë¶€ë„ í•´ë³´ì !!</p>

<hr />
<p>ì˜¤ëŠ˜ì€ íŠ¸ëœì­ì…˜ì˜ ë§ˆì§€ë§‰ ì‹œê°„ì´ë‹¤.<br />
íŠ¸ëœì­ì…˜ì˜ ê°œë…ìì²´ëŠ” ì–´ë µê²Œ ëŠê»´ì§€ì§€ ì•ŠëŠ”ë°<br />
ê·¸ ì•ˆì— ìˆëŠ” ì»¤ë„¥ì…˜ì´ ì–´ë–»ê²Œ ì—°ê²°ë˜ì–´ì§€ëŠ”ì§€..<br />
ë“±ë“± DBì˜ ì ‘ê·¼ ë°©ë²•ì— ëŒ€í•´ êµ¬ì¡°ë¥¼ ëª…í™•íˆ íŒŒì•…í•˜ì§€ ëª»í–ˆë˜ ì ì´<br />
ê°€ì¥ í˜ë“¤ì—ˆë˜ ê²ƒ ê°™ë‹¤.</p>

<p>ì–´ì œëŠ” DBë¥¼ ì´ìš©í•´ commit(); rollback(); ì¿¼ë¦¬ë¥¼ ë³´ë‚´<br />
ì‹¤ì œë¡œ ì„¸ì…˜ë§ˆë‹¤ ë‹¤ë¥´ê²Œ ë³´ì´ê³  ë™ì‘í•˜ëŠ”ê±¸ í™•ì¸í•´ ë³¼ ìˆ˜ ìˆì—ˆë‹¤.<br />
ì˜¤ëŠ˜ì€ ì‹¤ì œ ì½”ë“œì— ì ìš©í•´ì„œ í•˜ëŠ”ë²•ì„ ë°°ì›Œë³´ì</p>

<h2 id="transactional">@Transactional</h2>

<h3 id="ì‚¬ìš©ë°©ë²•">ì‚¬ìš©ë°©ë²•</h3>

<p>í•´ë‹¹ ì–´ë…¸í…Œì´ì…˜ìœ¼ë¡œ ë§í•  ê²ƒ ê°™ìœ¼ë©´<br />
AOP ê¸°ëŠ¥ê¹Œì§€ ì¶”ê°€ëœ íŠ¸ëœì­ì…˜ì´ë¼ê³  ë³´ë©´ ë  ê²ƒ ê°™ë‹¤.</p>

<p>Serivce ë¡œì§, ì¦‰ ë¹„ì§€ë‹ˆìŠ¤ ë¡œì§ì—ì„œ íŠ¸ëœì­ì…˜ì„ ì ìš©í•´<br />
í•˜ë‚˜ì˜ ê·¸ë£¹ìœ¼ë¡œ ë¬¶ì–´ ìµœì¢…ì ìœ¼ë¡œ ì™„ë£Œí•˜ë©´ commit();<br />
ì˜ˆì™¸ê°€ ë°œìƒí•˜ë©´ rollback();ì„ ì‹œì¼œì£¼ì–´ì•¼í•œë‹¤.</p>

<p>í•˜ë‚˜ì˜ ë¹„ì§€ë‹ˆìŠ¤ ë¡œì§ ë©”ì„œë“œì—ëŠ” ì—¬ëŸ¬ì¢…ë¥˜ì˜ ì¿¼ë¦¬ê°€ ë“¤ì–´ê°ˆ ìˆ˜ë„ìˆë‹¤.<br />
ì¡°íšŒ(findAll) í›„ ìƒì„±(save)ì„ í•  ìˆ˜ ë„ ìˆëŠ” ê²ƒì´ê³ <br />
ë¡œì§ì— ë”°ë¼ DBì— ì ‘ê·¼ ìˆ˜ê°€ ëŠ˜ì–´ë‚  ìˆ˜ë„ ìˆë‹¤.<br />
ì´ ëª¨ë“ ê±¸ í•˜ë‚˜ì˜ íŠ¸ëœì­ì…˜ìœ¼ë¡œ ë¬¶ì–´ ëª¨ë‘ì„±ê³µ=commit, ì‹¤íŒ¨=rollback<br />
ì´ë¼ê³  ìƒê°í•˜ë©´ ê°„ë‹¨í•  ê²ƒ ê°™ë‹¤.</p>

<p>ì˜›ë‚ ì—ëŠ” íŠ¸ëœì­ì…˜ ë§¤ë‹ˆì €ë¥¼ ì´ìš©í•´ ì§ì ‘ ì‘ì„±í–ˆë‹¤ê³ í•œë‹¤.</p>

<p><img src="https://lh3.googleusercontent.com/drive-viewer/AJc5JmTUoJ37QEpejnf7c71VPSO_r3ZdbX7CNXRfzh0MNJMn-ooo0Lib8xwQrmY6RS-ZDopydl6GyJi4FTwb9ZWRKx8BfBYKUA=w1920-h921" alt="image" class="align-left" style="max-width: 100%" /></p>

<p>DBì ‘ê·¼ ë°©ë²•ì—ë”°ë¼ íŠ¸ëœì­ì…˜ë§¤ë‹ˆì € êµ¬í˜„ì²´ë¥¼ ì´ìš©í•´<br />
íŠ¸ëœì­ì…˜ì„ ì»¤ë°‹í•˜ê³  ë¡¤ë°±í•˜ë©° ê´€ë¦¬í–ˆì—ˆë‹¤ê³  í•œë‹¤.</p>

<p><strong>ì˜ˆì œ)</strong></p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kt">void</span> <span class="nf">accountTransfer</span><span class="o">(</span><span class="nc">String</span> <span class="n">fromId</span><span class="o">,</span> <span class="nc">String</span> <span class="n">toId</span><span class="o">,</span> <span class="kt">int</span> <span class="n">money</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">SQLException</span> <span class="o">{</span>
    <span class="c1">// íŠ¸ëœì­ì…˜ ì‹œì‘</span>
    <span class="nc">TransactionStatus</span> <span class="n">status</span> <span class="o">=</span> <span class="n">transactionManager</span><span class="o">.</span><span class="na">getTransaction</span><span class="o">(</span><span class="k">new</span> <span class="nc">DefaultTransactionDefinition</span><span class="o">());</span>
    <span class="k">try</span> <span class="o">{</span>
        <span class="c1">//ë¹„ì§€ë‹ˆìŠ¤ ë¡œì§</span>
        <span class="n">bizLogic</span><span class="o">(</span><span class="n">fromId</span><span class="o">,</span> <span class="n">toId</span><span class="o">,</span> <span class="n">money</span><span class="o">);</span>
        <span class="n">transactionManager</span><span class="o">.</span><span class="na">commit</span><span class="o">(</span><span class="n">status</span><span class="o">);</span><span class="c1">// ì„±ê³µì‹œ ì»¤ë°‹</span>
    <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">transactionManager</span><span class="o">.</span><span class="na">rollback</span><span class="o">(</span><span class="n">status</span><span class="o">);</span> <span class="c1">// ì‹¤íŒ¨ì‹œ ë¡¤ë°±</span>
        <span class="k">throw</span> <span class="k">new</span> <span class="nf">IllegalStateException</span><span class="o">(</span><span class="n">e</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>í•˜ì§€ë§Œ ì´ë ‡ê²Œë  ê²½ìš° try, catchë¬¸ì´ë‚˜<br />
íŠ¸ëœì­ì…˜ ë§¤ë‹ˆì €ë¶€ë¶„ì˜ commit,rollback ë“± ë°˜ë³µì ì¸ ì½”ë“œì™€<br />
íŠ¸ëœì­ì…˜ ë§¤ë‹ˆì €ë¥¼ ì‚¬ìš©í•˜ê¸°ìœ„í•œ ê°ì²´ë¥¼ ì–»ì–´ì•¼í•´ì•¼í•´ì„œ<br />
ìˆœìˆ˜í•œ ë¹„ì§€ë‹ˆìŠ¤ë¡œì§ì˜ ì½”ë“œë§Œ ë‚¨ì§€ ëª»í•˜ê²Œë˜ì–´ì§„ë‹¤.</p>

<p>ì´ëŸ¬í•œ ë°°ê²½ì—ì„œ Spring AOPë¥¼ ì ìš©ì„ í•  ìˆ˜ë„ ìˆì§€ë§Œ<br />
@Transactional ì• ë…¸í…Œì´ì…˜ì„ ë¶™ì—¬ì£¼ë©´ AOPê¹Œì§€ <br />
ì ìš©ë˜ì–´ ê¹”ê¸ˆí•œ ì½”ë“œë¡œ ë³€ê²½í•  ìˆ˜ ìˆë‹¤.</p>

<p><strong>ì˜ˆì œ)</strong></p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Transactional</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">accountTransfer</span><span class="o">(</span><span class="nc">String</span> <span class="n">fromId</span><span class="o">,</span> <span class="nc">String</span> <span class="n">toId</span><span class="o">,</span> <span class="kt">int</span> <span class="n">money</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">SQLException</span> <span class="o">{</span>
    <span class="n">bizLogic</span><span class="o">(</span><span class="n">fromId</span><span class="o">,</span> <span class="n">toId</span><span class="o">,</span> <span class="n">money</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div></div>

<p>ìœ„ì™€ ê°™ì´ ì• ë…¸í…Œì´ì…˜ì„ ë¶™ì—¬ íŠ¸ëœì­ì…˜ì„ ì ìš©í•˜ëŠ” ë°©ë²•ì„<br />
<strong>ì„ ì–¸í˜• ë°©ì‹ì˜ íŠ¸ëœì­ì…˜ ì ìš©</strong>ì´ë¼ê³ í•œë‹¤.</p>

<p>í´ë˜ìŠ¤ ë ˆë²¨ì— ì ìš©í•˜ëŠ” ë°©ë²•ê³¼ ë§¤ì„œë“œ ë ˆë²¨ì— ì ìš©í•  ìˆ˜ ìˆê³ <br />
ë ˆë²¨ì—ë”°ë¥¸ ì ìš©ë²”ìœ„ê°€ ê²°ì •ë˜ì–´ì§„ë‹¤.<br />
í•´ë‹¹ ì• ë…¸í…Œì´ì…˜ì´ ë¶™ì€ ë©”ì„œë“œì™€ í´ë˜ìŠ¤ëŠ”<br />
ìë™ì ìœ¼ë¡œ íŠ¸ëœì­ì…˜ ê¸°ëŠ¥ì´ ì ìš©ë˜ì–´ ì„œë¹„ìŠ¤ ë¡œì§ ì‹¤í–‰ì¤‘<br />
Exceptionì´ ë°œìƒí•˜ê²Œë˜ì–´ì§„ë‹¤ë©´ rollback();ì„ ì‹¤í–‰í•˜ê²Œë˜ì–´ì§„ë‹¤.</p>

<p><br /></p>

<h3 id="ì˜ˆì™¸ì—-ë”°ë¥¸-ì²˜ë¦¬">ì˜ˆì™¸ì— ë”°ë¥¸ ì²˜ë¦¬</h3>

<p>í•˜ì§€ë§Œ Checked ì˜ˆì™¸ì™€, Unchecked ì˜ˆì™¸ê°€ ì„œë¡œ ë‹¤ë¥´ê²Œ ë™ì‘í•œë‹¤.</p>

<p><img src="https://lh3.googleusercontent.com/drive-viewer/AJc5JmTSLAOChGCHoy9NNwgmdECsc71qVVgUeTBzTSdKGAlH5tqp6IU6uhn2g81ChpPO6kV-uUGZ2-9bBermAPtxxrtbxdvTXw=w1920-h921" alt="image" class="align-left" style="max-width: 100%" /></p>

<p>rollback();ì— ëŒ€í•œ ì°¨ì´ê°€ ìˆê³ <br />
Checked ì—ì™¸ëŠ” ë°˜ë“œì‹œ ì˜ˆì™¸ì²˜ë¦¬ë¥¼ í•´ì£¼ì–´ì•¼í•œë‹¤.</p>

<p><br /></p>

<h3 id="transaction-ì „íŒŒ">Transaction ì „íŒŒ</h3>

<p>íŠ¸ëœì­ì…˜ ì „íŒŒëŠ” íŠ¸ëœì­ì…˜ ê²½ê³„ì—ì„œ ì§„í–‰ì¤‘ì¸<br />
íŠ¸ëœì­ì…˜ì´ ì¡´ì¬í• ë•Œ ë˜ëŠ” ì¡´ì¬í•˜ì§€ ì•Šì„ ë•Œ<br />
ì–´ë–»ê²Œ ë™ì‘í•  ê²ƒì¸ì§€ë¥¼ ê²°ì •í•˜ëŠ” ë°©ì‹ì„ ì˜ë¯¸í•œë‹¤.</p>

<p>ex) @Transactional(propagation = Propagation.REQUIRED)</p>

<ol>
  <li>
    <p>Propagation.REQUIRED<br />
-&gt; í˜„ì¬ ì§„í–‰ ì¤‘ì¸ íŠ¸ëœì­ì…˜ì´ ì¡´ì¬í•˜ë©´ í•´ë‹¹ íŠ¸ëœì­ì…˜ì„ ì‚¬ìš©í•˜ê³ <br />
ì¡´ì¬í•˜ì§€ ì•Šìœ¼ë©´ ìƒˆ íŠ¸ëœì­ì…˜ì„ ìƒì„±í•˜ë„ë¡ í•´ì¤€ëŠ” ì†ì„±ì´ë‹¤<br />
ì¦‰,ì„œë¡œ ë‹¤ë¥¸ ì„œë¹„ìŠ¤ì—ì„œ ë‹¤ë¥¸ íŠ¸ëœì­ì…˜ì„ ì‹¤í–‰ì‹œí‚¤ì§€ ì•Šê²Œí•´ì£¼ëŠ” ì—­í• </p>
  </li>
  <li>
    <p>Propagation.REQUIRES_NEW <br />
-&gt; ì´ë¯¸ ì§„í–‰ì¤‘ì¸ íŠ¸ëœì­ì…˜ê³¼ ë¬´ê´€í•˜ê²Œ ìƒˆë¡œìš´ íŠ¸ëœì­ì…˜ì´ ì‹œì‘ëœë‹¤.<br />
ê¸°ì¡´ì— ì§„í–‰ì¤‘ì´ë˜ íŠ¸ëœì­ì…˜ì€ ìƒˆë¡œìš´ ì‹œì‘ëœ íŠ¸ë™ì­ì…˜ì´ ì¢…ë£Œí•  ë•Œê¹Œì§€ ì¤‘ì§€ëœë‹¤.</p>
  </li>
  <li>
    <p>Propagation.MANDATORY<br />
-&gt; ì§„í–‰ì¤‘ì¸ íŠ¸ëœì­ì…˜ì´ ì—†ìœ¼ë©´ ì˜ˆì™¸ë¥¼ ë°œìƒì‹œí‚¨ë‹¤.</p>
  </li>
  <li>
    <p>Propagation.NOT_SUPPORTED<br />
-&gt; íŠ¸ëœì­ì…˜ì„ í•„ìš”ë¡œ í•˜ì§€ì•ŠìŒì„ ì˜ë¯¸í•œë‹¤.<br />
-&gt; íŠ¸ëœì­ì…˜ì´ ìˆìœ¼ë©´ ë©”ì„œë“œ ì‹¤í–‰ì´ ì¢…ë£Œë ë•Œê¹Œì§€ ì§„í–‰ì¤‘ì¸ íŠ¸ëœì­ì…˜ì€ ì¤‘ì§€ë˜ë©°<br />
ë©”ì„œë“œ ì‹¤í–‰ì´ ì¢…ë£Œë˜ë©´ íŠ¸ëœì­ì…˜ì„ ê³„ì† ì§„í–‰í•œë‹¤.</p>
  </li>
  <li>
    <p>Propagation.NEVER<br />
-&gt; íŠ¸ëœì­ì…˜ì„ í•„ìš”ë¡œí•˜ì§€ ì•ŠìŒì„ ì˜ë¯¸í•œë‹¤.<br />
-&gt; ì§„í–‰ ì¤‘ì¸ íŠ¸ëœì­ì…˜ì´ ì¡´ì¬í•  ê²½ìš°ì—ëŠ” ì˜ˆì™¸ë¥¼ ë°œìƒì‹œí‚¨ë‹¤.</p>
  </li>
</ol>

<h3 id="transaction-ê²©ë¦¬-ìˆ˜ì¤€">Transaction ê²©ë¦¬ ìˆ˜ì¤€</h3>
<ol>
  <li>
    <p>UNCOMMITED  <br />
-&gt; ì»¤ë°‹ë˜ì§€ ì•Šì€ ì½ê¸°<br />
-&gt; ë‹¤ë¥¸ íŠ¸ëœì­ì…˜ì—ì„œ ì»¤ë°‹í•˜ì§€ ì•Šì€ ë°ì´í„°ë¥¼ ì½ëŠ” ê²ƒì„ í—ˆìš©</p>
  </li>
  <li>
    <p>READ COMMITTED<br />
-&gt; ì»¤ë°‹ëœ ì½ê¸°  <br />
-&gt; ë‹¤ë¥¸ íŠ¸ëœì­ì…˜ì— ì˜í•´ ì»¤ë°‹ëœ ë°ì´í„°ë¥¼ ì½ëŠ” ê²ƒì„ í—ˆìš©í•©ë‹ˆë‹¤.</p>
  </li>
  <li>
    <p>REPEATABLE READ<br />
-&gt; ë°˜ë³µ ê°€ëŠ¥í•œ ì½ê¸° <br />
-&gt; íŠ¸ëœì­ì…˜ ë‚´ì—ì„œ í•œ ë²ˆ ì¡°íšŒí•œ ë°ì´í„°ë¥¼ ë°˜ë³µí•´ì„œ ì¡°íšŒí•´ë„ ê°™ì€ ë°ì´í„°ê°€ ì¡°íšŒë˜ë„ë¡ í•©ë‹ˆë‹¤.</p>
  </li>
  <li>
    <p>SERIALIZABLE<br />
-&gt; ì§ë ¬í™” ê°€ëŠ¥<br />
-&gt; ë™ì¼í•œ ë°ì´í„°ì— ëŒ€í•´ì„œ ë™ì‹œì— ë‘ ê°œ ì´ìƒì˜ íŠ¸ëœì­ì…˜ì´ ìˆ˜í–‰ë˜ì§€ ëª»í•˜ë„ë¡ í•©ë‹ˆë‹¤.</p>
  </li>
</ol>

<p><br /></p>

<h2 id="event">Event</h2>
<h3 id="event-ë€">Event ë€?</h3>
<p>Spring ë‚´ë¶€ì—ëŠ” Evnetë¼ëŠ” ë§¤ì»¤ë‹ˆì¦˜ì„ ê°€ì§€ê³  ìˆë‹¤ê³ í•œë‹¤.<br />
<strong>Beanê³¼ Beanì‚¬ì´ì— ë°ì´í„°ë¥¼ ì „ë‹¬í•˜ëŠ” ë°©ë²•</strong>ì¤‘ í•˜ë‚˜ì´ë‹¤.</p>

<p>ì¼ë°˜ì ìœ¼ë¡œëŠ” ìŠ¤í”„ë§ì»¨í…Œì´ë„ˆì˜ ë¹ˆì„ ì£¼ì…í• ë•Œ DIë¥¼ ì´ìš©í•œë‹¤<br />
Evnetë¥¼ ì´ìš©í•´ ê°ì²´ë¥¼ ë„˜ê²¨ì¤„ ìˆ˜ë„ ìˆë‹¤ëŠ” ë§ì´ë‹¤.</p>

<p><br /></p>

<h3 id="evnet-ì‚¬ìš©ë°©ë²•">Evnet ì‚¬ìš©ë°©ë²•</h3>
<p>ì‚¬ìš©ë°©ë²•ì€ ê°„ë‹¨í•˜ë‹¤</p>
<ol>
  <li>publisher(ë°œí–‰)ë¡œ ì´ë²¤íŠ¸ë¥¼ ë°œìƒì‹œí‚¨ë‹¤</li>
  <li>listenerë¡œ ì´ë²¤íŠ¸ë¥¼ ë°›ëŠ”ë‹¤.</li>
</ol>

<p>publisherë¡œ ë°œí–‰ì‹œí‚¤ëŠ” ë°©ë²•ì€ <br />
ApplicationEventPublisher í´ë˜ìŠ¤ì˜ .publishEvent();<br />
ë©”ì„œë“œë¥¼ í†µí•´ì„œ ë°œí–‰ì‹œí‚¬ ìˆ˜ ìˆë‹¤.</p>

<p>íŠ¸ëœì­ì…˜ê³¼ ì—°ë™ì‹œì¼œ í•œë²ˆ ì˜ˆì œë¥¼ ë§Œë“¤ì–´ë³´ì</p>

<p>ê°„ë‹¨í•œ ì˜ˆì œë¡œ Member í´ë˜ìŠ¤ì—ëŠ” ì—¬ëŸ¬ê°€ì§€ ì •ë³´ê°€ ìˆë‹¤ê³  ê°€ì •í•˜ê³ <br />
íšŒì›ê°€ì…ì„ ëˆŒëŸ¬ POSTë§¤ì„œë“œë¥¼ í†µí•´ Serviceë¡œì§ì´ í˜¸ì¶œëœë‹¤ ê°€ì •í•´ë³´ì</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Slf4j</span>
<span class="nd">@RequiredArgsConstructor</span>
<span class="nd">@Transactional</span>
<span class="nd">@Service</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MemberService</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="nc">MemberRepository</span> <span class="n">memberRepository</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="nc">ApplicationEventPublisher</span> <span class="n">publisher</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nc">Member</span> <span class="nf">createMember</span><span class="o">(</span><span class="nc">Member</span> <span class="n">member</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">Member</span> <span class="n">savedMember</span> <span class="o">=</span> <span class="n">memberRepository</span><span class="o">.</span><span class="na">save</span><span class="o">(</span><span class="n">member</span><span class="o">);</span>
        <span class="n">publisher</span><span class="o">.</span><span class="na">publishEvent</span><span class="o">(</span><span class="k">new</span> <span class="nc">MemberCreatedEvent</span><span class="o">(</span><span class="k">this</span><span class="o">,</span> <span class="n">savedMember</span><span class="o">));</span> <span class="c1">// ì´ë²¤íŠ¸ ë°œìƒì‹œí‚¤ê¸°</span>
        <span class="k">return</span> <span class="n">savedMember</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>

</code></pre></div></div>
<p>ê°„ë‹¨í•œ ì½”ë“œë¡œ ApplicationEventPublisher ê°ì²´ë¥¼ ìŠ¤í”„ë§ì»¨í…Œì´ë„ˆë¥¼ í†µí•´<br />
ì£¼ì…ë°›ì€ ê°ì²´ publisherë¡œ ì´ë²¤íŠ¸ë¥¼ ë°œìƒì‹œí‚¤ëŠ” ë©”ì„œë“œë¥¼ ì‹¤í–‰ì‹œí‚¨ë‹¤.<br />
í•´ë‹¹ ê°ì²´ì—ëŠ” Event ì •ë³´ë¥¼ ë‹´ì€ ê°ì²´ê°€ ë“¤ì–´ìˆì–´ì•¼í•œë‹¤.</p>

<p>ì •ë³´ë¥¼ ë‹´ì€ ê°ì²´ë¥¼ ë”°ë¡œ ë§Œë“¤ê¸°ìœ„í•´ í´ë˜ìŠ¤ë¥¼ ë§Œë“¤ì—ˆë‹¤.</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Getter</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MemberCreatedEvent</span> <span class="kd">extends</span> <span class="nc">ApplicationEvent</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="nc">Member</span> <span class="n">member</span><span class="o">;</span>
    <span class="kd">public</span> <span class="nf">MemberCreatedEvent</span><span class="o">(</span><span class="nc">Object</span> <span class="n">source</span><span class="o">,</span> <span class="nc">Member</span> <span class="n">member</span><span class="o">)</span> <span class="o">{</span>
        <span class="kd">super</span><span class="o">(</span><span class="n">source</span><span class="o">);</span>
        <span class="k">this</span><span class="o">.</span><span class="na">member</span> <span class="o">=</span> <span class="n">member</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>MemberCreatedEventë¼ëŠ” ê°ì²´ë¥¼ Eventí•˜ì—¬<br />
ìš°ë¦¬ëŠ” ì´ì œ Listenrë¥¼ í†µí•´ ê°ì²´ë¥¼ ë°›ì„ ìˆ˜ ìˆë‹¤.</p>

<p>Listener í´ë˜ìŠ¤ë¥¼ ë§Œë“¤ì–´ë³´ì</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Component</span>
<span class="nd">@RequiredArgsConstructor</span>
<span class="nd">@Slf4j</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MemberCreatedEventListener</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="nc">EmailSender</span> <span class="n">emailSender</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="nc">MemberService</span> <span class="n">memberService</span><span class="o">;</span>
    
    <span class="nd">@EventListener</span> <span class="c1">// EventListenerë¡œ Event ê°ì²´ ê°€ì ¸ì˜´</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">listener</span><span class="o">(</span><span class="nc">MemberCreatedEvent</span> <span class="n">event</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="nc">String</span> <span class="n">message</span> <span class="o">=</span> <span class="s">"message test"</span><span class="o">;</span>
            <span class="n">emailSender</span><span class="o">.</span><span class="na">sendEmail</span><span class="o">(</span><span class="n">message</span><span class="o">);</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">MailSendException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">log</span><span class="o">.</span><span class="na">error</span><span class="o">(</span><span class="s">"MailSendException, rollback"</span><span class="o">);</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">RuntimeException</span><span class="o">(</span><span class="n">e</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>
<p>@EventListener ì–´ë…¸í…Œì´ì…˜ì„ ì‚¬ìš©í•œ<br />
ë©”ì„œë“œëŠ” Eventë¡œ ë°œí–‰í•œ ê°ì²´ë¥¼ ê°€ì ¸ì˜¬ ìˆ˜ ìˆë‹¤.</p>

<p>Service ë¡œì§ì´ ì‹¤í–‰ë˜ì–´ì§ˆë•Œ Evnet ë©”ì„œë“œë¥¼ ë§Œë‚˜ëŠ” ìˆœê°„<br />
ì œì–´ì˜ íë¦„ì´ Listener í´ë˜ìŠ¤ë¡œ ë„˜ì–´ì˜¤ê²Œ ë˜ì–´ì§„ë‹¤.</p>

<p>ìœ„ì— ì˜ˆì œëŠ” ê°„ë‹¨í•˜ê²Œ emailì„ ë³´ë‚´ëŠ” ì˜ˆì œë¡œ ì‘ì„±í•˜ì˜€ê³ <br />
ë©”ì„œë“œë¥¼ ì‹¤í–‰í•˜ë©´ 5ì´ˆë’¤ì— MailSendExceptionì´ë¼ëŠ”<br />
Checked Exceptionì„ ë°œìƒí•˜ê²Œ ì½”ë“œë¥¼ ì‘ì„±í•˜ì˜€ë‹¤.</p>

<p>ì‹¤ì œ ë¡œì§ì„ ì‹¤í–‰í•  ê²½ìš°</p>
<ol>
  <li>Serviceë¡œì§ì—ì„œ Event ë°œí–‰í•˜ì—¬ Listener í˜¸ì¶œ</li>
  <li>Listener í´ë˜ìŠ¤ì—ì„œ Event íƒ€ì…ê³¼ ë§ëŠ”ê°ì²´ë¥¼ ì°¾ì•„ ê°ì²´ë¥¼ ì£¼ì…</li>
  <li>.sendEmail(message)ì—ì„œ Checked Exception ë°œìƒ</li>
  <li>Checked Exceptionì€ rollbackì´ ì•ˆë˜ê¸°ë•Œë¬¸ì— Unchecked <br />
Exceptionìœ¼ë¡œ ë‹¤ì‹œ ì˜ˆì™¸ì²˜ë¦¬(RuntimeException)</li>
  <li>ìµœì¢…ì ìœ¼ë¡œ rollbackí•˜ì—¬ ê¸°ì¡´ì— ì²˜ë¦¬ë˜ì–´ì§„ ì‘ì—… ì¢…ë£Œ</li>
</ol>

<p>ìœ„ì™€ ê°™ì´ ë™ì‘í•˜ëŠ” ëª¨ìŠµì„ ë³¼ ìˆ˜ ìˆë‹¤.</p>

<p><br /></p>

<h2 id="async">@Async</h2>
<p>ìŠ¤í”„ë§ í”„ë ˆì„ì›Œí¬ì—ì„œ ì§€ì›í•˜ëŠ” ë¹„ë™ê¸° ì²˜ë¦¬ ë°©ì‹ì´ë‹¤.<br />
í•´ë‹¹ ì–´ë…¸í…Œì´ì…˜ì„ ì´í•´í•˜ê¸° ìœ„í•´ì„  ë©€í‹°ì“°ë ˆë“œ, ë™ê¸°, ë¹„ë™ê¸°ì—<br />
ì´í•´ê°€ í•„ìš”í•˜ë‹¤.</p>

<p>ì •ë§ ê°„ë‹¨í•˜ê²Œ ì •ë¦¬í•˜ìë©´<br />
ë™ê¸° - í•˜ë‚˜ì˜ ì“°ë ˆë“œì—ì„œ ê°™ì€ ì œì–´íë¦„ì„ ê°€ì§<br />
ë¹„ë™ê¸° - ë©€í‹°ì“°ë ˆë“œë¡œ ì„œë¡œ ë‹¤ë¥´ê²Œ ì œì–´íë¦„ì„ê°€ì§</p>

<p>ì´ë¼ê³  ìƒê°í•´ë³¼ ìˆ˜ ìˆì„ ê²ƒ ê°™ë‹¤.</p>

<p>ê°„ë‹¨í•˜ê²Œ ìœ„ì—ì„œ ë³´ì•˜ë˜ ì½”ë“œ ì˜ˆì œë¡œ ë³¸ë‹¤ë©´<br />
MemberServiceì—ì„œ í•˜ë‚˜ì˜ ì“°ë ˆë“œë¡œ<br />
Eventë¥¼ ë°œí–‰ì‹œí‚¤ê³  Listener ë©”ì„œë“œë¡œ í˜¸ì¶œë˜ê²Œ ë˜ì–´<br />
ìµœì¢…ì ìœ¼ë¡œ Unchecked Exceptionì´ ë°œìƒí•˜ì—¬<br />
rollback(); ë˜ì–´ì§€ëŠ” ëª¨ìŠµì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.</p>

<p>ë§Œì•½ ìœ„ì— ì½”ë“œì—ì„œ @Asyncë¥¼ ì ìš©í•˜ì—¬<br />
í•´ë‹¹ ë©”ì„œë“œë¥¼ ë¹„ë™ê¸°ë¡œ ê°€ì ¸ê°ˆ ìˆ˜ê°€ ìˆë‹¤.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Component</span>
<span class="nd">@RequiredArgsConstructor</span>
<span class="nd">@Slf4j</span>
<span class="nd">@EnableAsync</span> <span class="c1">// ë¹„ë™ê¸° ì‚¬ìš©ê°€ëŠ¥í•˜ë„ë¡ ì„¤ì •</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MemberCreatedEventListener</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="nc">EmailSender</span> <span class="n">emailSender</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="nc">MemberService</span> <span class="n">memberService</span><span class="o">;</span>

    <span class="nd">@Async</span> <span class="c1">// ë¹„ë™ê¸°ë¡œ ì´ë©”ì¼ ì „ë‹¬í•˜ë„ë¡ ë³€ê²½</span>
    <span class="nd">@EventListener</span> 
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">listener</span><span class="o">(</span><span class="nc">MemberCreatedEvent</span> <span class="n">event</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="nc">String</span> <span class="n">message</span> <span class="o">=</span> <span class="s">"message test"</span><span class="o">;</span>
            <span class="n">emailSender</span><span class="o">.</span><span class="na">sendEmail</span><span class="o">(</span><span class="n">message</span><span class="o">);</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">MailSendException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">log</span><span class="o">.</span><span class="na">error</span><span class="o">(</span><span class="s">"MailSendException, rollback"</span><span class="o">);</span>
            <span class="n">memberService</span><span class="o">.</span><span class="na">deleteMember</span><span class="o">(</span><span class="n">event</span><span class="o">.</span><span class="na">getMember</span><span class="o">().</span><span class="na">getMemberId</span><span class="o">());</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">RuntimeException</span><span class="o">(</span><span class="n">e</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>
<p>@EnableAsync , @Async ì–´ë…¸í…Œì´ì…˜ì„ ì´ìš©í•´<br />
listenrë¼ëŠ” ë©”ì„œë“œëŠ” ë¹„ë™ê¸°ìƒíƒœê°€ ë˜ì—ˆë‹¤.<br />
ì¦‰, MemberSerivce ë¡œì§ì—ì„œ í˜¸ì¶œí•˜ì—¬ë„ ì œì–´ì˜ íë¦„ì€<br />
MemberSerivceëŠ” ë³¸ì¸ ì“°ë ˆë“œëŒ€ë¡œ ì§„í–‰í•˜ê³ </p>

<p>listenr ë©”ì„œë“œëŠ” ë³„ë„ì˜ ì“°ë ˆë“œê°€ ìƒê²¨ ì§„í–‰í•˜ê²Œëœë‹¤.</p>

<hr />
<p>ì˜¤ëŠ˜ì€ ì´ë ‡ê²Œ Evnetì™€ Transactionì— ëŒ€í•´<br />
ì¡°ê¸ˆ ë” ì•Œì•„ë³´ëŠ” ì‹œê°„ì„ ê°€ì¡Œë‹¤.</p>

<p>ëŒ€ëµì ì¸ ë‚´ìš©ê³¼ ì´í•´ëŠ” ì–´ëŠì •ë„ ëœ ê²ƒ ê°™ë‹¤.<br />
í•˜ì§€ë§Œ íŠ¸ëœì­ì…˜ ì–´ë…¸í…Œì´ì…˜ì´ í•´ì£¼ëŠ” ê¸°ëŠ¥ì´ ë„ˆë¬´ í’ë¶€í•˜ê¸°ë•Œë¬¸ì—<br />
ì˜¤íˆë ¤ ë‚´ì§€ì‹ì˜ í•œê³„ê°€ ë³´ì—¬ì§€ëŠ” ê²ƒ ê°™ë‹¤.</p>

<p>ì‹¤ì œ ë‚´ë¶€ì—ì„œ ì–´ë–»ê²Œ ë™ì‘í•˜ëŠ”ì§€ë¥¼ ì•Œì•„ì•¼<br />
íŠ¸ë˜ì­ì…˜ì— ëŒ€í•´ ì™„ë²½íˆ ì´í•´í–ˆë‹¤ê³  í•  ìˆ˜ ìˆì„ ê²ƒ ê°™ë‹¤.<br />
ì§€ê¸ˆì€ ëŒ€ëµ ì ì¸ ê·¸ë¦¼ìœ¼ë¡œë§Œ ë¨¸ë¦¿ì†ì—ì„œ ê·¸ë ¤ì§€ì§€ë§Œ<br />
í›„ì— ì–´ë“œë°´ìŠ¤í•œ ê³µë¶€ë¥¼ í†µí•´ íŠ¸ëœì­ì…˜ì„ ë‹¤ì‹œ ì •ë³µí•´ë³´ì</p>

<p>ì˜¤ëŠ˜ ê³µë¶€ëŠ” ì—¬ê¸°ì„œ ë!!</p>

<p><br /></p>

<p><span style="color:#994C00"><strong>ì˜¤ëŠ˜ì˜ ì»¤í”¼ëŸ‰</strong></span>: â˜•ï¸ â˜•ï¸ â˜•ï¸<br />
<strong>ì˜¤ëŠ˜ì˜ ì ì‹¬</strong>: ì¹´ë ˆ, ê¹€ì¹˜ì°Œê°œ</p>]]></content><author><name>LEE JAEHYEOK</name></author><category term="TIL" /><category term="TIL" /><category term="ë¶€íŠ¸ìº í”„" /><category term="ì½”ë“œìŠ¤í…Œì´ì¸ " /><summary type="html"><![CDATA[ë‚ ì”¨ë„ ì„ ì„ í•˜ë‹ˆ ê¸°ë¶„ì¢‹ì€ ì›”ìš”ì¼ ì‹œì‘ì´ë‹¤.]]></summary></entry><entry><title type="html">TIL) Spring Transaction 1</title><link href="http://localhost:4000/til/2022/11/04/til.html" rel="alternate" type="text/html" title="TIL) Spring Transaction 1" /><published>2022-11-04T00:00:00+09:00</published><updated>2022-11-04T00:00:00+09:00</updated><id>http://localhost:4000/til/2022/11/04/til</id><content type="html" xml:base="http://localhost:4000/til/2022/11/04/til.html"><![CDATA[<p>ë“œë””ì–´ ê¸ˆìš”ì¼ì´ë‹¤ !!</p>

<p><img src="https://lh3.googleusercontent.com/drive-viewer/AJc5JmTMURddp7eS9p4eU_B_kWlUW2OZXswDZohNbNZsQyulns7guaGsjqClS9QHbeeZNzRPUp9PL-pgI6FXT-9PQEqibl_29Q=w1920-h921" alt="image" class="align-left" style="max-width: 100%" /></p>

<p>ì£¼ë§ì´ ë˜ì–´ë„ ê³µë¶€ë¥¼í•  ê²ƒì´ê¸° ë•Œë¬¸ì—<br />
ì›”ìš”ì¼ê¹Œì§€ ìˆœì‚­ë‹¹í•  ê²ƒ ê°™ë‹¤.</p>

<p>í•˜ë‚˜í•œ ì•Œì•„ê°ˆ ìˆ˜ë¡ ì¢€ë” ì•Œê³  ì‹¶ì€ ë§ˆì„±ì˜ ê¸°ëŠ¥ë“¤â€¦<br />
ë„ˆë¬´ ì¬ë°Œë‹¤. ê³„ì†í•´ì„œ ê³µë¶€í•˜ê²Œëœë‹¤.</p>

<hr />

<p>ì˜¤ëŠ˜ì€ íŠ¸ëœì­ì…˜ì— ëŒ€í•´ ê³µë¶€í•´ë³´ëŠ” ì‹œê°„ì´ë‹¤.<br />
ì—¬ëŸ¬ë²ˆ ë“¤ì–´ë´¤ê³  ì•„ì§ ì–´ë–¤ ì˜ë¯¸ì¸ì§€ë¥¼<br />
ì •í™•íˆ ì•Œì§€ëª»í•˜ë‹ˆ ê³µë¶€í•´ë³´ë„ë¡í•˜ì</p>

<p><br /></p>

<h2 id="transaction">Transaction</h2>

<h3 id="transaction-ì´ë€">Transaction ì´ë€?</h3>
<p>íŠ¸ëœì­ì…˜ì€ ì—¬ëŸ¬ê°œì˜ ì‘ì—…ë“¤ì„ í•˜ë‚˜ì˜ ê·¸ë£¹ìœ¼ë¡œ<br />
ë¬¶ì–´ì„œ ì²˜ë¦¬í•˜ëŠ” ì²˜ë¦¬ ë‹¨ìœ„ë¡œ, ë¬¼ë¦¬ì ìœ¼ë¡œëŠ” ì—¬ëŸ¬ê°œì˜ ì‘ì—…ì´ì§€ë§Œ<br />
ë…¼ë¦¬ì ìœ¼ë¡  ë§ˆì¹˜ í•˜ë‚˜ì˜ ì‘ì—…ìœ¼ë¡œ ì¸ì‹í•´ì„œ<br />
ì „ë¶€ ì„±ê³µ or ì‹¤íŒ¨ ì˜ ê²°ê³¼ë¡œ í•˜ë‚˜ë¡œë§Œ ì²˜ë¦¬ë˜ì–´ì•¼í•˜ëŠ” ì˜ë¯¸ë¥¼ ê°€ì§„ë‹¤.</p>

<p>ì˜ˆë¥¼ ë“¤ì–´ì„œ, ê³„ì¢Œì´ì²´ë¥¼ í•œë‹¤ê³  ê°€ì •í•˜ì˜€ì„ ê²½ìš°<br />
Aë¼ëŠ” ì‚¬ëŒì´ Bë¼ëŠ” ì‚¬ëŒì—ê²Œ ê³„ì¢Œì´ì²´ë¥¼ í–ˆì„ë•Œ<br />
AëŠ” ì†¡ê¸ˆì„ í–ˆì§€ë§Œ ì˜¤ë¥˜ë¡œì¸í•´ Bê°€ ë°›ì§€ ëª»í–ˆì„ ê²½ìš°<br />
Aì˜ ëˆë§Œ ë¹ ì§€ê³  BëŠ” ë°›ì§€ëª»í•˜ëŠ” ìƒí™©ì´ ìƒê¸´ë‹¤. ì´ëŸ° ê²½ìš°ê°€ ìƒê¸´ë‹¤ë©´<br />
ì„œë¹„ìŠ¤ë¥¼ í•˜ì§€ëª»í•  ì •ë„ì˜ í° ì¼ì´ ë‚˜ê¸°ë•Œë¬¸ì— ì†¡ê¸ˆì´ë¼ëŠ” ì‘ì—…ë‹¨ìœ„ê°€ ìˆìœ¼ë©´<br />
ìµœì¢…ì ìœ¼ë¡œ ì†¡ê¸ˆì™„ë£Œê¹Œì§€ í•˜ë‚˜ì˜ íŠ¸ëœì­ì…˜ìœ¼ë¡œ ë´ì•¼í•˜ëŠ” ê²ƒì´ë‹¤.</p>

<p>íŠ¸ëœì­ì…˜ì„ ì–˜ê¸°í• ë•ŒëŠ” ACID ì›ì¹™ì„ ì´ìš©í•œë‹¤.</p>

<h3 id="acid-ì›ì¹™">ACID ì›ì¹™</h3>
<ol>
  <li>ì›ìì„±: íŠ¸ëœì­ì…˜ ë‚´ì—ì„œ ì‹¤í–‰í•œ ì‘ì—…ë“¤ì€ ë§ˆì¹˜ í•˜ë‚˜ì˜ ì‘ì—…ì¸ ê²ƒì²˜ëŸ¼ ëª¨ë‘ ì„±ê³µ í•˜ê±°ë‚˜ ëª¨ë‘ ì‹¤íŒ¨í•´ì•¼ í•œë‹¤.</li>
  <li>ì¼ê´€ì„±: ëª¨ë“  íŠ¸ëœì­ì…˜ì€ ì¼ê´€ì„± ìˆëŠ” ë°ì´í„°ë² ì´ìŠ¤ ìƒíƒœë¥¼ ìœ ì§€í•´ì•¼ í•œë‹¤. ì˜ˆë¥¼ ë“¤ì–´ ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ ì •í•œ ë¬´ê²°ì„± ì œì•½ ì¡°ê±´ì„ í•­ìƒ ë§Œì¡±í•´ì•¼ í•œë‹¤.</li>
  <li>ê²©ë¦¬ì„±: ë™ì‹œì— ì‹¤í–‰ë˜ëŠ” íŠ¸ëœì­ì…˜ë“¤ì´ ì„œë¡œì—ê²Œ ì˜í–¥ì„ ë¯¸ì¹˜ì§€ ì•Šë„ë¡ ê²©ë¦¬í•œë‹¤. ì˜ˆë¥¼ ë“¤ì–´ ë™ì‹œì— ê°™ì€ ë°ì´í„°ë¥¼ ìˆ˜ì •í•˜ì§€ ëª»í•˜ë„ë¡ í•´ì•¼ í•œë‹¤. ê²©ë¦¬ì„±ì€ ë™ì‹œì„±ê³¼ ê´€ë ¨ëœ ì„±ëŠ¥ ì´ìŠˆë¡œ ì¸í•´ íŠ¸ëœì­ì…˜ ê²©ë¦¬ ìˆ˜ì¤€ (Isolation level)ì„ ì„ íƒí•  ìˆ˜ ìˆë‹¤.</li>
  <li>ì§€ì†ì„±: íŠ¸ëœì­ì…˜ì„ ì„±ê³µì ìœ¼ë¡œ ëë‚´ë©´ ê·¸ ê²°ê³¼ê°€ í•­ìƒ ê¸°ë¡ë˜ì–´ì•¼ í•œë‹¤. ì¤‘ê°„ì— ì‹œìŠ¤í…œì— ë¬¸ì œê°€ ë°œìƒí•´ë„ ë°ì´í„°ë² ì´ìŠ¤ ë¡œê·¸ ë“±ì„ ì‚¬ìš©í•´ì„œ ì„±ê³µí•œ íŠ¸ëœì­ì…˜ ë‚´ìš©ì„ ë³µêµ¬í•´ì•¼ í•œë‹¤.</li>
</ol>

<h3 id="dbë¡œ-í™•ì¸í•˜ëŠ”-ì˜ˆì œ">DBë¡œ í™•ì¸í•˜ëŠ” ì˜ˆì œ</h3>
<p>ìš°ì„  DataBaseë¥¼ í†µí•´ ê°œë…ì„ í™•ì¸í•´ ë³¼ ìˆ˜ ìˆë‹¤.</p>

<p><img src="https://lh3.googleusercontent.com/drive-viewer/AJc5JmQSexoFyUMZWpDWivlRkoPtfcQ3EoLXbMdi9AvRnh8SV8ty8-one4e3UBrV9O3-6YBbptYiajuOe45fpQfUQ_9wPMjh=w1920-h921" alt="image" class="align-left" style="max-width: 100%" /></p>

<p>ê°„ë‹¨í•œ ì˜ˆì œë¥¼ ìœ„í•´ H2 ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ì‚¬ìš©í–ˆê³ <br />
ì¿¼ë¦¬ë¡œ ê°ì memberA, memberBì—ê²Œ 10000ì›ì„ ë„£ì–´ë‘ì—ˆë‹¤.</p>

<p><br /></p>

<p><img src="https://lh3.googleusercontent.com/drive-viewer/AJc5JmTdKis6NrWIeBPyfuYe62wOBUart4GIDHJxWqR8I5AnKeGNfAzgKf7ZUzlaqBP809jTGi3lWHsipeS_Oh5wCkFc7OjBww=w1920-h921" alt="image" class="align-left" style="max-width: 100%" /></p>

<p>ì˜ˆë¥¼ ë“¤ì–´ ê°€ì •í•´ë³´ì, memberAë¼ëŠ” ì‚¬ëŒì´<br />
2000ì›ì„ Bì—ê²Œ ì¤€ë‹¤ê³  ê°€ì •í•˜ê¸°ìœ„í•´ ì¿¼ë¦¬ë¥¼ ì´ìš©í•´ <br />
ì™¼ìª½ ì„¸ì…˜ì˜ memberAë¼ëŠ” ì‚¬ëŒì˜ ëˆì„ 2000ì› ì°¨ê° ì‹œì¼°ë‹¤.<br />
<em>(ìë™ ì»¤ë°‹ì„ êº¼ì£¼ëŠ” ì¿¼ë¦¬ë„ ê°™ì´ ë„£ì—ˆë‹¤.)</em></p>

<p>ì—¬ê¸°ì„œ ì¤‘ìš”í•œì ì€ ì™¼ìª½ê³¼ ì˜¤ë¥¸ìª½ì€ ì„¸ì…˜ìœ¼ë¡œ ë‚˜íƒ€ë‚¸ ê²ƒì´ë©°<br />
ì´ ë‘ ê°œì˜ ì„¸ì…˜ìœ¼ë¡œ í…ŒìŠ¤íŠ¸ë¥¼ í•˜ì˜€ë‹¤. <br />
ì„¸ì…˜ì´ë€ ìš°ë¦¬ê°€ DBì— ì ‘ê·¼ì„ í•  ë–„, í´ë¼ì´ì–¸íŠ¸ì™€ Connectionì„ ë§ºê²Œë˜ëŠ”ë°  <br />
ë°ì´í„° ë² ì´ìŠ¤ ì„œë²„ëŠ” ë‚´ë¶€ì— ì„¸ì…˜ì´ë€ ê²ƒì„ ë§Œë“¤ì–´ í•´ë‹¹ ì»¤ë„¥ì…˜ì„ í†µí•œ ëª¨ë“  <br />
ìš”ì²­ì€ ì´ ì„¸ì…˜ì„ í†µí•´ì„œ ì‹¤í–‰í•˜ê²Œ ëœë‹¤.</p>

<p><strong>í•œ ë§ˆë””ë¡œ SQLì„ ì „ë‹¬ ë°›ìœ¼ë©´ í˜„ì¬ ì»¤ë„¥ì…˜ì— ì—°ê²°ëœ ì„¸ì…˜ì´ SQLì„ ì‹¤í–‰í•œë‹¤.</strong></p>

<p>ì´ ì–˜ê¸°ë¥¼ í† ëŒ€ë¡œ ìœ„ë¥¼ ì‚´í´ë³´ìë©´, ì»¤ë°‹ì´ ì´ë£¨ì–´ ì§€ì§€ ì•Šì€ ìƒíƒœì´ê³ <br />
ì™¼ìª½ ì„¸ì…˜ì„ ì¡°íšŒ ì¿¼ë¦¬ë¥¼ ë‚ ë ¸ì„ë•ŒëŠ” ì •ìƒì ìœ¼ë¡œ 2000ì›ì´ ì°¨ê°ë˜ì—ˆì§€ë§Œ<br />
ì˜¤ë¥¸ìª½ ì„¸ì…˜ì—ì„œëŠ” ì¡°íšŒë¥¼í•´ë„ ê¸°ì¡´ì˜ 10000ì›ì´ í‘œì‹œë˜ëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤.</p>

<p>ì´ ë§ì€ ì¦‰, ì™¼ìª½ ì„¸ì…˜ì´ commit();ë˜ì§€ ì•Šì•„<br />
ì˜¤ë¥¸ìª½ ì„¸ì…˜ê³¼ ë‹¤ë¥´ê²Œ ë³´ì´ëŠ” ëª¨ìŠµì´ë‹¤.</p>

<p><br /></p>

<p><img src="https://lh3.googleusercontent.com/drive-viewer/AJc5JmSAT0SVkFQRFSs83afh0wemUypXU-0AxB9UgUTQ_nXJ2xMQ_SWhKlueIx5wVXyuV7Z-Lp2pAuv2Otk9W-yQBG81MMnGXQ=w1920-h921" alt="image" class="align-left" style="max-width: 100%" /></p>

<p>ì´ ìƒí™©ì—ì„œ ì™¼ìª½ ì„¸ì…˜ì— commit(); ëª…ë ¹ì„ ë³´ë‚¸ í›„<br />
ì™¼ìª½ ì˜¤ë¥¸ìª½ ì„¸ì…˜ì„ ì¡°íšŒí•´ë³´ë©´<br />
ìœ„ì™€ ê°™ì´ ë™ì¼í•´ì§„ ëª¨ìŠµì„ ë³¼ ìˆ˜ ìˆë‹¤.</p>

<p><br /></p>

<p><img src="https://lh3.googleusercontent.com/drive-viewer/AJc5JmQSexoFyUMZWpDWivlRkoPtfcQ3EoLXbMdi9AvRnh8SV8ty8-one4e3UBrV9O3-6YBbptYiajuOe45fpQfUQ_9wPMjh=w1920-h921" alt="image" class="align-left" style="max-width: 100%" /></p>

<p>ë°˜ëŒ€ë¡œ ì™¼ìª½ ì„¸ì…˜ì—ì„œ rollback(); ëª…ë ¹ì„ ë³´ëƒˆì„ ê²½ìš°ì—ëŠ”<br />
ìœ„ì™€ ê°™ì´ ì›ë˜ìƒíƒœë¡œ ëŒì•„ê°„ ëª¨ìŠµì„ ë³¼ ìˆ˜ ìˆë‹¤.</p>

<p>ì—¬ê¸°ì„œ ìš°ë¦¬ëŠ” ì•Œì•„ì•¼í•  ê²ƒì´ ì„¸ì…˜ì— ë”°ë¼<br />
ì„œë¡œ ìƒíƒœê°€ ë‹¤ë¥´ê²Œ ë³´ì´ëŠ” ë¬¸ì œê°€ ë°œìƒí•œë‹¤.<br />
ê·¸ëŸ¼ ìˆ˜ë§ì€ ì‚¬ëŒì´ ì´ìš©í•˜ëŠ” í´ë¼ì´ì–¸íŠ¸ì—ì„œ ì—¬ëŸ¬ ìš”ì²­ì´ì™€<br />
ì¿¼ë¦¬ê°€ ìˆ˜ë„ ì—†ì´ ë‚ ë¼ì™”ì„ ê²½ìš°ì— DBì¡°ì‘ì— ìˆì–´ ì–´ë ¤ì›€ì´ ìƒê¸´ë‹¤.</p>

<p>ê·¸ë˜ì„œ íŠ¸ëœì­ì…˜ìœ¼ë¡œ ì‘ì—…ë‹¨ìœ„ë¥¼ í•˜ë‚˜ë¡œ ë¬¶ì–´<br />
í•´ë‹¹ ì„¸ì…˜ì´ ì‹¤í–‰ë˜ì—ˆì„ ë•Œ ì˜ˆì™¸ë°œìƒí•˜ì§€ ì•Šê³  ì „ë¶€ ì„±ê³µí–ˆì„ ê²½ìš°<br />
ë‹¤ë¥¸ ì„¸ì…˜ì´ ì´ìš©ì´ ê°€ëŠ¥í•˜ë„ë¡ êµ¬í˜„í•  í•„ìš”ê°€ ìˆë‹¤.</p>

<p><br /></p>

<h3 id="db-lock">DB Lock</h3>

<p>ìœ„ì—ì„œ commit();ê³¼ rollback();ì— ëŒ€í•´ì„œ ì•Œì•„ë³´ì•˜ë‹¤.<br />
ë‚´ê°€ ìˆ˜í–‰í•˜ëŠ” ë¹„ì§€ë‹ˆìŠ¤ ë¡œì§ê³¼ ì¿¼ë¦¬ê°€ ì •ìƒì ìœ¼ë¡œ ëª¨ë‘ ìˆ˜í–‰ë˜ì—ˆì„ë•Œ<br />
commit();ì„ ì§„í–‰í•˜ê³  ë„ì¤‘ì— ì˜ˆì™¸ê°€ ìƒê¸°ë©´ rollback();ì„ í•´ì£¼ë©´ëœë‹¤.</p>

<p>ì—¬ê¸°ì„œ í•œê°€ì§€ ìƒê°í•´ë³´ì•„ì•¼í•  ê²ƒì´ ìš°ë¦¬ê°€ commit();ì„ í•˜ê¸°ì „ì—<br />
ë‹¤ë¥¸ ì„¸ì…˜ì—ì„œëŠ” ê¸°ì¡´ì˜ ìƒíƒœê°€ ë³´ì—¬ì§€ê²Œë˜ì–´ì§„ë‹¤.</p>

<p>ì´ëŸ¬í•œ ìƒíƒœì—ì„œ ë‹¤ë¥¸ì„¸ì…˜ì—ì„œ í•´ë‹¹ë¶€ë¶„ì„ ìˆ˜ì •í•˜ëŠ” ì¿¼ë¦¬ë¥¼ ë³´ëƒˆì„ ê²½ìš°ì—ëŠ”<br />
ì–´ë–»ê²Œ ë™ì‘ì´ ë˜ì–´ì§€ëŠ”ê°€? í•˜ëŠ” ì˜ë¬¸ì´ìƒê¸´ë‹¤.</p>

<p>ë°ì´í„°ë² ì´ìŠ¤ëŠ” ì´ëŸ° ë¬¸ì œë¥¼ í•´ê²°í•˜ê¸°ìœ„í•´<br />
DB Lockì´ë¼ëŠ” ê°œë…ì„ ì œê³µí•´ì¤€ë‹¤.</p>

<p><br /></p>

<p><img src="https://lh3.googleusercontent.com/drive-viewer/AJc5JmTXbqbmqrTNq4gTfLkWf9gIJXW9eWn5HcHqjCdyoOV_OqscxzZOTWG29-j0iGltlzppk2c_rsWgRkU_IpsJvYsXvwDtfw=w1920-h921" alt="image" class="align-left" style="max-width: 100%" /></p>

<p>memberAë¼ëŠ” ì‚¬ëŒì˜ ëˆì„ 10000ìœ¼ë¡œ ì…‹íŒ…í•´ë‘ê³ <br />
ì™¼ìª½ ì„¸ì…˜ì—ëŠ” 500ìœ¼ë¡œ ë³€ê²½(commit í•˜ì§€ì•ŠìŒ), ì˜¤ë¥¸ìª½ ì„¸ì…˜ì—ëŠ” ê¸°ì¡´ê³¼ ë™ì¼<br />
ìƒíƒœë¡œ ë‘”ë‹¤ìŒ ì˜¤ë¥¸ìª½ ì„¸ì…˜ì—ì„œ memberAì˜ ëˆì„ 1000ìœ¼ë¡œ ë°”ê¾¸ì—ˆì„ ë•Œ</p>

<p>ì–´ë– í•œ ì¼ì´ ë°œìƒí•˜ëŠëƒ? ë¼ëŠ”ê²Œ ìš°ë¦¬ì˜ ì´ˆì ì´ë‹¤.</p>

<p><br /></p>

<p><img src="https://lh3.googleusercontent.com/drive-viewer/AJc5JmTIXyEljH6kJA5qPQ9z19u5CL3sddOYEaiCJ9TFDKrv-tNNWb90ILvae9qEluwWPvwyeMvOwCfjKKnetibuOWXBRxRm=w1920-h921" alt="image" class="align-left" style="max-width: 100%" /></p>

<p>ê²°ê³¼ëŠ” ìœ„ì™€ ê°™ì´ ì˜¤ë¥¸ìª½ ì„¸ì…˜ì—ì„œëŠ” ìˆ˜í–‰í•  ìˆ˜ ìˆëŠ” ì¿¼ë¦¬ë¥¼ ì‹¤í–‰í•œë‹¤.<br />
ì˜¤ë¥¸ìª½ ì„¸ì…˜ì„ ë³´ë©´ ì•„ë˜ì— ì‹¤í–‰ëœ ì¿¼ë¦¬ì˜ ë¡œê·¸ë¥¼ ë³¼ ìˆ˜ ìˆë‹¤.</p>

<p>SET LOCK_TIMEOUT 60000; -&gt; ë½ íƒ€ì„ì•„ì›ƒì„ 60ì´ˆë¡œ ì„¤ì •<br />
set autocommit false; -&gt; ìˆ˜ë™ì»¤ë°‹ìœ¼ë¡œ ë³€ê²½<br />
ì´ ë‘ê°€ì§€ê°€ ì‹¤í–‰ ë˜ì—ˆê³ , ê¶ê·¹ì ìœ¼ë¡œ 1000ì›ìœ¼ë¡œ ë³€ê²½í•˜ëŠ”<br />
update ì¿¼ë¦¬ë¬¸ì´ ì‹¤í–‰ë˜ì§€ ì•Šì€ ëª¨ìŠµì´ë‹¤.</p>

<p>ê·¸ ë§ì€ ì¦‰, DBì—ì„œ Lockì´ë¼ëŠ” ê°œë…ì„ ì œê³µí•´<br />
ë³€ê²½ì„ ê°•ì œë¡œ ë§‰ì•„ì£¼ê³  ìˆëŠ” ëª¨ìŠµì´ë‹¤.</p>

<p>ì™¼ìª½ íŠ¸ëœì­ì…˜ì´ ì‹¤í–‰ë˜ì–´ì§ˆ ë•Œ ë½ì„ íšë“í•˜ì—¬ <br />
commit();ì„ í•˜ê¸°ì „ê¹Œì§€ ë‹¤ë¥¸ ì„¸ì…˜ì˜ ì ‘ê·¼ì„ ë§‰ê³ ìˆëŠ” ê²ƒì´ë‹¤.</p>

<p>í•˜ì§€ë§Œ ì²«ë²ˆì¨° ì¿¼ë¦¬ë¡œ íƒ€ì„ì•„ì›ƒì„ ì„¤ì •í–ˆê¸° ë•Œë¬¸ì—<br />
í•´ë‹¹ íŠ¸ëœì­ì…˜ì€ 60ì´ˆ í›„ì— ì•„ë˜ì™€ ê°™ì€<br />
ì•ŒëŒì´ ë°œìƒí•˜ë©´ì„œ ì„¸ì…˜ì´ ìë™ì ìœ¼ë¡œ ì¢…ë£Œí•˜ê²Œëœë‹¤.</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> Timeout trying to lock table {0}; SQL statement:
    update member set money=10000 - 2000 where member_id = 'memberA' [50200-200]
    HYT00/50200
</code></pre></div></div>

<p><br /></p>

<p><img src="https://lh3.googleusercontent.com/drive-viewer/AJc5JmQpgfd4MHVjIet62g9TxKlmVw0jeVCINrpP4pRD2xp6UdS5EnMW2uhWA9zz8uNjxKyp2cSFOriSBRFKGXI8zqUib6As1A=w1920-h921" alt="image" class="align-left" style="max-width: 100%" /></p>

<p>ë°˜ëŒ€ë¡œ 60ì´ˆê°€ ì§€ë‚˜ê¸° ì „ì— ì™¼ìª½ ì„¸ì…˜ì—ì„œ<br />
commit();í•˜ì—¬ ë½ì„ ë°˜ë‚©í•˜ì˜€ì„ ê²½ìš°ì—ëŠ”<br />
ì˜¤ë¥¸ìª½ì„¸ì…˜ì—ì„œ ë½ì„ íšë“í•˜ì—¬ update ì¿¼ë¦¬ë¥¼ ì§„í–‰í•œ ëª¨ìŠµì„<br />
ìœ„ìœ„ ì‚¬ì§„ê³¼ ê°™ì´ í™•ì¸í•´ ë³¼ ìˆ˜ ìˆë‹¤.</p>

<p>í•œ ë§ˆë””ë¡œ ì •ë¦¬í•´ë³´ìë©´</p>
<ol>
  <li>ì„¸ì…˜ì´ ì‹¤í–‰ë˜ë©´ ë½ì„ íšë“</li>
  <li>í•´ë‹¹ ë½ì´ ë°˜ë‚©ë˜ê¸° ì „ê¹Œì§„ ë‹¤ë¥¸ ì„¸ì…˜ì—ì„œëŠ” ìˆ˜ì • ë¶ˆê°€ëŠ¥</li>
  <li>ë½ì„ íšë“í•œ ì„¸ì…˜ì´ commit(); rollback();ì„ ìˆ˜í–‰í•´ì•¼ ë½ì„ ë°˜ë‚©í•œë‹¤.</li>
</ol>

<hr />
<p>ì´ë ‡ê²Œ ì˜¤ëŠ˜ì€ íŠ¸ëœì­ì…˜ê³¼ DBë½ì— ëŒ€í•´ ê³µë¶€í–ˆë‹¤. <br />
DBë½ì„ ì•Œê¸°ì „ê¹Œì§€ëŠ” í•­ìƒ ê¶ê¸ˆí•´í•´ì™”ë‹¤.</p>

<p>ë™ì‹œì— í•˜ë‚˜ì˜ DB ë ˆì½”ë“œì— ë³€ê²½í• ë•ŒëŠ” ëˆ„ê°€ ìš°ì„ ê¶Œì„ ê°€ì§€ëŠ”ê±°ì§€?ë¼ëŠ”<br />
ë¬¼ìŒì´ í•­ìƒìˆì—ˆë‹¤. ê·¸ ì´ìœ ëŠ” ì´ì „ì— PLC í”„ë¡œê·¸ë˜ë°ì„ í•˜ì˜€ì„ ë•Œë„<br />
í•˜ë‚˜ì˜ ê³µì •ì— ë™ì‹œì‘ì—…ì´ ë¬¼ë ¤ìˆìœ¼ë©´ ìš°ì„ ìˆœìœ„ë¥¼ ì²˜ë¦¬í•´ì¤˜ì•¼í•˜ëŠ”<br />
ë¡œì§ì„ ì‘ì„±í•´ì£¼ì–´ì•¼í–ˆê¸° ë•Œë¬¸ì´ë‹¤.</p>

<p>ì˜¤ëŠ˜ ê·¸ ì§ˆë¬¸ì— ëŒ€í•œ ë¬¼ìŒì€ ì–´ëŠì •ë„ í•´ê²° ëœ ê²ƒ ê°™ê³ <br />
ìµœì¢…ì ìœ¼ë¡œ ê¶ê¸ˆí•œì ì€ ê·¸ëŸ¼ ì´ íŠ¸ëœì­ì…˜ì„<br />
Javaì½”ë“œë¡œ ì–´ë–»ê²Œ ì ìš©í•˜ëŠ”ê²Œ ì•Œë§ëŠ” ê²ƒì¸ì§€?ë¼ëŠ”<br />
ì§ˆë¬¸ì´ ìƒê¸°ì§€ë§Œ ì´í›„ì— í•™ìŠµí•  ê³¼ì •ì— í¬í•¨ë˜ì–´ìˆëŠ” ê²ƒ ê°™ìœ¼ë‹ˆ<br />
ê³µë¶€í•˜ë©´ì„œ ë‹¤ì‹œ ê¹¨ë‹¬ì•„ë´ì•¼í•  ê²ƒ ê°™ë‹¤.</p>

<p>ì˜¤ëŠ˜ ê³µë¶€ëŠ” ì—¬ê¸°ì„œ ë !!</p>

<p><br /></p>

<p><span style="color:#994C00"><strong>ì˜¤ëŠ˜ì˜ ì»¤í”¼ëŸ‰</strong></span>: â˜•ï¸ â˜•ï¸<br />
<strong>ì˜¤ëŠ˜ì˜ ì ì‹¬</strong>: ì§œì¥ë©´, ë°¥</p>]]></content><author><name>LEE JAEHYEOK</name></author><category term="TIL" /><category term="TIL" /><category term="ë¶€íŠ¸ìº í”„" /><category term="ì½”ë“œìŠ¤í…Œì´ì¸ " /><summary type="html"><![CDATA[ë“œë””ì–´ ê¸ˆìš”ì¼ì´ë‹¤ !!]]></summary></entry><entry><title type="html">TIL) Spring JPA 3 (ë‹¤ëŒ€ë‹¤ / @ManyToOne,@OneToMany)</title><link href="http://localhost:4000/til/2022/11/03/til.html" rel="alternate" type="text/html" title="TIL) Spring JPA 3 (ë‹¤ëŒ€ë‹¤ / @ManyToOne,@OneToMany)" /><published>2022-11-03T00:00:00+09:00</published><updated>2022-11-03T00:00:00+09:00</updated><id>http://localhost:4000/til/2022/11/03/til</id><content type="html" xml:base="http://localhost:4000/til/2022/11/03/til.html"><![CDATA[<p>ì˜¤ëœë§Œì— ì‹œê°„ê°€ëŠ”ì§€ ëª¨ë¥´ê³  ê³µë¶€í•œ ê²ƒ ê°™ë‹¤.</p>

<p><img src="https://lh3.googleusercontent.com/drive-viewer/AJc5JmTXh7B366xpO46r-jW9QXzgykyRRJY1uS1iFupj0wgGjVU6tOw0-_zdw_jjWyNyLnQdZ12IU54jq9ltbiYTPW-gWDxxmw=w1512-h807" alt="image" class="align-left" style="max-width: 100%" /></p>

<p>ì–´ì œ ë‹¤ëŒ€ë‹¤ ê´€ê³„ì— ëŒ€í•œ<br />
ì„œë¡œì˜ ê°ì²´ ì°¸ì¡°ê°€ ì´í•´ê°€ì§€ ì•Šì•„ ìƒˆë²½ 3ì‹œê¹Œì§€<br />
ë°¤ì„ ìƒˆì›Œê°€ë©° ê³µë¶€ë¥¼ í–ˆë‹¤.<br />
ì¡¸ë¦¬ê¸°ë„ í–ˆì§€ë§Œ ì•Œê³ ìí•˜ëŠ” ë§ˆìŒì— ì§‘ì¤‘ì´ ì˜¤ëœë§Œì— ì—„ì²­ ëœ ê²ƒ ê°™ë‹¤.</p>

<p>ì–´ì œ ê³µë¶€í–ˆë” ë‹¤ëŒ€ë‹¤(N:M) ê´€ê³„ì— ëŒ€í•´ ê³µë¶€í•´ë³´ì</p>

<hr />

<h3 id="ë‹¤ëŒ€ë‹¤-ê´€ê³„-nm">ë‹¤ëŒ€ë‹¤ ê´€ê³„ (N:M)</h3>
<p>ë‹¤ëŒ€ë‹¤ ê´€ê³„ëŠ” N:Nê´€ê³„ë¼ê³  í•œë‹¤.<br />
ì˜ˆì  ì— RDBMSì—ì„œ ê³µë¶€ í–ˆë˜ ê²ƒ ì²˜ëŸ¼ ì¤‘ê°„ì— í…Œì´ë¸”ì„ í•œê°œ<br />
ë” ë§Œë“¤ì–´ì„œ 1 : N : 1 ë¡œ ë§Œë“¤ì–´ì£¼ëŠ” ë°©ë²•ì´ë‹¤.</p>

<p><img src="https://lh3.googleusercontent.com/drive-viewer/AJc5JmQR036vsqkAgtZouiUTcGK0jsHDhCHVUlwfI1dt3W4yY7Z-B7XgMRN-YpiyiMZ6p2eYOlql4ec=w1920-h921" alt="image" class="align-left" style="max-width: 100%" /></p>

<p>ìœ„ì™€ ê°™ì´ ê°„ë‹¨í•œ ì˜ˆì œë¡œ ì†ë‹˜ê³¼, ì£¼ë¬¸ì„ ë‹¤ëŒ€ë‹¤ ê´€ê³„ë¡œ ë§µí•‘í•˜ê³  ì‹¶ì„ ê²½ìš°<br />
ì¤‘ê°„ì— Customer_Orderë¼ëŠ” í…Œì´ë¸”ì— ê°ìì˜ ì™¸ë˜í‚¤ë¥¼ ë‘ì–´<br />
ì°¸ì¡°í•  ìˆ˜ ìˆê²Œ í•˜ëŠ” ê²ƒì´ë‹¤.</p>

<p>ìœ„ì— ê·¸ë¦¼ì²˜ëŸ¼ ì¤‘ê°„ì— í…Œì´ë¸” í´ë˜ìŠ¤ë¥¼ í•˜ë‚˜ ë§Œë“¤ì–´<br />
ë‘ í…Œì´ë¸”ì˜ IDê°’ì„ ì°¸ì¡°í•˜ë©´ ë˜ëŠ” ë°©ë²•ì´ë‹¤.</p>

<p><br /></p>

<p>ì˜ˆë¥¼ ë“¤ê¸° ìœ„í•´<br />
Coffeeì™€ Order í´ë˜ìŠ¤ë¥¼ ë§Œë“¤ì–´ì„œ ì§„í–‰ í•˜ë ¤í•œë‹¤.<br />
ê³ ê°ì´ë¼ëŠ” í´ë˜ìŠ¤ëŠ” ë¹ ì¡Œì§€ë§Œ ê°„ë‹¨í•˜ê²Œ í•˜ê¸°ìœ„í•´<br />
ë‘ê°€ì§€ë§Œ ë§Œë“¤ê³  ì§„í–‰í•´ë³´ì</p>

<h3 id="manytoone-ë‹¨ë°©í–¥">@ManyToOne ë‹¨ë°©í–¥</h3>

<p>CoffeeëŠ” ì»¤í”¼ì˜ ë“±ë¡ì •ë³´ë¼ê³ í•˜ì (ì»¤í”¼ì´ë¦„,ê°€ê²© ë“±)<br />
Orderì€ ì‚¬ìš©ìê°€ ì£¼ë¬¸í•œ ì •ë³´ë¼ê³ í•˜ì (ì£¼ë¬¸ì‹œê°„, ê³ ê°ì´ë¦„ ë“±)<br />
ì„œë¡œ ë‹¤ëŒ€ë‹¤ ê´€ê³„ë¥¼ ë§ºì–´ ì¤‘ê°„í…Œì´ë¸”ì„ í†µí•´ ê°ì²´ ì°¸ì¡°ë¥¼ í•´ë³´ì</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Entity</span>
<span class="nd">@Getter</span>
<span class="nd">@Setter</span>
<span class="nd">@NoArgsConstructor</span>
<span class="nd">@Table</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"COFFEE"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Coffee</span> <span class="o">{</span>
    <span class="nd">@Id</span>
    <span class="nd">@GeneratedValue</span><span class="o">(</span><span class="n">strategy</span> <span class="o">=</span> <span class="nc">GenerationType</span><span class="o">.</span><span class="na">IDENTITY</span><span class="o">)</span>
    <span class="kd">private</span> <span class="kt">long</span> <span class="n">coffeeId</span><span class="o">;</span>

    <span class="nd">@Column</span><span class="o">(</span><span class="n">nullable</span> <span class="o">=</span> <span class="kc">false</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">coffeeName</span><span class="o">;</span>

    <span class="nd">@Column</span><span class="o">(</span><span class="n">nullable</span> <span class="o">=</span> <span class="kc">false</span><span class="o">)</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">price</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div></div>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Entity</span>
<span class="nd">@Getter</span>
<span class="nd">@Setter</span>
<span class="nd">@NoArgsConstructor</span>
<span class="nd">@Table</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"ORDERS"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Order</span> <span class="o">{</span>
    <span class="nd">@Id</span>
    <span class="nd">@GeneratedValue</span><span class="o">(</span><span class="n">strategy</span> <span class="o">=</span> <span class="nc">GenerationType</span><span class="o">.</span><span class="na">IDENTITY</span><span class="o">)</span>
    <span class="kd">private</span> <span class="kt">long</span> <span class="n">orderId</span><span class="o">;</span>

    <span class="nd">@Column</span><span class="o">(</span><span class="n">nullable</span> <span class="o">=</span> <span class="kc">false</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">LocalDateTime</span> <span class="n">createdAt</span> <span class="o">=</span> <span class="nc">LocalDateTime</span><span class="o">.</span><span class="na">now</span><span class="o">();</span>

    <span class="nd">@Column</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">personName</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div></div>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Entity</span>
<span class="nd">@Getter</span>
<span class="nd">@Setter</span>
<span class="nd">@NoArgsConstructor</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">OrderCoffee</span> <span class="o">{</span>
    <span class="nd">@Id</span>
    <span class="nd">@GeneratedValue</span><span class="o">(</span><span class="n">strategy</span> <span class="o">=</span> <span class="nc">GenerationType</span><span class="o">.</span><span class="na">IDENTITY</span><span class="o">)</span>
    <span class="kd">private</span> <span class="kt">long</span> <span class="n">orderCoffeeId</span><span class="o">;</span>

    <span class="nd">@ManyToOne</span>
    <span class="nd">@JoinColumn</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"COFFEE_ID"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">Coffee</span> <span class="n">coffee</span><span class="o">;</span>

    <span class="nd">@ManyToOne</span>
    <span class="nd">@JoinColumn</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"ORDER_ID"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">Order</span> <span class="n">order</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div></div>

<p>Order - OrderCoffee - Coffee (1:N:1)ìœ¼ë¡œ<br />
ì´ë£¨ì–´ì§„ ê´€ê³„ì´ë‹¤. í˜„ì¬ OrderCoffeeì—ì„œë§Œ<br />
@ManyToOneìœ¼ë¡œ ë‹¤ëŒ€ì¼ë¡œ ì—°ê´€ê´€ê³„ë¥¼ ë§ºê³  ìˆë‹¤.</p>

<p>ì´ë ‡ê²Œ ì„¤ì •ì„ í•  ê²½ìš° <br />
OrderCoffee í…Œì´ë¸”ì• ì„œ coffee,orderì˜ ì°¸ì¡°ê°€ ê°€ëŠ¥í•˜ì§€ë§Œ<br />
Orderì™€ CoffeeëŠ” ì„œë¡œ ì°¸ì¡°ë¥¼ í•˜ì§€ ëª»í•œë‹¤.</p>

<p>ìœ„ì™€ ê°™ì€ ê²½ìš°ì—ëŠ” OrderCoffee ê°ì²´ íƒ€ì…ìœ¼ë¡œ<br />
Repositoryë¥¼ ë§Œë“¤ì–´ ì €ì¥í•´ì£¼ì–´ì•¼í•œë‹¤.</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">OrderCoffeeRepository</span> <span class="kd">extends</span> <span class="nc">JpaRepository</span><span class="o">&lt;</span><span class="nc">OrderCoffee</span><span class="o">,</span><span class="nc">Long</span><span class="o">&gt;</span> <span class="o">{</span>
<span class="o">}</span>
</code></pre></div></div>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Service</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">OrderCoffeeService</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="nc">OrderCoffeeRepository</span> <span class="n">orderCoffeeRepository</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">OrderCoffeeService</span><span class="o">(</span><span class="nc">OrderCoffeeRepository</span> <span class="n">orderCoffeeRepository</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">orderCoffeeRepository</span> <span class="o">=</span> <span class="n">orderCoffeeRepository</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="nc">OrderCoffee</span> <span class="nf">createOrderCoffee</span><span class="o">(</span><span class="nc">OrderCoffee</span> <span class="n">orderCoffee</span><span class="o">){</span>
        <span class="k">return</span> <span class="n">orderCoffeeRepository</span><span class="o">.</span><span class="na">save</span><span class="o">(</span><span class="n">orderCoffee</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>
<p>OrderCoffee í´ë˜ìŠ¤ íƒ€ì…ìœ¼ë¡œ ë§Œë“  ê°ì²´ì—<br />
coffee,order ê°ì²´ë¥¼ setterë¡œ ì£¼ì…ì‹œì¼œì¤€ ë‹¤ìŒ<br />
í•´ë‹¹ ê°ì²´ë¥¼ ë§¤ê°œë³€ìˆ˜ë¡œ ê°€ì§„  createOrderCoffee ë©”ì„œë“œë¥¼ í˜¸ì¶œí•˜ë©´<br />
JpaRepositoryë¡œ ì¸í•´ DBì— ê°’ì´ ì €ì¥ë˜ê²Œ ë˜ì–´ì§„ë‹¤.</p>

<p>ì´ë ‡ê²Œë˜ë©´ OrderCoffee í…Œì´ë¸”ì—ëŠ” order,coffeì˜ IDê°’ìœ¼ë¡œ ì™¸ë˜í‚¤ë¡œ<br />
ì§€ì •ë˜ì–´ ê°ê° ê°ì²´ë¥¼ ì°¸ì¡°í•˜ì—¬ ì‚¬ìš©ì´ ê°€ëŠ¥í•˜ë‹¤.</p>

<p><img src="https://lh3.googleusercontent.com/drive-viewer/AJc5JmSJE-aVzmVTrpdk2WiyCL7gk_eHKfofUIocw4kesvHn-RHofW9VVbBlVPoSn16R7f76yyYRKwKKoPyBtNPZriEfNJwe=w1512-h807" alt="image" class="align-left" style="max-width: 100%" /></p>

<p><br /></p>

<h3 id="manytoone-onetomany-ì–‘ë°©í–¥">@ManyToOne @OneToMany ì–‘ë°©í–¥</h3>

<p><strong>í•˜ì§€ë§Œ !!</strong><br />
ìš°ë¦¬ëŠ” Orderì™€ Coffeeì˜ ë‹¤ëŒ€ë‹¤ ê´€ê³„ë¥¼ ë³´ê³  ìˆëŠ”ë°<br />
ìœ„ì™€ ê°™ì´ ì‚¬ìš©í•  ê²½ìš° Orderì—ì„œ Coffeeë¥¼ ì°¸ì¡°í•˜ì§€ ëª»í•˜ê²Œ ë˜ëŠ” ìƒí™©ì´ë‹¤.</p>

<p>ì„œë¡œ ì°¸ì¡°ê°€ ê°€ëŠ¥í•˜ë„ë¡ ì½”ë“œë¥¼ ìˆ˜ì •í•´ë³´ì</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Entity</span>
<span class="nd">@Getter</span>
<span class="nd">@Setter</span>
<span class="nd">@NoArgsConstructor</span>
<span class="nd">@Table</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"ORDERS"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Order</span> <span class="o">{</span>
    <span class="nd">@Id</span>
    <span class="nd">@GeneratedValue</span><span class="o">(</span><span class="n">strategy</span> <span class="o">=</span> <span class="nc">GenerationType</span><span class="o">.</span><span class="na">IDENTITY</span><span class="o">)</span>
    <span class="kd">private</span> <span class="kt">long</span> <span class="n">orderId</span><span class="o">;</span>

    <span class="nd">@Column</span><span class="o">(</span><span class="n">nullable</span> <span class="o">=</span> <span class="kc">false</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">LocalDateTime</span> <span class="n">createdAt</span> <span class="o">=</span> <span class="nc">LocalDateTime</span><span class="o">.</span><span class="na">now</span><span class="o">();</span>

    <span class="nd">@Column</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">personName</span><span class="o">;</span>

    <span class="nd">@OneToMany</span><span class="o">(</span><span class="n">mappedBy</span> <span class="o">=</span> <span class="s">"order"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">OrderCoffee</span><span class="o">&gt;</span> <span class="n">orderCoffees</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ArrayList</span><span class="o">&lt;&gt;();</span>
<span class="o">}</span>
</code></pre></div></div>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Entity</span>
<span class="nd">@Getter</span>
<span class="nd">@Setter</span>
<span class="nd">@NoArgsConstructor</span>
<span class="nd">@Table</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"COFFEE"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Coffee</span> <span class="o">{</span>
    <span class="nd">@Id</span>
    <span class="nd">@GeneratedValue</span><span class="o">(</span><span class="n">strategy</span> <span class="o">=</span> <span class="nc">GenerationType</span><span class="o">.</span><span class="na">IDENTITY</span><span class="o">)</span>
    <span class="kd">private</span> <span class="kt">long</span> <span class="n">coffeeId</span><span class="o">;</span>

    <span class="nd">@Column</span><span class="o">(</span><span class="n">nullable</span> <span class="o">=</span> <span class="kc">false</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">coffeeName</span><span class="o">;</span>

    <span class="nd">@Column</span><span class="o">(</span><span class="n">nullable</span> <span class="o">=</span> <span class="kc">false</span><span class="o">)</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">price</span><span class="o">;</span>

    <span class="nd">@OneToMany</span><span class="o">(</span><span class="n">mappedBy</span> <span class="o">=</span> <span class="s">"coffee"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">OrderCoffee</span><span class="o">&gt;</span> <span class="n">orderCoffees</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ArrayList</span><span class="o">&lt;&gt;();</span>
<span class="o">}</span>
</code></pre></div></div>
<p>Orderê³¼ Coffeeë¥¼ @OneToManyë¥¼ ì´ìš©í•´<br />
ì–‘ë°©í–¥ìœ¼ë¡œ ì°¸ì¡°ê°€ ê°€ëŠ¥í•˜ë„ë¡ ì„¤ì •í•´ ì£¼ì—ˆë‹¤.</p>

<p>ì´ë ‡ê²Œ ì„¤ì •í•  ê²½ìš° Orderê°€ OrderCoffee ì°¸ì¡°ê°€ ê°€ëŠ¥í•˜ê³ <br />
ê·¸ë¡œì¸í•´ OrderCoffeeì—ì„œ Coffeeë¡œ ì°¸ì¡°ê°€ ê°€ëŠ¥í•´ì§„ë‹¤.</p>

<p>ì˜ˆë¥¼ ë“¤ì–´ ìš°ë¦¬ê°€<br />
ë§¤ì¥ì— ì»¤í”¼ê°€ 3ê°œê°€ ë“±ë¡ë˜ì–´ìˆë‹¤ê³ í•´ë³´ì (ì•„ë©”ë¦¬ì¹´ë…¸,ì¹´í˜ë¼ë–¼,í—¤ì´ì¦ë„›ë¼ë–¼)</p>

<p><img src="https://lh3.googleusercontent.com/drive-viewer/AJc5JmQqkAYU_59TIa660ZzyHtDhni-i-ZA6mBu5nz1OJ6KA6ESnFmopbQw8yfMIr85KE2cK10_Q6k6hGGFMOnu54JzpzpE5OQ=w1512-h807" alt="image" class="align-left" style="max-width: 100%" /></p>

<p>Coffee Repositoryë¥¼ ì´ìš©í•´ DBì— ì €ì¥í•œ ëª¨ìŠµì´ë‹¤.</p>

<p>ë‚˜ë¼ëŠ” ì‚¬ëŒì´ 1ê°œì˜ ì£¼ë¬¸ì„ í–ˆëŠ”ë° ë“±ë¡ëœ ì»¤í”¼ì¤‘ ì•„ë©”ë¦¬ì¹´ë…¸ë¥¼ ì£¼ë¬¸í–ˆë‹¤ê³  ê°€ì •í•´ë³´ì<br />
ê·¸ëŸ¬ë©´ Order Controller í•¸ë“¤ëŸ¬ë©”ì„œë“œë¥¼ í†µí•´ POST ì£¼ë¬¸ì„ í•´ì•¼í•  ê²ƒì´ë‹¤.<br />
ë‚˜ë¼ëŠ” ì‚¬ëŒì˜ ì •ë³´ê³¼ ì–´ë–¤ ì»¤í”¼ì¸ì§€ë§Œ ì•Œë©´ ëœë‹¤.<br />
ì¦‰, ì£¼ë¬¸(Order)ì„ í•˜ë©´ OrderCoffee í…Œì´ë¸”ê¹Œì§€ ë§µí•‘ì„ ì‹œì¼œì¤˜ì•¼í•œë‹¤.</p>

<p>ìœ„ì˜ ë‚´ìš©ì„ í† ëŒ€ë¡œ<br />
ì£¼ë¬¸ Controller,Serviceë¥¼ ë§Œë“¤ì—ˆë‹¤.<br />
ì°¨ê·¼ì°¨ê·¼ ì•„ë˜ì—ì„œ í™•ì¸í•´ë³´ì</p>

<p>ìš°ì„  í•¸ë“¤ëŸ¬ ë©”ì„œë“œë¥¼ ë§µí•‘í•´ì¤„ Dtoë¥¼ ë§Œë“¤ì<br />
ìœ„ì—ì„œ ì–˜ê¸°í–ˆë“¯ì´ <strong>ì£¼ë¬¸í•˜ëŠ” ì‚¬ëŒì´ë¦„</strong>ê³¼, <strong>ì»¤í”¼ ëª©ë¡ì˜ ë²ˆí˜¸</strong>ë§Œ ì•Œë©´ ëœë‹¤.</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Getter</span>
<span class="nd">@Setter</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">OrderPostDto</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">personName</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">OrderCoffeeDto</span><span class="o">&gt;</span> <span class="n">orderCoffees</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div></div>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Getter</span>
<span class="nd">@Setter</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">OrderCoffeeDto</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kt">long</span> <span class="n">coffeeId</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div></div>

<p>ìœ„ì™€ ê°™ì´ Dtoë¥¼ ì‘ì„±í–ˆê³ </p>

<p><img src="https://lh3.googleusercontent.com/drive-viewer/AJc5JmQTzfqAsa2VbELiYL8VSeeVlzwfyBQO5EJfFNLAmYtp3oWyq9Z09m9MMoRQPlPdPK1nXySnEstsVlb5h3y1PvMGQQ_q=w1512-h807" alt="image" class="align-left" style="max-width: 90%" /></p>

<p>Postmanì„ í†µí•´ API ìš”ì²­ì„ ìœ„ì™€ ê°™ì´ ë³´ë‚´ë©´ ëœë‹¤.<br />
ì´ë ‡ê²Œ ë³´ë‚´ì£¼ì—ˆì„ ê²½ìš° ìš°ë¦¬ëŠ” coffeeId 1ë²ˆ ì¦‰, ì•„ë©”ë¦¬ì¹´ë…¸ë¼ëŠ” ê²ƒì„<br />
ì•Œ ìˆ˜ ìˆê³ , ì£¼ë¬¸í•œì‚¬ëŒì€ â€œì´ì¬í˜â€ì´ ë˜ëŠ” ê²ƒì´ë‹¤.</p>

<p>ì´ì–´ì„œ Controllerì„ ì‘ì„±í•´ë³´ì</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@RestController</span>
<span class="nd">@RequestMapping</span><span class="o">(</span><span class="s">"/api/orders"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">OrderController</span> <span class="o">{</span>
    
    <span class="kd">private</span> <span class="kd">final</span> <span class="nc">OrderService</span> <span class="n">orderService</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">OrderController</span><span class="o">(</span><span class="nc">OrderService</span> <span class="n">orderService</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">orderService</span> <span class="o">=</span> <span class="n">orderService</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@PostMapping</span>
    <span class="kd">public</span> <span class="nc">ResponseEntity</span> <span class="nf">postOrder</span><span class="o">(</span><span class="nd">@RequestBody</span> <span class="nc">OrderPostDto</span> <span class="n">orderPostDto</span><span class="o">){</span>

        <span class="nc">Order</span> <span class="n">order</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Order</span><span class="o">();</span>

        <span class="nc">List</span><span class="o">&lt;</span><span class="nc">OrderCoffee</span><span class="o">&gt;</span> <span class="n">orderCoffees</span> <span class="o">=</span> <span class="n">orderPostDto</span><span class="o">.</span><span class="na">getOrderCoffees</span><span class="o">()</span>
                <span class="o">.</span><span class="na">stream</span><span class="o">()</span>
                <span class="o">.</span><span class="na">map</span><span class="o">(</span><span class="n">object</span> <span class="o">-&gt;</span> <span class="o">{</span>
                    <span class="nc">OrderCoffee</span> <span class="n">orderCoffee</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">OrderCoffee</span><span class="o">();</span>
                    <span class="nc">Coffee</span> <span class="n">coffee</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Coffee</span><span class="o">();</span>
                    <span class="n">coffee</span><span class="o">.</span><span class="na">setCoffeeId</span><span class="o">(</span><span class="n">object</span><span class="o">.</span><span class="na">getCoffeeId</span><span class="o">());</span>
                    <span class="n">orderCoffee</span><span class="o">.</span><span class="na">setOrder</span><span class="o">(</span><span class="n">order</span><span class="o">);</span>
                    <span class="n">orderCoffee</span><span class="o">.</span><span class="na">setCoffee</span><span class="o">(</span><span class="n">coffee</span><span class="o">);</span>
                    <span class="n">order</span><span class="o">.</span><span class="na">getOrderCoffees</span><span class="o">();</span>
                    <span class="k">return</span> <span class="n">orderCoffee</span><span class="o">;</span>
                <span class="o">})</span>
                <span class="o">.</span><span class="na">collect</span><span class="o">(</span><span class="nc">Collectors</span><span class="o">.</span><span class="na">toList</span><span class="o">());</span>

        <span class="n">order</span><span class="o">.</span><span class="na">setPersonName</span><span class="o">(</span><span class="n">orderPostDto</span><span class="o">.</span><span class="na">getPersonName</span><span class="o">());</span>
        <span class="n">order</span><span class="o">.</span><span class="na">setOrderCoffees</span><span class="o">(</span><span class="n">orderCoffees</span><span class="o">);</span>

        <span class="nc">Order</span> <span class="n">result</span> <span class="o">=</span> <span class="n">orderService</span><span class="o">.</span><span class="na">createOrder</span><span class="o">(</span><span class="n">order</span><span class="o">);</span>

        <span class="k">return</span> <span class="k">new</span> <span class="nf">ResponseEntity</span><span class="o">(</span><span class="nc">HttpStatus</span><span class="o">.</span><span class="na">CREATED</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>
<p>Mapperë¥¼ ì´ìš©í•˜ì§€ ì•Šê³  Controllerì—ë‹¤ê°€ í”„ë¡œê·¸ë¨ì„ ì‘ì„±í–ˆë‹¤.<br />
ì—°ìŠµìš©ìœ¼ë¡œë§Œ í•˜ëŠ” ê²ƒì´ê¸°ì— ì°¸ê³  ë¶€íƒë°”ë€ë‹¤.</p>

<p>ë‚´ìš©ì„ ë³´ë©´</p>
<ol>
  <li>
    <p>Order,Coffee ê°ì²´ë¡œ ìƒˆë¡œ ë§Œë“¤ì–´ ì£¼ê³  ìˆë‹¤.</p>
  </li>
  <li>
    <p>OrderCoffee ê°ì²´ë¥¼ ë§Œë“¤ì–´ order,coffee ê°ì²´ë¥¼ setterë¡œ ì£¼ì…í•˜ê³  ìˆë‹¤.<br />
-&gt; ê·¸ì¤‘ Coffeeê°ì²´ëŠ” Dtoë¡œ ë°›ì€ coffeeIdë¥¼ ë„£ì–´ì„œ ë§Œë“ ë‹¤.</p>
  </li>
  <li>
    <p>OrderCoffee ê°ì²´ë¥¼ Listë¡œ ë°˜í™˜í•´ì¤€ë‹¤.</p>
  </li>
  <li>
    <p>Order ê°ì²´ì˜ í•„ë“œë³€ìˆ˜ì— ê°’ì„ ì£¼ì…í•˜ê³ ìˆë‹¤. <br />
-&gt; ë°˜í™˜í•œ ê°ì²´ë¥¼ Order ê°ì²´ì˜ í•„ë“œë³€ìˆ˜ orderCoffeesì— ì£¼ì…í•´ì£¼ê³  ìˆë‹¤.<br />
-&gt; Dtoë¡œ ë°›ì€ ê°’ì„ personNameì— ì£¼ì…í•´ì£¼ê³  ìˆë‹¤.</p>
  </li>
  <li>
    <p>ìµœì¢… ì ìœ¼ë¡œ ê°’ì´ ì£¼ì…ëœ Order ê°ì²´ë¥¼ Service ë¡œì§ìœ¼ë¡œ ì „ë‹¬í•œë‹¤.</p>
  </li>
</ol>

<p>ì—¬ê¸°ì„œ ì•Œ ìˆ˜ ìˆëŠ” ì ì€<br />
ìš°ë¦¬ê°€ Order í´ë˜ìŠ¤ì— ì–‘ë°©í–¥ìœ¼ë¡œ ì§€ì •í•œ
@OneToMany List<OrderCoffee> orderCoffees  
ê°ì²´ì— OrderCoffee í´ë˜ìŠ¤ì˜ ê°’ë“¤ì´ Listí˜•íƒœë¡œ ì¡´ì¬í•˜ê²Œ ëœë‹¤.</OrderCoffee></p>

<p>Order í´ë˜ìŠ¤ì—ì„œ ë³„ë„ì˜ findOrderCoffee ì¿¼ë¦¬ë¥¼ ì‘ì„±í•˜ì§€ ì•Šë”ë¼ê³ <br />
OrderCoffeeì˜ Listí™” ë˜ì–´ìˆëŠ” ê°ì²´ë¥¼ ì°¸ì¡°í•˜ì—¬ Coffeeë¥¼ ì¡°íšŒí•  ìˆ˜ ìˆë‹¤.</p>

<p><br /></p>

<p>ì´ì œ Serviceì™€ Repository ì½”ë“œë¥¼ ì‘ì„±í•´ë³´ì</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Service</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">CoffeeService</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="nc">CoffeeRepository</span> <span class="n">coffeeRepository</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">CoffeeService</span><span class="o">(</span><span class="nc">CoffeeRepository</span> <span class="n">coffeeRepository</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">coffeeRepository</span> <span class="o">=</span> <span class="n">coffeeRepository</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="nc">Coffee</span> <span class="nf">createCoffee</span><span class="o">(</span><span class="nc">Coffee</span> <span class="n">coffee</span><span class="o">){</span>
        <span class="k">return</span> <span class="n">coffeeRepository</span><span class="o">.</span><span class="na">save</span><span class="o">(</span><span class="n">coffee</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">OrderRepository</span> <span class="kd">extends</span> <span class="nc">JpaRepository</span><span class="o">&lt;</span><span class="nc">Order</span><span class="o">,</span> <span class="nc">Long</span><span class="o">&gt;</span> <span class="o">{</span>
<span class="o">}</span>
</code></pre></div></div>
<p>ê°„ë‹¨í•˜ê²Œ JpaRepositoryë¥¼ ìƒì†ë°›ì•„ JDBCì™€ ê°™ì´<br />
ì¿¼ë¦¬ë¬¸ì„ ì‘ì„±í•  ìˆ˜ë„ìˆê³  ì •í•´ì§„ ê·œì•½ëŒ€ë¡œ ì¿¼ë¦¬ë¥¼ ë‚ ë¦´ ìˆ˜ë„ ìˆë‹¤.<br />
ê·¸ì¤‘ .save();ë¥¼ ì´ìš©í•´ Order ê°ì²´ë¥¼ DBì— ì €ì¥í•˜ê²Œ í•´ì£¼ì—ˆë‹¤.</p>

<p>ì´ì œ ì£¼ë¬¸ì„ Postmanìœ¼ë¡œ ì‹¤í–‰í•˜ê²Œ ë  ê²½ìš°</p>

<p><img src="https://lh3.googleusercontent.com/drive-viewer/AJc5JmRnmNA4pymt_R759dyUt72jbf_Bms7zIM2lE2plqvJz05MFJIva97SO1RguJ4L9t5tVnCO3iyNdwKkoftNs1xOhfqgpUQ=w1512-h807" alt="image" class="align-left" style="max-width: 100%" /></p>

<p>ìœ„ì™€ ê°™ì´ ì£¼ë¬¸ì´ ì˜ DBì— ì €ì¥ëœ ëª¨ìŠµì„ ë³¼ ìˆ˜ ìˆë‹¤.</p>

<p><br /></p>

<p>í•˜ì§€ë§Œ ! ì—¬ê¸°ì„œ OrderCoffeeì˜ í…Œì´ë¸”ì—ëŠ”</p>

<p><img src="https://lh3.googleusercontent.com/drive-viewer/AJc5JmSrJSyX1h6jXCz0y0gt23p43O_gRw39Bl5G2Iqgx1reIWlR5YTZflQ3Y5cqCmK0ffMEd5izw4EkHZfAgEFYr0PMe6LKYQ=w1512-h807" alt="image" class="align-left" style="max-width: 100%" /></p>

<p>ê°’ì´ ì €ì¥ë˜ì§€ ì•ŠëŠ” ëª¨ìŠµì„ ë³¼ ìˆ˜ ìˆë‹¤.</p>

<p>ì™œëƒí•˜ë©´ ìš°ë¦¬ëŠ” Order Entityì— JPAê¸°ìˆ ì„ ì´ìš©í•´<br />
ORDER TABLEì—ë§Œ ê°’ì„ .save(); í•´ì£¼ì—ˆê¸° ë•Œë¬¸ì´ë‹¤.</p>

<p>ì—¬ê¸°ì„œ @ManyToOne, @OneToManyì˜ ì†ì„±ì¤‘<br />
Cascadeë¼ëŠ” ê²ƒìœ¼ë¡œ ê°„ë‹¨í•˜ê²Œ í•´ê²°í•  ìˆ˜ ìˆë‹¤.</p>

<p>Order í´ë˜ìŠ¤ì˜ Cascade ì†ì„±ì„ ì¶”ê°€í•´ì£¼ë©´ëœë‹¤.</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Entity</span>
<span class="nd">@Getter</span>
<span class="nd">@Setter</span>
<span class="nd">@NoArgsConstructor</span>
<span class="nd">@Table</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"ORDERS"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Order</span> <span class="o">{</span>
    <span class="nd">@Id</span>
    <span class="nd">@GeneratedValue</span><span class="o">(</span><span class="n">strategy</span> <span class="o">=</span> <span class="nc">GenerationType</span><span class="o">.</span><span class="na">IDENTITY</span><span class="o">)</span>
    <span class="kd">private</span> <span class="kt">long</span> <span class="n">orderId</span><span class="o">;</span>

    <span class="nd">@Column</span><span class="o">(</span><span class="n">nullable</span> <span class="o">=</span> <span class="kc">false</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">LocalDateTime</span> <span class="n">createdAt</span> <span class="o">=</span> <span class="nc">LocalDateTime</span><span class="o">.</span><span class="na">now</span><span class="o">();</span>

    <span class="nd">@Column</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">personName</span><span class="o">;</span>

    <span class="nd">@OneToMany</span><span class="o">(</span><span class="n">mappedBy</span> <span class="o">=</span> <span class="s">"order"</span><span class="o">,</span><span class="n">cascade</span> <span class="o">=</span> <span class="nc">CascadeType</span><span class="o">.</span><span class="na">PERSIST</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">OrderCoffee</span><span class="o">&gt;</span> <span class="n">orderCoffees</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ArrayList</span><span class="o">&lt;&gt;();</span>
<span class="o">}</span>
</code></pre></div></div>
<p>ìœ„ì™€ ê°™ì´ CascadeType.PERSIST ì†ì„±ì„ ì‚¬ìš©í•˜ë©´<br />
Orderê°ì²´ê°€ .save();ë˜ì–´ì§ˆë•Œ ORDER_COFFEE í…Œì´ë¸”ì—ë„<br />
ê°’ì´ ê°™ì´ ë§µí•‘ë˜ê²Œ ë˜ì–´ì§„ë‹¤.</p>

<p><strong>Cascadeë€?</strong><br />
cascade ì˜µì…˜ì´ë€ @OneToMany ë‚˜ @ManyToOneì— ì˜µì…˜ìœ¼ë¡œ ì¤„ ìˆ˜ ìˆëŠ” ê°’ì´ë‹¤.<br />
Entityì˜ ìƒíƒœ ë³€í™”ë¥¼ ì „íŒŒì‹œí‚¤ëŠ” ì˜µì…˜ì´ë‹¤.   <br />
ë§Œì•½ Entityì˜ ìƒíƒœ ë³€í™”ê°€ ìˆìœ¼ë©´ ì—°ê´€ë˜ì–´ ìˆëŠ”(ex. @OneToMany, @ManyToOne)<br />
Entityì—ë„ ìƒíƒœ ë³€í™”ë¥¼ ì „ì´ì‹œì¼œì¤€ë‹¤.</p>

<ol>
  <li>
    <p>Persistent: ì €ì¥ì„ í•˜ê³ ë‚˜ì„œ, JPAê°€ ì•„ëŠ” ìƒíƒœ(ê´€ë¦¬í•˜ëŠ” ìƒíƒœ)ê°€ ëœë‹¤.<br />
ê·¸ëŸ¬ë‚˜ .save()ë¥¼ í–ˆë‹¤ê³  í•´ì„œ, ì´ ìˆœê°„ ë°”ë¡œ DBì— ì´ ê°ì²´ì— ëŒ€í•œ ë°ì´í„°ê°€ ë“¤ì–´ê°€ëŠ” ê²ƒì€ ì•„ë‹ˆë‹¤. <br />
JPAê°€ persistent ìƒíƒœë¡œ ê´€ë¦¬í•˜ê³  ìˆë‹¤ê°€, í›„ì— ë°ì´í„°ë¥¼ ì €ì¥í•œë‹¤.<br />
(1ì°¨ ìºì‹œ, Dirty Checking(ë³€ê²½ì‚¬í•­ ê°ì§€), Write Behind(ìµœëŒ€í•œ ëŠ¦ê²Œ, í•„ìš”í•œ ì‹œì ì— DBì— ì ìš©) ë“±ì˜ ê¸°ëŠ¥ì„ ì œê³µí•œë‹¤)</p>
  </li>
  <li>
    <p>Removed: JPAê°€ ê´€ë¦¬í•˜ëŠ” ìƒíƒœì´ê¸´ í•˜ì§€ë§Œ, ì‹¤ì œ commitì´ ì¼ì–´ë‚  ë•Œ, ì‚­ì œê°€ ì¼ì–´ë‚œë‹¤.</p>
  </li>
</ol>

<p>Order í´ë˜ìŠ¤ì˜ ì½”ë“œë¥¼ ìˆ˜ì • í›„<br />
ë‹¤ì‹œ Postmanì„ í†µí•´ ì£¼ë¬¸ìš”ì²­ì„ ë³´ë‚¼ ê²½ìš°</p>

<p><img src="https://lh3.googleusercontent.com/drive-viewer/AJc5JmTvAacgrE_bydZh1uUd4Y6Y1N3G477EgDw3NkdPKUeGJ3cCF4jZbLGJvWQj63OQtnOEMac5K7JDTIxk9XAgWAwdl6uA=w1512-h807" alt="image" class="align-left" style="max-width: 100%" /></p>

<p>ë¹„ë¡œì†Œ ORDER_COFFEE í…Œì´ë¸”ì— ì™¸ë˜í‚¤ë¡œ<br />
ê°’ë“¤ì´ ì €ì¥ë˜ì–´ì§€ëŠ” ëª¨ìŠµì„ ë³¼ ìˆ˜ ìˆë‹¤.<br />
ì´ë ‡ê²Œ ì—°ê´€ê´€ê³„ë¥¼ í†µí•´ DBì— ë§µí•‘ê³¼ ì„œë¡œ ê°ì²´ ì°¸ì¡°ê°€ ê°€ëŠ¥í•˜ë‹¤.</p>

<p><br /></p>

<hr />

<p>ì´ë ‡ê²Œ ì˜¤ëŠ˜ì€ ë‹¤ëŒ€ë‹¤ì— ëŒ€í•´ ì •ë¦¬í•´ë³´ì•˜ë‹¤.<br />
@ManyToManyëŠ” ì‹¤ë¬´ì— ì˜ì‚¬ìš©í•˜ì§€ ì•ŠëŠ”ë‹¤ ë“¤ì–´ì„œ<br />
ì•„ì§ ê³µë¶€í•˜ì§€ ëª»í•œ ìƒíƒœì´ê¸´í•˜ë‹¤..<br />
ì‚¬ì‹¤ ìœ„ì˜ ë°©ë²•ìœ¼ë¡œ ì—°ê´€ê´€ê³„ ë§µí•‘í•˜ëŠ” ê²ƒì€ ê°„ë‹¨í•˜ë‹¤ê³  ìƒê°í•œë°<br />
ì„œë¡œ ê°ì²´ë¥¼ ì°¸ì¡°í•œë‹¤ëŠ”? ì˜ë¯¸ê°€ ì˜ ì™€ë‹¿ì§€ì•Šê¸°ëŠ”í•œë‹¤.</p>

<p>ê³„ì† ì‚¬ìš©í•´ë³´ë©´ì„œ ìµìˆ™í•´ì§ˆ ìˆ˜ ë°–ì— !!</p>

<p>ì˜¤ëŠ˜ ê³µë¶€ëŠ” ì—¬ê¸°ê¹Œì§€</p>

<p><br /></p>

<p><span style="color:#994C00"><strong>ì˜¤ëŠ˜ì˜ ì»¤í”¼ëŸ‰</strong></span>: â˜•ï¸ â˜•ï¸ â˜•ï¸<br />
<strong>ì˜¤ëŠ˜ì˜ ì ì‹¬</strong>: ê¹€ì¹˜ì°Œê°œë¼ë©´</p>]]></content><author><name>LEE JAEHYEOK</name></author><category term="TIL" /><category term="TIL" /><category term="ë¶€íŠ¸ìº í”„" /><category term="ì½”ë“œìŠ¤í…Œì´ì¸ " /><summary type="html"><![CDATA[ì˜¤ëœë§Œì— ì‹œê°„ê°€ëŠ”ì§€ ëª¨ë¥´ê³  ê³µë¶€í•œ ê²ƒ ê°™ë‹¤.]]></summary></entry><entry><title type="html">TIL) Spring JPA 2 (ë‹¤ëŒ€ì¼, ì¼ëŒ€ë‹¤ / @ManyToOne,@OneToMany)</title><link href="http://localhost:4000/til/2022/11/02/til.html" rel="alternate" type="text/html" title="TIL) Spring JPA 2 (ë‹¤ëŒ€ì¼, ì¼ëŒ€ë‹¤ / @ManyToOne,@OneToMany)" /><published>2022-11-02T00:00:00+09:00</published><updated>2022-11-02T00:00:00+09:00</updated><id>http://localhost:4000/til/2022/11/02/til</id><content type="html" xml:base="http://localhost:4000/til/2022/11/02/til.html"><![CDATA[<p>ì¼ì–´ë‚¬ëŠ”ë° ë‚ ì”¨ê°€ í™”ì°½í•˜ë‹¤ !<br />
ê³µë¶€í•˜ê¸° ë”± ì¢‹ì€ ë‚ ì´ë‹¤.<br />
ë°”ëŒë„ ì„ ì„ í•˜ë‹ˆ ì°½ë¬¸ì„ ë³´ë‹ˆ ê¸°ë¶„ë„ ì¢‹ì•„ì§€ê³ </p>

<p><img src="https://lh3.googleusercontent.com/drive-viewer/AJc5JmTTi3iIn8dTeSBPpmgo8WFDpboB_P96FekTAmQA2_3ffEhVNvvXCKe7KMWo9-LgViok2L1403k=w3024-h1614" alt="image" class="align-left" style="max-width: 100%" /></p>

<p>ì—¬ìœ ë¡­ê²Œ ì»¤í”¼ë§ˆì‹œë©´ì„œ ì´ë ‡ê²Œ ê³µë¶€í•œê²Œ ì–¼ë§ˆë§ˆì¸ê°€<br />
ì†Œì†Œí•œ ê²ƒì— í–‰ë³µì„ ëŠê»´ë³¸ë‹¤.</p>

<hr />

<p>ì–´ì œëŠ” JPAì— ëŒ€í•´ ì•Œì•„ë³´ì•˜ë‹¤.<br />
ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì™€ Entity ë§µí•‘ì— ëŒ€í•´ ì•Œì•„ë³´ì•˜ê³ <br />
ì˜¤ëŠ˜ì€ Entityì˜ ì—°ê´€ê´€ê³„ë¥¼ ë§µí•‘í•˜ëŠ” ë°©ë²•ì„ ì•Œì•„ë³´ì !</p>

<h2 id="ì—°ê´€-ê´€ê³„-mapping">ì—°ê´€ ê´€ê³„ Mapping</h2>

<p>ì—°ê´€ ê´€ê³„ ë§µí•‘ì€ ì´ì „ì— Spring data JDBC í•™ìŠµì„ í–ˆì„ ë•Œ<br />
ì‚¬ìš©í•´ë´¤ë˜ ê²½í—˜ì´ ìˆë‹¤. ê·¸ë¦¬ê³  RDBMS ê³µë¶€ í•  ë–„ 1:1, 1:N, N:N ë“±<br />
Entityê°„ì˜ ì—°ê´€ê´€ê³„ë¥¼ ì •í•´ ë°ì´í„°ë¥¼ ì°¸ì¡°í•  ìˆ˜ ìˆì—ˆë‹¤.</p>

<p>í…ŒìŠ¤íŠ¸ë¥¼ ìœ„í•œ ê°„ë‹¨í•œ ì •ì˜ë¥¼ í•´ë³´ì•˜ë‹¤.<br />
Member : memberId, email, name, phone, createdAt, modifiedAt<br />
Order : orderId, orderStatus, createdAt, modifiedAt<br />
í•´ë‹¹ ì—”í‹°í‹°ì— ìœ„ì™€ ê°™ì€ Columnì„ ê°€ì§€ëŠ” í´ë˜ìŠ¤ëŠ” ì¡´ì¬í•œë‹¤ê³  ê°€ì •í•˜ê² ë‹¤.</p>

<p>Member - Orderì˜ ì—°ê´€ê´€ê³„ë¥¼ ë§µí•‘ì„ ì—°ìŠµí•´ë³¼ ê²ƒì´ë‹¤.</p>

<p><br /></p>

<h3 id="ë‹¤ëŒ€ì¼-ê´€ê³„-n1">ë‹¤ëŒ€ì¼ ê´€ê³„ (N:1)</h3>
<p>ìœ„ì—ì„œ ê°€ì •í•œ í…Œì´ë¸”ê³¼ í´ë˜ìŠ¤ê°€ ì´ë‹¤ê³  ê°€ì •í•˜ê³ <br />
ë‹¤ëŒ€ì¼ ê´€ê³„ë¥¼ ì •ì˜í•´ë³´ê² ë‹¤.</p>

<p>í•œëª…ì˜ ì†ë‹˜ë‹¹ ì—¬ëŸ¬ê°œì˜ ì£¼ë¬¸ì„ í•  ìˆ˜ ìˆìœ¼ë‹ˆ  Order(N) : Member(1) <br />
ê´€ê³„ê°€ ì •ì˜ë˜ì–´ì§ˆ ìˆ˜ ìˆë‹¤. ì¦‰, Order Columnì—ì„œ Memberë¥¼ ì°¸ì¡°í•  ìˆ˜ ìˆê²Œ<br />
ë§Œë“¤ì–´ì£¼ì–´ì•¼í•œë‹¤. ë§ˆì¹˜ SQLë¡œ JOINì„ í•˜ë“¯ì´</p>

<p><strong>@ManyToOne</strong><br />
ë‹¤ëŒ€ì¼ê´€ê³„ë¥¼ ì •ì˜í•´ì£¼ëŠ” ì–´ë…¸í…Œì´ì…˜ì´ë‹¤.<br />
ì´ë¦„ë¶€í„° ì§ê´€ì ì´ë¼ ê¸°ì–µí•˜ê¸° ì‰¬ìš¸ ê²ƒ ê°™ë‹¤.</p>

<p>ì‚¬ìš©ë°©ë²•ì„ ì½”ë“œë¡œ ì•Œì•„ë³´ì</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@ManyToOne</span>
<span class="nd">@JoinColumn</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"MEMBER_ID"</span><span class="o">)</span>
<span class="kd">private</span> <span class="nc">Member</span> <span class="n">member</span><span class="o">;</span>

<span class="kd">public</span> <span class="kt">void</span> <span class="nf">addOrder</span><span class="o">(</span><span class="nc">Order</span> <span class="n">order</span><span class="o">){</span>
    <span class="k">this</span><span class="o">.</span><span class="na">orders</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">order</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div></div>
<p>í•´ë‹¹ í´ë˜ìŠ¤ëŠ” Order Entity í´ë˜ìŠ¤ì—ì„œ ì¶”ê°€í•œ ëª¨ìŠµì´ë‹¤.</p>

<p>ê¸°ì¡´ì— Order : orderId, orderStatus, createdAt, modifiedAt <br />
ì´ 4ê°œì˜ Columnì„ ì •ì˜ í–ˆì—ˆëŠ”ë° ì—¬ê¸°ì— member Columnì„ ì¶”ê°€í•œ ê²ƒì´ë‹¤.</p>

<p>ê·¸ë¦¬ê³  í•´ë‹¹ ì»¬ëŸ¼ì— @ManyToOne ì–´ë…¸í…Œì´ì…˜ê³¼<br />
Member íƒ€ì…ì˜ ê°ì²´ë¥¼ ë§Œë“¤ê³ , @JoinColumnìœ¼ë¡œ í•´ë‹¹ Columnì„ ì°¸ì¡°í• <br />
ì™¸ë˜í‚¤ Columnì„ ì ì–´ì£¼ë©´ ìš°ë¦¬ëŠ” member ê°ì²´ë¥¼ í†µí•´<br />
ê° Orderê°ì²´ì˜ member ê°ì²´ë¥¼ ì¡°íšŒí•  ìˆ˜ ìˆê²Œ ë˜ëŠ” ê²ƒì´ë‹¤.</p>

<p>í…ŒìŠ¤íŠ¸ë¥¼ ìœ„í•´ DBì— Member 2ëª…ê³¼, Order 1ê±´ì„ ë§Œë“¤ì–´ í…ŒìŠ¤íŠ¸í•´ë³´ì</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Configuration</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">JpaTest</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="nc">EntityManager</span> <span class="n">em</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">EntityTransaction</span> <span class="n">tx</span><span class="o">;</span>

    <span class="nd">@Bean</span>
    <span class="kd">public</span> <span class="nc">CommandLineRunner</span> <span class="nf">testJpaSingleMappingRunner</span><span class="o">(</span><span class="nc">EntityManagerFactory</span> <span class="n">entityManagerFactory</span><span class="o">){</span>
        <span class="k">this</span><span class="o">.</span><span class="na">em</span> <span class="o">=</span> <span class="n">entityManagerFactory</span><span class="o">.</span><span class="na">createEntityManager</span><span class="o">();</span>
        <span class="k">this</span><span class="o">.</span><span class="na">tx</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="na">getTransaction</span><span class="o">();</span>
        <span class="k">return</span> <span class="n">args</span> <span class="o">-&gt;</span> <span class="o">{</span>
            <span class="n">test</span><span class="o">();</span>

        <span class="o">};</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">test</span><span class="o">(){</span>
        <span class="n">tx</span><span class="o">.</span><span class="na">begin</span><span class="o">();</span>
        <span class="nc">Member</span> <span class="n">member1</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Member</span><span class="o">(</span><span class="s">"dhfif718@naver.com"</span><span class="o">,</span><span class="s">"ì´ì¬í˜"</span><span class="o">,</span><span class="s">"010-7894-1234"</span><span class="o">);</span>
        <span class="nc">Member</span> <span class="n">member2</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Member</span><span class="o">(</span><span class="s">"tmdghwlq@naver.com"</span><span class="o">,</span><span class="s">"ì—¼ìŠ¹í˜¸"</span><span class="o">,</span><span class="s">"010-1234-5623"</span><span class="o">);</span>
        <span class="n">em</span><span class="o">.</span><span class="na">persist</span><span class="o">(</span><span class="n">member1</span><span class="o">);</span>
        <span class="n">em</span><span class="o">.</span><span class="na">persist</span><span class="o">(</span><span class="n">member2</span><span class="o">);</span>

        <span class="nc">Order</span> <span class="n">order</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Order</span><span class="o">();</span>
        <span class="n">order</span><span class="o">.</span><span class="na">addMember</span><span class="o">(</span><span class="n">member2</span><span class="o">);</span>
        <span class="n">em</span><span class="o">.</span><span class="na">persist</span><span class="o">(</span><span class="n">order</span><span class="o">);</span>
        <span class="n">tx</span><span class="o">.</span><span class="na">commit</span><span class="o">();</span>

        <span class="nc">Order</span> <span class="n">findOrder</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="na">find</span><span class="o">(</span><span class="nc">Order</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="mi">1L</span><span class="o">);</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"findOrder: "</span> <span class="o">+</span> <span class="n">findOrder</span><span class="o">.</span><span class="na">getMember</span><span class="o">().</span><span class="na">getMemberId</span><span class="o">()</span> <span class="o">+</span> <span class="s">", "</span> <span class="o">+</span> <span class="n">findOrder</span><span class="o">.</span><span class="na">getMember</span><span class="o">().</span><span class="na">getEmail</span><span class="o">());</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="c1">// ì¶œë ¥</span>
<span class="nl">findOrder:</span> <span class="mi">2</span><span class="o">,</span> <span class="n">tmdghwlq</span><span class="nd">@naver</span><span class="o">.</span><span class="na">com</span>
</code></pre></div></div>
<p>member ê°ì²´ 2ê°œ(member1,member2)ì™€<br />
Order ê°ì²´ 1ê°œë¥¼ ë§Œë“¤ì—ˆë‹¤. Order ê°ì²´ì—ëŠ” Setterë¥¼ ì´ìš©í•˜ì—¬<br />
member2 ê°ì²´ë¥¼ member ì°¸ì¡°ë³€ìˆ˜ì— ì°¸ì¡°í•˜ë„ë¡ ì½”ë“œë¥¼ ì¶”ê°€í–ˆë‹¤.</p>

<p>ë§Œë“  ê°ì²´ë“¤ì„ ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì˜ ë“±ë¡í›„<br />
commit();ì„ ì§„í–‰í•˜ì—¬ DBì— ë“±ë¡í–ˆë‹¤.</p>

<p>ê°ì²´ë¥¼ í•œë²ˆ DBì—ì„œ ì¡°íšŒí•´ë³´ì</p>

<p>Order Table ì¡°íšŒ</p>

<p><img src="https://lh3.googleusercontent.com/drive-viewer/AJc5JmRKidG95kInTT4bELfZ7GDduH3EsU_XuozzuawHn0_ZWIHVc2FQJOfOu0v9IM-CUr0uStNbAu4=w1920-h921" alt="image" class="align-left" style="max-width: 100%" /></p>

<p>Member Table ì¡°íšŒ
<img src="https://lh3.googleusercontent.com/drive-viewer/AJc5JmR_NXQMR6J6A7xoKPr9nv4fuFdKlFBR7Ou740yNkH2VR81uYW-aTwIpXw1daN23U3UADsI7L7g=w1920-h921" alt="image" class="align-left" style="max-width: 100%" /></p>

<p>Table ì´ë¦„ì€ ORDERSì™€ USERSë¡œ ë³€ê²½í•´ì„œ ì‘ì—…í–ˆë‹¤.<br />
ì‹¤ì œë¡œ ì¡°íšŒí•´ë³¸ ê²°ê³¼  member ê°ì²´ 2ê°œì— ëŒ€í•œ ë°ì´í„°ê°€ <br />
ì˜ ì €ì¥ë˜ì–´ìˆëŠ” ëª¨ìŠµê³¼ order ë˜í•œ ì˜ ë§µí•‘ë˜ì–´ìˆë‹¤.</p>

<p>ì—¬ê¸°ì„œ @JoinColumnìœ¼ë¡œ ì™¸ë˜í‚¤ë¥¼ ì ì—ˆëŠ”ë°<br />
í•´ë‹¹ ì™¸ë˜í‚¤ê°€ DB Tableì— ì ìš©ëœ ëª¨ìŠµì´ í™•ì¸ ê°€ëŠ¥í•˜ë‹¤</p>

<p>ë§ˆì§€ë§‰ìœ¼ë¡œ ì½”ë“œ ë§ˆì§€ë§‰ êµ¬ë¬¸ì— ì¶œë ¥ìœ¼ë¡œ<br />
í•´ë‹¹ ê°ì²´ë¥¼ getterë¥¼ ì´ìš©í•´ ê°’ì„ ì¡°íšŒí•´ë³´ì•˜ì„ë•Œë„<br />
ì •ìƒì ìœ¼ë¡œ member2ì˜ ê°ì²´ ê°’ì„ ê°€ì ¸ì˜¤ëŠ” ëª¨ìŠµì„ ë³¼ ìˆ˜ ìˆë‹¤.</p>

<p><br /></p>

<p><strong>@OneToMany</strong><br />
ë§Œì•½ N:1ì´ ì•„ë‹Œ ì¼ëŒ€ë‹¤(1:N)ê´€ê³„ë¥¼ í‘œí˜„í• ë•ŒëŠ” ì–´ë–»ê²Œí•´ì•¼í• ê¹Œ?<br />
ì¼ëŒ€ë‹¤ ë‹¨ë°©í–¥ ë§µí•‘ì€ ì™œë˜í‚¤ë¥¼ í¬í•¨í•˜ì§€ ì•Šê¸°ë•Œë¬¸ì—
ì‚¬ì‹¤ ë§ì´ ì‚¬ìš©í•˜ëŠ” ë°©ë²•ì´ ì•„ë‹ˆë¼ê³  ë“¤ì—ˆë‹¤.</p>

<p>ìœ„ì— ì˜ˆì œë¡œ ë“¤ë©´ Orderê°€ ì•„ë‹Œ Memberê°€ Orderë¥¼ ì°¸ì¡°í•  ìˆ˜ ìˆì–´ì•¼í•œë‹¤.<br />
í˜„ì¬ ìƒíƒœì—ì„œëŠ” ì•Œìˆ˜ ìˆëŠ” ì •ë³´ëŠ”<br />
-&gt; ì£¼ë¬¸ì—ì„œ ì–´ë–¤ ê³ ê°ì´ ì£¼ë¬¸í–ˆëŠ”ì§€ ì•Œ ìˆ˜ ìˆë‹¤.</p>

<p>ì£¼ë¬¸ì„ í†µí•œ í™•ì¸ì´ ì•„ë‹Œ<br />
ì–´ë–¤ ê³ ê°ì´ ë¬´ìŠ¨ ì£¼ë¬¸ë“¤ì„ í–ˆëŠ”ì§€ë¥¼ ì•Œê³  ì‹¶ì„ë•Œ<br />
ì¼ëŒ€ë‹¤ ë§¤í•‘ì„ ì¶”ê°€í•´ì£¼ë©´ <strong>ì–‘ë°©í–¥ ê´€ê³„</strong>ë¥¼ ë§Œë“¤ì–´ ì¤„ ìˆ˜ ìˆë‹¤.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@OneToMany</span><span class="o">(</span><span class="n">mappedBy</span> <span class="o">=</span> <span class="s">"member"</span><span class="o">)</span>
<span class="kd">private</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Order</span><span class="o">&gt;</span> <span class="n">orders</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ArrayList</span><span class="o">&lt;&gt;();</span>

<span class="kd">public</span> <span class="kt">void</span> <span class="nf">addOrder</span><span class="o">(</span><span class="nc">Order</span> <span class="n">order</span><span class="o">){</span>
    <span class="k">this</span><span class="o">.</span><span class="na">orders</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">order</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div></div>
<p>Member Entity í´ë˜ìŠ¤ì— ì¶”ê°€ëœ ì½”ë“œë‹¤</p>

<p>OneToManyê°™ì€ ê²½ìš°ì—ëŠ” @JoinColumnì„ ì‚¬ìš©í•˜ì§€ ì•Šì•˜ê³ <br />
ì†ì„±ì¤‘ mappedByë¥¼ ì‚¬ìš©í–ˆë‹¤.<br />
ì•ˆì— ìˆëŠ” memberëŠ” ìš°ë¦¬ê°€ @ManyToOneìœ¼ë¡œ N:1ë¡œ ì—°ê²° ì‹œì¼œë†“ì€<br />
í•„ë“œ ë³€ìˆ˜ëª…ê³¼ ë™ì¼í•˜ê²Œ ì„¤ì •í•˜ë©´ ëœë‹¤.</p>

<p>ì–‘ë°© ì—°ê´€ ê´€ê³„ ë§µí•‘ì„ ëëƒˆìœ¼ë‹ˆ<br />
(ë‹¤ëŒ€ë‹¤ì™€ëŠ” ë‹¤ë¥¸ë‚´ìš©ì´ë‹¤.)</p>

<p>ìœ„ì—ì„œ ë³´ì•˜ë˜ ì˜ˆì œì—ì„œ test ë©”ì„œë“œ ë‚´ìš©ë§Œ ë°”ê¾¸ì–´ ë³´ê³ <br />
í…ŒìŠ¤íŠ¸ë¥¼ ì§„í–‰í•´ë³´ì</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">private</span> <span class="kt">void</span> <span class="nf">test</span><span class="o">()</span> <span class="o">{</span>
    <span class="n">tx</span><span class="o">.</span><span class="na">begin</span><span class="o">();</span>
    <span class="nc">Member</span> <span class="n">member</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Member</span><span class="o">(</span><span class="s">"dhfif718@naver.com"</span><span class="o">,</span> <span class="s">"ì´ì¬í˜"</span><span class="o">,</span> <span class="s">"010-1234-5678"</span><span class="o">);</span>
    <span class="nc">Order</span> <span class="n">order1</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Order</span><span class="o">();</span>
    <span class="nc">Order</span> <span class="n">order2</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Order</span><span class="o">();</span>

    <span class="n">member</span><span class="o">.</span><span class="na">addOrder</span><span class="o">(</span><span class="n">order1</span><span class="o">);</span>
    <span class="n">member</span><span class="o">.</span><span class="na">addOrder</span><span class="o">(</span><span class="n">order2</span><span class="o">);</span>
    <span class="n">order1</span><span class="o">.</span><span class="na">addMember</span><span class="o">(</span><span class="n">member</span><span class="o">);</span>
    <span class="n">order2</span><span class="o">.</span><span class="na">addMember</span><span class="o">(</span><span class="n">member</span><span class="o">);</span>

    <span class="n">em</span><span class="o">.</span><span class="na">persist</span><span class="o">(</span><span class="n">member</span><span class="o">);</span>
    <span class="n">em</span><span class="o">.</span><span class="na">persist</span><span class="o">(</span><span class="n">order1</span><span class="o">);</span>
    <span class="n">em</span><span class="o">.</span><span class="na">persist</span><span class="o">(</span><span class="n">order2</span><span class="o">);</span>

    <span class="n">tx</span><span class="o">.</span><span class="na">commit</span><span class="o">();</span>

    <span class="nc">Member</span> <span class="n">findMember</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="na">find</span><span class="o">(</span><span class="nc">Member</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="mi">1L</span><span class="o">);</span>

    <span class="n">findMember</span><span class="o">.</span><span class="na">getOrders</span><span class="o">().</span><span class="na">stream</span><span class="o">()</span>
    <span class="o">.</span><span class="na">forEach</span><span class="o">(</span><span class="n">findOrder</span> <span class="o">-&gt;</span> <span class="o">{</span>
    <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"findOrder: "</span> <span class="o">+</span> <span class="n">findOrder</span><span class="o">.</span><span class="na">getOrderId</span><span class="o">()</span> <span class="o">+</span> <span class="s">", "</span> <span class="o">+</span> <span class="n">findOrder</span><span class="o">.</span><span class="na">getOrderStatus</span><span class="o">());</span>
    <span class="o">});</span>
<span class="o">}</span>

<span class="c1">//ì¶œë ¥</span>
<span class="nl">findOrder:</span> <span class="mi">1</span><span class="o">,</span> <span class="no">ORDER_REQUEST</span>
<span class="nl">findOrder:</span> <span class="mi">2</span><span class="o">,</span> <span class="no">ORDER_REQUEST</span>
</code></pre></div></div>
<p>test ë©”ì„œë“œì˜ ë‚´ìš©ë§Œ ë³€ê²½ë˜ì—ˆê³  í™•ì¸í•´ë³´ë©´<br />
MemberëŠ” 1ê°œ, OrderëŠ” 2ê°œë¥¼ ìƒì„±í•˜ì˜€ê³ </p>

<p>Member ê°ì²´ì˜ addOrder ë©”ì„œë“œë¥¼ í†µí•´ Orderê°ì²´ë¥¼ 2ê°œë¥¼<br />
Listì— add ì‹œì¼œ ì •ë¦¬í•´ì£¼ì—ˆë‹¤.</p>

<p>3ê°œì˜ ê°ì²´ë¥¼ ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì— ì˜¬ë¦° í›„ commit();í•˜ì—¬<br />
DBì— ìµœì¢…ì ìœ¼ë¡œ ì €ì¥í•˜ê²Œë˜ì–´ì§„ë‹¤.</p>

<p><img src="https://lh3.googleusercontent.com/drive-viewer/AJc5JmRKidG95kInTT4bELfZ7GDduH3EsU_XuozzuawHn0_ZWIHVc2FQJOfOu0v9IM-CUr0uStNbAu4=w1920-h921" alt="image" class="align-left" style="max-width: 100%" /></p>

<p><img src="https://lh3.googleusercontent.com/drive-viewer/AJc5JmR_NXQMR6J6A7xoKPr9nv4fuFdKlFBR7Ou740yNkH2VR81uYW-aTwIpXw1daN23U3UADsI7L7g=w1920-h921" alt="image" class="align-left" style="max-width: 100%" /></p>

<p>ì•¼ê¸°ì„œ ì–‘ë°©í–¥ì´ë¼ëŠ” ê²ƒì„ í™•ì¸ í•  ìˆ˜ ìˆëŠ” ì ì€</p>
<ol>
  <li>Order í´ë˜ìŠ¤ì˜ member ê°ì²´ë¥¼ í†µí•´ ì£¼ë¬¸ì˜ ê³ ê°ì„ ì•Œ ìˆ˜ ìˆë‹¤.</li>
  <li>Member í´ë˜ìŠ¤ì˜ orders ê°ì²´ë¥¼ í†µí•´ì„œ ê³ ê°ì´ ë¬´ìŠ¨ ì£¼ë¬¸ë“¤ì„ í–ˆëŠ”ì§€ ì•Œ ìˆ˜ ìˆë‹¤.<br />
ì´ë ‡ê²Œ ì—°ê´€ê´€ê³„ ë§µí•‘ì„ í†µí•´ ì„œë¡œ ë°ì´í„°ë¥¼ ì¡°íšŒí•  ìˆ˜ ìˆëŠ”<br />
ì–‘ë°©í–¥ ì—°ê´€ê´€ê³„ê°€ í˜•ì„±ë˜ì—ˆë‹¤ëŠ” ê²ƒì„ ê²€ì¦í•´ ë³¼ ìˆ˜ ìˆë‹¤.</li>
</ol>

<p>í•œ ê°€ì§€ ë” ì–˜ê¸°í•´ë³´ìë©´ Member í´ë˜ìŠ¤ì˜ DB USERS<br />
DBì˜ List&lt;/Order/&gt; orders ê°ì²´ëŠ” Columnìœ¼ë¡œ í‘œì‹œë˜ì§€ ì•ŠëŠ”ë‹¤ëŠ” ê²ƒì´ë‹¤.</p>

<p><br /></p>

<hr />

<p>ì˜¤ëŠ˜ì€ ë‹¤ëŒ€ì¼ê³¼ ì¼ëŒ€ë‹¤ì— ëŒ€í•œ
ì–´ë…¸í…Œì´ì…˜ ì‚¬ìš© ë°©ë²•ì„ ê³µë¶€í–ˆë‹¤.</p>

<p>ë‹¤ëŒ€ë‹¤ ê´€ê³„ì— ëŒ€í•´ì„œëŠ” ë‚´ì¼ ì´ì–´ì„œ ì •ë¦¬í•´ë³´ë ¤ê³  í•œë‹¤.</p>

<p><br /></p>

<p><span style="color:#994C00"><strong>ì˜¤ëŠ˜ì˜ ì»¤í”¼ëŸ‰</strong></span>: â˜•ï¸ â˜•ï¸ â˜•ï¸<br />
<strong>ì˜¤ëŠ˜ì˜ ì ì‹¬</strong>: ê¹€ì¹˜ì°Œê°œ, ê³„ë€ë§ì´, ë°¥</p>]]></content><author><name>LEE JAEHYEOK</name></author><category term="TIL" /><category term="TIL" /><category term="ë¶€íŠ¸ìº í”„" /><category term="ì½”ë“œìŠ¤í…Œì´ì¸ " /><summary type="html"><![CDATA[ì¼ì–´ë‚¬ëŠ”ë° ë‚ ì”¨ê°€ í™”ì°½í•˜ë‹¤ ! ê³µë¶€í•˜ê¸° ë”± ì¢‹ì€ ë‚ ì´ë‹¤. ë°”ëŒë„ ì„ ì„ í•˜ë‹ˆ ì°½ë¬¸ì„ ë³´ë‹ˆ ê¸°ë¶„ë„ ì¢‹ì•„ì§€ê³ ]]></summary></entry></feed>