<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="4.3.0">Jekyll</generator><link href="http://localhost:4000/feed.xml" rel="self" type="application/atom+xml" /><link href="http://localhost:4000/" rel="alternate" type="text/html" /><updated>2023-02-11T21:19:42+09:00</updated><id>http://localhost:4000/feed.xml</id><title type="html">LeeJellan</title><subtitle>ì•ˆë…•í•˜ì„¸ìš”!ğŸ™‚ IT,ì—¬í–‰,ê¸°íƒ€ ë“± ê¸°ë¡ì„ ë‚¨ê¸°ê¸°ìœ„í•œ ë¸”ë¡œê·¸ ì…ë‹ˆë‹¤ !</subtitle><author><name>LEE JAEHYEOK</name></author><entry><title type="html">[Programmers - Java] í°ì¼“ëª¬</title><link href="http://localhost:4000/algorithm/2023/02/11/algo-ponketmon.html" rel="alternate" type="text/html" title="[Programmers - Java] í°ì¼“ëª¬" /><published>2023-02-11T00:00:00+09:00</published><updated>2023-02-11T00:00:00+09:00</updated><id>http://localhost:4000/algorithm/2023/02/11/algo-ponketmon</id><content type="html" xml:base="http://localhost:4000/algorithm/2023/02/11/algo-ponketmon.html"><![CDATA[]]></content><author><name>LEE JAEHYEOK</name></author><category term="Algorithm" /><category term="Algorithm" /><category term="Programmers" /><summary type="html"><![CDATA[]]></summary></entry><entry><title type="html">MySQL replace í•¨ìˆ˜ì‚¬ìš©í•˜ì—¬ ì¼ê´„ ë³€ê²½í•˜ê¸°</title><link href="http://localhost:4000/db/2023/02/09/db-mysqlreplace.html" rel="alternate" type="text/html" title="MySQL replace í•¨ìˆ˜ì‚¬ìš©í•˜ì—¬ ì¼ê´„ ë³€ê²½í•˜ê¸°" /><published>2023-02-09T00:00:00+09:00</published><updated>2023-02-09T00:00:00+09:00</updated><id>http://localhost:4000/db/2023/02/09/db-mysqlreplace</id><content type="html" xml:base="http://localhost:4000/db/2023/02/09/db-mysqlreplace.html"><![CDATA[<p>ì˜ˆì „ì— ì‘ì—…í–ˆë˜ ì´ë¯¸ì§€ ì‚¬ì§„ì´ ë‚ ë¼ê°€ë²„ë ¸ë‹¤â€¦ êµ¬ê¸€ ë“œë¼ì´ë¸Œì— ì´ë¯¸ì§€ë¥¼ ë„£ì–´ ì£¼ì†Œë¥¼ ë½‘ì•„ì„œ  <br />
MySQL í…Œì´ë¸”ì— ì£¼ì†Œê°’ìœ¼ë¡œ ë„£ì–´ë‘ì—ˆëŠ”ë° ì‚¬ì§„ì´ ë‚ ë¼ê°€ë²„ë ¸ë‹¤â€¦</p>

<p><img src="https://user-images.githubusercontent.com/95069395/217779406-6b06d791-ae7a-4f77-b89d-e68c3c63e8af.png" alt="image" class="align-left" style="max-width: 100%" /></p>

<p>OAuth2.0ìœ¼ë¡œ íšŒì›ê°€ì…ì„ ì§„í–‰í•œ íšŒì›ë“¤ì€ í•´ë‹¹ ë²¤ë”ì—ì„œ<br />
ì‚¬ì§„ì£¼ì†Œë¥¼ ê°€ì ¸ì™€ì„œ DBì— ì €ì¥í•˜ê¸°ë•Œë¬¸ì— ë‚¨ì•„ìˆê³ <br />
ì¼ë°˜ìœ¼ë¡œ íšŒì›ê°€ì…í•œ ìœ ì €ëŠ” ìœ„ì— 12ê°€ì§€ ê¸°ë³¸ì´ë¯¸ì§€ë¥¼ ëœë¤ìœ¼ë¡œ ë°°ì •ë°›ê²Œë˜ëŠ”ë°<br />
ë³´ëŠ”ê±°ì²˜ëŸ¼ ì‚¬ì§„ ì›ë³¸íŒŒì¼ì´ êµ¬ê¸€ë“œë¼ì´ë¸Œì—ì„œ ë‚ ë¼ê°€ì„œ í‘œì‹œê°€ì•ˆë˜ëŠ” ëª¨ìŠµì´ë‹¤.</p>

<p>ì²˜ìŒí–ˆë˜ í”„ë¡œì íŠ¸ì´ê¸°ë„í•˜ê³  ì‚¬ì§„ê´€ë¦¬í•˜ëŠ” ë°©ë²•ì´ ë„ˆë¬´ missì¸ ê²ƒ ê°™ë‹¤. <br />
ìš°ì„  ë°ì´í„°ë² ì´ìŠ¤ì— íšŒì›ìœ¼ë¡œ ê°€ì…ë˜ì–´ìˆëŠ” ë©¤ë²„ê°€ 100ëª…ì •ë„ ê°€ì…ë˜ì–´ìˆëŠ”ë° <br />
í•´ë‹¹ ë°ì´í„°ë¥¼ ì¡°ì‘í•˜ê¸°ìœ„í•´ì„œ Replaceë¼ëŠ” í•¨ìˆ˜ë¥¼ ì´ìš©í•´ ì¼ê´„ ë³€ê²½í•˜ê¸°ë¡œ ì •í–ˆë‹¤.</p>

<p><br /></p>

<h3 id="-replace-í•¨ìˆ˜-ì‚¬ìš©">ğŸ“Œ Replace í•¨ìˆ˜ ì‚¬ìš©</h3>

<p>WorkBench ì—´ì–´ì„œ ê°•ì œë¡œ SQLì„ ë§Œë“¤ì–´ ë³€ê²½í• ë ¤ê³ í•œë‹¤.</p>

<p><img src="https://user-images.githubusercontent.com/95069395/217779419-2cc32d98-7a95-4ebd-ad58-da1cadcf0395.png" alt="image" class="align-left" style="max-width: 100%" /></p>

<p>memberë¼ëŠ” í…Œì´ë¸”ì— image ì»¬ëŸ¼ì˜ ë°ì´í„°ë¥¼ ë°”ê¾¸ëŠ” ê²ƒì´ë‹¤. <br />
(â—ï¸ í˜„ì¬ ì´ë¯¸ì§€ ì£¼ì†Œ ì¢…ë¥˜ë¥¼ 12ê°€ì§€ë¡œ í•œì •ì§€ì–´ë†”ì„œ ê°€ëŠ¥í•œ ì‘ì—…ì´ë‹¤.<br />
ë§Œì•½ ì¢…ë¥˜ê°€ ê°ê¸°ë‹¬ëë‹¤ë©´ ë‹¤ë¥¸ë°©ë²•ì„ ì•Œì•„ë´ì•¼í–ˆì„ ê²ƒì´ë‹¤.)</p>

<p><br /></p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>SELECT REPLACE<span class="o">(</span>image, <span class="s1">'https://ê¸°ì¡´ì´ë¯¸ì§€ì£¼ì†Œ'</span>,<span class="s1">'https://ë³€ê²½ì´ë¯¸ì§€ì£¼ì†Œ'</span><span class="o">)</span> FROM member<span class="p">;</span>
UPDATE member SET member.image <span class="o">=</span> REPLACE<span class="o">(</span>image, <span class="s1">'https://ê¸°ì¡´ì´ë¯¸ì§€ì£¼ì†Œ'</span>,<span class="s1">'https://ë³€ê²½ì´ë¯¸ì§€ì£¼ì†Œ'</span><span class="o">)</span><span class="p">;</span>
</code></pre></div></div>
<p>Table : member<br />
Column : image</p>

<p>ë³€ê²½í•˜ê³ ì í•˜ëŠ” ë°ì´í„°ëŠ” imageì˜ Textê°’ì„ ë³€ê²½í•˜ëŠ” ê²ƒì´ë‹¤.<br />
<code class="language-plaintext highlighter-rouge">REPLACE('ë¬¸ìì—´','ê¸°ì¡´ë¬¸ìì—´','ë³€ê²½ë¬¸ìì—´')</code> í˜•ì‹ìœ¼ë¡œ ì¿¼ë¦¬ë¥¼ ë‚ ë ¤ì£¼ë©´ ëœë‹¤.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>SELECT REPLACE<span class="o">(</span>image, <span class="s1">'https://lh3.googleusercontent.com/u/0/drive-viewer/AFDK6gOtBngM6igLV_5Gi86DYVCKWPOuuBgzUxZiiu2DZVYZdi1T_CpI2-xBeHbODJMwMymHxzTtCtLwlbTsvuCZj1dbg5fWkw=w1920-h921'</span>,<span class="s1">'https://user-images.githubusercontent.com/95069395/217765437-5eb0766a-139b-4d74-8ea7-f13fb511fb6b.png'</span><span class="o">)</span> FROM member<span class="p">;</span>
UPDATE member SET member.image <span class="o">=</span> REPLACE<span class="o">(</span>image, <span class="s1">'https://lh3.googleusercontent.com/u/0/drive-viewer/AFDK6gOtBngM6igLV_5Gi86DYVCKWPOuuBgzUxZiiu2DZVYZdi1T_CpI2-xBeHbODJMwMymHxzTtCtLwlbTsvuCZj1dbg5fWkw=w1920-h921'</span>,<span class="s1">'https://user-images.githubusercontent.com/95069395/217765437-5eb0766a-139b-4d74-8ea7-f13fb511fb6b.png'</span><span class="o">)</span><span class="p">;</span>
UPDATE member SET member.image <span class="o">=</span> REPLACE<span class="o">(</span>image, <span class="s1">'https://lh3.googleusercontent.com/u/0/drive-viewer/AFDK6gOg7R_zu1d5ondnz2mF9Mfs5POsyaYwY0bpBfzQmTCA5iNpVhU3rycNjteK9RZKX0_dsQLXn1AGkA_MtfZJKeSJ03vOJg=w1000-h921'</span>,<span class="s1">'https://user-images.githubusercontent.com/95069395/217765442-ddf39075-30c9-45a1-9d55-806b35c9c991.png'</span><span class="o">)</span><span class="p">;</span>
UPDATE member SET member.image <span class="o">=</span> REPLACE<span class="o">(</span>image, <span class="s1">'https://lh3.googleusercontent.com/u/0/drive-viewer/AFDK6gPE5xpI0-lxEqtHYRm-avwUL1X2y8HUz_CtZoT2afckhm77Y_hZfo5N7xB6VP2bDxsiIT4DcFRwe8wSc5-y9BFHYfhe=w1000-h921'</span>,<span class="s1">'https://user-images.githubusercontent.com/95069395/217765447-d8b3c96e-42d2-4b4d-9660-df536e82a48e.png'</span><span class="o">)</span><span class="p">;</span>
UPDATE member SET member.image <span class="o">=</span> REPLACE<span class="o">(</span>image, <span class="s1">'https://lh3.googleusercontent.com/u/0/drive-viewer/AFDK6gPEZNW9ORtC6bMAw54VDZFQ3IaDPrGVWFKi18kERIrAxuE8N8MmbZhtol2Ujxvyrz21Ows7-0_4P8cz_sJlXYPvVu4z=w1920-h921'</span>,<span class="s1">'https://user-images.githubusercontent.com/95069395/217765450-c1e29534-8974-45c3-ba3d-0d98dc3ac4c7.png'</span><span class="o">)</span><span class="p">;</span>
UPDATE member SET member.image <span class="o">=</span> REPLACE<span class="o">(</span>image, <span class="s1">'https://lh3.googleusercontent.com/u/0/drive-viewer/AFDK6gOUcWn-HIk4JoOiMBxVqMc458drW7579JOqVcfR3Nq7eHs2WZV1URKdSy7iAEnrteP-19yw4B7xAAphkiPKu4fAez8j3g=w1000-h921'</span>,<span class="s1">'https://user-images.githubusercontent.com/95069395/217765456-26f2ac03-91a6-4b4d-a14c-ab6275d49022.png'</span><span class="o">)</span><span class="p">;</span>
UPDATE member SET member.image <span class="o">=</span> REPLACE<span class="o">(</span>image, <span class="s1">'https://lh3.googleusercontent.com/u/0/drive-viewer/AFDK6gMY6Ju7pO_FZp5hyfYdjKljdMAFlS5nCtbnvfJfXXqG52kH_WvYSqNsi7ClGgYVgmK8Gav_XdM_tCc5liRtQD8bZq4Ryg=w1920-h921'</span>,<span class="s1">'https://user-images.githubusercontent.com/95069395/217765459-d95c0338-5ced-4689-9afb-61d917e0c4ad.png'</span><span class="o">)</span><span class="p">;</span>
UPDATE member SET member.image <span class="o">=</span> REPLACE<span class="o">(</span>image, <span class="s1">'https://lh3.googleusercontent.com/u/0/drive-viewer/AFDK6gP3vIemuwNCa2gLq8QFxJ0mvEUyH90NCzzCdEh6zkRFmQvF6_MHHo8N46VTTP58ovW3ikNSXN281NhTcbDaBfESUl6eUw=w1000-h921'</span>,<span class="s1">'https://user-images.githubusercontent.com/95069395/217765462-8b65713a-f436-405e-812d-c7b906bcb8e8.png'</span><span class="o">)</span><span class="p">;</span>
UPDATE member SET member.image <span class="o">=</span> REPLACE<span class="o">(</span>image, <span class="s1">'https://lh3.googleusercontent.com/u/0/drive-viewer/AFDK6gMzNhh9XTiXBHg_K4sHjKxhNVZTpihvtXFyGa_pR2L3j2ymHy6w9uDu5Pqmjo_-PPl40kIJENWVqGGfVE7-o1vMxMS0Zg=w1000-h921'</span>,<span class="s1">'https://user-images.githubusercontent.com/95069395/217765465-83f95069-d4be-4418-a7ee-f569b235f665.png'</span><span class="o">)</span><span class="p">;</span>
UPDATE member SET member.image <span class="o">=</span> REPLACE<span class="o">(</span>image, <span class="s1">'https://lh3.googleusercontent.com/u/0/drive-viewer/AFDK6gOnvAfzDjdq54wfaQ3aQnYMNbfCsFwZVvyBIxEzKYw7LUtT7SnlxkIyZnkXyxrN2y8N5CuXVCLdNdloEMYYl7PPTBotWA=w1000-h921'</span>,<span class="s1">'https://user-images.githubusercontent.com/95069395/217765469-2a34827e-f18c-4bca-aa49-ab3c698c46ce.png'</span><span class="o">)</span><span class="p">;</span>
UPDATE member SET member.image <span class="o">=</span> REPLACE<span class="o">(</span>image, <span class="s1">'https://lh3.googleusercontent.com/u/0/drive-viewer/AFDK6gOeqDCgTYyD4_NlylK0EE-y1Fn0lj364mopuRJbuN4JvWP2eQGBJt6Ygv48nrlnHiuiq2Dkgz3ep7XILzUgT_lVAN1VpA=w1000-h921'</span>,<span class="s1">'https://user-images.githubusercontent.com/95069395/217765473-c7044900-f16b-407c-a27e-939c7c8a2e17.png'</span><span class="o">)</span><span class="p">;</span>
UPDATE member SET member.image <span class="o">=</span> REPLACE<span class="o">(</span>image, <span class="s1">'https://lh3.googleusercontent.com/u/0/drive-viewer/AFDK6gPKgEG4sHNVV90PQrE5jn37skBOV5Qp7M3czg2sShhPYx46ybBb0KhQ37mcxGl6H6E_1xVdAhna7aAJGi8qp1oYGCWMMw=w1000-h921'</span>,<span class="s1">'https://user-images.githubusercontent.com/95069395/217765476-31afe366-b1d2-4ee8-92f4-7d254a7616d2.png'</span><span class="o">)</span><span class="p">;</span>
UPDATE member SET member.image <span class="o">=</span> REPLACE<span class="o">(</span>image, <span class="s1">'https://lh3.googleusercontent.com/u/0/drive-viewer/AFDK6gNXn3Qy3cjHid6lgXk6cT9J78rm98pYCgumlTWAHENmA_Q3ujH3MxEbMBYp_lHBLM8rpIU51BtZnzaIKi3CiEsrqcDKQA=w1000-h921'</span>,<span class="s1">'https://user-images.githubusercontent.com/95069395/217765478-e9cbd679-d241-4a42-b285-f334b0b22241.png'</span><span class="o">)</span><span class="p">;</span>
</code></pre></div></div>

<p>ì¿¼ë¦¬ë¥¼ ë§Œë“¤ê³  í…Œì´ë¸”ì— ì •ìƒì ìœ¼ë¡œ ë³€ê²½ë˜ëŠ”ì§€ í™•ì¸ê¹Œì§€ ì™„ë£Œ!</p>

<p><img src="https://user-images.githubusercontent.com/95069395/217785372-71da8902-27fb-42ed-97ee-d171e916a983.png" alt="image" class="align-left" style="max-width: 100%" /></p>

<p>ë‹¤ì‹œ ì‚¬ì´íŠ¸ê°€ ì œëŒ€ë¡œëœ ì´ë¯¸ì§€ë¡œ í‘œí˜„ë˜ëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤. <br />
ì¿¼ë¦¬ ì‹¤í–‰ì‹œ 1175 ì—ëŸ¬ê°€ ë°œìƒí•œë‹¤ë©´ -&gt; <a href="https://jwgye.tistory.com/31">Updateì‹œ ì—ëŸ¬ì½”ë“œ 1175 ì²˜ë¦¬</a>ë¸”ë¡œê·¸ë¥¼ ì°¸ê³ í•´ë³´ì</p>

<p><br /></p>

<p>ì´ë ‡ê²Œ í…Œì´ë¸”ì˜ ì»¬ëŸ¼ìì²´ ë‚´ìš©ì„ ë°”ê¿”ë¼ì›Œì•¼í•  ê²½ìš°ì—<br />
REPLACEë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒë³´ë‹¨ Table Data exportë¥¼ ì‚¬ìš©í•´ csvíŒŒì¼ì—ì„œ <br />
ì¼ê´„ë³€ê²½í•˜ì—¬ ìˆ˜ì •í•œë‹¤ìŒ importí•´ì„œ ë°ì´í„°ë¥¼ ê°ˆì•„ë¼ì›Œì£¼ëŠ”ê²ƒì´ í›¨ì”¬ë” íš¨ìœ¨ì ì¸ ê²ƒ ê°™ë‹¤.</p>

<p><br />
<br />
<br /></p>

<p>âœ¨ ì°¸ê³  ë¸”ë¡œê·¸
<a href="https://leenow.tistory.com/13">Mysql Replace í•¨ìˆ˜ ì‚¬ìš©ë²• ë ˆí¼ëŸ°ìŠ¤</a></p>

<p><br />
<br /></p>]]></content><author><name>LEE JAEHYEOK</name></author><category term="DB" /><category term="DB" /><category term="MySQL" /><summary type="html"><![CDATA[ì˜ˆì „ì— ì‘ì—…í–ˆë˜ ì´ë¯¸ì§€ ì‚¬ì§„ì´ ë‚ ë¼ê°€ë²„ë ¸ë‹¤â€¦ êµ¬ê¸€ ë“œë¼ì´ë¸Œì— ì´ë¯¸ì§€ë¥¼ ë„£ì–´ ì£¼ì†Œë¥¼ ë½‘ì•„ì„œ MySQL í…Œì´ë¸”ì— ì£¼ì†Œê°’ìœ¼ë¡œ ë„£ì–´ë‘ì—ˆëŠ”ë° ì‚¬ì§„ì´ ë‚ ë¼ê°€ë²„ë ¸ë‹¤â€¦]]></summary></entry><entry><title type="html">Nginx ì—ëŸ¬ ì¡°ì¹˜ , Failed to start A high performance web server and a reverse proxy server.</title><link href="http://localhost:4000/linux/unix/2023/01/28/server-nginxerror.html" rel="alternate" type="text/html" title="Nginx ì—ëŸ¬ ì¡°ì¹˜ , Failed to start A high performance web server and a reverse proxy server." /><published>2023-01-28T00:00:00+09:00</published><updated>2023-01-28T00:00:00+09:00</updated><id>http://localhost:4000/linux/unix/2023/01/28/server-nginxerror</id><content type="html" xml:base="http://localhost:4000/linux/unix/2023/01/28/server-nginxerror.html"><![CDATA[<p>https ê´€ë ¨ ì„¤ì •ì„ ë§Œì§€ë‹¤ê°€<br />
nginxë¥¼ ì‹¤í–‰í•˜ëŠ”ë° ì•„ë˜ì™€ ê°™ì€ ì—ëŸ¬ê°€ ë°œìƒí–ˆë‹¤.</p>
<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">sudo </span>service nginx start
Job <span class="k">for </span>nginx.service failed because the control process exited with error code.
See <span class="s2">"systemctl status nginx.service"</span> and <span class="s2">"journalctl -xeu nginx.service"</span> <span class="k">for </span>details.
</code></pre></div></div>
<p>í„°ë¯¸ë„ì— ë‚˜ì˜¨ëŒ€ë¡œ <code class="language-plaintext highlighter-rouge">systemctl status nginx.service</code>ë¥¼ <br />
ì…ë ¥í•˜ì—¬ ë¡œê·¸ë¥¼ í™•ì¸í•´ë´¤ë‹¤.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>systemctl status nginx.service
Ã— nginx.service - A high performance web server and a reverse proxy server
     Loaded: loaded <span class="o">(</span>/lib/systemd/system/nginx.service<span class="p">;</span> enabled<span class="p">;</span> vendor preset: enabled<span class="o">)</span>
     Active: failed <span class="o">(</span>Result: exit-code<span class="o">)</span> since Sat 2023-01-28 02:54:33 KST<span class="p">;</span> 14s ago
       Docs: man:nginx<span class="o">(</span>8<span class="o">)</span>
    Process: 11722 <span class="nv">ExecStartPre</span><span class="o">=</span>/usr/sbin/nginx <span class="nt">-t</span> <span class="nt">-q</span> <span class="nt">-g</span> daemon on<span class="p">;</span> master_process on<span class="p">;</span> <span class="o">(</span><span class="nv">code</span><span class="o">=</span>exited, <span class="nv">status</span><span class="o">=</span>0/SUCCESS<span class="o">)</span>
    Process: 11723 <span class="nv">ExecStart</span><span class="o">=</span>/usr/sbin/nginx <span class="nt">-g</span> daemon on<span class="p">;</span> master_process on<span class="p">;</span> <span class="o">(</span><span class="nv">code</span><span class="o">=</span>exited, <span class="nv">status</span><span class="o">=</span>1/FAILURE<span class="o">)</span>
        CPU: 27ms

Jan 28 02:54:32 instance-20230101-2217 nginx[11723]: nginx: <span class="o">[</span>emerg] <span class="nb">bind</span><span class="o">()</span> to 0.0.0.0:80 failed <span class="o">(</span>98: Unknown error<span class="o">)</span>
Jan 28 02:54:32 instance-20230101-2217 nginx[11723]: nginx: <span class="o">[</span>emerg] <span class="nb">bind</span><span class="o">()</span> to <span class="o">[</span>::]:80 failed <span class="o">(</span>98: Unknown error<span class="o">)</span>
Jan 28 02:54:32 instance-20230101-2217 nginx[11723]: nginx: <span class="o">[</span>emerg] <span class="nb">bind</span><span class="o">()</span> to 0.0.0.0:80 failed <span class="o">(</span>98: Unknown error<span class="o">)</span>
Jan 28 02:54:32 instance-20230101-2217 nginx[11723]: nginx: <span class="o">[</span>emerg] <span class="nb">bind</span><span class="o">()</span> to <span class="o">[</span>::]:80 failed <span class="o">(</span>98: Unknown error<span class="o">)</span>
Jan 28 02:54:33 instance-20230101-2217 nginx[11723]: nginx: <span class="o">[</span>emerg] <span class="nb">bind</span><span class="o">()</span> to 0.0.0.0:80 failed <span class="o">(</span>98: Unknown error<span class="o">)</span>
Jan 28 02:54:33 instance-20230101-2217 nginx[11723]: nginx: <span class="o">[</span>emerg] <span class="nb">bind</span><span class="o">()</span> to <span class="o">[</span>::]:80 failed <span class="o">(</span>98: Unknown error<span class="o">)</span>
Jan 28 02:54:33 instance-20230101-2217 nginx[11723]: nginx: <span class="o">[</span>emerg] still could not <span class="nb">bind</span><span class="o">()</span>
Jan 28 02:54:33 instance-20230101-2217 systemd[1]: nginx.service: Control process exited, <span class="nv">code</span><span class="o">=</span>exited, <span class="nv">status</span><span class="o">=</span>1/FAILURE
Jan 28 02:54:33 instance-20230101-2217 systemd[1]: nginx.service: Failed with result <span class="s1">'exit-code'</span><span class="nb">.</span>
Jan 28 02:54:33 instance-20230101-2217 systemd[1]: Failed to start A high performance web server and a reverse proxy server.
</code></pre></div></div>

<p>ìœ„ì™€ ê°™ì€ ì—ëŸ¬ ì½”ë“œë“¤ì´ ë‚˜ì™”ë‹¤. <br />
<code class="language-plaintext highlighter-rouge">Failed to start A high performance web server and a reverse proxy server.</code>ë¥¼<br />
í‚¤ì›Œë“œë¡œ ê²€ìƒ‰í•˜ë‹ˆ <a href="https://stackoverflow.com/questions/51525710/nginx-failed-to-start-a-high-performance-web-server-and-a-reverse-proxy-server">Stackoverflow í•´ê²° ë ˆí¼ëŸ°ìŠ¤</a>ë¡œ ë¬¸ì œ í•´ê²°ì´ ê°€ëŠ¥í–ˆë‹¤.</p>

<p>ë‚˜ì™€ ê°™ì€ ê²½ìš°ëŠ”</p>
<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>fuser <span class="nt">-k</span> 80/tcp
<span class="nb">sudo </span>systemctl restart nginx
</code></pre></div></div>
<p>ë¥¼ ì…ë ¥í•˜ì—¬ì£¼ë‹ˆ ì˜¤ë¥˜ê°€ í•´ê²°ë˜ì—ˆë‹¤.</p>

<p>ë‚´ìš©ì„ ë³´ìí•˜ë‹ˆ.. ì´ë¯¸ ì‹¤í–‰ 80ìœ¼ë¡œ ì‹¤í–‰ì¤‘ì¸ í¬íŠ¸ê°€ ìˆì—ˆë˜ ê²ƒ..<br />
<code class="language-plaintext highlighter-rouge">sudo lsof -i:80</code>ë¥¼ ì…ë ¥í•´ì„œ í•œë²ˆ í™•ì¸í›„</p>

<p>ìœ„ì— ëª…ë ¹ì–´ì²˜ëŸ¼ í•´ë‹¹í•˜ëŠ” í¬íŠ¸ë¥¼ ì¤‘ì§€ì‹œì¼œì£¼ì!</p>]]></content><author><name>LEE JAEHYEOK</name></author><category term="Linux/Unix" /><category term="Linux" /><category term="Unix" /><summary type="html"><![CDATA[https ê´€ë ¨ ì„¤ì •ì„ ë§Œì§€ë‹¤ê°€ nginxë¥¼ ì‹¤í–‰í•˜ëŠ”ë° ì•„ë˜ì™€ ê°™ì€ ì—ëŸ¬ê°€ ë°œìƒí–ˆë‹¤. $ sudo service nginx start Job for nginx.service failed because the control process exited with error code. See "systemctl status nginx.service" and "journalctl -xeu nginx.service" for details. í„°ë¯¸ë„ì— ë‚˜ì˜¨ëŒ€ë¡œ systemctl status nginx.serviceë¥¼ ì…ë ¥í•˜ì—¬ ë¡œê·¸ë¥¼ í™•ì¸í•´ë´¤ë‹¤.]]></summary></entry><entry><title type="html">Oracle Cloud ì™¸ë¶€ ì ‘ì† ì„¤ì •</title><link href="http://localhost:4000/server/2023/01/27/server-oraclesetting.html" rel="alternate" type="text/html" title="Oracle Cloud ì™¸ë¶€ ì ‘ì† ì„¤ì •" /><published>2023-01-27T00:00:00+09:00</published><updated>2023-01-27T00:00:00+09:00</updated><id>http://localhost:4000/server/2023/01/27/server-oraclesetting</id><content type="html" xml:base="http://localhost:4000/server/2023/01/27/server-oraclesetting.html"><![CDATA[<p>ì˜¤ëŠ˜ì€ Oracle Cloud ì„œë²„ì—<br />
nginxì— í´ë¼ì´ì–¸íŠ¸ë¥¼ ë°°í¬í•´ ì™¸ë¶€ì—ì„œ ì ‘ì†í•˜ê³ <br />
WorkBenchë¥¼ ì´ìš©í•´ mysqlì„ ì ‘ì†í•˜ë ¤í•œë‹¤.</p>

<p>ì™¸ë¶€ì ‘ì†ê´€ë ¨í•´ ì„¤ì •ì„ ì •ë¦¬í•´ë³´ë ¤í•œë‹¤.</p>

<p><br /></p>

<h3 id="-ufw-vs-iptables">ğŸ“Œ UFW vs iptables</h3>

<p>iptablesë¥¼ ì´ìš©í•´ ë°©í™”ë²½ ì„¤ì •ì„ í•  ìˆ˜ ìˆë‹¤.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>iptables <span class="nt">-I</span> INPUT 1 <span class="nt">-p</span> tcp <span class="nt">--dport</span> 80 <span class="nt">-j</span> ACCEPT
</code></pre></div></div>
<p>ì™€ ê°™ì´ ì…ë ¥í•´ì£¼ë©´ ì„¤ì •ì´ ê°€ëŠ¥í•˜ë‹¤. <br />
UFWëŠ” ì´ë¥¼ ì¢€ë” ì‰½ê²Œm ì„¤ì •í•  ìˆ˜ ìˆë„ë¡ í•´ì£¼ëŠ” ëª…ë ¹ì–´ì´ê³ <br />
ìˆ˜ì¤€ë†’ì€ ë°©í™”ë²½ êµ¬ì„±ì—ëŠ” iptablesë¥¼ ì‚¬ìš©í•´ì•¼í•œë‹¤.</p>

<p><br /></p>

<h3 id="-ufw-í™œì„±ë¹„í™œì„±">ğŸ“Œ UFW í™œì„±/ë¹„í™œì„±</h3>

<p><strong>1). UFW í™œì„±í™”</strong></p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>ufw <span class="nb">enable</span>
</code></pre></div></div>

<p><br /></p>

<p><strong>2). UFW ë¹„í™œì„±í™”</strong></p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>ufw disable
</code></pre></div></div>

<p><br /></p>

<p><strong>3). UFW ìƒíƒœí™•ì¸</strong></p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>ufw status verbose
</code></pre></div></div>

<p>ìƒíƒœí™•ì¸ ëª…ë ¹ì–´ë¥¼ ì…ë ¥í•˜ë©´</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Status: active
Logging: on <span class="o">(</span>low<span class="o">)</span>
Default: deny <span class="o">(</span>incoming<span class="o">)</span>, allow <span class="o">(</span>outgoing<span class="o">)</span>, disabled <span class="o">(</span>routed<span class="o">)</span>
New profiles: skip

To                         Action      From
<span class="nt">--</span>                         <span class="nt">------</span>      <span class="nt">----</span>
3306/tcp                   ALLOW IN    Anywhere
80/tcp                     ALLOW IN    Anywhere
3306/tcp <span class="o">(</span>v6<span class="o">)</span>              ALLOW IN    Anywhere <span class="o">(</span>v6<span class="o">)</span>
80/tcp <span class="o">(</span>v6<span class="o">)</span>                ALLOW IN    Anywhere <span class="o">(</span>v6<span class="o">)</span>
</code></pre></div></div>
<p>ì™€ ê°™ì´ í—ˆìš©í•œ í¬íŠ¸ì— ëŒ€í•´ í‘œì‹œê°€ëœë‹¤. ex) 80, 3306<br />
ìœ„ì—ì„œ í™•ì¸ì´ ê°€ëŠ¥í•˜ë“¯, ê¸°ë³¸ë£°ì€</p>

<p>incomingëŠ” ì „ë¶€ ê±°ë¶€(deny)<br />
outgoingì€ ì „ë¶€ í—ˆê°€(allow)<br />
ë¡œ UFWì— ê¸°ë³¸ìœ¼ë¡œ ì„¤ì •ë˜ì–´ìˆëŠ” ë£°ì´ë‹¤.</p>

<p><br /></p>

<h3 id="-ufw-í—ˆìš©ì°¨ë‹¨-ë£°ì¶”ê°€">ğŸ“Œ UFW í—ˆìš©,ì°¨ë‹¨ ë£°ì¶”ê°€</h3>

<p><strong>1). http 80ë²ˆ í¬ TCP,UDP í¬íŠ¸ë¥¼ ëª¨ë‘í—ˆìš©</strong></p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>ufw allow 80
</code></pre></div></div>

<p><br /></p>

<p><strong>2). http 80ë²ˆ í¬ TCP í¬íŠ¸ë§Œ í—ˆìš©</strong></p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>ufw allow 80/tcp
</code></pre></div></div>

<p><br /></p>

<p><strong>3). http 80ë²ˆ í¬ UDP í¬íŠ¸ë§Œ í—ˆìš©</strong></p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>ufw allow 80/udp
</code></pre></div></div>

<p><br /></p>

<p>ë°˜ëŒ€ë¡œ ì°¨ë‹¨ê³¼ ê°™ì€ ê²½ìš°ì—ëŠ” allowìë¦¬ì— <br />
<code class="language-plaintext highlighter-rouge">deny</code> ëª…ë ¹ì–´ë¥¼ ì…ë ¥í•´ì£¼ë©´ ëœë‹¤.</p>

<p><br /></p>

<h3 id="-ufw-í—ˆìš©ì°¨ë‹¨-ë£°-ì‚­ì œ">ğŸ“Œ UFW í—ˆìš©,ì°¨ë‹¨ ë£° ì‚­ì œ</h3>

<p>ìœ„ì—ì„œ <code class="language-plaintext highlighter-rouge">allow</code>, <code class="language-plaintext highlighter-rouge">deny</code>ëª…ë ¹ì–´ë¥¼ ì´ìš©í•´ <br />
í—ˆìš©ê³¼ ì°¨ë‹¨ ë£°ì„ ì¶”ê°€í•´ì£¼ì—ˆë‹¤. <br />
<code class="language-plaintext highlighter-rouge">sudo ufw status verbose</code>ë¡œ ì¡°íšŒí•˜ì˜€ì„ ê²½ìš°ì—<br />
ì•„ë˜ì™€ ê°™ì´ ì¡°íšŒë˜ì—ˆë‹¤ê³  ê°€ì •í–ˆì„ë•Œ</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Status: active
Logging: on <span class="o">(</span>low<span class="o">)</span>
Default: deny <span class="o">(</span>incoming<span class="o">)</span>, allow <span class="o">(</span>outgoing<span class="o">)</span>, disabled <span class="o">(</span>routed<span class="o">)</span>
New profiles: skip

To                         Action      From
<span class="nt">--</span>                         <span class="nt">------</span>      <span class="nt">----</span>
80/tcp                     ALLOW IN    Anywhere
80                         DENY IN     Anywhere
80/tcp <span class="o">(</span>v6<span class="o">)</span>                ALLOW IN    Anywhere <span class="o">(</span>v6<span class="o">)</span>
80 <span class="o">(</span>v6<span class="o">)</span>                    DENY IN     Anywhere <span class="o">(</span>v6<span class="o">)</span>
</code></pre></div></div>
<p>í•´ë‹¹ ì •ì±…ë“¤ì„ ì‚­ì œí•˜ê³  ì‹¶ì€ ê²½ìš°ì—ëŠ”</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>ufw delete deny 80
</code></pre></div></div>
<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>ufw delete allow 80/tcp
</code></pre></div></div>
<p>ì™€ ê°™ì€ ë°©ì‹ìœ¼ë¡œ <code class="language-plaintext highlighter-rouge">delete</code> ëª…ë ¹ì–´ë¥¼ ì´ìš©í•´ ë£°ì„ ì‚­ì œí•  ìˆ˜ ìˆë‹¤.</p>

<p><br /></p>

<p>âœ¨ ì°¸ê³  ë¸”ë¡œê·¸ <br />
<a href="https://kibua20.tistory.com/124">í´ë¼ìš°ë“œ ë°©í™”ë²½ ì„¤ì • ì°¸ê³  ë ˆí¼ëŸ°ìŠ¤</a>, <a href="https://webdir.tistory.com/206">ìš°ë¶„íˆ¬ UFW ì„¤ì • ì°¸ê³  ë ˆí¼ëŸ°ìŠ¤</a></p>]]></content><author><name>LEE JAEHYEOK</name></author><category term="Server" /><category term="Server" /><category term="Oracle" /><summary type="html"><![CDATA[ì˜¤ëŠ˜ì€ Oracle Cloud ì„œë²„ì— nginxì— í´ë¼ì´ì–¸íŠ¸ë¥¼ ë°°í¬í•´ ì™¸ë¶€ì—ì„œ ì ‘ì†í•˜ê³  WorkBenchë¥¼ ì´ìš©í•´ mysqlì„ ì ‘ì†í•˜ë ¤í•œë‹¤.]]></summary></entry><entry><title type="html">Spring) MailAuthenticationException ë¬¸ì œ í•´ê²°</title><link href="http://localhost:4000/spring/2023/01/21/spring-email.html" rel="alternate" type="text/html" title="Spring) MailAuthenticationException ë¬¸ì œ í•´ê²°" /><published>2023-01-21T00:00:00+09:00</published><updated>2023-01-21T00:00:00+09:00</updated><id>http://localhost:4000/spring/2023/01/21/spring-email</id><content type="html" xml:base="http://localhost:4000/spring/2023/01/21/spring-email.html"><![CDATA[<p>ì˜¤ëŠ˜ì€ íšŒì›ê°€ì…ì‹œ ì´ë©”ì¼ ì „ì†¡ ë¡œì§ì„ í™•ì¸ì¤‘<br />
<code class="language-plaintext highlighter-rouge">org.springframework.mail.MailAuthenticationException</code>ì™€ ê°™ì€<br />
ì˜ˆì™¸ë¥¼ ë§Œë‚¬ê³  í•´ë‹¹ê´€ë ¨ í•´ê²°ë°©ë²•ì„ ì ì–´ê°€ë³´ë ¤í•œë‹¤.</p>

<p><br /></p>

<h3 id="-ì‘ì—…í™˜ê²½">âœ… ì‘ì—…í™˜ê²½</h3>

<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Spring Boot 2.7.7  
Java 11 
macOs Monterey 12.6 ë²„ì „ 
ë¡œì»¬í™˜ê²½ì—ì„œ í…ŒìŠ¤íŠ¸ ì§„í–‰
</code></pre></div></div>

<p><br /></p>

<h3 id="-ì—ëŸ¬-í™•ì¸-ë°-í•´ê²°">ğŸ“Œ ì—ëŸ¬ í™•ì¸ ë° í•´ê²°</h3>

<p>ì²«ë²ˆì§¸ë¡œ Spring ì—ì„œ ì§€ì›í•˜ëŠ” mail ì„œë¹„ìŠ¤ë¥¼ ì´ìš©í•´ë³´ë ¤í•œë‹¤. <br />
ë©”ì¼ì„ ë³´ë‚´ëŠ” ì£¼ì²´ëŠ” Googleì˜ gmailì„ ì´ìš©í•˜ë ¤í•œë‹¤.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">implementation</span> <span class="err">'</span><span class="n">org</span><span class="o">.</span><span class="na">springframework</span><span class="o">.</span><span class="na">boot</span><span class="o">:</span><span class="n">spring</span><span class="o">-</span><span class="n">boot</span><span class="o">-</span><span class="n">starter</span><span class="o">-</span><span class="n">mail</span><span class="err">'</span>
</code></pre></div></div>
<p><a href="https://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/mail/package-summary.html">org.springframewokr.mail</a>, <a href="https://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/mail/javamail/package-summary.html">org.springframewokr.javamail</a> íŒ¨í‚¤ì§€ë¥¼ ì‚¬ìš©í•œë‹¤.</p>

<p><code class="language-plaintext highlighter-rouge">JavaMailSender</code> ì¸í„°í˜ì´ìŠ¤ì˜ <code class="language-plaintext highlighter-rouge">send();</code>ë©”ì„œë“œë¥¼<br />
Override í•˜ì—¬ êµ¬í˜„í•˜ì˜€ê³  í…ŒìŠ¤íŠ¸ ì§„í–‰ë„ì¤‘ ì•„ë˜ì™€ ê°™ì€ ì˜ˆì™¸ë¥¼ ë§Œë‚˜ê²Œ ë˜ì—ˆë‹¤.</p>

<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>2023-01-21 15:40:59.934 ERROR 281 --- [         task-1] .a.i.SimpleAsyncUncaughtExceptionHandler : Unexpected exception occurred invoking async method: public void codestates.frogroup.indiego.global.email.event.MemberRegistrationEventListener.listen(codestates.frogroup.indiego.global.email.event.MemberRegistrationApplicationEvent) throws java.lang.Exception

org.springframework.mail.MailAuthenticationException: Authentication failed; nested exception is javax.mail.AuthenticationFailedException: 534-5.7.9 Application-specific password required. Learn more at
534 5.7.9  https://support.google.com/mail/?p=InvalidSecondFactor t1-20020a63d241000000b004c974bb9a4esm11189895pgi.83 - gsmtp
</code></pre></div></div>

<p>ë‚´ìš©ì„ ì˜ ì½ì–´ë³´ë‹ˆ, ì¸ì¦ì— ì‹¤íŒ¨í•˜ì˜€ê³ <br />
<code class="language-plaintext highlighter-rouge">Application-specific password required</code> ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ìŠ¤í™ì— ë§ëŠ”<br />
ë¹„ë°€ë²ˆí˜¸ë¥¼ ìš”êµ¬í•œë‹¤ê³ í•œë‹¤. ê·¸ë¦¬ê³  ì°¸ê³ ìš© ì£¼ì†Œë¥¼ í•˜ë‚˜ê°€ ì½˜ì†”ì— ì°í˜€ìˆë‹¤.<br />
<a href="https://support.google.com/accounts/answer/185833?visit_id=638098789197662028-710657186&amp;p=InvalidSecondFactor&amp;rd=1">ì•± ë¹„ë°€ë²ˆí˜¸ë¡œ ë¡œê·¸ì¸</a>ê´€ë ¨ ì£¼ì†Œì´ë©°, ì •ë§ ì¹œì ˆí•œ Springâ€¦ ê°ë™..</p>

<p>ì˜ˆì™¸ê°€ ë°œìƒí•œ ì½”ë“œë¥¼ ì­‰ ë”°ë¼ê°€ë‹¤ ë³´ë©´<br />
<code class="language-plaintext highlighter-rouge">JavaMailSender</code>ì¸í„°í˜ì´ìŠ¤ì˜</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>	<span class="kd">protected</span> <span class="kt">void</span> <span class="nf">doSend</span><span class="o">(</span><span class="nc">MimeMessage</span><span class="o">[]</span> <span class="n">mimeMessages</span><span class="o">,</span> <span class="nd">@Nullable</span> <span class="nc">Object</span><span class="o">[]</span> <span class="n">originalMessages</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">MailException</span> <span class="o">{</span>
		<span class="nc">Map</span><span class="o">&lt;</span><span class="nc">Object</span><span class="o">,</span> <span class="nc">Exception</span><span class="o">&gt;</span> <span class="n">failedMessages</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">LinkedHashMap</span><span class="o">&lt;&gt;();</span>
		<span class="nc">Transport</span> <span class="n">transport</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>

		<span class="k">try</span> <span class="o">{</span>
			<span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">mimeMessages</span><span class="o">.</span><span class="na">length</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>

				<span class="c1">// Check transport connection first...</span>
				<span class="k">if</span> <span class="o">(</span><span class="n">transport</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">||</span> <span class="o">!</span><span class="n">transport</span><span class="o">.</span><span class="na">isConnected</span><span class="o">())</span> <span class="o">{</span>
					<span class="k">if</span> <span class="o">(</span><span class="n">transport</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
						<span class="k">try</span> <span class="o">{</span>
							<span class="n">transport</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
						<span class="o">}</span>
						<span class="k">catch</span> <span class="o">(</span><span class="nc">Exception</span> <span class="n">ex</span><span class="o">)</span> <span class="o">{</span>
							<span class="c1">// Ignore - we're reconnecting anyway</span>
						<span class="o">}</span>
						<span class="n">transport</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
					<span class="o">}</span>
					<span class="k">try</span> <span class="o">{</span>
						<span class="n">transport</span> <span class="o">=</span> <span class="n">connectTransport</span><span class="o">();</span>
					<span class="o">}</span>
					<span class="k">catch</span> <span class="o">(</span><span class="nc">AuthenticationFailedException</span> <span class="n">ex</span><span class="o">)</span> <span class="o">{</span>
						<span class="k">throw</span> <span class="k">new</span> <span class="nf">MailAuthenticationException</span><span class="o">(</span><span class="n">ex</span><span class="o">);</span>
					<span class="o">}</span>
					<span class="k">catch</span> <span class="o">(</span><span class="nc">Exception</span> <span class="n">ex</span><span class="o">)</span> <span class="o">{</span>
						<span class="c1">// Effectively, all remaining messages failed...</span>
						<span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="n">i</span><span class="o">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">mimeMessages</span><span class="o">.</span><span class="na">length</span><span class="o">;</span> <span class="n">j</span><span class="o">++)</span> <span class="o">{</span>
							<span class="nc">Object</span> <span class="n">original</span> <span class="o">=</span> <span class="o">(</span><span class="n">originalMessages</span> <span class="o">!=</span> <span class="kc">null</span> <span class="o">?</span> <span class="n">originalMessages</span><span class="o">[</span><span class="n">j</span><span class="o">]</span> <span class="o">:</span> <span class="n">mimeMessages</span><span class="o">[</span><span class="n">j</span><span class="o">]);</span>
							<span class="n">failedMessages</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">original</span><span class="o">,</span> <span class="n">ex</span><span class="o">);</span>
						<span class="o">}</span>
						<span class="k">throw</span> <span class="k">new</span> <span class="nf">MailSendException</span><span class="o">(</span><span class="s">"Mail server connection failed"</span><span class="o">,</span> <span class="n">ex</span><span class="o">,</span> <span class="n">failedMessages</span><span class="o">);</span>
					<span class="o">}</span>
				<span class="o">}</span>
        <span class="o">}</span>        
                
                <span class="o">...</span> <span class="n">ìƒëµ</span>
	<span class="o">}</span>
</code></pre></div></div>
<p>êµ¬í˜„ì²´ì¸ <code class="language-plaintext highlighter-rouge">JavaMailSenderImpl</code>ì˜ ì•„ë˜ì˜ ë©”ì„œë“œì—ì„œ <br />
<code class="language-plaintext highlighter-rouge">connectTransport();</code> ë©”ì„œë“œë¥¼ í˜¸ì¶œí•  ë•Œ ì˜ˆì™¸ê°€ ë°œìƒí•œ ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>	<span class="kd">protected</span> <span class="nc">Transport</span> <span class="nf">connectTransport</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">MessagingException</span> <span class="o">{</span>
		<span class="nc">String</span> <span class="n">username</span> <span class="o">=</span> <span class="n">getUsername</span><span class="o">();</span>
		<span class="nc">String</span> <span class="n">password</span> <span class="o">=</span> <span class="n">getPassword</span><span class="o">();</span>
		<span class="k">if</span> <span class="o">(</span><span class="s">""</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">username</span><span class="o">))</span> <span class="o">{</span>  <span class="c1">// probably from a placeholder</span>
			<span class="n">username</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
			<span class="k">if</span> <span class="o">(</span><span class="s">""</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">password</span><span class="o">))</span> <span class="o">{</span>  <span class="c1">// in conjunction with "" username, this means no password to use</span>
				<span class="n">password</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
			<span class="o">}</span>
		<span class="o">}</span>

		<span class="nc">Transport</span> <span class="n">transport</span> <span class="o">=</span> <span class="n">getTransport</span><span class="o">(</span><span class="n">getSession</span><span class="o">());</span>
		<span class="n">transport</span><span class="o">.</span><span class="na">connect</span><span class="o">(</span><span class="n">getHost</span><span class="o">(),</span> <span class="n">getPort</span><span class="o">(),</span> <span class="n">username</span><span class="o">,</span> <span class="n">password</span><span class="o">);</span>
		<span class="k">return</span> <span class="n">transport</span><span class="o">;</span>
	<span class="o">}</span>
</code></pre></div></div>
<p>í•´ë‹¹ ì½”ë“œì—ì„œë„ <code class="language-plaintext highlighter-rouge">transport.connect();</code> ë©”ì„œë“œ ì•ˆì—ì„œ<br />
host, port, user, passwordì˜ ì •ë³´ë¡œ ì—°ê²° ì‹œë„ë¥¼ í•˜ëŠ”ë° ì •ë³´ê°€ ë§ì§€ì•Šì•„ <br />
ì—°ê²°ì´ ì •ìƒì ìœ¼ë¡œ ì‹¤í–‰ë˜ì§€ ì•Šì„ ê²½ìš°ì— <code class="language-plaintext highlighter-rouge">AuthenticationFailedException</code> ì˜ˆì™¸ê°€ <br />
ë°œìƒí•˜ëŠ” ê±°ì´ë¼ê³  ì¶”ì¸¡ì´ëœë‹¤â€¦ ì¢€ë” ì–´ë“œë²¤ìŠ¤í•œ ê³µë¶€ëŠ” ì¶”í›„í•´ í•´ë´ì•¼í•  ê²ƒ ê°™ë‹¤.</p>

<p><br /></p>

<p>ê·¸ë˜ì„œ ìŠ¤í”„ë§ì—ì„œ ì¹œì ˆí•˜ê²Œ ì•Œë ¤ì¤€ ì½˜ì†”ë‚´ìš©ëŒ€ë¡œ í•´ê²°ì„ í•´ë³´ì.</p>

<p>í˜„ì¬ yml ì„¤ì • íŒŒì¼ì´ë‹¤.</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">mail</span><span class="pi">:</span>
  <span class="na">smtp</span><span class="pi">:</span>
    <span class="na">host</span><span class="pi">:</span> <span class="s">smtp.gmail.com</span>
    <span class="na">port</span><span class="pi">:</span> <span class="m">587</span>
    <span class="na">username</span><span class="pi">:</span> <span class="s">${GOOGLE_ID}</span>
    <span class="na">password</span><span class="pi">:</span> <span class="s">${GOOGLE_PASSWORD}</span>
    <span class="na">auth</span><span class="pi">:</span> <span class="no">true</span>
    <span class="na">starttls</span><span class="pi">:</span>
      <span class="na">enable</span><span class="pi">:</span> <span class="no">true</span>
  <span class="na">subject</span><span class="pi">:</span>
    <span class="na">member</span><span class="pi">:</span>
      <span class="na">registration</span><span class="pi">:</span> <span class="s">ê°œêµ´ë‹¨ì˜ ì¸ë””ê³  ì„œë¹„ìŠ¤ì— ì„±ê³µì ìœ¼ë¡œ ê°€ì…í•˜ì…¨ìŠµë‹ˆë‹¤.</span>
  <span class="na">template</span><span class="pi">:</span>
    <span class="na">name</span><span class="pi">:</span>
      <span class="na">member</span><span class="pi">:</span>
        <span class="na">join</span><span class="pi">:</span> <span class="s">email-registration-member</span>
</code></pre></div></div>
<p>í™˜ê²½ë³€ìˆ˜ë¥¼ ì´ìš©í•´ ì„¤ì •í•´ë‘ì—ˆê³ <br />
usernameì—ëŠ” êµ¬ê¸€ ì´ë©”ì¼ ì£¼ì†Œë¥¼ ë„£ì—ˆê³ <br />
passwordì—ëŠ” êµ¬ê¸€ ë¹„ë°€ë²ˆí˜¸ë¥¼ ë„£ì—ˆì—ˆë‹¤.</p>

<p>ì—¬ê¸°ì„œ ë¹„ë°€ë²ˆí˜¸ ìŠ¤í™ì´ ë§ì§€ì•Šë‹¤ê³  ì˜ˆì™¸ê°€ ë°œìƒí•œ ê²ƒì´ì˜€ê³ <br />
<a href="https://support.google.com/accounts/answer/185833?visit_id=638098789197662028-710657186&amp;p=InvalidSecondFactor&amp;rd=1">ì•± ë¹„ë°€ë²ˆí˜¸ë¡œ ë¡œê·¸ì¸</a>ìœ¼ë¡œ ì ‘ì†í•´ ì•± ë¹„ë°€ë²ˆí˜¸ë¥¼ ì„¤ì •í•´ì£¼ì—ˆë‹¤.</p>

<p><img src="https://user-images.githubusercontent.com/95069395/213848506-5245e665-d3ef-4c2d-901d-94c49ef6f696.png" alt="image" class="align-left" style="max-width: 100%" /></p>

<p>ìµœì¢…ì ìœ¼ë¡œ ë¹„ë°€ë²ˆí˜¸ë¥¼ ë°›ê²Œëœë‹¤ë©´<br />
16ìì˜ ë¹„ë°€ë²ˆí˜¸ë¥¼ ë°œê¸‰ë°›ê²Œ ë  ê²ƒì´ê³ </p>

<p>password í™˜ê²½ë³€ìˆ˜ì— ê³µë°±ì—†ì´ 16ìë¥¼ ì…ë ¥í•´ì£¼ë©´ ëœë‹¤.<br />
ex) abcdefghijklmnop</p>

<p><br /></p>

<p>ìˆ˜ì •ì„ í•˜ê³  ë‹¤ì‹œ íšŒì›ê°€ì… ì„œë¹„ìŠ¤ë¥¼ ì§„í–‰í•´ë³´ì•˜ë‹¤.</p>

<p><img src="https://user-images.githubusercontent.com/95069395/213848511-98c77ad0-50b7-4470-8665-538d73155427.png" alt="image" class="align-left" style="max-width: 100%" /></p>

<p>ê°„ë‹¨í•œ í…œí”Œë¦¿ìœ¼ë¡œ ìš°ì„  í…ŒìŠ¤íŠ¸ë¥¼ ì§„í–‰í–ˆê³  <br />
íšŒì›ê°€ì…ì„í•œ ìœ ì €ì˜ ë©”ì¼ë¡œ ì •ìƒì ìœ¼ë¡œ íšŒì›ê°€ì… ì•ˆë‚´ ë©”ì¼ì´ ë³´ë‚´ì§„ ê²ƒì„ í™•ì¸í•´ë³¼ ìˆ˜ ìˆë‹¤!!</p>

<p><br />
<br /></p>

<p>âœ¨ ì°¸ê³  ë¸”ë¡œê·¸<br />
<a href="https://kijuk.tistory.com/162?category=1056346">ë¬¸ì œ í•´ê²° ì°¸ê³  ë¸”ë¡œê·¸</a></p>

<p><br />
<br /></p>]]></content><author><name>LEE JAEHYEOK</name></author><category term="Spring" /><category term="Spring" /><category term="email" /><summary type="html"><![CDATA[ì˜¤ëŠ˜ì€ íšŒì›ê°€ì…ì‹œ ì´ë©”ì¼ ì „ì†¡ ë¡œì§ì„ í™•ì¸ì¤‘ org.springframework.mail.MailAuthenticationExceptionì™€ ê°™ì€ ì˜ˆì™¸ë¥¼ ë§Œë‚¬ê³  í•´ë‹¹ê´€ë ¨ í•´ê²°ë°©ë²•ì„ ì ì–´ê°€ë³´ë ¤í•œë‹¤.]]></summary></entry><entry><title type="html">Spring) AWS S3 FileUpload í•˜ì—¬ URLë¡œ ê´€ë¦¬í•˜ê¸°</title><link href="http://localhost:4000/spring/2023/01/15/spring-fileupload.html" rel="alternate" type="text/html" title="Spring) AWS S3 FileUpload í•˜ì—¬ URLë¡œ ê´€ë¦¬í•˜ê¸°" /><published>2023-01-15T00:00:00+09:00</published><updated>2023-01-15T00:00:00+09:00</updated><id>http://localhost:4000/spring/2023/01/15/spring-fileupload</id><content type="html" xml:base="http://localhost:4000/spring/2023/01/15/spring-fileupload.html"><![CDATA[<p>ì˜¤ëŠ˜ì€ AWS S3ì— íŒŒì¼ ì—…ë¡œë“œë¥¼ í•˜ëŠ”<br />
ì˜ˆì œë¥¼ ë‹¤ë¤„ë³´ë ¤í•œë‹¤.</p>

<p>êµ¬ê¸€ì—ì„œ ì—¬ëŸ¬ê°€ì§€ ë¸”ë¡œê·¸ë¥¼ ëŒì•„ë‹¤ë‹ˆë©° í•™ìŠµí–ˆê³ <br />
ìˆœì„œì™€ ì½”ë“œì— ëŒ€í•´ ì •ë¦¬í•´ë³´ë ¤í•œë‹¤. <br />
ë‚´ê°€ ì‘ì„±í•œ ì½”ë“œëŠ” <a href="https://github.com/MyCatlikesChuru/ImageFileUpload">GitHub ë ˆí¬ì§€í† ë¦¬</a>ë¡œ ê³µìœ í•´ë³¸ë‹¤.</p>

<p><br /></p>

<h3 id="-ì‘ì—…-í™˜ê²½">âœ… ì‘ì—… í™˜ê²½</h3>

<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>AWS S3 ë²„í‚·
Spring Boot 2.7.7  
Java 11 
macOs Monterey 12.6 ë²„ì „ 
ë¡œì»¬í™˜ê²½ì—ì„œ í…ŒìŠ¤íŠ¸ ì§„í–‰
</code></pre></div></div>

<p><br /></p>

<h3 id="-ì‘ì—…-ìˆœì„œ-ë°-ì¤€ë¹„">ğŸ“Œ ì‘ì—… ìˆœì„œ ë° ì¤€ë¹„</h3>

<p>ë‚´ê°€ êµ¬ìƒí•˜ë ¤ê³  ìƒê°í•˜ëŠ” ì•„í‚¤í…ì²˜ë¥¼ ê·¸ë ¤ë³´ì•˜ë‹¤.<br />
ìˆœì„œë¥¼ ê°„ë‹¨íˆ ì§šê³  ë„˜ì–´ê°€ì</p>

<p><img src="https://user-images.githubusercontent.com/95069395/212537839-f1ebee39-3c06-449e-b3f0-359bb3c3d1c6.png" alt="image" class="align-left" style="max-width: 100%" /></p>

<p>1). í´ë¼ì´ì–¸íŠ¸ì—ì„œ ì´ë¯¸ì§€íŒŒì¼ì„ ì—…ë¡œë“œ ìš”ì²­<br />
-&gt; multipart/form-data íƒ€ì…ìœ¼ë¡œ ìš”ì²­<br />
-&gt; Key=file / value=ì´ë¯¸ì§€ í˜•íƒœë¡œ ìš”ì²­ì„ ë³´ëƒ„</p>

<p>2). ìš”ì²­ì„ ë°›ì€ ì„œë²„ì—ì„œ íŒŒì¼ì„ AWS S3 ë²„í‚·ì— ì €ì¥í•¨.<br />
-&gt; ì „ë‹¬ ë°›ì€ íŒŒì¼ì„ AWS ì €ì¥ì†Œì— ì›í•˜ëŠ” í´ë”ì— ì €ì¥í•¨.<br />
-&gt; ì €ì¥ì™„ë£Œí›„ DataBaseì— URLì„ ì €ì¥í•¨.</p>

<p>3). ì €ì¥ì´ ì •ìƒì ìœ¼ë¡œ ì²˜ë¦¬ë˜ì—ˆë‹¤ê³  í´ë¼ì´ì–¸íŠ¸ì— ì‘ë‹µí•¨.<br />
-&gt; ë§Œì•½ ì €ì¥ì— ì‹¤íŒ¨ ë° ì˜ˆì™¸ê°€ ë°œìƒí–ˆì„ ë•ŒëŠ” ì˜ˆì™¸ì²˜ë¦¬í•˜ì—¬ ì‘ë‹µí•´ì¤Œ</p>

<p>â—ï¸ì½”ë“œê°€ ê¸¸ì–´ì§ˆ ê²ƒì„ ìš°ë ¤í•´ DBì— ì €ì¥í•˜ëŠ” ê³¼ì •ì€ ìƒëµí•©ë‹ˆë‹¤!<br />
AWS S3ì— ì €ì¥ë˜ê³  URLì„ ì¶”ì¶œí•˜ëŠ” ê³¼ì •ë§Œ ë‹´ìœ¼ë ¤í•©ë‹ˆë‹¤.</p>

<p><br /></p>

<h3 id="-aws-s3-ìƒì„±">ğŸ“Œ AWS S3 ìƒì„±</h3>

<p>ì²«ë²ˆì§¸ë¡œ í•´ì•¼í•  ê²ƒì´ S3 ë²„í‚·ì„ ìƒì„±í•´ì•¼í•œë‹¤. <br />
ì—¬ëŸ¬ê°€ì§€ ê¸€ì„ ì°¸ê³ í•´ë³´ë©´ ì‰½ê²Œ ë§Œë“¤ ìˆ˜ ìˆì„ ê²ƒì´ë‹¤. <br />
ê·¸ë˜ë„ ì´ëŸ¬í•œ ê³¼ì •ì„ ì ì–´ë³´ë ¤í•œë‹¤.</p>

<p>ë‚˜ì™€ ê°™ì€ ê²½ìš°ëŠ” í”„ë¦¬í‹°ì–´ ê³„ì •ì´ ìˆê¸°ì— ë¬´ë£Œë¡œ ë§Œë“¤ì–´ ì‚¬ìš©í–ˆë‹¤. <br />
ë¬´ë£Œ ê¸°ì¤€ì— ë„˜ì–´ê°€ì§€ë§Œ ì•Šê²Œ ì˜ ì‚¬ìš©í•˜ë©´ ë¬´ë¦¬ëŠ” ì—†ì„ ê²ƒ ê°™ë‹¤.</p>

<p>ë³¸ê²©ì ìœ¼ë¡œ ë§Œë“¤ì–´ë³´ì</p>

<p><img src="https://user-images.githubusercontent.com/95069395/212538169-ec74cc60-1060-40d0-8e44-df280f9571dc.png" alt="image" class="align-left" style="max-width: 100%" /></p>

<p>ë²„í‚· ì´ë¦„ê³¼ ë¦¬ì „ì„ ì„ íƒí•´ì£¼ì.<br />
í•œêµ­ì— ìˆê¸°ë•Œë¬¸ì— ì„œìš¸ë¦¬ì „ì„ ì„ íƒí–ˆë‹¤.</p>

<p><br /></p>

<p><img src="https://user-images.githubusercontent.com/95069395/212538230-331609e3-66e3-4d2d-8f55-aa7cb22b4792.png" alt="image" class="align-left" style="max-width: 100%" /></p>

<p>ìš°ì„  ì—‘ì„¸ìŠ¤ ì°¨ë‹¨ì˜ ì²´í¬ë°•ìŠ¤ëŠ” í•´ì œì‹œì¼œë‘ì—ˆê³ <br />
ì´ì—ë”°ë¼ ì•„ë˜ ê²½ê³ ë¬¸êµ¬ê°€ ëœ¬ë‹¤. í•´ë‹¹ë¶€ë¶„ì„ ì²´í¬í•´ì¤˜ì•¼<br />
ë²„í‚·ì„ ë§Œë“¤ ìˆ˜ ìˆë‹¤.</p>

<p>ì´ë¯¸ì§€ë¥¼ í´ë¼ì´ì–¸íŠ¸ì— ê³µìš©ìœ¼ë¡œ ì‚¬ìš©í•  ê²ƒì´ê¸° ë•Œë¬¸ì— <br />
ìš°ì„ ì€ í¼ë¸”ë¦­ ì•¡ì„¸ì„œë¥¼ ì°¨ë‹¨í•˜ì§€ ì•Šì•˜ë‹¤.</p>

<p><br /></p>

<p><img src="https://user-images.githubusercontent.com/95069395/212538236-33952455-c626-4cad-99df-69af51b0ecf2.png" alt="image" class="align-left" style="max-width: 100%" /></p>

<p><img src="https://user-images.githubusercontent.com/95069395/212538244-c3dbfff3-1865-4a8f-9b49-1874cd5ca7c0.png" alt="image" class="align-left" style="max-width: 100%" /></p>

<p>ì´ì™¸ ì„¤ì •ì€ ê¸°ë³¸ìœ¼ë¡œ ë‘ê³  ë²„í‚· ìƒì„±ì„ ì§„í–‰í•˜ë©´ <br />
ë²„í‚·ì´ ë§Œë“¤ì–´ì§„ ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤.</p>

<p>í•´ë‹¹ ë²„í‚·ì—ì„œ í´ë”ë¥¼ ë§Œë“¤ì–´ ê´€ë¦¬ë¥¼ í•  ìˆ˜ ìˆë‹¤.<br />
ë‚˜ëŠ” í”„ë¡œí•„ì‚¬ì§„ì„ ëª¨ì•„ë†“ëŠ” í´ë”ì— <br />
ì´ë¯¸ì§€ ì—…ë¡œë“œí•œ íŒŒì¼ì„ ê´€ë¦¬í•˜ë ¤í•œë‹¤.</p>

<p><img src="https://user-images.githubusercontent.com/95069395/212538533-35027900-bebf-458b-b258-bd28fe7a5025.png" alt="image" class="align-left" style="max-width: 100%" /></p>

<p>ë²„í‚·ì—ì„œ í´ë” ë§Œë“¤ê¸°ë¥¼ ëˆŒëŸ¬ ë§Œë“¤ì–´ ì¤„ ìˆ˜ ìˆë‹¤.</p>

<p><img src="https://user-images.githubusercontent.com/95069395/212538576-c6629514-ad7d-406f-9c39-3b9ce24562e8.png" alt="image" class="align-left" style="max-width: 100%" /></p>

<p>ë§Œë“¤ê²Œë  ê²½ìš° ìœ„ì™€ ê°™ì€ í´ë”ê°€ ìƒê¸°ëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤. <br />
ìµœì¢…ì ìœ¼ë¡œ ìœ„ì— í´ë”ì— ì´ë¯¸ì§€ë¥¼ ì˜¬ë ¤ë³¼ ì˜ˆì •ì´ë‹¤.</p>

<p><br /></p>

<h3 id="-iam-ì„¤ì •">ğŸ“Œ IAM ì„¤ì •</h3>

<p>IAM -&gt; ì—‘ì„¸ìŠ¤ ê´€ë¦¬ -&gt; ì‚¬ìš©ì -&gt; ì‚¬ìš©ì ì¶”ê°€ë¥¼ ëˆŒëŸ¬ ì¤ë‹ˆë‹¤.</p>

<p><img src="https://user-images.githubusercontent.com/95069395/212538540-44bf93ef-9803-4f48-9f86-827a3d36f4fe.png" alt="image" class="align-left" style="max-width: 100%" /></p>

<p>ì‚¬ìš©ìì´ë¦„ì„ ì›í•˜ëŠ”ëŒ€ë¡œ ì„¤ì •í•˜ê³  <br />
ì—‘ì„¸ìŠ¤ í‚¤ ì²´í¬ ë°•ìŠ¤ë¥¼ ì²´í¬í•œë‹¤.</p>

<p><br /></p>

<p><img src="https://user-images.githubusercontent.com/95069395/212538545-cdcaad32-3f64-4a44-b73d-6c534338cb6b.png" alt="image" class="align-left" style="max-width: 100%" /></p>

<p>ë‹¤ìŒìœ¼ë¡œ ë„˜ì–´ê°€ ê¸°ì¡´ ì •ì±… ì§ì ‘ ì—°ê²°ì—ì„œ<br />
<code class="language-plaintext highlighter-rouge">AmazonS3FullAcess</code>ë¥¼ ì¶”ê°€í•´ì¤€ë‹¤.</p>

<p><br /></p>

<p><img src="https://user-images.githubusercontent.com/95069395/212538553-619d2f40-f900-4376-a9f7-c79633571007.png" alt="image" class="align-left" style="max-width: 100%" /></p>

<p>ë‹¤ìŒì„ ëˆŒëŸ¬ ë„˜ì–´ê°€ì¤€ë‹¤.</p>

<p><br /></p>

<p><img src="https://user-images.githubusercontent.com/95069395/212538556-b8fff09d-fe94-4dc2-bdfc-58f3625efee0.png" alt="image" class="align-left" style="max-width: 100%" /></p>

<p>ì‚¬ìš©ì ë§Œë“¤ê¸° ì¶”ê°€</p>

<p><br /></p>

<p><img src="https://user-images.githubusercontent.com/95069395/212538557-7d71c867-db35-4be6-bd34-a1b9fc4a99e9.png" alt="image" class="align-left" style="max-width: 100%" /></p>

<p>ì§€ì •í•œ ì‚¬ìš©ìì´ë¦„ìœ¼ë¡œ ì—‘ì„¸ìŠ¤ í‚¤IDì™€ ë¹„ë°€ ì—‘ì„¸ìŠ¤ í‚¤ê°€ ë°œê¸‰ëœë‹¤. <br />
ì´ ë‘ê°€ì§€ê°€ ì¤‘ìš”í•˜ë‹¤. í›„ì— ì—°ê²°í• ë•Œ ì‚¬ìš©ë˜ë‹ˆ ë”°ë¡œ ì €ì¥í•´ë‘ì</p>

<p>ì´ í‚¤ëŠ” ì ˆëŒ€ë¡œ Githubì— ì˜¬ë¦¬ê±°ë‚˜ ê³µìœ ë˜ë©´ ì•ˆë˜ëŠ” í‚¤ê°’ì´ë‹ˆ <br />
ì£¼ì˜í•´ì„œ ê´€ë¦¬í•˜ë„ë¡ í•˜ì</p>

<p><br /></p>

<p><img src="https://user-images.githubusercontent.com/95069395/212538560-2247c35c-3d06-46c3-b4ef-215f9e8ca6ac.png" alt="image" class="align-left" style="max-width: 100%" /></p>

<p>ìµœì¢…ì ìœ¼ë¡œ IAM ì‚¬ìš©ìê°€ ë§Œë“¤ì–´ì§„ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤. <br />
í•´ë‹¹ í‚¤ê°’ìœ¼ë¡œ S3ì— ì ‘ê·¼ì´ ê°€ëŠ¥í•´ì¡Œê³  <br />
ì´ì œ ì½”ë“œë¥¼ ì‘ì„±í•´ ì´ë¯¸ì§€ë¥¼ ì˜¬ë ¤ë³´ë„ë¡ í•˜ì</p>

<p><br /></p>

<h3 id="-ì½”ë“œ-ì‘ì„±">ğŸ“Œ ì½”ë“œ ì‘ì„±</h3>

<h4 id="-ê¸°ë³¸-ì…‹íŒ…">ğŸ›  ê¸°ë³¸ ì…‹íŒ…</h4>

<p><code class="language-plaintext highlighter-rouge">application.yml</code> ì„ ì„¤ì •í•´ì£¼ì</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">spring</span><span class="pi">:</span>
  <span class="na">servlet</span><span class="pi">:</span>
    <span class="na">multipart</span><span class="pi">:</span>
      <span class="na">max-file-size</span><span class="pi">:</span> <span class="s">10MB</span>
      <span class="na">max-request-size</span><span class="pi">:</span> <span class="s">10MB</span>
<span class="na">cloud</span><span class="pi">:</span>
  <span class="na">aws</span><span class="pi">:</span>
    <span class="na">credentials</span><span class="pi">:</span>
      <span class="na">access-key</span><span class="pi">:</span> <span class="s">${S3_ACCESS_KEY}</span>
      <span class="na">secret-key</span><span class="pi">:</span> <span class="s">${S3_SECRET_KEY}</span>
    <span class="na">s3</span><span class="pi">:</span>
      <span class="na">bucket</span><span class="pi">:</span> <span class="s">indiego-fileupload/profileimage</span>
    <span class="na">region</span><span class="pi">:</span>
      <span class="na">static</span><span class="pi">:</span> <span class="s">ap-northeast-2</span>
    <span class="na">stack</span><span class="pi">:</span>
      <span class="na">auto</span><span class="pi">:</span> <span class="no">false</span>
</code></pre></div></div>

<p>ì²˜ìŒìœ¼ë¡œëŠ” servletì˜ multipart ìš©ëŸ‰ ì‚¬ì´ì¦ˆë¥¼ ì§€ì •í•´ì£¼ì—ˆë‹¤. <br />
10MB ì´ìƒì„ ë„˜ì§€ëª»í•˜ë„ë¡ ì§€ì •í–ˆê³ , ë„˜ì€ íŒŒì¼ì´ ì˜¬ ê²½ìš°ì—<br />
ì˜ˆì™¸ì²˜ë¦¬ëŠ” ê°€ì¥ ë§¨ ì•„ë˜ì—ì„œ ì•Œì•„ë³´ì</p>

<p>ìœ„ì—ì„œ S3 ì„¤ì •í–ˆë˜ ê²ƒê³¼ ê°™ì´ <br />
regionì€ ì„œìš¸(ap-northeast-2)ë¡œ ì§€ì •<br />
bucketì€ ë‚˜ì˜ ë²„í‚·ì´ë¦„ì¸ indiego-fileuploadì— <br />
í´ë” ê²½ë¡œì¸ /profileimageë¥¼ ë¶™ì—¬ì£¼ì—ˆë‹¤.</p>

<p>ê·¸ë¦¬ê³  acees-key, secret-keyì— ëŒ€í•œ ì„¤ì •ì€ <br />
í™˜ê²½ë³€ìˆ˜ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆê³  ì§€ì •í•´ë‘ì—ˆë‹¤. ê°ì í™˜ê²½ì— ë§ê²Œ<br />
ê°’ì„ í™˜ê²½ë³€ìˆ˜ì— ë„£ê³  ì‚¬ìš©í•˜ê±°ë‚˜ í•˜ë“œì½”ë”©ìœ¼ë¡œ í•´ë‘ì–´ë„ëœë‹¤.(ê¹ƒì—ì˜¬ë¦¬ì§€ë§Œ ë§ê²ƒ..)</p>

<p><br /></p>

<p>ê·¸ë¦¬ê³  build.gradleì„ ì„¤ì •í•´ì£¼ì.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">dependencies</span> <span class="o">{</span>
        <span class="o">...</span>
	<span class="n">implementation</span> <span class="err">'</span><span class="n">org</span><span class="o">.</span><span class="na">springframework</span><span class="o">.</span><span class="na">cloud</span><span class="o">:</span><span class="n">spring</span><span class="o">-</span><span class="n">cloud</span><span class="o">-</span><span class="n">starter</span><span class="o">-</span><span class="nl">aws:</span><span class="mf">2.2</span><span class="o">.</span><span class="mi">6</span><span class="o">.</span><span class="na">RELEASE</span><span class="err">'</span>
        <span class="o">...</span>
<span class="o">}</span>
</code></pre></div></div>
<p>ê¸°ë³¸ì ì¸ Spring web, Lombok ê°™ì€ <br />
ì˜ì¡´ ë¼ì´ë¸ŒëŸ¬ë¦¬ë„ ì„¤ì •í•´ì£¼ì–´ì•¼í•œë‹¤.</p>

<p>ë‹¤ìŒìœ¼ë¡œëŠ”<br />
AmazonS3Config í´ë˜ìŠ¤ë¥¼ ì‘ì„±í•´ë³´ì.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Configuration</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">AmazonS3Config</span> <span class="o">{</span>
    
	<span class="nd">@Value</span><span class="o">(</span><span class="s">"${cloud.aws.credentials.access-key}"</span><span class="o">)</span>
	<span class="kd">private</span> <span class="nc">String</span> <span class="n">accessKey</span><span class="o">;</span>

	<span class="nd">@Value</span><span class="o">(</span><span class="s">"${cloud.aws.credentials.secret-key}"</span><span class="o">)</span>
	<span class="kd">private</span> <span class="nc">String</span> <span class="n">secretKey</span><span class="o">;</span>

	<span class="nd">@Value</span><span class="o">(</span><span class="s">"${cloud.aws.region.static}"</span><span class="o">)</span>
	<span class="kd">private</span> <span class="nc">String</span> <span class="n">region</span><span class="o">;</span>

	<span class="nd">@Bean</span>
	<span class="kd">public</span> <span class="nc">AmazonS3Client</span> <span class="nf">amazonS3Client</span><span class="o">()</span> <span class="o">{</span>
		<span class="nc">BasicAWSCredentials</span> <span class="n">awsCreds</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">BasicAWSCredentials</span><span class="o">(</span><span class="n">accessKey</span><span class="o">,</span> <span class="n">secretKey</span><span class="o">);</span>
		<span class="k">return</span> <span class="o">(</span><span class="nc">AmazonS3Client</span><span class="o">)</span> <span class="nc">AmazonS3ClientBuilder</span><span class="o">.</span><span class="na">standard</span><span class="o">()</span>
			<span class="o">.</span><span class="na">withRegion</span><span class="o">(</span><span class="n">region</span><span class="o">)</span>
			<span class="o">.</span><span class="na">withCredentials</span><span class="o">(</span><span class="k">new</span> <span class="nc">AWSStaticCredentialsProvider</span><span class="o">(</span><span class="n">awsCreds</span><span class="o">))</span>
			<span class="o">.</span><span class="na">build</span><span class="o">();</span>
	<span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">AmazonS3Client</code>íƒ€ì…ìœ¼ë¡œ ë¹ˆì„ ë§Œë“¤ì–´ ì£¼ì—ˆë‹¤. <br />
ì´ìš©ëœ ì •ë³´ëŠ” í™˜ê²½ë³€ìˆ˜ì— ì„¤ì •í–ˆë˜ ê°’ë“¤ì´ ì´ìš©ë˜ì—ˆë‹¤.<br />
ì´ë ‡ê²Œê¹Œì§€ë§Œ ì„¤ì •í•´ë†“ê³  ìŠ¤í”„ë§ ë¶€íŠ¸ê°€ ì˜ ì‹¤í–‰ë˜ëŠ”ì§€ í™•ì¸í•´ë³´ì</p>

<p><br /></p>

<h4 id="-ë¬¸ì œë°œìƒ-ì²˜ë¦¬">ğŸ ë¬¸ì œë°œìƒ ì²˜ë¦¬</h4>

<p>ì‹¤í–‰ì¤‘ ì—¬ëŸ¬ê°€ì§€ ì˜ˆì™¸ë“¤ì„ ë§Œë‚˜ê²Œ ë  ìˆ˜ ìˆë‹¤. <br />
ë‚´ê°€ ë§Œë“  ì˜ˆì™¸ë“¤ì˜ í•´ê²°ë°©ë²•ì„ ì ì–´ë³¸ë‹¤.</p>

<p><strong>1). AmazonClientException ë¬¸ì œ</strong></p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">com</span><span class="o">.</span><span class="na">amazonaws</span><span class="o">.</span><span class="na">AmazonClientException</span><span class="o">:</span> <span class="no">EC2</span> <span class="nc">Instance</span> <span class="nc">Metadata</span> <span class="nc">Service</span> <span class="n">is</span> <span class="n">disabled</span>
</code></pre></div></div>

<p>ìœ„ì™€ ê°™ì€ ì˜ˆì™¸ê°€ ì½˜ì†”ì— ì°í˜€ìˆì—ˆë‹¤.<br />
<a href="https://h-kkaemi.tistory.com/24">AmazonClientException ì°¸ê³  ë ˆí¼ëŸ°ìŠ¤</a>ë¥¼ ì°¸ê³ í•´ì„œ í•´ê²°í•´ë³´ì•˜ë‹¤.</p>

<p><img src="https://user-images.githubusercontent.com/95069395/212529483-83bdd3c5-1ec1-499e-a7b9-9e4d4143866b.png" alt="image" class="align-left" style="max-width: 100%" /></p>

<p>ì²«ë²ˆì§¸ë¡œ êµ¬ì„±í¸ì§‘ì—ì„œ  VM Optionì„ ì¶”ê°€í•´<br />
<code class="language-plaintext highlighter-rouge">-Dcom.amazonaws.sdk.disableEc2Metadata=true</code>ë¥¼ ì¶”ê°€í•´ì£¼ì—ˆë‹¤.</p>

<p>ê·¸ë¦¬ê³  yml íŒŒì¼ ë¡œê¹… ì„¤ì •ì„</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">logging</span><span class="pi">:</span>
  <span class="na">level</span><span class="pi">:</span>
    <span class="na">com</span><span class="pi">:</span>
      <span class="na">amazonaws</span><span class="pi">:</span>
        <span class="na">util</span><span class="pi">:</span>
          <span class="na">EC2MetadataUtils</span><span class="pi">:</span> <span class="s">error</span>
</code></pre></div></div>

<p>ìœ„ì™€ ê°™ì´ ì„¤ì •í•´ì¤€ë‹¤ë©´, ë”ì´ìƒ ì˜¤ë¥˜ ë©”ì„¸ì§€ëŠ” ë³´ì´ì§€ ì•Šì„ ê²ƒì´ë‹¤.</p>

<p><br /></p>

<p><strong>2). AmazonS3Exception ë¬¸ì œ</strong></p>

<p>ì´ë²ˆì— ë°œìƒí•œ ë¬¸ì œëŠ” ë²„í‚·ì—ì„œ ACLsë¥¼ í—ˆìš©í•˜ì§€<br />
ì•Šì•˜ë‹¤ëŠ” ë¬¸êµ¬ê°€ ì¶œë ¥ì™¸ì—ˆë‹¤.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>com.amazonaws.services.s3.model.AmazonS3Exception: The bucket does not allow ACLs
</code></pre></div></div>

<p>í•´ë‹¹ ë¬¸ì œë„ AWS S3 ë²„í‚·ì˜</p>

<p><img src="https://user-images.githubusercontent.com/95069395/212529451-bd253a0e-7033-44a9-9749-8704c9223db3.png" alt="image" class="align-left" style="max-width: 100%" /></p>

<p>ACLì„ í™œì„±í™”ì‹œì¼œë‘ì—ˆë”ë‹ˆ í•´ê²°ë˜ì—ˆë‹¤.</p>

<p><br /></p>

<h4 id="-ì½”ë“œ-ì‘ì„±-1">ğŸ›  ì½”ë“œ ì‘ì„±</h4>

<p>ì²«ë²ˆì§¸ë¡œ Controllerë¥¼ ì‘ì„±í•´ë³´ì</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">package</span> <span class="nn">com.image.fileupload.controller</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">com.image.fileupload.service.AwsS3Service</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.image.fileupload.service.ImageUploadService</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">lombok.RequiredArgsConstructor</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">lombok.extern.slf4j.Slf4j</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.http.ResponseEntity</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.multipart.MultipartFile</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">javax.servlet.http.HttpServletRequest</span><span class="o">;</span>

<span class="nd">@Slf4j</span>
<span class="nd">@RestController</span>
<span class="nd">@RequestMapping</span><span class="o">(</span><span class="s">"/upload"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">UploadController</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="nc">ImageUploadService</span> <span class="n">awsS3Service</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">UploadController</span><span class="o">(</span><span class="nc">AwsS3Service</span> <span class="n">awsS3Service</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">awsS3Service</span> <span class="o">=</span> <span class="n">awsS3Service</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@PostMapping</span>
    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">saveImage</span><span class="o">(</span><span class="nd">@RequestParam</span> <span class="nc">MultipartFile</span> <span class="n">file</span><span class="o">){</span>

        <span class="n">log</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">"multipartFile = {}"</span><span class="o">,</span> <span class="n">file</span><span class="o">);</span>
        <span class="nc">String</span> <span class="n">url</span> <span class="o">=</span> <span class="n">awsS3Service</span><span class="o">.</span><span class="na">StoreImage</span><span class="o">(</span><span class="n">file</span><span class="o">);</span>
        <span class="n">log</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">"url = {}"</span><span class="o">,</span><span class="n">url</span><span class="o">);</span>
        <span class="k">return</span> <span class="n">url</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>
<p>ì‚¬ì´ì‚¬ì´ì— ë¡œê·¸ë¡œ ê°’ì„ í™•ì¸í•  ìˆ˜ ìˆë„ë¡ ì°ì–´ë‘ì—ˆë‹¤. <br />
key = file / value = ì´ë¯¸ì§€ ë¡œ ë°›ì•„ì˜¤ëŠ” ë°©ë²•ì´ë‹¤.<br />
Springì—ì„œëŠ” MultipartFile í˜•ì‹ìœ¼ë¡œ ë°›ì•„ì˜¬ ìˆ˜ ìˆë‹¤. <br />
ë¬¼ë¡  HttpServletReqeustì—ì„œë„ êº¼ë‚´ì˜¬ ìˆ˜ ìˆë‹¤.</p>

<p>ì—¬ê¸°ì„œ MutipartFile íƒ€ì…ìœ¼ë¡œ ë°›ì•„ì˜¨ file ê°ì²´ë¥¼ ë¡œê·¸ë¡œ ì°ì–´ë³´ë©´<br />
<code class="language-plaintext highlighter-rouge">StandardMultipartFile@57413913</code>ì™€ ê°™ì€ í˜•íƒœë¡œ ì˜¤ëŠ”ê²Œ í™•ì¸ì´ ê°€ëŠ¥í•˜ë‹¤.</p>

<p><br /></p>

<p>ì´ì œ ì„œë¹„ìŠ¤ ë¡œì§ì„ ì‘ì„±í•´ë³´ì <br />
AWS S3 ì™¸ì— ë‹¤ë¥¸ ì €ì¥ì†Œë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆê²Œì— <br />
ì¸í„°í˜ì´ìŠ¤ë¥¼ í•˜ë‚˜ ë§Œë“¤ì—ˆë‹¤.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">ImageUploadService</span> <span class="o">{</span>
	<span class="nc">String</span> <span class="nf">StoreImage</span><span class="o">(</span><span class="nc">MultipartFile</span> <span class="n">img</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div></div>

<p>í•´ë‹¹ ì¸í„°í˜ì´ìŠ¤ë¥¼ êµ¬í˜„ì²´ë¡œ <br />
AwsS3Service í´ë˜ìŠ¤ë¥¼ ë§Œë“¤ì—ˆë‹¤.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Slf4j</span>
<span class="nd">@RequiredArgsConstructor</span>
<span class="nd">@Service</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">AwsS3Service</span> <span class="kd">implements</span> <span class="nc">ImageUploadService</span> <span class="o">{</span>

	<span class="kd">private</span> <span class="kd">final</span> <span class="nc">AmazonS3</span> <span class="n">amazonS3</span><span class="o">;</span>

	<span class="nd">@Value</span><span class="o">(</span><span class="s">"${cloud.aws.s3.bucket}"</span><span class="o">)</span>
	<span class="kd">private</span> <span class="nc">String</span> <span class="n">bucketName</span><span class="o">;</span>

	<span class="kd">public</span> <span class="nc">String</span> <span class="nf">StoreImage</span><span class="o">(</span><span class="nc">MultipartFile</span> <span class="n">file</span><span class="o">)</span> <span class="o">{</span>
		<span class="n">validateFileExists</span><span class="o">(</span><span class="n">file</span><span class="o">);</span>
		<span class="nc">String</span> <span class="n">originalFilename</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="na">getOriginalFilename</span><span class="o">();</span>
		<span class="nc">String</span> <span class="n">storeFileName</span> <span class="o">=</span> <span class="n">createStoreFileName</span><span class="o">(</span><span class="n">originalFilename</span><span class="o">);</span>

		<span class="k">try</span> <span class="o">(</span><span class="nc">InputStream</span> <span class="n">inputStream</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="na">getInputStream</span><span class="o">())</span> <span class="o">{</span>
			<span class="n">amazonS3</span><span class="o">.</span><span class="na">putObject</span><span class="o">(</span><span class="k">new</span> <span class="nc">PutObjectRequest</span><span class="o">(</span><span class="n">bucketName</span><span class="o">,</span> <span class="n">storeFileName</span><span class="o">,</span> <span class="n">inputStream</span><span class="o">,</span> <span class="kc">null</span><span class="o">)</span>
				<span class="o">.</span><span class="na">withCannedAcl</span><span class="o">(</span><span class="nc">CannedAccessControlList</span><span class="o">.</span><span class="na">PublicRead</span><span class="o">));</span>
		<span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">IOException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
			<span class="k">throw</span> <span class="k">new</span> <span class="nf">RuntimeException</span><span class="o">();</span>
		<span class="o">}</span>

		<span class="k">return</span> <span class="n">amazonS3</span><span class="o">.</span><span class="na">getUrl</span><span class="o">(</span><span class="n">bucketName</span><span class="o">,</span> <span class="n">storeFileName</span><span class="o">).</span><span class="na">toString</span><span class="o">();</span>
	<span class="o">}</span>

	<span class="kd">private</span> <span class="kt">void</span> <span class="nf">validateFileExists</span><span class="o">(</span><span class="nc">MultipartFile</span> <span class="n">multipartFile</span><span class="o">)</span> <span class="o">{</span>
		<span class="k">if</span> <span class="o">(</span><span class="n">multipartFile</span><span class="o">.</span><span class="na">isEmpty</span><span class="o">())</span> <span class="o">{</span>
			<span class="k">throw</span> <span class="k">new</span> <span class="nf">RuntimeException</span><span class="o">();</span>
		<span class="o">}</span>
	<span class="o">}</span>

	<span class="kd">private</span> <span class="kd">static</span> <span class="nc">String</span> <span class="nf">createStoreFileName</span><span class="o">(</span><span class="nc">String</span> <span class="n">originalFilename</span><span class="o">)</span> <span class="o">{</span>
		<span class="nc">String</span> <span class="n">ext</span> <span class="o">=</span> <span class="n">extractExt</span><span class="o">(</span><span class="n">originalFilename</span><span class="o">);</span>
		<span class="nc">String</span> <span class="n">uuid</span> <span class="o">=</span> <span class="no">UUID</span><span class="o">.</span><span class="na">randomUUID</span><span class="o">().</span><span class="na">toString</span><span class="o">();</span>
		<span class="k">return</span> <span class="n">uuid</span> <span class="o">+</span> <span class="s">"."</span> <span class="o">+</span> <span class="n">ext</span><span class="o">;</span>
	<span class="o">}</span>

	<span class="kd">private</span> <span class="kd">static</span> <span class="nc">String</span> <span class="nf">extractExt</span><span class="o">(</span><span class="nc">String</span> <span class="n">originalFilename</span><span class="o">)</span> <span class="o">{</span>
		<span class="kt">int</span> <span class="n">pos</span> <span class="o">=</span> <span class="n">originalFilename</span><span class="o">.</span><span class="na">lastIndexOf</span><span class="o">(</span><span class="s">"."</span><span class="o">);</span>
		<span class="k">return</span> <span class="n">originalFilename</span><span class="o">.</span><span class="na">substring</span><span class="o">(</span><span class="n">pos</span> <span class="o">+</span> <span class="mi">1</span><span class="o">);</span>
	<span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>ì—¬ê¸°ì„œ AmazonS3 ë¥¼ DI ë°›ì•„ <code class="language-plaintext highlighter-rouge">.putObject();</code> ë©”ì„œë“œë¥¼ ì´ìš©í•´ <br />
AWS S3 ì €ì¥ì†Œì— ì €ì¥ì„í•  ìˆ˜ ìˆê²Œë˜ì–´ì§„ë‹¤.</p>

<p><code class="language-plaintext highlighter-rouge">.putObject();</code>ì˜ ë§¤ê°œë³€ìˆ˜ë“¤ë¡œëŠ”<br />
(ë²„í‚· ì´ë¦„ê³¼, íŒŒì¼ì´ë¦„, MultipartFile inputsStream ê°ì²´, ObjectMetaData ê°ì²´)<br />
ë¥¼ ë„£ì–´ ì£¼ë©´ ì •ìƒì ìœ¼ë¡œ íŒŒì¼ì´ ì—…ë¡œë“œê°€ ë˜ì–´ì§ˆ ê²ƒì´ë‹¤.</p>

<p>ê·¸ë¦¬ê³  ì™¸ë¶€ì— ê³µê°œí•  ì´ë¯¸ì§€ì´ê¸° ë•Œë¬¸ì—<br />
<code class="language-plaintext highlighter-rouge">.withCannedAcl(CannedAccessControlList.PublicRead)</code>ë¥¼ ê±¸ì–´ì£¼ì—ˆë‹¤.</p>

<p>ë‚˜ì™€ ê°™ì€ ê²½ìš°ì— íŒŒì¼ì´ë¦„ê°™ì€ ê²½ìš°ëŠ” <br />
ê¸°ì¡´ì— ë°›ì€ originalFilenameì„ UUIDë¥¼ ì´ìš©í•´ <br />
ì¢…ë³µë  í™•ë¥ ì´ ë§¤ìš° ë‚®ê²Œ íŒŒì¼ì´ë¦„ì„ ë³€ê²½í•´ì£¼ê³  ë§ˆì§€ë§‰ì—ëŠ”<br />
í™•ì¥ì ë°ì´í„°ë¥¼ ë½‘ì•„ ë¶™ì—¬ì£¼ê²Œ ë˜ì–´ íŒŒì¼ì´ë¦„ì„ ì™„ì„±ì‹œì¼œì£¼ì—ˆë‹¤.</p>

<p>ì˜ˆë¥¼ë“¤ìë©´ <code class="language-plaintext highlighter-rouge">e491b9f6-c528-4a47-bd5c-0381aad21ed5.png</code>ì™€ ê°™ì´ <br />
íŒŒì¼ì´ë¦„ì´ ë§Œë“¤ì–´ì§€ê²Œ ë˜ëŠ” ëª¨ìŠµì„ ë³¼ ìˆ˜ ìˆë‹¤.</p>

<p><br /></p>

<p>ì—¬ê¸°ê¹Œì§€ ì‘ì„±ì„ í—€ë‹¤ë©´ ì´ì œ í´ë¼ì´ì–¸íŠ¸ ìª½ì—ì„œ <br />
ì´ë¯¸ì§€ë¥¼ ë³´ë‚´ AWS S3ì— ì €ì¥ë˜ëŠ” ëª¨ìŠµì„ í™•ì¸í•´ë³¼ ìˆ˜ ìˆë‹¤.</p>

<p>í´ë¼ì´ì–¸íŠ¸ì„ SSR ë°©ì‹ìœ¼ë¡œ<br />
thymeleafë¥¼ ì´ìš©í•´ ë§Œë“¤ì–´ì¤„ ìˆ˜ë„ ìˆì§€ë§Œ</p>

<p><img src="https://user-images.githubusercontent.com/95069395/212540211-2ec688c8-b5c4-4630-8b45-56f08ae246f9.png" alt="image" class="align-left" style="max-width: 100%" /></p>

<p>í¬ìŠ¤íŠ¸ë§¨ì„ í†µí•´ì„œë„ ì „ì†¡ì´ ê°€ëŠ¥í•˜ë‹¤. <br />
multipart/form-data í˜•ì‹ìœ¼ë¡œ ì„¤ì •í•´ì¤€ë‹¤ìŒ. <br />
Bodyì— Key,Valueë¥¼ ì„¤ì •í•´ì£¼ë©´ëœë‹¤.</p>

<p>Keyê°’ ì„¤ì •ì‹œì—ëŠ” ì˜¤ë¥¸ìª½ì— Textê°€ì•„ë‹Œ Fileë¡œ ë³€ê²½í•´ì£¼ì–´ì•¼í•œë‹¤.<br />
ê·¸ëŸ¬ë©´ Valueì— ì´ë¯¸ì§€ë¥¼ ì„ íƒí•  ìˆ˜ ìˆëŠ” ì°½ì´ë‚˜ì˜¨ë‹¤. <br />
ì°½ì„ ëˆŒëŸ¬ í˜„ì¬ ë°ìŠ¤í¬íƒ‘ì—ì„œ ì˜¬ë¦´ ì´ë¯¸ì§€ë¥¼ ì„ íƒí•´ì¤€ë‹¤.</p>

<p>ê·¸ë¦¬ê³  APIë¥¼ ìš”ì²­ë³´ë‚´ê²Œ ëœë‹¤ë©´</p>

<p><img src="https://user-images.githubusercontent.com/95069395/212540224-4a1655bc-b22f-4694-a948-dcb7d368e697.png" alt="image" class="align-left" style="max-width: 100%" /></p>

<p>ë‚´ê°€ ì§€ì •í–ˆë˜ indiego-fileupload ë²„í‚·ì—<br />
profileimageë¼ëŠ” í´ë”ì— ë‚´ê°€ ì§€ì •í•œ í˜•ì‹ì˜ í´ë”ì´ë¦„ê³¼ í™•ì¥ìë¡œ <br />
ê°ì²´ê°€ ì˜¬ë¼ê°€ìˆëŠ” ëª¨ìŠµì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.</p>

<p><img src="https://user-images.githubusercontent.com/95069395/212540227-70c09e05-f781-4a21-9236-8f60b8872d04.png" alt="image" class="align-left" style="max-width: 100%" /></p>

<p>ê°ì²´ë¥¼ ëˆŒëŸ¬ ë“¤ì–´ê°€ë©´ ê°ì²´ URLì´ ë‚˜ì˜¤ê²Œë˜ëŠ”ë°<br />
í•´ë‹¹ URLì„ êº¼ë‚´ì„œ í´ë¼ì´ì–¸íŠ¸ ì¸¡ì— ì „ë‹¬í•˜ê³  ìš°ë¦¬ DBì— ì €ì¥í•˜ë©´ëœë‹¤.</p>

<p>êº¼ë‚´ëŠ” ì½”ë“œëŠ” ì´ë¯¸ ìœ„ì— ì‘ì„±ë˜ì–´ìˆë‹¤.<br />
<code class="language-plaintext highlighter-rouge">amazonS3.getUrl(bucketName, storeFileName).toString();</code> ì½”ë“œë¡œ <br />
<code class="language-plaintext highlighter-rouge">getUrl();</code> ë©”ì„œë“œë¥¼ ì´ìš©í•´ êº¼ë‚´ì˜¬ ìˆ˜ ìˆë‹¤. í•´ë‹¹ ê°’ì„ Stringìœ¼ë¡œ <br />
ë°˜í™˜í•´ì£¼ê³  í•´ë‹¹ê°’ì„ ì´ì œ ìš°ë¦¬ê°€ ì›í•˜ëŠ” ëª©ì ì— ë§ê²Œ ì‚¬ìš©í•˜ë©´ëœë‹¤.</p>

<p>ë‚˜ì™€ ê°™ì€ ê²½ìš°ì—ëŠ” ë°˜í™˜í•œ URLì„ text/plainìœ¼ë¡œ ë°˜í™˜í•´ì£¼ì—ˆê³ <br />
ìœ„ì— Postmanìœ¼ë¡œ ë³´ë©´ ì˜ ë°˜í™˜ëœ ê²ƒì„ í™•ì¸í•  ìˆ˜ê°€ìˆë‹¤.</p>

<p><br /></p>

<h3 id="-íŒŒì¼-ì‚¬ì´ì¦ˆ-ì˜ˆì™¸ì²˜ë¦¬">ğŸ“Œ íŒŒì¼ ì‚¬ì´ì¦ˆ ì˜ˆì™¸ì²˜ë¦¬</h3>

<p>ì²˜ìŒì— ì„¤ì •í–ˆë˜ yml íŒŒì¼ì— 10MBë¡œ<br />
ìš©ëŸ‰ì„ ì œí•œí•´ë‘ì—ˆì—ˆë‹¤.</p>

<p>ë§Œì•½ ì •ë§ë¡œ ì‚¬ì´ì¦ˆê°€ ë„˜ê²Œ ëœë‹¤ë©´</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>org.springframework.web.multipart.MaxUploadSizeExceededException: Maximum upload size exceeded<span class="p">;</span> nested exception is java.lang.IllegalStateException:
</code></pre></div></div>

<p>ì™€ ê°™ì€ ì˜ˆì™¸ê°€ ë°œìƒí•˜ê²Œ ë  ê²ƒì´ê³  <br />
í•´ë‹¹ ì˜ˆì™¸ë¥¼ ì²˜ë¦¬í•˜ê¸°ìœ„í•´ì„œ ê°„ë‹¨í•œ ì˜ˆì™¸ì²˜ë¦¬ ë¡œì§ì„ êµ¬í˜„í•´ë³´ì•˜ë‹¤.</p>

<p>@ControllerAdviceë¥¼ ì´ìš©í•´ì„œ<br />
<code class="language-plaintext highlighter-rouge">MaxUploadSizeExceededException</code>ì˜ˆì™¸ë¥¼ ì¡ì„ ìˆ˜ ìˆë‹¤.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@ControllerAdvice</span>
<span class="nd">@Slf4j</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">GlobalExceptionHandler</span> <span class="o">{</span>

    <span class="nd">@ExceptionHandler</span><span class="o">(</span><span class="nc">Exception</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
    <span class="kd">protected</span> <span class="nc">ResponseEntity</span><span class="o">&lt;</span><span class="nc">ErrorResponse</span><span class="o">&gt;</span> <span class="nf">handleException</span><span class="o">(</span><span class="nc">MaxUploadSizeExceededException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">log</span><span class="o">.</span><span class="na">error</span><span class="o">(</span><span class="s">"MaxUploadSizeExceededException"</span><span class="o">,</span> <span class="n">e</span><span class="o">);</span>

        <span class="n">log</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">"# ì˜ˆì™¸ì²˜ë¦¬ ì¡ìŒ"</span><span class="o">);</span>
        <span class="kd">final</span> <span class="nc">ErrorResponse</span> <span class="n">response</span> <span class="o">=</span> <span class="nc">ErrorResponse</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="n">e</span><span class="o">);</span>
        <span class="k">return</span> <span class="nc">ResponseEntity</span><span class="o">.</span><span class="na">internalServerError</span><span class="o">().</span><span class="na">body</span><span class="o">(</span><span class="n">response</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Getter</span>
<span class="nd">@NoArgsConstructor</span>
<span class="nd">@JsonInclude</span><span class="o">(</span><span class="nc">JsonInclude</span><span class="o">.</span><span class="na">Include</span><span class="o">.</span><span class="na">NON_NULL</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">ErrorResponse</span> <span class="o">{</span>

	<span class="kd">private</span> <span class="kt">int</span> <span class="n">status</span><span class="o">;</span>
	<span class="kd">private</span> <span class="nc">String</span> <span class="n">message</span><span class="o">;</span>

	<span class="kd">private</span> <span class="nf">ErrorResponse</span><span class="o">(</span><span class="nc">String</span> <span class="n">message</span><span class="o">,</span> <span class="kt">int</span> <span class="n">status</span><span class="o">)</span> <span class="o">{</span>
		<span class="k">this</span><span class="o">.</span><span class="na">message</span> <span class="o">=</span> <span class="n">message</span><span class="o">;</span>
		<span class="k">this</span><span class="o">.</span><span class="na">status</span> <span class="o">=</span> <span class="n">status</span><span class="o">;</span>
	<span class="o">}</span>

	<span class="kd">public</span> <span class="kd">static</span> <span class="nc">ErrorResponse</span> <span class="nf">of</span><span class="o">(</span><span class="nc">MaxUploadSizeExceededException</span> <span class="n">maxUploadSizeExceededException</span><span class="o">)</span> <span class="o">{</span>
		<span class="k">return</span> <span class="k">new</span> <span class="nf">ErrorResponse</span><span class="o">(</span><span class="n">maxUploadSizeExceededException</span><span class="o">.</span><span class="na">getMessage</span><span class="o">(),</span><span class="mi">500</span><span class="o">);</span>
	<span class="o">}</span>

<span class="o">}</span>
</code></pre></div></div>

<p>ErrorResponseì— ëŒ€í•œ ë‚´ìš©ì€ ìš°ì„  ëŒ€ê°• ì •ì˜í•´ë³´ì•˜ë‹¤. <br />
ì–´ë–»ê²Œ ë°˜í™˜í• ì§€ì—ëŒ€í•´ì„œëŠ” ì»¤ìŠ¤í„°ë§ˆì´ì§•ì„ í†µí•´ì„œ <br />
ì…ë§›ì— ë§ê²Œ ë³€ê²½í•´ë³´ë©´ ì¢‹ì„ ê²ƒ ê°™ë‹¤.</p>

<p><br />
<br /></p>

<p>âœ¨ ì°¸ê³  ë¸”ë¡œê·¸ <br />
<a href="https://antdev.tistory.com/93#recentEntries">AWS S3, FileUpload ì°¸ê³  ë ˆí¼ëŸ°ìŠ¤</a>, <a href="https://victorydntmd.tistory.com/334">FileUpload ê´€ë ¨ ì°¸ê³  ë¸”ë¡œê·¸ ë ˆí¼ëŸ°ìŠ¤</a></p>]]></content><author><name>LEE JAEHYEOK</name></author><category term="Spring" /><category term="Spring" /><category term="S3" /><summary type="html"><![CDATA[ì˜¤ëŠ˜ì€ AWS S3ì— íŒŒì¼ ì—…ë¡œë“œë¥¼ í•˜ëŠ” ì˜ˆì œë¥¼ ë‹¤ë¤„ë³´ë ¤í•œë‹¤.]]></summary></entry><entry><title type="html">Redis JWT Refresh Token ê´€ë¦¬ ë° ì¬ë°œí–‰</title><link href="http://localhost:4000/db/2023/01/14/db-redis.html" rel="alternate" type="text/html" title="Redis JWT Refresh Token ê´€ë¦¬ ë° ì¬ë°œí–‰" /><published>2023-01-14T00:00:00+09:00</published><updated>2023-01-14T00:00:00+09:00</updated><id>http://localhost:4000/db/2023/01/14/db-redis</id><content type="html" xml:base="http://localhost:4000/db/2023/01/14/db-redis.html"><![CDATA[<p>Redisì— ëŒ€í•œ ê°„ë‹¨í•œ CSì§€ì‹ê³¼ <br />
<a href="https://mycatlikeschuru.github.io/db/2023/01/08/db-redissetting.html">Redis ì„¤ì¹˜ ë° CLI ì‚¬ìš©ë²•</a>ì„ ì•Œì•„ë³´ì•˜ì—ˆë‹¤.</p>

<p>ì˜¤ëŠ˜ì€ ì´ì œ ë‚˜ì˜ ì‚¬ìš© ëª©ì ì¸ í”„ë¡œì íŠ¸ì— ë„ì…ì„ í•´ë³´ë ¤í•œë‹¤. <br />
JWT Refresh Tokenê´€ë¦¬ì™€ ì¢‹ì•„ìš”,ì¡°íšŒìˆ˜ ë“± <br />
ë¹ˆë²ˆíˆ updateê°€ ì¼ì–´ë‚˜ëŠ” í•­ëª©ì— ëŒ€í•´ì„œ ê´€ë¦¬í•˜ëŠ” ì°¨ì›ì—ì„œ <br />
ìºì‹œì„œë²„ì¸ Redisë¥¼ ì‚¬ìš©í•´ë³´ë ¤í•œë‹¤.</p>

<p>ê·¸ ì¤‘ì—ì„œë„ Redis ì‚¬ìš©ì— ëŒ€í•œ ì½”ë“œì™€<br />
JWT í† í°ì„ Redisì— ì–´ë–»ê²Œ ê´€ë¦¬í•˜ê³  ì¬ë°œê¸‰ë°›ëŠ”ì§€ì— ëŒ€í•´<br />
ì´ˆì ì„ ë‘ê³  ì‘ì„±í–ˆê¸°ì— ë§ì€ ì½”ë“œë“¤ì´ ìƒëµë˜ì–´ ìˆë‹¤ëŠ”ì  ì°¸ê³  ë¶€íƒë“œë¦°ë‹¤.</p>

<h3 id="-ì‘ì—…í™˜ê²½">âœ… ì‘ì—…í™˜ê²½</h3>

<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Spring Boot 2.7.7
java 11 
macOS Ventura 13.1
ë¡œì»¬ í™˜ê²½ì—ì„œ í…ŒìŠ¤íŠ¸ ì§„í–‰
</code></pre></div></div>

<p><br /></p>

<h3 id="-redis-í”„ë¡œê·¸ë¨-ì‘ì„±">ğŸ“Œ Redis í”„ë¡œê·¸ë¨ ì‘ì„±</h3>

<p>Spring Bootì—ì„œëŠ” <code class="language-plaintext highlighter-rouge">Spring Data Redis</code>ë¥¼ ì´ìš©í•´<br />
Lettuce, Jedisë¼ëŠ” ë‘ê°€ì§€ ì˜¤í”ˆì†ŒìŠ¤ Java ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤ê³  í•œë‹¤.<br />
LettuceëŠ” ë³„ë„ì˜ ì„¤ì •ì´ í•„ìš”ì—†ê³ , JedisëŠ” ì˜ì¡´ì„±ì„ ì¶”ê°€í•´ì¤˜ì•¼í•œë‹¤.</p>

<p>Gradle ì˜ì¡´ì„±</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">implementation</span> <span class="err">'</span><span class="n">org</span><span class="o">.</span><span class="na">springframework</span><span class="o">.</span><span class="na">boot</span><span class="o">:</span><span class="n">spring</span><span class="o">-</span><span class="n">boot</span><span class="o">-</span><span class="n">starter</span><span class="o">-</span><span class="n">data</span><span class="o">-</span><span class="n">redis</span><span class="err">'</span>
</code></pre></div></div>

<p>Spring data RedisëŠ” ë‘ê°€ì§€ ì ‘ê·¼ ë°©ì‹ì„ ì œê³µí•˜ëŠ”ë°<br />
í•˜ë‚˜ëŠ” Redis Template, í•˜ë‚˜ëŠ” RedisRepositoryë¥¼ ì´ìš©í•œ ë°©ì‹ì´ë‹¤.   <br />
ì´ë²ˆì— ì‚¬ìš©í•´ë³¸ ë°©ë²•ì€ Redis Template ë°©ì‹ì´ê³ </p>

<p><code class="language-plaintext highlighter-rouge">RedisConnectionFactory</code> ì¸í„°í˜ì´ìŠ¤ë¥¼ í†µí•´<br />
<code class="language-plaintext highlighter-rouge">LettuceConnectionFactory</code> ìƒì„±í•˜ì—¬ ë°˜í™˜í•˜ëŠ” Beanì„ ë“±ë¡í•´ì•¼í•œë‹¤.</p>

<p><strong>1). RedisConfig í´ë˜ìŠ¤</strong></p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Configuration</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">RedisConfig</span> <span class="o">{</span>

	<span class="nd">@Value</span><span class="o">(</span><span class="s">"${spring.redis.host}"</span><span class="o">)</span>
	<span class="kd">private</span> <span class="nc">String</span> <span class="n">host</span><span class="o">;</span>

	<span class="nd">@Value</span><span class="o">(</span><span class="s">"${spring.redis.port}"</span><span class="o">)</span>
	<span class="kd">private</span> <span class="kt">int</span> <span class="n">port</span><span class="o">;</span>

	<span class="nd">@Bean</span>
	<span class="kd">public</span> <span class="nc">RedisConnectionFactory</span> <span class="nf">redisConnectionFactory</span><span class="o">()</span> <span class="o">{</span>
		<span class="k">return</span> <span class="k">new</span> <span class="nf">LettuceConnectionFactory</span><span class="o">(</span><span class="n">host</span><span class="o">,</span> <span class="n">port</span><span class="o">);</span>
	<span class="o">}</span>

	<span class="nd">@Bean</span>
	<span class="kd">public</span> <span class="nc">RedisTemplate</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">Object</span><span class="o">&gt;</span> <span class="nf">redisTemplate</span><span class="o">()</span> <span class="o">{</span>
		<span class="nc">RedisTemplate</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">Object</span><span class="o">&gt;</span> <span class="n">redisTemplate</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">RedisTemplate</span><span class="o">&lt;&gt;();</span>
		<span class="n">redisTemplate</span><span class="o">.</span><span class="na">setKeySerializer</span><span class="o">(</span><span class="k">new</span> <span class="nc">StringRedisSerializer</span><span class="o">());</span>
		<span class="n">redisTemplate</span><span class="o">.</span><span class="na">setValueSerializer</span><span class="o">(</span><span class="k">new</span> <span class="nc">StringRedisSerializer</span><span class="o">());</span>
		<span class="n">redisTemplate</span><span class="o">.</span><span class="na">setConnectionFactory</span><span class="o">(</span><span class="n">redisConnectionFactory</span><span class="o">());</span>
		<span class="k">return</span> <span class="n">redisTemplate</span><span class="o">;</span>
	<span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>
<p><code class="language-plaintext highlighter-rouge">LettuceConnectionFactory</code>ë¥¼ ìƒì„±ìë¥¼ ë§Œë“¤ì–´ ë°˜í™˜í• ë•Œ<br />
host, port ì •ë³´ê°€ í•„ìš”í•˜ë‹¤.</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">spring</span><span class="pi">:</span>
  <span class="na">cache</span><span class="pi">:</span>
    <span class="na">type</span><span class="pi">:</span> <span class="s">redis</span>
  <span class="na">redis</span><span class="pi">:</span>
    <span class="na">host</span><span class="pi">:</span> <span class="s">localhost</span>
    <span class="na">port</span><span class="pi">:</span> <span class="m">6379</span>
</code></pre></div></div>

<p>ë¡œì»¬í™˜ê²½ì—ì„œ í…ŒìŠ¤íŠ¸ë¥¼ í•  ê²ƒì´ê¸° ë•Œë¬¸ì—<br />
ymlíŒŒì¼ì— ì„¤ì •í•´ì£¼ê³  @Value ì–´ë…¸í…Œì´ì…˜ìœ¼ë¡œ íŒŒì‹±í•˜ë„ë¡ í–ˆë‹¤.</p>

<p>ê·¸ë¦¬ê³  <code class="language-plaintext highlighter-rouge">setKeySerializer</code>,<code class="language-plaintext highlighter-rouge">setValueSerializer</code>ì™€ ê°™ì€<br />
<code class="language-plaintext highlighter-rouge">RedisTemplete</code>ê°ì²´ì— ì„¤ì •ì„ í•´ì£¼ëŠ” ì´ìœ ëŠ”</p>

<p>RedisTemplateë¥¼ ì‚¬ìš©í•  ë•Œ Spring - Redis ê°„ ë°ì´í„°<br />
ì§ë ¬í™”,ì—­ì§ë ¬í™” ì‹œ ì‚¬ìš©í•˜ëŠ” ë°©ì‹ì´ JDK ì§ë ¬í™” ë°©ì‹ì´ê¸° ë•Œë¬¸ì— <br />
ë¬¸ì œëŠ” ì—†ì§€ë§Œ redis-clië¥¼ í†µí•´ ì ‘ê·¼í• ë•Œ ì•Œì•„ë³¼ ìˆ˜ ì—†ëŠ” í˜•íƒœë¡œ ì¶œë ¥ë˜ê¸° ë•Œë¬¸ì— <br />
ì„¤ì •ì„ ì§„í–‰ í•´ì¤€ ê²ƒì´ë‹¤!</p>

<p><br /></p>

<p><strong>2). RedisDao í´ë˜ìŠ¤</strong></p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Component</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">RedisDao</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="kd">final</span> <span class="nc">RedisTemplate</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">Object</span><span class="o">&gt;</span> <span class="n">redisTemplate</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">RedisDao</span><span class="o">(</span><span class="nc">RedisTemplate</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">Object</span><span class="o">&gt;</span> <span class="n">redisTemplate</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">redisTemplate</span> <span class="o">=</span> <span class="n">redisTemplate</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setValues</span><span class="o">(</span><span class="nc">String</span> <span class="n">key</span><span class="o">,</span> <span class="nc">String</span> <span class="n">data</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">ValueOperations</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">Object</span><span class="o">&gt;</span> <span class="n">values</span> <span class="o">=</span> <span class="n">redisTemplate</span><span class="o">.</span><span class="na">opsForValue</span><span class="o">();</span>
        <span class="n">values</span><span class="o">.</span><span class="na">set</span><span class="o">(</span><span class="n">key</span><span class="o">,</span> <span class="n">data</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setValues</span><span class="o">(</span><span class="nc">String</span> <span class="n">key</span><span class="o">,</span> <span class="nc">String</span> <span class="n">data</span><span class="o">,</span> <span class="nc">Duration</span> <span class="n">duration</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">ValueOperations</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">Object</span><span class="o">&gt;</span> <span class="n">values</span> <span class="o">=</span> <span class="n">redisTemplate</span><span class="o">.</span><span class="na">opsForValue</span><span class="o">();</span>
        <span class="n">values</span><span class="o">.</span><span class="na">set</span><span class="o">(</span><span class="n">key</span><span class="o">,</span> <span class="n">data</span><span class="o">,</span> <span class="n">duration</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">getValues</span><span class="o">(</span><span class="nc">String</span> <span class="n">key</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">ValueOperations</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">Object</span><span class="o">&gt;</span> <span class="n">values</span> <span class="o">=</span> <span class="n">redisTemplate</span><span class="o">.</span><span class="na">opsForValue</span><span class="o">();</span>
        <span class="k">return</span> <span class="o">(</span><span class="nc">String</span><span class="o">)</span> <span class="n">values</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">key</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">deleteValues</span><span class="o">(</span><span class="nc">String</span> <span class="n">key</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">redisTemplate</span><span class="o">.</span><span class="na">delete</span><span class="o">(</span><span class="n">key</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">expireValues</span><span class="o">(</span><span class="nc">String</span> <span class="n">key</span><span class="o">,</span> <span class="kt">int</span> <span class="n">timeout</span><span class="o">){</span>
        <span class="n">redisTemplate</span><span class="o">.</span><span class="na">expire</span><span class="o">(</span><span class="n">key</span><span class="o">,</span> <span class="n">timeout</span> <span class="o">,</span> <span class="nc">TimeUnit</span><span class="o">.</span><span class="na">MILLISECONDS</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setHashOps</span><span class="o">(</span><span class="nc">String</span> <span class="n">key</span><span class="o">,</span> <span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">data</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">HashOperations</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">Object</span><span class="o">,</span> <span class="nc">Object</span><span class="o">&gt;</span> <span class="n">values</span> <span class="o">=</span> <span class="n">redisTemplate</span><span class="o">.</span><span class="na">opsForHash</span><span class="o">();</span>
        <span class="n">values</span><span class="o">.</span><span class="na">putAll</span><span class="o">(</span><span class="n">key</span><span class="o">,</span> <span class="n">data</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">getHashOps</span><span class="o">(</span><span class="nc">String</span> <span class="n">key</span><span class="o">,</span> <span class="nc">String</span> <span class="n">hashKey</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">HashOperations</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">Object</span><span class="o">,</span> <span class="nc">Object</span><span class="o">&gt;</span> <span class="n">values</span> <span class="o">=</span> <span class="n">redisTemplate</span><span class="o">.</span><span class="na">opsForHash</span><span class="o">();</span>
        <span class="k">return</span> <span class="n">values</span><span class="o">.</span><span class="na">hasKey</span><span class="o">(</span><span class="n">key</span><span class="o">,</span> <span class="n">hashKey</span><span class="o">)</span> <span class="o">?</span> <span class="o">(</span><span class="nc">String</span><span class="o">)</span><span class="n">redisTemplate</span><span class="o">.</span><span class="na">opsForHash</span><span class="o">().</span><span class="na">get</span><span class="o">(</span><span class="n">key</span><span class="o">,</span> <span class="n">hashKey</span><span class="o">)</span> <span class="o">:</span> <span class="k">new</span> <span class="nc">String</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">deleteHashOps</span><span class="o">(</span><span class="nc">String</span> <span class="n">key</span><span class="o">,</span> <span class="nc">String</span> <span class="n">hashKey</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">HashOperations</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">Object</span><span class="o">,</span> <span class="nc">Object</span><span class="o">&gt;</span> <span class="n">values</span> <span class="o">=</span> <span class="n">redisTemplate</span><span class="o">.</span><span class="na">opsForHash</span><span class="o">();</span>
        <span class="n">values</span><span class="o">.</span><span class="na">delete</span><span class="o">(</span><span class="n">key</span><span class="o">,</span> <span class="n">hashKey</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">validateValue</span><span class="o">(</span><span class="nc">String</span> <span class="n">value</span><span class="o">){</span>
        <span class="k">if</span><span class="o">(</span><span class="n">value</span> <span class="o">==</span> <span class="kc">null</span><span class="o">){</span>
            <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="kc">true</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>ë‘ë²ˆì§¸ë¡œëŠ” <code class="language-plaintext highlighter-rouge">RedisDao</code>ë¼ëŠ” í´ë˜ìŠ¤ë¥¼ ë§Œë“¤ì–´ <br />
ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆì— ë¹ˆìœ¼ë¡œ ë“±ë¡í•´<br />
DI ë°›ì•„ ì‚¬ìš©í•˜ë„ë¡ í´ë˜ìŠ¤ë¥¼ í•˜ë‚˜ ë§Œë“¤ì–´ ì£¼ì—ˆë‹¤.</p>

<p>ì•ˆì— ë©”ì„œë“œ ë‚´ìš©ë“¤ì„ ë³´ë©´ <br />
ê¸°ë³¸ì ì¸ Key,Valueë¥¼ ì„¤ì •í•˜ëŠ” ë°©ë²•, ê·¸ë¦¬ê³  Getí•˜ì—¬ ê°€ì ¸ì˜¤ê¸° <br />
ë˜í•œ ì†Œë©¸ ì‹œê°„ì„¤ì •(TTL)ì„ í•˜ì—¬ Keyë¥¼ ë§Œë“¤ê¸°</p>

<p>Hash ìë£Œêµ¬ì¡°ë¡œ Key,Value ë§Œë“¤ê¸° ì •ë„ ì½”ë“œë¥¼ ì¶”ê°€í•´ë‘ì—ˆë‹¤. <br />
JWTì‚¬ìš©í• ë• ê¸°ë³¸ì  Key,Valueë¡œ ì§„í–‰í•  ì˜ˆì •ì´ê³ <br />
ë‹¤ë¥¸ í”„ë¡œì íŠ¸ì—ì„œ Hash êµ¬ì¡°ë¥¼ ì‚¬ìš©í•˜ê¸°ë•Œë¬¸ì— ìš°ì„  ì¶”ê°€í•´ì¤¬ë‹¤.</p>

<p><br /></p>

<h3 id="-redisë¥¼-í†µí•œ-refresh-token-ê´€ë¦¬">ğŸ“Œ Redisë¥¼ í†µí•œ Refresh Token ê´€ë¦¬</h3>

<h4 id="redisë¥¼-ì´ìš©í•œ-jwt-í™œìš©">Redisë¥¼ ì´ìš©í•œ JWT í™œìš©</h4>

<p>ì´ëŸ¬í•œ ë°©ë²•ì´ ì •ë§ ìµœì„ ì¼ì§€? <br />
í™•ì‹¤í•˜ì§„ ì•Šë‹¤â€¦ ì—¬ëŸ¬ê°€ì§€ ë ˆí¼ëŸ°ìŠ¤ ë¸”ë¡œê·¸ë“¤ì„ ë³´ë©´ì„œ<br />
ì´ë²ˆì— í”„ë¡œì íŠ¸ë¥¼ í•˜ë©´ì„œ ì ìš©í•´ë³¸ ì•„í‚¤í…ì²˜ë¥¼ ê·¸ë ¤ë³´ì•˜ë‹¤.</p>

<p><img src="https://user-images.githubusercontent.com/95069395/212480772-df9dcb0d-241e-4301-97e7-688b64424717.png" alt="image" class="align-left" style="max-width: 100%" /></p>

<p>ìˆœì„œë¥¼ ì‚´í´ ë³´ìë©´</p>

<p><strong>1). ë¡œê·¸ì¸ì‹œ JWT í† í°ì„ ë°œê¸‰ ë°›ëŠ”ë‹¤.</strong><br />
-&gt; AccessToken, RefreshTokenì„ ë°œê¸‰ ë°›ìŒ.</p>

<p><br /></p>

<p><strong>2). ë°œê¸‰ë°›ì€ í† í°ì„ Clientì— ì „ë‹¬ í•œë‹¤.</strong><br />
-&gt; Access Tokenì€ Headerì— <code class="language-plaintext highlighter-rouge">Authorization</code>ì— ë‹´ëŠ”ë‹¤.<br />
-&gt; Refresh Tokenì€ ì¿ í‚¤ì— ë‹´ì•„ ë³´ë‚´ì¤€ë‹¤.
ì „ë‹¬í•˜ê¸° ì „ì— ì„œë²„ì—ì„œëŠ” Refresh Tokenì„ Redis ìºì‹œì„œë²„ì— Key/Value <br />
í˜•íƒœë¡œ ì†Œë©¸ì‹œê°„ì„ ì§€ì •í•´ ì €ì¥í•œë‹¤. (ë‚˜ëŠ” 2ì¼ ì •ë„ë¡œ í•´ë‘ì—ˆë‹¤)</p>

<p>â—ï¸<strong>ìƒê°í•´ë³¼ ë§Œí•œ ë‚´ìš©ë“¤</strong><br />
ì—¬ê¸°ì„œ ìƒê°í•´ë³´ë©´ ì¢‹ì€ ì ì´. Refresh Tokenì„ í´ë¼ì´ì–¸íŠ¸ì— ë³´ë‚´ëŠ” ê²ƒì´<br />
ì •ë§ ìµœì‹ ì¸ê°€? ë¼ëŠ” ìƒê°ì´ ë“ ë‹¤. ì´ë¶€ë¶„ì— ëŒ€í•´ ê³ ë¯¼ì„ ë§ì´í•´ë´¤ê³  ë§ì´ ì°¾ì•„ë³´ì•˜ì§€ë§Œ<br />
ê²°ë¡ ì ìœ¼ë¡œ ë‚´ê°€ ë‚´ë¦° ìƒê°ì€ í•´ë‹¹ Refresh Tokenì„ í´ë¼ì´ì–¸íŠ¸ì—ì„œ ì„œë²„ë¡œ<br />
ë³´ë‚´ì£¼ì§€ ì•Šìœ¼ë©´ Access Tokenìœ¼ë¡œë§Œ ì¬ë°œê¸‰ì´ ì´ë£¨ì–´ì§€ê²Œë˜ëŠ”ë°<br />
Access Tokenì„ íƒˆì·¨ë‹¹í•  ê²½ìš° Redisì— ìˆëŠ” Refresh Tokenìœ¼ë¡œ ì¬ë°œê¸‰ì´ ê°€ëŠ¥í•´ì§€ë‹ˆ<br />
ìœ„í—˜í•´ ì§ˆ ê²ƒ ê°™ë‹¤ëŠ” ìƒê°ì— ì´ë¥´ëŸ¿ê³ , ì·¨ì•½ì ì´ ì¡´ì¬í•˜ì§€ë§Œ ìµœì†Œí•œ ì¿ í‚¤ë¡œ ë‹´ì•„ ë³´ë‚´ <br />
HttpOnly ì˜µì…˜ìœ¼ë¡œ XSS(Cross-Site Scripting) ê³µê²©ì„ ë§‰ì„ ìˆ˜ê¸°ì— ë³´ë‚´ì£¼ê¸°ë¡œ ê²°ì •í–ˆë‹¤.</p>

<p><br /></p>

<p><strong>3). API ìš”ì²­í• ë•Œ ì¸ì¦ì„ ìœ„í•œ Access Tokenì„ ë‹´ì•„ ìš”ì²­í•œë‹¤.</strong><br />
-&gt; ì •ìƒì ìœ¼ë¡œ ì¸ì¦ì´ ì™„ë£Œë˜ë©´ í•´ë‹¹ APIë¥¼ ìˆ˜í–‰í•œë‹¤.<br />
-&gt; ë§Œì•½ Access Tokenì´ ë§Œë£Œë˜ì—ˆë‹¤ë©´? ì„œë²„ì—ì„œëŠ” ë§Œë£Œë˜ì—ˆë‹¤ê³  <br />
í´ë¼ì´ì–¸íŠ¸ì¸¡ì— ì•Œë ¤ì¤€ë‹¤. (ë‚˜ì™€ ê°™ì€ê²½ìš°ëŠ” í† í°ì´ ë§Œë£Œë˜ì—ˆë‹¤ê³  JSONì„ ì‘ë‹µí•´ì¤Œ)</p>

<p><br /></p>

<p><strong>4). ë§Œë£Œì‘ë‹µì„ ë°›ì€ í´ë¼ì´ì–¸íŠ¸ëŠ” Access Token ì¬ë°œí–‰ APIë¥¼ ìš”ì²­í•œë‹¤.</strong><br />
-&gt; Access Tokenê³¼ Refresh Tokenì„ í—¤ë”ì— ë‹´ì•„ì„œ Access Token ì¬ë°œê¸‰ì„ ìš”ì²­í•œë‹¤.<br />
-&gt; ì¬ë°œê¸‰ ìš”ì²­ì„ ë°›ì€ ì„œë²„ëŠ” Refresh Tokenì„ Redisì—ì„œ ì°¾ëŠ”ë‹¤. <br />
-&gt; ë§Œì•½ Redis ìºì‹œì„œë²„ì•ˆì— Refresh Tokenì´ ì†Œë©¸ë˜ì§€ ì•Šì•˜ë‹¤ë©´<br />
Access Token ì¬ë°œê¸‰ ì‹œí€€ìŠ¤ë¥¼ ì§„í–‰í•œë‹¤.<br />
-&gt; ë§Œì•½ Refresh Tokenì´ ì†Œë©¸ë˜ì—ˆë‹¤ë©´, ì˜ˆì™¸ì²˜ë¦¬í•˜ì—¬ í´ë¼ì´ì–¸íŠ¸ì— ì•Œë ¤ì¤€ë‹¤.<br />
(ì´í›„ ë¡œê·¸ì•„ì›ƒì„ í•˜ë“  ë‹¤ìŒ ì•¡ì…˜ì€ í´ë¼ì´ì–¸íŠ¸ìª½ì— ë§¡ê¸´ë‹¤.)</p>

<p><br /></p>

<h4 id="jwt-redis-ì €ì¥-ì¬ë°œí–‰-ì½”ë“œ">JWT Redis ì €ì¥, ì¬ë°œí–‰ ì½”ë“œ</h4>

<p>ìœ„ì™€ ê°™ì€ í”Œë¡œìš°ë¡œ ì¼ë‹¨ ì •ë¦¬ë¥¼ í•˜ì˜€ë‹¤. <br />
í•´ë‹¹ ë¡œì§ êµ¬í˜„ì€ ì•„ë˜ì—ì„œ ì‚´í´ë³´ì.<br />
ëª¨ë“  ë¡œì§ì„ ì ì–´ë‘ì§„ ì•Šì„ ê²ƒì´ê³ , ì¤‘ìš”í•˜ë‹¤ê³  ìƒê°í•˜ëŠ”<br />
ë¶€ë¶„ì˜ í´ë˜ìŠ¤ ë‚´ìš©ë“¤ë§Œ ì ì–´ë³¼ ì˜ˆì •ì´ë‹¤.</p>

<p><strong>1). ë¡œê·¸ì¸ì‹œ JWT í† í° ë°œê¸‰, Redisì— ì €ì¥</strong></p>

<p><strong>JwtAuthenticationFilter í´ë˜ìŠ¤</strong></p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">JwtAuthenticationFilter</span> <span class="kd">extends</span> <span class="nc">UsernamePasswordAuthenticationFilter</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="nc">AuthenticationManager</span> <span class="n">authenticationManager</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="nc">TokenProvider</span> <span class="n">tokenProvider</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="nc">RedisDao</span> <span class="n">redisDao</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">JwtAuthenticationFilter</span><span class="o">(</span><span class="nc">AuthenticationManager</span> <span class="n">authenticationManager</span><span class="o">,</span> <span class="nc">TokenProvider</span> <span class="n">tokenProvider</span><span class="o">,</span> <span class="nc">RedisDao</span> <span class="n">redisDao</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">authenticationManager</span> <span class="o">=</span> <span class="n">authenticationManager</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">tokenProvider</span> <span class="o">=</span> <span class="n">tokenProvider</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">redisDao</span> <span class="o">=</span> <span class="n">redisDao</span><span class="o">;</span>
    <span class="o">}</span>
    
    <span class="nd">@SneakyThrows</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="nc">Authentication</span> <span class="nf">attemptAuthentication</span><span class="o">(</span><span class="nc">HttpServletRequest</span> <span class="n">request</span><span class="o">,</span> <span class="nc">HttpServletResponse</span> <span class="n">response</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">ObjectMapper</span> <span class="n">objectMapper</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ObjectMapper</span><span class="o">();</span>

        <span class="nc">LoginDto</span> <span class="n">loginDto</span> <span class="o">=</span> <span class="n">objectMapper</span><span class="o">.</span><span class="na">readValue</span><span class="o">(</span><span class="n">request</span><span class="o">.</span><span class="na">getInputStream</span><span class="o">(),</span> <span class="nc">LoginDto</span><span class="o">.</span><span class="na">class</span><span class="o">);</span> <span class="c1">// ServletInputSteamì„ LoginDto í´ë˜ìŠ¤ ê°ì²´ë¡œ ì—­ì§ë ¬í™” (ì¦‰, JSON ê°ì²´êº¼ëƒ„)</span>
        <span class="n">log</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">"# attemptAuthentication : loginDto.getEmail={}, login.getPassword={}"</span><span class="o">,</span><span class="n">loginDto</span><span class="o">.</span><span class="na">getEmail</span><span class="o">(),</span><span class="n">loginDto</span><span class="o">.</span><span class="na">getPassword</span><span class="o">());</span>

        <span class="nc">UsernamePasswordAuthenticationToken</span> <span class="n">authenticationToken</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">UsernamePasswordAuthenticationToken</span><span class="o">(</span><span class="n">loginDto</span><span class="o">.</span><span class="na">getEmail</span><span class="o">(),</span> <span class="n">loginDto</span><span class="o">.</span><span class="na">getPassword</span><span class="o">());</span>
        <span class="k">return</span> <span class="n">authenticationManager</span><span class="o">.</span><span class="na">authenticate</span><span class="o">(</span><span class="n">authenticationToken</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">successfulAuthentication</span><span class="o">(</span><span class="nc">HttpServletRequest</span> <span class="n">request</span><span class="o">,</span> <span class="nc">HttpServletResponse</span> <span class="n">response</span><span class="o">,</span> <span class="nc">FilterChain</span> <span class="n">chain</span><span class="o">,</span> <span class="nc">Authentication</span> <span class="n">authResult</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">ServletException</span><span class="o">,</span> <span class="nc">IOException</span> <span class="o">{</span>

        <span class="nc">AuthMember</span> <span class="n">authMember</span> <span class="o">=</span> <span class="o">(</span><span class="nc">AuthMember</span><span class="o">)</span> <span class="n">authResult</span><span class="o">.</span><span class="na">getPrincipal</span><span class="o">();</span>
        <span class="nc">TokenDto</span> <span class="n">tokenDto</span> <span class="o">=</span> <span class="n">tokenProvider</span><span class="o">.</span><span class="na">generateTokenDto</span><span class="o">(</span><span class="n">authMember</span><span class="o">);</span>
        <span class="nc">String</span> <span class="n">accessToken</span> <span class="o">=</span> <span class="n">tokenDto</span><span class="o">.</span><span class="na">getAccessToken</span><span class="o">();</span> <span class="c1">// accessToken ë§Œë“¤ê¸°</span>
        <span class="nc">String</span> <span class="n">refreshToken</span> <span class="o">=</span> <span class="n">tokenDto</span><span class="o">.</span><span class="na">getRefreshToken</span><span class="o">();</span> <span class="c1">// refreshToken ë§Œë“¤ê¸°</span>

        <span class="n">tokenProvider</span><span class="o">.</span><span class="na">accessTokenSetHeader</span><span class="o">(</span><span class="n">accessToken</span><span class="o">,</span><span class="n">response</span><span class="o">);</span> <span class="c1">// AccessToken Header response ìƒì„±</span>
        <span class="c1">//tokenProvider.refreshTokenSetHeader(refreshToken,response); // RefreshToken Header response ìƒì„±</span>
        <span class="n">tokenProvider</span><span class="o">.</span><span class="na">refreshTokenSetCookie</span><span class="o">(</span><span class="n">refreshToken</span><span class="o">,</span><span class="n">response</span><span class="o">);</span> <span class="c1">// RefreshToken Cookieë¡œ ì„¤ì •</span>
        <span class="nc">Responder</span><span class="o">.</span><span class="na">loginSuccessResponse</span><span class="o">(</span><span class="n">response</span><span class="o">,</span><span class="n">authMember</span><span class="o">);</span> <span class="c1">// login ì™„ë£Œì‹œ Response ì‘ë‹µ ë§Œë“¤ê¸°</span>

        <span class="c1">// ë¡œê·¸ì¸ ì„±ê³µì‹œ Refresh Token Redis ì €ì¥ ( key = Refresh Token / value = Access Token )</span>
        <span class="kt">int</span> <span class="n">refreshTokenExpirationMinutes</span> <span class="o">=</span> <span class="n">tokenProvider</span><span class="o">.</span><span class="na">getRefreshTokenExpirationMinutes</span><span class="o">();</span>
        <span class="n">redisDao</span><span class="o">.</span><span class="na">setValues</span><span class="o">(</span><span class="n">refreshToken</span><span class="o">,</span><span class="n">accessToken</span><span class="o">,</span> <span class="nc">Duration</span><span class="o">.</span><span class="na">ofMinutes</span><span class="o">(</span><span class="n">refreshTokenExpirationMinutes</span><span class="o">));</span>

        <span class="k">this</span><span class="o">.</span><span class="na">getSuccessHandler</span><span class="o">().</span><span class="na">onAuthenticationSuccess</span><span class="o">(</span><span class="n">request</span><span class="o">,</span><span class="n">response</span><span class="o">,</span><span class="n">authResult</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>
<p><code class="language-plaintext highlighter-rouge">UsernamePasswordAuthenticationFilter</code>ë¥¼ ìƒì†ë°›ì•„<br />
êµ¬í˜„í•œ <code class="language-plaintext highlighter-rouge">JwtAuthenticationFilter</code> í•„í„° í´ë˜ìŠ¤ì´ë‹¤. Spring Securityì—<br />
FilterChainì— ì„¤ì •í•´ë‘ì–´ ë¡œê·¸ì¸ ìš”ì²­ì‹œ í•´ë‹¹ í•„í„°ë¥¼ ê±°ì¹˜ê²Œëœë‹¤.</p>

<p>ì—¬ê¸°ì„œ ì¤‘ì ì ìœ¼ë¡œ ë´ì•¼í•  ì½”ë“œëŠ”<br />
<code class="language-plaintext highlighter-rouge">successfulAuthentication</code>ë©”ì„œë“œ ë¶€ë¶„ì´ë‹¤.<br />
<code class="language-plaintext highlighter-rouge">UsernamePasswordAuthenticationFilter</code> í•„í„°ì—ì„œëŠ” <br />
ì¸ì¦ëœ ê°ì²´ë¥¼ <code class="language-plaintext highlighter-rouge">Security Context Holder</code>ì— ì €ì¥í•´ì£¼ëŠ” ì—­í• ì„í•œë‹¤.</p>

<p>ë‚˜ì™€ ê°™ì€ ê²½ìš°ëŠ” í•´ë‹¹ í•„í„°ë¥¼ Overrideí•˜ì˜€ê¸° ë•Œë¬¸ì—<br />
<code class="language-plaintext highlighter-rouge">Security Context Holder</code>ì— ê°ì²´ì €ì¥í•˜ëŠ”ê±´ <code class="language-plaintext highlighter-rouge">JwtVerificationFilter</code>ë¼ëŠ”<br />
ì¸ì¦í•„í„°ë¥¼ ë§Œë“¤ì–´ ì²˜ë¦¬í•´ì£¼ì—ˆê³ , í˜„ì¬ ìœ„ì— ì˜¬ë ¤ë‘” í•„í„°í´ë˜ìŠ¤ì—ì„œëŠ”<br />
JWT ë°œí–‰ê³¼ <code class="language-plaintext highlighter-rouge">redisDao.setValues()</code>ë©”ì„œë“œë¥¼ í†µí•´ Redisì—</p>

<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Key : refreshToken  
Value : accessToken  
ì†Œë©¸ì‹œê°„ : 2ì¼
</code></pre></div></div>
<p>ë¡œ ì €ì¥ì„ í•´ì£¼ê²Œ ë˜ì—ˆë‹¤. ìœ„ í”Œë¡œìš°ì—ì„œ ì–˜ê¸°í–ˆë˜ 1),2)ë²ˆì— í•´ë‹¹í•˜ëŠ” ë‚´ìš©ì´ë‹¤.<br />
ì´ë ‡ê²Œ í•„í„° êµ¬í˜„ ë¶€ë¶„ì—ì„œ JWTë¥¼ ë°œí–‰í•´ Redisì— ì €ì¥í•´ì£¼ê²Œ ë˜ì—ˆë‹¤.</p>

<p><br /></p>

<p><strong>2). Token ë§Œë£Œì‹œ JWT ì¬ë°œí–‰</strong></p>

<p>ìœ„ì—ì„œ ë¡œê·¸ì¸ì‹œ í† í° ë°œê¸‰ê¹Œì§€ í•´ì£¼ì—ˆê³   <br />
í´ë¼ì´ì–¸íŠ¸ì—ì„œ Access Tokenì„ í—¤ë”ì— ë‹´ì•„ ì–´ë–¤<br />
APIë¥¼ ìš”ì²­í•˜ì˜€ì„ë•Œ, í† í°ì´ ë§Œë£Œë˜ì—ˆë‹¤ê³  ì„œë²„ì—ì„œ í™•ì¸í•´ì„œ ì•Œë ¤ì£¼ë©´<br />
ì¬ë°œí–‰ APIë¥¼ í´ë¼ì´ì–¸íŠ¸ì—ì„œ ë³´ë‚´ê¸°ë¡œ í–ˆì—ˆë‹¤.</p>

<p>â—ï¸ Access Token ë§Œë£Œí™•ì¸ ì½”ë“œëŠ” ë„ˆë¬´ ë§ê¸°ë•Œë¬¸ì— ìƒëµí•©ë‹ˆë‹¤.<br />
í•„ìëŠ” <code class="language-plaintext highlighter-rouge">JwtAuthenticationFilter</code> í•„í„°í´ë˜ìŠ¤ë¥¼ ë§Œë“¤ì–´ <code class="language-plaintext highlighter-rouge">OncePerRequestFilter</code>ë¥¼<br />
ìƒì†ë°›ì•„ APIìš”ì²­ì‹œ <code class="language-plaintext highlighter-rouge">doFilterInternal</code>ë¥¼ Overrideë°›ì•„ êµ¬í˜„í•´ í•´ë‹¹ í•„í„°ì—ì„œ <br />
JWT í•´ë…ì„í•˜ê³ , ì •ìƒì ìœ¼ë¡œ í•´ë…í•˜ë©´ APIê°€ ì‹¤í–‰ë  ê²ƒì´ê³ , í† í°ì— ë¬¸ì œê°€ ìˆê±°ë‚˜ ë§Œë£Œê°€ë˜ì—ˆìœ¼ë©´<br />
ì˜ˆì™¸ì²˜ë¦¬í•˜ì—¬ í´ë¼ì´ì–¸íŠ¸ ì¸¡ì— JSONì„ ë§Œë“¤ì–´ Bodyì— ë˜ì ¸ì£¼ì—ˆìŠµë‹ˆë‹¤.</p>

<p><br /></p>

<p><strong>MemberController í´ë˜ìŠ¤</strong></p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Slf4j</span>
<span class="nd">@RestController</span>
<span class="nd">@Validated</span>
<span class="nd">@RequiredArgsConstructor</span>
<span class="nd">@RequestMapping</span><span class="o">(</span><span class="s">"/members"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MemberController</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="kd">final</span> <span class="nc">MemberService</span> <span class="n">memberService</span><span class="o">;</span>

    <span class="o">...</span>

    <span class="nd">@GetMapping</span><span class="o">(</span><span class="s">"/reissue"</span><span class="o">)</span>
    <span class="kd">public</span> <span class="nc">ResponseEntity</span> <span class="nf">reissue</span><span class="o">(</span><span class="nd">@CookieValue</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">"refreshToken"</span><span class="o">,</span> <span class="n">required</span> <span class="o">=</span> <span class="kc">false</span><span class="o">)</span> <span class="nc">String</span> <span class="n">refreshToken</span><span class="o">,</span>
                                  <span class="nc">HttpServletRequest</span> <span class="n">request</span><span class="o">,</span>
                                  <span class="nc">HttpServletResponse</span> <span class="n">response</span><span class="o">){</span>

        <span class="n">memberService</span><span class="o">.</span><span class="na">reissueAccessToken</span><span class="o">(</span><span class="n">refreshToken</span><span class="o">,</span><span class="n">request</span><span class="o">,</span><span class="n">response</span><span class="o">);</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nf">ResponseEntity</span><span class="o">(</span><span class="s">"Refresh Token ì¬ë°œê¸‰ ì™„ë£Œ!"</span><span class="o">,</span><span class="nc">HttpStatus</span><span class="o">.</span><span class="na">CREATED</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>
<p>ì¬ë°œí–‰ì„ ì‹¤í–‰í•´ì£¼ëŠ” APIì´ë‹¤. í•´ë‹¹ APIëŠ”<br />
ìœ„ì—ì„œ ì–˜ê¸°í–ˆë˜ <code class="language-plaintext highlighter-rouge">JwtAuthenticationFilter</code>ì—ì„œ ì‹¤í–‰ë˜ì§€ ì•Šê²Œ<br />
<code class="language-plaintext highlighter-rouge">shouldNotFilter</code>ë¥¼ êµ¬í˜„í•´ ì²˜ë¦¬í•´ì¤„ ìˆ˜ ìˆë‹¤. <br />
ê·¸ë ‡ê²Œë˜ë©´ AccessTokenì´ ë§Œë£Œë˜ì—ˆë”ë¼ë„, í•´ë‹¹ APIëŠ” ì‹¤í–‰ì´ ëœë‹¤.<br />
í•´ë‹¹ ë¡œì§ì€ API ìš”ì²­ë¶€ë¶„ì´ê³ , ì´ì œ ì¤‘ìš”í•œ Serviceë¡œì§ì„ í™•ì¸í•´ë³´ì</p>

<p><br /></p>

<p><strong>MemberSerivce í´ë˜ìŠ¤</strong></p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Service</span>
<span class="nd">@Slf4j</span>
<span class="nd">@RequiredArgsConstructor</span>
<span class="nd">@Transactional</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MemberService</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="nc">MemberRepository</span> <span class="n">memberRepository</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="nc">CustomBeanUtils</span><span class="o">&lt;</span><span class="nc">Member</span><span class="o">&gt;</span> <span class="n">beanUtils</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="nc">PasswordEncoder</span> <span class="n">passwordEncoder</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="nc">CustomAuthorityUtils</span> <span class="n">authorityUtils</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="nc">TokenProvider</span> <span class="n">tokenProvider</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="nc">RedisDao</span> <span class="n">redisDao</span><span class="o">;</span>

    <span class="o">...</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">reissueAccessToken</span><span class="o">(</span><span class="nc">String</span> <span class="n">refreshToken</span><span class="o">,</span> <span class="nc">HttpServletRequest</span> <span class="n">request</span><span class="o">,</span> <span class="nc">HttpServletResponse</span> <span class="n">response</span><span class="o">){</span>

        <span class="k">if</span><span class="o">(</span><span class="n">refreshToken</span> <span class="o">==</span> <span class="kc">null</span><span class="o">){</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">BusinessLogicException</span><span class="o">(</span><span class="nc">ExceptionCode</span><span class="o">.</span><span class="na">COOKIE_REFRESH_TOKEN_NOT_FOUND</span><span class="o">);</span>
        <span class="o">}</span>

        <span class="nc">String</span> <span class="n">accessToken</span> <span class="o">=</span> <span class="n">tokenProvider</span><span class="o">.</span><span class="na">resolveToken</span><span class="o">(</span><span class="n">request</span><span class="o">);</span>
        <span class="nc">String</span> <span class="n">redisAccessToken</span> <span class="o">=</span> <span class="n">redisDao</span><span class="o">.</span><span class="na">getValues</span><span class="o">(</span><span class="n">refreshToken</span><span class="o">);</span>

        <span class="c1">// Refresh Tokenì´ Redisì— ì¡´ì¬í•  ê²½ìš° Access Token ìƒì„±</span>
        <span class="k">if</span><span class="o">(</span><span class="n">redisDao</span><span class="o">.</span><span class="na">validateValue</span><span class="o">(</span><span class="n">redisAccessToken</span><span class="o">)</span> <span class="o">&amp;&amp;</span> <span class="n">accessToken</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">redisAccessToken</span><span class="o">)){</span>
            <span class="n">log</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">"# RefreshTokenì„ í†µí•œ AccessToken ì¬ë°œê¸‰ ì‹œì‘"</span><span class="o">);</span>
            <span class="nc">Claims</span> <span class="n">claims</span> <span class="o">=</span> <span class="n">tokenProvider</span><span class="o">.</span><span class="na">parseClaims</span><span class="o">(</span><span class="n">refreshToken</span><span class="o">);</span> <span class="c1">// Refresh Token ë³µí˜¸í™”</span>
            <span class="nc">String</span> <span class="n">email</span> <span class="o">=</span> <span class="n">claims</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">"sub"</span><span class="o">,</span> <span class="nc">String</span><span class="o">.</span><span class="na">class</span><span class="o">);</span> <span class="c1">// Refresh Tokenì—ì„œ emailì •ë³´ ê°€ì ¸ì˜¤ê¸°</span>
            <span class="nc">Member</span> <span class="n">member</span> <span class="o">=</span> <span class="n">findVerifiedMember</span><span class="o">(</span><span class="n">email</span><span class="o">);</span> <span class="c1">// DBì—ì„œ ì‚¬ìš©ì ì •ë³´ ì°¾ê¸°</span>
            <span class="nc">AuthMember</span> <span class="n">authMember</span> <span class="o">=</span> <span class="nc">AuthMember</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="n">member</span><span class="o">.</span><span class="na">getId</span><span class="o">(),</span> <span class="n">member</span><span class="o">.</span><span class="na">getEmail</span><span class="o">(),</span> <span class="n">member</span><span class="o">.</span><span class="na">getRoles</span><span class="o">());</span>
            <span class="nc">TokenDto</span> <span class="n">tokenDto</span> <span class="o">=</span> <span class="n">tokenProvider</span><span class="o">.</span><span class="na">generateTokenDto</span><span class="o">(</span><span class="n">authMember</span><span class="o">);</span> <span class="c1">// Token ë§Œë“¤ê¸°</span>
            <span class="kt">int</span> <span class="n">refreshTokenExpirationMinutes</span> <span class="o">=</span> <span class="n">tokenProvider</span><span class="o">.</span><span class="na">getRefreshTokenExpirationMinutes</span><span class="o">();</span>
            <span class="n">redisDao</span><span class="o">.</span><span class="na">setValues</span><span class="o">(</span><span class="n">refreshToken</span><span class="o">,</span> <span class="n">tokenDto</span><span class="o">.</span><span class="na">getAccessToken</span><span class="o">(),</span> <span class="nc">Duration</span><span class="o">.</span><span class="na">ofMinutes</span><span class="o">(</span><span class="n">refreshTokenExpirationMinutes</span><span class="o">));</span>
            <span class="n">tokenProvider</span><span class="o">.</span><span class="na">accessTokenSetHeader</span><span class="o">(</span><span class="n">tokenDto</span><span class="o">.</span><span class="na">getAccessToken</span><span class="o">(),</span><span class="n">response</span><span class="o">);</span>

        <span class="o">}</span> <span class="k">else</span> <span class="k">if</span><span class="o">(!</span><span class="n">redisDao</span><span class="o">.</span><span class="na">validateValue</span><span class="o">(</span><span class="n">redisAccessToken</span><span class="o">)){</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">BusinessLogicException</span><span class="o">(</span><span class="nc">ExceptionCode</span><span class="o">.</span><span class="na">REFRESH_TOKEN_NOT_FOUND</span><span class="o">);</span>
        <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">BusinessLogicException</span><span class="o">(</span><span class="nc">ExceptionCode</span><span class="o">.</span><span class="na">TOKEN_IS_NOT_SAME</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>ë‹¤ë¥¸ ì„œë¹„ìŠ¤ ë¡œì§ë“¤ì€ ì§€ìš°ê³  í‘œí˜„í•´ë‘ì—ˆë‹¤. <br />
<code class="language-plaintext highlighter-rouge">reissueAccessToken</code>ë©”ì„œë“œë¼ëŠ” ë¶€ë¶„ì„ ë§Œë“¤ì–´ ê²€ì¦ ë¡œì§ì„ ì‘ì„±í–ˆë‹¤.</p>

<p>ì²«ë²ˆì§¸ë¡œëŠ” ì¿ í‚¤ì— RefreshTokenì´ ì œëŒ€ë¡œ ë‹´ê²¨ì™”ëŠ”ì§€ë¥¼ í™•ì¸í•œë‹¤.</p>

<p>ê·¸ë¦¬ê³ ëŠ” ì´ì œ í—¤ë”ì— ë‹´ê¸´ AccessTokenì„ êº¼ë‚´ê³ <br />
ì¿ í‚¤ë¡œ ì „ë‹¬ë°›ì€ RefreshTokenìœ¼ë¡œ <code class="language-plaintext highlighter-rouge">redisDao.getValues</code>ë©”ì„œë“œë¥¼ ì´ìš©í•´<br />
Redisì—ì„œ AccessTokenì„ êº¼ë‚¸ë‹¤. <em><strong>(key=refreshToken, value=accessTokenìœ¼ë¡œ ì €ì¥í–ˆìœ¼ë‹ˆê¹Œ!)</strong></em></p>

<p>ì´ì œ <code class="language-plaintext highlighter-rouge">if(redisDao.validateValue(redisAccessToken) &amp;&amp; accessToken.equals(redisAccessToken))</code><br />
ë¹„êµë¬¸ì„ í†µí•´ ì´ ë‘ê°œì˜ AccessTokenì„ ë¹„êµí•´ ì¼ì¹˜í•˜ëŠ”ì§€ í™•ì¸í•˜ê³ <br />
ë§Œì•½ êº¼ë‚´ì™”ì„ë•Œ ì†Œë©¸ì´ ëœ ìƒíƒœë¼ë©´ <code class="language-plaintext highlighter-rouge">redisDao.validateValue(redisAccessToken)</code>ì—<br />
nullê°’ì´ ì°í˜€ìˆê²Œë˜ì–´ ë‘˜ ì¤‘í•˜ë‚˜ë¼ë„ ì¡°ê±´ì´ ë§Œì¡±í•˜ì§€ ëª»í•˜ë©´ ì˜ˆì™¸ì²˜ë¦¬ê°€ ë  ê²ƒì´ë‹¤.</p>

<p>ì¦‰! Refresh Tokenì´ ì¡´ì¬í•˜ê³ (ì†Œë©¸ë˜ì§€ ì•Šê³ )<br />
í•´ë‹¹ Refresh Tokenì— ë§¤ì¹­ë˜ëŠ” Access Tokenì„ ë“¤ê³ ì™”ì„ë•Œë§Œ<br />
Access Tokenì„ ì¬ë°œí–‰ í•œë‹¤ìŒì— ë‹¤ì‹œ í´ë¼ì´ì–¸íŠ¸ì— ì „ì†¡í•´ì¤€ë‹¤ëŠ” ì„œë¹„ìŠ¤ ë¡œì§ì´ë‹¤.</p>

<p><br /></p>

<h3 id="-ì •ë¦¬">ğŸ“Œ ì •ë¦¬</h3>

<p>ì´ë ‡ê²Œ ì—¬ëŸ¬ê°€ì§€ ë ˆí¼ëŸ°ìŠ¤ë¥¼ ì°¾ì•„ë³´ë©´ì„œ <br />
ìš°ì„  ë‚´ê°€ ìƒê°í•˜ëŠ”ëŒ€ë¡œ ì •ë¦¬í•˜ì—¬ ì˜¬ë ¤ë³´ì•˜ë‹¤. <br />
ì´ ë°©ë²•ì´ í‹€ë¦´ìˆ˜ë„ ìˆê³ , ì–´ëŠì •ë„ íƒ€í˜‘ì´ ë  ìˆ˜ë„ ìˆë‹¤ê³  ìƒê°í•œë‹¤.</p>

<p>ì•ìœ¼ë¡œë„ í† í°ì„ ì‚¬ìš©í•œë‹¤ë©´ ë³´ì•ˆì— ëŒ€í•´ ì¢€ë” ê¹Šê²Œ ê³µë¶€ë¥¼ í•´ë´ì•¼í•  ê²ƒ ê°™ë‹¤.<br />
ë˜í•œ, ì´ ê¸€ì˜ ë³¸ëª©ì ì€ ì½”ë“œë¥¼ ì „ë¶€ ë¦¬ë·°í•œë‹¤ê¸° ë³´ë‹¤ëŠ”</p>

<p>ì–´ë– í•œ íë¦„ìœ¼ë¡œ ì‘ì—…ì„ í–ˆëŠ”ì§€ì™€ Redisë¥¼ ì´ìš©í•˜ì—¬<br />
í† í°ì„ ë¹„êµí•˜ëŠ” ë¶€ë¶„ì— ì´ˆì ì„ ë‘ê³  ì‘ì„±í–ˆê¸°ì— <br />
Spring Securityì— ëŒ€í•œ ë‚´ìš©ì„ ì–´ëŠì •ë„ ì„ ìˆ˜ì§€ì‹ìœ¼ë¡œ ê°€ì§€ê³  ìˆì–´ì•¼í•˜ê¸°ì—<br />
ì¡°ê¸ˆ ë¶ˆì¹œì ˆí•œ ì„¤ëª…ì´ ë  ìˆ˜ë„ ìˆì„ ê²ƒ ê°™ë‹¤ëŠ” ìƒê°ì´ë“ ë‹¤.</p>

<p>ê·¸ë˜ë„ ì°¸ê³ ì°¨ ì˜¬ë ¤ë³´ê³ <br />
ë‚´ê³µë¶€ë¥¼ ìœ„í•œ ê¸°ë¡ì´ê¸°ë„í•˜ì—¬ ì •ë¦¬í•´ë³´ì•˜ë‹¤ ğŸ“š</p>

<p><br />
<br />
<br /></p>

<p>âœ¨ ì°¸ê³  ë¸”ë¡œê·¸
<a href="https://hudi.blog/refresh-token-in-spring-boot-with-redis/">Redis Jpa ì‚¬ìš© ë ˆí¼ëŸ°ìŠ¤</a>, <a href="https://wildeveloperetrain.tistory.com/32">Redis ì‚¬ìš©ë°©ë²• 2ê°€ì§€ ë ˆí¼ëŸ°ìŠ¤</a></p>

<p><br />
<br /></p>]]></content><author><name>LEE JAEHYEOK</name></author><category term="DB" /><category term="DB" /><category term="redis" /><summary type="html"><![CDATA[Redisì— ëŒ€í•œ ê°„ë‹¨í•œ CSì§€ì‹ê³¼ Redis ì„¤ì¹˜ ë° CLI ì‚¬ìš©ë²•ì„ ì•Œì•„ë³´ì•˜ì—ˆë‹¤.]]></summary></entry><entry><title type="html">Git Cherry-Pickìœ¼ë¡œ Commit ì˜®ê¸°ê¸°</title><link href="http://localhost:4000/git/2023/01/12/git-cherrypick.html" rel="alternate" type="text/html" title="Git Cherry-Pickìœ¼ë¡œ Commit ì˜®ê¸°ê¸°" /><published>2023-01-12T00:00:00+09:00</published><updated>2023-01-12T00:00:00+09:00</updated><id>http://localhost:4000/git/2023/01/12/git-cherrypick</id><content type="html" xml:base="http://localhost:4000/git/2023/01/12/git-cherrypick.html"><![CDATA[<h3 id="-cherry-pick">ğŸ“Œ Cherry-Pick</h3>

<p>ì‘ì—…ì„ í•˜ë˜ì¤‘ ë‹¤ë¥¸ ë¸Œëœì¹˜ì— Commitì„ í•´ë²„ë ¸ë‹¤â€¦</p>

<p><strong>íŒ€ì› ëª¨ë‘ê°€ ê°œë°œ ì¤‘ì¸ ë¸Œëœì¹˜</strong> : <code class="language-plaintext highlighter-rouge">develop</code><br />
<strong>í˜„ì¬ ë‚´ê°€ ê°œë°œí•˜ëŠ” ë¸Œëœì¹˜</strong> : <code class="language-plaintext highlighter-rouge">feat/BE/ljh</code></p>

<p>ì´ë ‡ê²Œ ë‘ê°€ì§€ë¡œ ìš´ì˜ì¤‘ì´ì—ˆë‹¤.</p>

<p><img src="https://user-images.githubusercontent.com/95069395/212029237-9092798b-deca-43ea-8a8d-d99591ca7963.png" alt="image" class="align-left" style="max-width: 100%" /></p>

<p>ì‚¬ì§„ì—ì„œ ë³¼ ìˆ˜ ìˆë“¯ì´â€¦ <code class="language-plaintext highlighter-rouge">develop</code> ë¸Œëœì¹˜ì— ì»¤ë°‹ì„ ë‘ê°œë‚˜ í•´ë²„ë¦°ìƒí™©<br />
#14, #3 ìœ¼ë¡œëœ ì œëª©ì˜ ì»¤ë°‹ì´ë‹¤..<br />
<code class="language-plaintext highlighter-rouge">feat/BE/ljh</code>  ë¸Œëœì¹˜ë¡œ ì»¤ë°‹ì„ ì˜®ê²¨ì•¼í•˜ëŠ” ìƒí™©ì´ë‹¤.</p>

<p>í•´ë‹¹ ì»¤ë°‹ì„ ë³µì‚¬í•´ì„œ ì˜®ê¸¸ ìˆ˜ ìˆëŠ” ë°©ë²•ì´ Cherry-Pickì´ë‹¤.<br />
ë³¸ê²©ì ìœ¼ë¡œ ì‚¬ìš©ë²•ì„ ì•Œì•„ë³´ì</p>

<p><br /></p>

<h3 id="-commit-hash-ê°’">ğŸ“Œ Commit Hash ê°’</h3>

<p>ì²«ë²ˆì§¸ë¡œ ë‚´ê°€ ì˜ëª»ì˜¬ë¦´ ì»¤ë°‹ì˜ í•´ì‰¬ê°’ì„ ì•Œì•„ì•¼í•œë‹¤.</p>

<p>ë‚´ê°€ ì»¤ë°‹ì„ ì˜ëª»ì˜¬ë¦° ë¸Œëœì¹˜(<code class="language-plaintext highlighter-rouge">develop</code>)ì—ì„œ<br />
<code class="language-plaintext highlighter-rouge">git log</code>ë¥¼ ì…ë ¥í•´ ì»¤ë°‹ì˜ í•´ì‰¬ê°’ì„ ì•Œ ìˆ˜ ìˆë‹¤.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>commit 7525f9a220700884994e53e90babc345d199e10e <span class="o">(</span>HEAD -&gt; develop<span class="o">)</span>
Author: Lee JaeHyeok &lt;dhfif718@gmail.com&gt;
Date:   Thu Jan 12 18:02:48 2023 +0900

    <span class="c">#14 - Responseder, TokenPrvider ì—­í•  ì¶”ê°€</span>
    
    1. ë¡œê·¸ì¸ ì‹œ ì‘ë‹µ ê°€ëŠ¥í•˜ë„ë¡ Responder ì¶”ê°€
    2. JWT ê´€ë ¨ ì˜ˆì™¸ë°œìƒì‹œ Json ê°ì²´ë¡œ ë°˜í™˜ì•ˆë˜ëŠ” ë¬¸ì œ ìˆ˜ì •
    3. HttpServletRequest ê°ì²´ë¡œ AccessToken ê°€ì ¸ì˜¤ë„ë¡ TokenProviderì—ê²Œ ì—­í•  ì´ì „
       <span class="o">(</span>ì¶”í›„ RefreshTokenìœ¼ë¡œ AccessToken ë°œê¸‰ì‹œ í†µì¼ì„±ìˆê²Œ ì‚¬ìš©ì„ ìœ„í•¨<span class="o">)</span>


commit cd49c93bd4905f6d1f4a19d8438ab4c4d6b6d15b
Author: Lee JaeHyeok &lt;dhfif718@gmail.com&gt;
Date:   Thu Jan 12 17:58:46 2023 +0900

    <span class="c">#3 - LoginResponseDto ì¶”ê°€</span>
    
    1. ë¡œê·¸ì¸ ì‹œ ì‘ë‹µ ê°€ëŠ¥í•˜ë„ë¡ ResponseDto ì¶”ê°€

</code></pre></div></div>

<p>ë‚˜ëŠ” ì´ 2ê°œì˜ ì»¤ë°‹ì„ í–ˆê³ <br />
ì²«ë²ˆì§¸ ì»¤ë°‹ì€ <code class="language-plaintext highlighter-rouge">7525f9a220700884994e53e90babc345d199e10e</code>ë¡œ<br />
<code class="language-plaintext highlighter-rouge">7525f9a</code>ì™€ ê°™ì´ 7ìë¦¬ë¡œ í‘œí˜„í•  ìˆ˜ë„ ìˆë‹¤.</p>

<p>ë‘ë²ˆì§¸ ì»¤ë°‹ì€ <code class="language-plaintext highlighter-rouge">cd49c93bd4905f6d1f4a19d8438ab4c4d6b6d15b</code>ì´ë‹¤.</p>

<p>ì´ ë‘ê°€ì§€ ì»¤ë°‹ì„ ì´ì œ <code class="language-plaintext highlighter-rouge">feat/BE/ljh</code>ë¼ëŠ”<br />
ë¸Œëœì¹˜ë¡œ ì˜®ê¸°ê³  ì‹¶ì€ ìƒí™©ì´ë‹¤.</p>

<p><br /></p>

<h3 id="-cherry-pick-ì‚¬ìš©í•˜ì—¬-ì»¤ë°‹-ì˜®ê¸°ê¸°">ğŸ“Œ Cherry-Pick ì‚¬ìš©í•˜ì—¬ ì»¤ë°‹ ì˜®ê¸°ê¸°</h3>

<p>ë¨¼ì € ë¸Œëœì¹˜ ì²´í¬ì•„ì›ƒì„ ì§„í–‰í•˜ì.</p>
<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>git checkout feat/BE/ljh
</code></pre></div></div>

<p><br /></p>

<p>ì´ì œ í•˜ë‚˜ì”© Cherry-Pick ëª…ë ¹ì–´ë¥¼ ì‚¬ìš©í•´ ì˜®ê²¨ë³´ì</p>
<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>git cherry-pick cd49c93bd4905f6d1f4a19d8438ab4c4d6b6d15b
</code></pre></div></div>
<p>ë¥¼ ì…ë ¥í•´ì£¼ë©´ë˜ê³ , ë§Œì•½ ì‹¤í–‰í•˜ì˜€ì„ë•Œ ì •ìƒì ìœ¼ë¡œ <br />
ì™„ë£Œê°€ë˜ë©´ ì´ìƒì´ ì—†ê² ì§€ë§Œ, í˜¹ì‹œë‚˜</p>

<p>ì•„ë˜ì™€ ê°™ì´ conflictê°€ ë°œìƒí•˜ê²Œ ë  ìˆ˜ ìˆë‹¤.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Auto-merging server/src/main/java/codestates/frogroup/indiego/domain/member/entity/dto/MemberDto.java
CONFLICT <span class="o">(</span>content<span class="o">)</span>: Merge conflict <span class="k">in </span>server/src/main/java/codestates/frogroup/indiego/domain/member/entity/dto/MemberDto.java
error: could not apply cd49c93... <span class="c">#3 - LoginResponseDto ì¶”ê°€</span>
hint: After resolving the conflicts, mark them with
hint: <span class="s2">"git add/rm &lt;pathspec&gt;"</span>, <span class="k">then </span>run
hint: <span class="s2">"git cherry-pick --continue"</span><span class="nb">.</span>
hint: You can instead skip this commit with <span class="s2">"git cherry-pick --skip"</span><span class="nb">.</span>
hint: To abort and get back to the state before <span class="s2">"git cherry-pick"</span>,
hint: run <span class="s2">"git cherry-pick --abort"</span><span class="nb">.</span>
</code></pre></div></div>
<p>hint ì•ˆë‚´ì— ë”°ë¼ ì§„í–‰í• ìˆ˜ê°€ ìˆë‹¤. <br />
ìš°ì„  CONFLICTê°€ ë°œìƒí•œ ë¶€ë¶„ì„ ë¡œê·¸ë¡œ ì•Œë ¤ì¤€ë‹¤.<br />
ë‚˜ì™€ ê°™ì€ ê²½ìš°ëŠ” <code class="language-plaintext highlighter-rouge">MemberDto</code> ì¶©ëŒì´ ë‚˜ì™”ë‹¤ê³  ìœ„ì— ë‚˜ì™€ìˆë‹¤.</p>

<p>í•´ë‹¹ í´ë˜ìŠ¤ë¡œ ê°€ë©´ ì¸í…”ë¦¬ì œì´ì—ì„œ ì¶©ëŒë‚œ ë¶€ë¶„ì„ í‘œì‹œí•´ì¤€ë‹¤. <br />
ì¶©ëŒë‚œ ë¶€ë¶„ì„ ì½”ë“œë¥¼ ìˆ˜ì •í•´ ìš°ì„  í•´ê²°í•´ì£¼ê³ <br />
<code class="language-plaintext highlighter-rouge">git add .</code>ë¥¼ ì§„í–‰í›„ <code class="language-plaintext highlighter-rouge">git cherry-pick --continue</code>ë¥¼ ì§„í–‰í•˜ë©´ëœë‹¤.<br />
ë§ˆì¹˜ rebaseí•˜ëŠ” ê³¼ì •ê³¼ ë§¤ìš° í¡ì‚¬í•˜ë‹¤.</p>

<p>ì¶©ëŒë¶€ë¶„ì´ ì „ë¶€ í•´ê²°ë˜ì—ˆìœ¼ë©´ nanoí¸ì§‘ê¸°ë¡œ ì €ì¥í• ê±´ì§€ë¥¼ ë¬¼ì–´ë³¸ë‹¤.<br />
ctrl + s, ctrl + x ë¥¼ ëˆŒëŸ¬ì¤˜ ì €ì¥ì„í•´ì¤€ë‹¤.</p>

<p><br /></p>

<p>ì™„ë£Œë¥¼ í–ˆë‹¤ë©´.. <code class="language-plaintext highlighter-rouge">git log</code>ë¥¼ ì…ë ¥í•˜ë©´ <br />
<code class="language-plaintext highlighter-rouge">develop</code>ë¸Œëœì¹˜ì— ìˆë˜ ì»¤ë°‹ì´ <code class="language-plaintext highlighter-rouge">feat/BE/ljh</code>ë¡œ ë³µì‚¬ëœ ê²ƒì„ <br />
ë³¼ ìˆ˜ ìˆì„ ê²ƒì´ë‹¤ !!!!!</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>commit a5d3ef8d6110d838c896ba3125c351eb5b611623 <span class="o">(</span>HEAD -&gt; feat/BE/ljh<span class="o">)</span>
Author: Lee JaeHyeok &lt;dhfif718@gmail.com&gt;
Date:   Thu Jan 12 17:58:46 2023 +0900

    1. ë¡œê·¸ì¸ ì‹œ ì‘ë‹µ ê°€ëŠ¥í•˜ë„ë¡ ResponseDto ì¶”ê°€

</code></pre></div></div>

<p>í•´ì‰¬ê°’ì„ ë³´ì•„í•˜ë‹ˆ ë³µì‚¬ë³´ë‹¤ëŠ” ìƒˆë¡œ ë§Œë“¤ì–´ì§„ ëŠë‚Œì´ë‹¤. <br />
ì´ë ‡ê²Œ ì˜®ê¸°ë ¤ê³ í•˜ëŠ” ì»¤ë°‹ì„ ëª¨ë‘ ì˜®ê¸°ë©´ ëœë‹¤.</p>

<p><br /></p>

<h3 id="-ì˜ëª»ì˜¬ë¦°-ì»¤ë°‹-ì‚­ì œ">ğŸ“Œ ì˜ëª»ì˜¬ë¦° ì»¤ë°‹ ì‚­ì œ</h3>

<p><code class="language-plaintext highlighter-rouge">develop</code> ë¸Œëœì¹˜ì— ì˜ëª»ì˜¬ë¦° ì»¤ë°‹ì„ ì‚­ì œí•´ì¤˜ì•¼í•œë‹¤. <br />
Cherry-Pickì„ í–ˆë‹¤ê³  ìë™ìœ¼ë¡œ ì‚­ì œê°€ë˜ì§„ ì•ŠëŠ”ë‹¤.</p>

<p><code class="language-plaintext highlighter-rouge">develop</code> ë¸Œëœì¹˜ë¡œ ì²´í¬ì•„ì›ƒì„í•˜ì—¬</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>git reset HEAD^
</code></pre></div></div>

<p>ë¥¼ ì…ë ¥í•˜ë©´ ê°€ì¥ ìµœê·¼ì¸ HEADì˜ ì»¤ë°‹ì´ ì‚­ì œë˜ì–´ì§„ë‹¤.</p>

<p>í˜¹ì‹œë‚˜ ì¸í…”ë¦¬ì œì´ë¥¼ ì‚¬ìš©í•˜ê³  ìˆë‹¤ë©´<br />
í•˜ë‹¨ì— Gitì— ë“¤ì–´ê°€ì„œ</p>

<p><img src="https://user-images.githubusercontent.com/95069395/212040809-3a14a459-78b8-42a4-9558-b42c83cd9f30.png" alt="image" class="align-left" style="max-width: 100%" /></p>

<p>ì‚­ì œí•˜ë ¤ê³  í•˜ëŠ” ì»¤ë°‹ì— ì˜¤ë¥¸ìª½ ë§ˆìš°ìŠ¤ë¥¼ í´ë¦­í•´<br />
Drop Commitì„ ëˆŒëŸ¬ì£¼ë©´ ëœë‹¤.</p>

<p><br />
<br />
<br /></p>]]></content><author><name>LEE JAEHYEOK</name></author><category term="GIT" /><category term="GIT" /><category term="GITHUB" /><summary type="html"><![CDATA[ğŸ“Œ Cherry-Pick]]></summary></entry><entry><title type="html">Git ì´ì „ Commit Message ìˆ˜ì •í•˜ê¸°</title><link href="http://localhost:4000/git/2023/01/12/git-commitmessage.html" rel="alternate" type="text/html" title="Git ì´ì „ Commit Message ìˆ˜ì •í•˜ê¸°" /><published>2023-01-12T00:00:00+09:00</published><updated>2023-01-12T00:00:00+09:00</updated><id>http://localhost:4000/git/2023/01/12/git-commitmessage</id><content type="html" xml:base="http://localhost:4000/git/2023/01/12/git-commitmessage.html"><![CDATA[<h3 id="-clië¡œ-ë³€ê²½">ğŸ“Œ CLIë¡œ ë³€ê²½</h3>

<p>ë§Œì•½ ì´ì „ì— ì»¤ë°‹ë©”ì„¸ì§€ë¥¼ ì‹¤ìˆ˜ë¡œ ì˜ëª» ì˜¬ë ¸ë‹¤ê³ í•  ê²½ìš°</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>git rebase <span class="nt">-i</span> HEAD~3        
</code></pre></div></div>
<p>ë¥¼ ì…ë ¥í•´ì„œ ì»¤ë°‹ë©”ì„¸ì§€ê°€ ìˆ˜ì •ì´ ê°€ëŠ¥í•˜ë‹¤. <br />
<code class="language-plaintext highlighter-rouge">~3</code>ì€ ê°€ì¥ìµœì‹ ë¶€í„° ìˆ˜ì •í•˜ê³ ìí•˜ëŠ” ì»¤ë°‹ ìˆ˜ëŸ‰ì´ë‹¤</p>

<p>Pickì´ë¼ê³  ë˜ì–´ìˆëŠ” ë¶€ë¶„ì„ rewordë¡œ ë³€ê²½í•œ ë‹¤ìŒ <br />
ì»¤ë°‹ë©”ì„¸ì§€ë¥¼ ìˆ˜ì •í•´ì£¼ë©´ ë°˜ì˜ëœë‹¤.</p>

<p><br /></p>

<h3 id="-intellijë¡œ-ë³€ê²½">ğŸ“Œ IntelliJë¡œ ë³€ê²½</h3>

<p>IDEë¥¼ ì‚¬ìš©í•˜ë©´ vi,nano í¸ì§‘ê¸°ë¥¼ ì´ìš©í•˜ëŠ” ê²ƒë³´ë‹¤<br />
í›¨ì”¬ ìˆ˜ì›”í•˜ê²Œ ì‘ì—…í•  ìˆ˜ ìˆë‹¤.</p>

<p>í•˜ë‹¨ì˜ Git íƒ­ì—ì„œ ì»¤ë°‹ë©”ì„¸ì§€ë¥¼ ë³€ê²½í•˜ê³ ìí•˜ëŠ”<br />
ì»¤ë°‹ì„ ëˆŒëŸ¬ ì˜¤ë¥¸ìª½ í´ë¦­ì„í•˜ì</p>

<p><img src="https://user-images.githubusercontent.com/95069395/212041524-5d07ce20-07d1-4299-96e0-866fc2857dfb.png" alt="image" class="align-left" style="max-width: 100%" /></p>

<p><code class="language-plaintext highlighter-rouge">Interactively Rebase from Here</code>ë¥¼ ëˆŒëŸ¬ì£¼ì</p>

<p><img src="https://user-images.githubusercontent.com/95069395/212041533-03319280-6850-4b08-8cfe-f8918c7013d8.png" alt="image" class="align-left" style="max-width: 100%" /></p>

<p>ê·¸ëŸ¬ë©´ Rebasing Commits íŒì—…ì´ ë…¸ì¶œë˜ëŠ”ë° <br />
ì›í•˜ëŠ” ì»¤ë°‹ ë©”ì‹œì§€ ì´ë¦„ìœ¼ë¡œ ë³€ê²½í•œ ë‹¤ìŒì—</p>

<p>START REBASINGì„ ëˆŒëŸ¬ì£¼ë©´ <br />
ë³€ê²½ëœ ì»¤ë°‹ ë©”ì„¸ì§€ë¡œ ë°˜ì˜ëœ ëª¨ìŠµì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.</p>

<p><br />
<br />
<br /></p>]]></content><author><name>LEE JAEHYEOK</name></author><category term="GIT" /><category term="GIT" /><category term="GITHUB" /><summary type="html"><![CDATA[ğŸ“Œ CLIë¡œ ë³€ê²½]]></summary></entry><entry><title type="html">Redis CLI ì„¤ì¹˜ ë° ì‚¬ìš©ë°©ë²•</title><link href="http://localhost:4000/db/2023/01/08/db-redissetting.html" rel="alternate" type="text/html" title="Redis CLI ì„¤ì¹˜ ë° ì‚¬ìš©ë°©ë²•" /><published>2023-01-08T00:00:00+09:00</published><updated>2023-01-08T00:00:00+09:00</updated><id>http://localhost:4000/db/2023/01/08/db-redissetting</id><content type="html" xml:base="http://localhost:4000/db/2023/01/08/db-redissetting.html"><![CDATA[<p><strong>Redis</strong>ëŠ” <strong>Remote Dictionary Server</strong>ì˜ ì•½ìë¡œ <br />
<code class="language-plaintext highlighter-rouge">key:value</code>ë¡œ ê°’ì„ ì €ì¥í•˜ëŠ” NoSQLì´ë‹¤. <br />
ì¸-ë©”ëª¨ë¦¬(In-Memory) ë°ì´í„°ë² ì´ìŠ¤ë¡œ ë©”ëª¨ë¦¬ì— ë°ì´í„°ê°€ ì €ì¥ëœë‹¤..</p>

<p><img src="https://user-images.githubusercontent.com/95069395/211693910-59b5da13-847e-4313-aed9-ce48a76c7434.png" alt="image" class="align-left" style="max-width: 100%" /></p>

<p>ë¹„ê´€ê³„í˜• ë°ì´í„° ë² ì´ìŠ¤ ê´€ë¦¬ ì‹œìŠ¤í…œ(DBMS)ì´ë©°<br />
ìºì‹œì„œë²„ë¡œ ë§ì´ ì´ìš©ëœë‹¤.  <br />
ìºì‹œëŠ” í•œë²ˆ ì½ì–´ì˜¨ ë°ì´í„°ë¥¼ ì„ì˜ì˜ ê³µê°„ì— ì €ì¥í•˜ì—¬<br />
ë‹¤ìŒì— ì½ì„ ë•ŒëŠ” ë¹ ë¥´ê²Œ ê²°ê³¼ê°’ì„ ë°›ì„ ìˆ˜ ìˆë„ë¡ ë„ì™€ì£¼ëŠ” ê³µê°„ì´ë‹¤.</p>

<p><br /></p>

<p>í•™ìŠµì˜ ëª©ì ì€ JWT Refresh Token ê´€ë¦¬ ëª©ì ê³¼<br />
ì¢‹ì•„ìš”,í˜¹ì€ ì¡°íšŒìˆ˜ ê°™ì€ ìì£¼ ì—…ë°ì´íŠ¸ê°€ ì¼ì–´ë‚˜ëŠ” ë°ì´í„°ë¥¼<br />
RDBMSì—ì„œ ê³„ì† ì¿¼ë¦¬ë¥¼ ë‚ ë¦¬ê³  ì‹¶ì§€ ì•Šê¸°ë•Œë¬¸ì´ì˜€ë‹¤.</p>

<p>ë³¸ê²©ì ìœ¼ë¡œ ì•Œì•„ë³´ê¸°ì „ì— CLIë¥¼ í†µí•´ ì„¤ì¹˜ì™€ ê¸°ë³¸ì ì¸ ëª…ë ¹ì–´ë¥¼ ìµí˜€ë³´ì</p>

<p><br /></p>

<h3 id="-redis-ì„¤ì¹˜">ğŸ“Œ Redis ì„¤ì¹˜</h3>

<p>ë§¥ì„ ì‚¬ìš©í•˜ëŠ” ìœ ì €ë¼ë©´ brewë¥¼ ì‚¬ìš©í•  í…ë°</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>brew <span class="nb">install </span>redis
</code></pre></div></div>
<p>ë¥¼ ì…ë ¥í•˜ë©´ redis ì„¤ì¹˜ê°€ ê°€ëŠ¥í•˜ë‹¤.</p>

<p><br /></p>

<h3 id="-redis-ì‹œì‘-ì¢…ë£Œ">ğŸ“Œ Redis ì‹œì‘, ì¢…ë£Œ</h3>

<p>ê¸°ë³¸ ì ì¸ redis ì‹œì‘ ëª…ë ì–´ì´ë‹¤.</p>
<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>brew services start redis
</code></pre></div></div>
<p><code class="language-plaintext highlighter-rouge">==&gt; Successfully started redis (label: homebrew.mxcl.redis)</code><br />
ì™€ ê°™ì´ í‘œí˜„ë˜ë©´ ì •ìƒì ìœ¼ë¡œ ì‹¤í–‰ ëœ ê²ƒì´ë‹¤.</p>

<p><br /></p>

<p>ì‹œì‘ì´ì™„ë£Œë˜ê³  ì•„ë˜ ëª…ë ¹ì–´ë¥¼ ì…ë ¥í•˜ë©´</p>
<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>redis-cli
</code></pre></div></div>
<p><code class="language-plaintext highlighter-rouge">127.0.0.1:6379&gt;</code>ê³¼ ê°™ì´ <code class="language-plaintext highlighter-rouge">localhost:6379</code>ë¡œ<br />
ì ‘ì†ë˜ì—ˆë‹¤ëŠ” í‘œì‹œê°€ ë‚˜ì˜¬ ê±°ë‹¤.</p>

<p><br /></p>

<p>redis ì¢…ë£Œ, ì¬ì‹œì‘ ëª…ë ì–´ì´ë‹¤.</p>
<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>brew services stop redis
</code></pre></div></div>
<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>brew services restart redis
</code></pre></div></div>

<p>nginx, httpd ë“± ì‹œì‘ëª…ë ¹ì–´ê°€ ë¹„ìŠ·í•˜ê³  ìµìˆ™í•  ê²ƒì´ë‹¤.</p>

<p><br /></p>

<h3 id="-redis-crud">ğŸ“Œ Redis CRUD</h3>

<p><strong>1). í˜„ì¬ì˜ í‚¤ê°’ì„ í™•ì¸</strong></p>
<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>127.0.0.1:6379&gt; keys <span class="k">*</span>
</code></pre></div></div>

<p><br /></p>

<p><strong>2). key / value í˜•íƒœë¡œ ì €ì¥ (í•œê°œë§Œ)</strong></p>
<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>127.0.0.1:6379&gt; <span class="nb">set test </span>a
</code></pre></div></div>
<p>test : key ê°’ì´ëœë‹¤.<br />
a : value ê°’ì´ëœë‹¤.<br />
ì¦‰ testë¼ëŠ” í‚¤ì˜ aë¼ëŠ” valueë¡œ ì €ì¥!</p>

<p><br /></p>

<p><strong>3). key / value í˜•íƒœë¡œ ì €ì¥ (ì—¬ëŸ¬ê°œ í•œë²ˆì—)</strong></p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>127.0.0.1:6379&gt; mset test1 a test2 b
</code></pre></div></div>
<p>ì™€ ê°™ì´ ì…ë ¥í•˜ê²Œ ë  ê²½ìš°, test1,test2 ë¼ëŠ” í‚¤ê°€ ìƒê¸°ê³ <br />
a,bë¼ëŠ” valueê°€ ìƒê¸´ë‹¤.</p>

<p><br /></p>

<p><strong>4). keyì˜ valueë¥¼ ì¡°íšŒ</strong></p>
<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>127.0.0.1:6379&gt; get <span class="nb">test</span>
</code></pre></div></div>
<p>testë¼ëŠ” í‚¤ì˜ valueë¥¼ ì¡°íšŒí•œë‹¤. <br />
ìœ„ì—ì„œ aë¡œ ì§€ì •í–ˆìœ¼ë‹ˆ aë¡œ ì¶œë ¥ëœë‹¤.</p>

<p><br /></p>

<p><strong>5). ì†Œë©¸ì‹œê°„ ì§€ì •í•´ì„œ ì €ì¥í•˜ê¸°</strong></p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>127.0.0.1:6379&gt; setex <span class="nb">test </span>10 a
</code></pre></div></div>
<p>ì™€ ê°™ì´ ì§€ì •í•˜ê²Œ ë  ê²½ìš°, testë¼ëŠ” í‚¤ê°’ì€<br />
10ì´ˆë™ì•ˆë§Œ ì¡´ì¬í•˜ê²Œ ëœë‹¤.<br />
10ì´ˆí›„ì— ìë™ìœ¼ë¡œ ì†Œë©¸ë˜ë©° ì¡°íšŒë¥¼í•´ë„ ì°¾ì„ ìˆ˜ ì—†ë‹¤.</p>

<p><br /></p>

<p><strong>6). í‚¤ì™€ ê°’ ì‚­ì œí•˜ê¸°</strong></p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>127.0.0.1:6379&gt; del <span class="nb">test</span>
</code></pre></div></div>
<p>í‚¤ê°’ì„ ì…ë ¥í•´ ë§Œë“¤ì–´ë‘” í‚¤ë¥¼ ì‚­ì œí•  ìˆ˜ ìˆë‹¤. <br />
ì‚­ì œê°€ ì™„ë£Œë˜ë©´ <code class="language-plaintext highlighter-rouge">(integer) 1</code>ì™€ ê°™ì´ í‘œì‹œëœë‹¤.</p>

<p><br /></p>

<p><strong>7). ëª¨ë“  í‚¤ì™€ ê°’ ì‚­ì œí•˜ê¸°</strong></p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>127.0.0.1:6379&gt; flushall
</code></pre></div></div>
<p>ëª¨ë“  í‚¤ì™€ ê°’ì„ ì‚­ì œí•´ì£¼ëŠ” ëª…ë ¹ì–´ë‹¤</p>

<p><br /></p>

<p><strong>8). í‚¤ì˜ ì†Œë©¸ ì‹œê°„ í™•ì¸í•˜ê¸°</strong></p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>127.0.0.1:6379&gt; ttl <span class="nb">test</span>
</code></pre></div></div>
<p>ttl ë‹¤ìŒì— í‚¤ê°’ì„ ì…ë ¥í•˜ë©´ í˜„ì¬ ë‚¨ì€ ì‹œê°„ì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤. <br />
ì´ˆë‹¨ìœ„ë¡œ í‘œì‹œë˜ë©°, ê³„ì† ì…ë ¥í•˜ë©´ ì´ˆê°€ ì¤„ì–´ë“œëŠ”ê±¸ ë³¼ ìˆ˜ ìˆë‹¤.</p>

<p><br /></p>

<h3 id="-redis-ì—¬ëŸ¬ê°œì˜-í•„ë“œ">ğŸ“Œ Redis ì—¬ëŸ¬ê°œì˜ í•„ë“œ</h3>

<p>redisì˜ hashes ìë£Œêµ¬ì¡°ì—ëŠ”<br />
Keyì™€ Field ìš©ì–´ê°€ ë‚˜ì˜¨ë‹¤.</p>

<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Hash Key1
     á„‚ Hash Sub Key1 (=Field1)
     á„‚ Hash Sub Key2 (=Field2)
</code></pre></div></div>
<p>ì™€ ê°™ì€ êµ¬ì¡°ë¡œ í•˜ë‚˜ì˜ Keyê°’ì— ì—¬ëŸ¬ê°€ì§€<br />
Fieldë¥¼ ì €ì¥ì„ í• ìˆ˜ ìˆë‹¤.</p>

<p><br /></p>

<p><strong>1). í•˜ë‚˜ì˜ í‚¤ë¡œ ì—¬ëŸ¬ê°œ í•„ë“œ ì €ì¥</strong></p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>127.0.0.1:6379&gt; hset dhfif718@naver.com token <span class="s2">"value1"</span> like <span class="s2">"10"</span>
</code></pre></div></div>
<p>HSET ëª…ë ¹ì–´ë¥¼ ì´ìš©í•  ìˆ˜ ìˆë‹¤.</p>

<p>dhfif718@naver.com ë¼ëŠ” Keyê°’ì—</p>

<p>key : token / value : value1<br />
key : like / value : 10<br />
ì´ë¼ëŠ” í•„ë“œë¡œ ì €ì¥ì´ ë˜ì–´ì§„ ê²ƒì´ë‹¤.</p>

<p>ì–´ë–»ê²Œ ë³´ë©´ dhfif718@naver.com Keyì˜ í•„ë“œëŠ” tokenê³¼ likeê°€ ë˜ëŠ” ì…ˆì´ë‹¤.</p>

<p><br /></p>

<p><strong>2). ì¡°íšŒí•˜ëŠ” ë°©ë²•</strong></p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>127.0.0.1:6379&gt; hget dhfif718@naver.com like
</code></pre></div></div>

<p>ì¡°íšŒë¥¼í• ë•Œ ìœ„ì™€ ê°™ì€ ë°©ë²•ìœ¼ë¡œ ì¡°íšŒí•˜ê²Œë˜ë©´<br />
10ì´ë¼ëŠ” ê°’ì´ ì¶œë ¥ë˜ê²Œ ë˜ì–´ì§„ë‹¤.</p>

<p>ë§Œì•½ ì „ì²´ í•„ë“œë¥¼ ì¡°íšŒí•˜ê³  ì‹¶ë‹¤ë©´</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>127.0.0.1:6379&gt; hgetall dhfif718@naver.com
</code></pre></div></div>
<p>hgetallì„ keyê°’ê³¼ ì…ë ¥í•˜ë©´ ì „ì²´ ì¡°íšŒê°€ ëœë‹¤.</p>
<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>1<span class="o">)</span> <span class="s2">"token"</span>
2<span class="o">)</span> <span class="s2">"value1"</span>
3<span class="o">)</span> <span class="s2">"like"</span>
4<span class="o">)</span> <span class="s2">"10"</span>
</code></pre></div></div>
<p>ì™€ ê°™ì€ ë°©ì‹ìœ¼ë¡œ ì¶œë ¥ë˜ì–´ì§„ë‹¤.</p>

<p><br /></p>

<p><strong>3). ì‚­ì œí•˜ëŠ” ë°©ë²•</strong></p>

<p>ë§ˆì§€ë§‰ìœ¼ë¡œ ì‚­ì œí•˜ëŠ” ë°©ë²•ì´ë‹¤.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>127.0.0.1:6379&gt; hdel dhfif718@naver.com token like
</code></pre></div></div>

<p>ì—¬ëŸ¬ê°œì˜ í•„ë“œë¥¼ í•œë²ˆì— ì‚­ì œí•  ìˆ˜ë„ ìˆê³ <br />
í•˜ë‚˜ì”© ì§€ì •í•´ì„œ ì‚­ì œí•  ìˆ˜ë„ ìˆë‹¤.</p>

<p><br /><br />
<br /></p>

<p>âœ¨ ì°¸ê³  ë¸”ë¡œê·¸ <br />
<a href="https://freeblogger.tistory.com/10">Redis ì°¸ê³  ë ˆí¼ëŸ°ìŠ¤ 1</a>, <a href="https://wlswoo.tistory.com/44">Redis ì°¸ê³  ë ˆí¼ëŸ°ìŠ¤ 2</a>, <a href="https://m.blog.naver.com/PostView.naver?isHttpsRedirect=true&amp;blogId=wideeyed&amp;logNo=221428664697">Redis Hash ì°¸ê³  ë ˆí¼ëŸ°ìŠ¤</a>, <a href="https://server-talk.tistory.com/472">Redis ìš°ë¶„íˆ¬ ì„¤ì¹˜ ë ˆí¼ëŸ°ìŠ¤</a></p>

<p><br />
<br /></p>]]></content><author><name>LEE JAEHYEOK</name></author><category term="DB" /><category term="DB" /><category term="redis" /><summary type="html"><![CDATA[RedisëŠ” Remote Dictionary Serverì˜ ì•½ìë¡œ key:valueë¡œ ê°’ì„ ì €ì¥í•˜ëŠ” NoSQLì´ë‹¤. ì¸-ë©”ëª¨ë¦¬(In-Memory) ë°ì´í„°ë² ì´ìŠ¤ë¡œ ë©”ëª¨ë¦¬ì— ë°ì´í„°ê°€ ì €ì¥ëœë‹¤..]]></summary></entry></feed>