<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="4.3.0">Jekyll</generator><link href="http://localhost:4000/feed.xml" rel="self" type="application/atom+xml" /><link href="http://localhost:4000/" rel="alternate" type="text/html" /><updated>2022-10-23T18:48:11+09:00</updated><id>http://localhost:4000/feed.xml</id><title type="html">LeeJellan</title><subtitle>안녕하세요!🙂 IT,여행,기타 등 기록을 남기기위한 블로그 입니다 !</subtitle><author><name>LEE JAEHYEOK</name></author><entry><title type="html">Jekyll GitHub Page 댓글, 파비콘 꾸미기</title><link href="http://localhost:4000/jekyll/2022/10/22/it-jekyll-comment&favicon.html" rel="alternate" type="text/html" title="Jekyll GitHub Page 댓글, 파비콘 꾸미기" /><published>2022-10-22T00:00:00+09:00</published><updated>2022-10-22T00:00:00+09:00</updated><id>http://localhost:4000/jekyll/2022/10/22/it-jekyll-comment&amp;favicon</id><content type="html" xml:base="http://localhost:4000/jekyll/2022/10/22/it-jekyll-comment&amp;favicon.html"><![CDATA[<h1 id="jekyll-테마-적용">Jekyll 테마 적용</h1>

<p><br /></p>

<p><img src="https://jekyllrb.com/img/octojekyll.png" alt="example image" /></p>

<p><br /></p>

<p>오늘은 Github Page를 통해 첫번째로 하는 포스팅이다.<br />
MarkDown 문법도 어색하고 모든게 서툴지만 천천히 블로그 개설 준비를 하려한다.</p>

<p>Jekyll 이란?<br />
텍스트 변환 엔진으로, 마크업 언어로 작성하면 미리 정의해놓은 규칙에따라 정적 웹사이트를 만들어준다.<br />
우리가 직접 테마를 만들 수도 있지만,, 아직 초보 개발자인 나한테 모든게 어렵게 느껴진다.<br />
그 첫걸음을 하기위해 우선 다른 개발자분들이 만들어 놓은 테마를 이용할 생각이다.</p>

<p>나는 그중에서 yat이라는 테마를 사용하기로 했다.<br />
( <a href="https://jekyll-themes.com/jekyll-theme-yat/">Jekyll yat 테마 사이트</a>, <a href="https://github.com/jeffreytse/jekyll-theme-yat">Jekyll yat 테마 제작자 github</a> )</p>

<p>현재 내가 사용하고 있는 블로그의 테마다.<br />
Jekyll관련 셋업이랑 테마를 Git Page에 적용하는 방법<br />
로컬 환경에서 작업하는법 등은 다른글을 통해 작성해 보겠다.</p>

<p><br /></p>

<h3 id="jekyll-yat-테마-utterances-댓글-기능-추가">Jekyll yat 테마 Utterances 댓글 기능 추가</h3>

<p><img src="https://ifh.cc/g/BpXV1h.png" alt="example image" /><br />
위와 같은 댓글 기능을 추가하는 방법이다.</p>

<p>위에서 다운 받은 yat 테마는 기본적으로 댓글 기능이 따로 있지는 않는다.<br />
하지만 개발자가 여러가지 기능을 사용할 수 있게 미리 개발을 해두어서 우리는<br />
그 기능을 지원하는 것만 설정하면 댓글을 사용할 수 있다.</p>

<p>Disqus comments, Gitment comments, Utterances comments<br />
이렇게 3가지 댓글 기능을 지원해주고 있고, 이중에서 나는 Utterances 코맨트<br />
기능을 사용하려한다. 아래를 쭉 따라해보자</p>

<p><br /></p>

<p><img src="https://ifh.cc/g/YV9G0L.png" alt="example image" /><br />
GitHub에 Repository를 하나 생성해야한다.<br />
이름은 아무렇게나 지어도 상관없다. 중요한점은 public로 만들어야한다.</p>

<p><br /></p>

<p><img src="https://ifh.cc/g/C0C4x3.png" alt="example image" /><br />
Repository를 만들었으면, Quick Setup화면이 보여질 텐데<br />
<span style="color:#0066CC"><strong>‘creating a new file’</strong></span>을 클릭 !</p>

<p><br /></p>

<p><img src="https://ifh.cc/g/nskSGt.png" alt="example image" /><br />
클릭을 하면 위와같은 화면을넘어오는데<br />
빨간색 박스의 내용을 그대로 입력해준다.<br />
origins의 주소에는 내가 댓글 기능을 추가할 blog를 추가하면된다.<br />
나는 내 Github Page를 추가 !</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{
  "origins": ["https://mycatlikeschuru.github.io"]
}
</code></pre></div></div>

<p><br /></p>

<p><img src="https://ifh.cc/g/HHFBBK.png" alt="example image" /><br />
<a href="https://github.com/apps/utterances">utterances</a> 사이트를 접속해 install을 눌러 주면<br />
위와 같은 화면이 나오게되는데 Only select repositories에서<br />
아까 위에서 만들었던 Repository CommentTest를 선택해주고<br />
Rquest를 눌러 주면 완료. 이 이후에 따로 페이지가 발생하게 되는데<br />
무시해도 상관 없다.</p>

<p><br /></p>

<p><img src="https://ifh.cc/g/Cbkygc.png" alt="example image" /><br />
나는 IntelliJ를 통해서 MarkDown을 작성 중이고<br />
대부분 VScode를 이용해서 작성하는 것 같다.<br />
여하튼,, 작성 툴을 이용해 _config.yml 설정파일에서</p>

<p>utterances 항목을 찾아주면된다.<br />
아마 처음에 테마를 받으면 # 으로 주석처리가 되어있을 것이다.<br />
주석 처리를 풀어준 다음에. 오른쪽의 네모박스와 같이 입력해주면 되는데<br />
여기서 repo -&gt; 이부분만 아까 우리가 만들어준 repository로 적용하면<br />
<span style="color:#F04965">(<em>주의: utterances 밑에 repo,issue_term 등등,, 맨앞을 공백으로 해야 적용됨</em>)</span></p>

<p><br /></p>

<p><img src="https://ifh.cc/g/M2V3ps.png" alt="example image" /><br />
그렇게되면 이렇게 ! GitHub처럼 댓글을 사용할 수 있는<br />
기능이 이렇게 똭! 하고 사용이 가능합니다~<br />
주로 우리가 올리는 글 위주가 IT관련이라 GitHub로그인이 필요한<br />
utterances를 통해서 댓글 기능을 추가해보았다~</p>

<p>참고로 disqus도 적용해 보았는데 별다른 오류 없이 잘동작되었었다.</p>

<p><br /></p>

<h3 id="jekyll-yat-파비콘-추가">Jekyll yat 파비콘 추가</h3>

<p><img src="https://ifh.cc/g/pgWVFk.jpg" alt="example image" /><br />
파비콘(favicon)은 우리가 웹사이트에서 보면</p>

<p><img src="https://ifh.cc/g/xAF0Qj.png" align="left" />
<br /></p>

<p>위와 같이 웹사이트 홈페이지의 이름과 같이 나오는 사진이다.</p>

<p>yat 테마는 favicon을 적용하면 우리 블로그 왼쪽 위에<br />
프로필 사진 마냥 귀엽게 표시도되고 웹 TAB에서도 파비콘 아이콘이<br />
적용되는 모습을 볼 수 있다.</p>

<p><br /></p>

<p><img src="https://ifh.cc/g/L2lDHM.png" alt="example image" /><br />
파비콘 적용 방법은 정말 매우 간단하다.<br />
_config.yml 파일에서 favicon: ““이라고 되어있는 부분에<br />
자원 경로를 넣어주면된다. 나와 같은 경우는 assets의 images 폴더에<br />
내 파비콘 사진을 두었고 그 경로를 오른쪽과 같이 지정해서<br />
파비콘이 정상적으로 적용된 모습을 확인 할 수 있었다.</p>

<hr />

<p>오늘은 Jekyll 테마 중 yat이라는 테마를 커스터 마이징하는<br />
글을 올려 보았다. 기존에 Tistory를 이용할 때는<br />
그냥 이미지와 글,코드 올리는 것들이 간단했는데<br />
아무래도 Markdown언어로 작성하다보니 확실히 시간소요가 더 되는 것 같다.<br />
그래도 앞으로 사용하다보면 빨라질거라 생각하며 첫 포스팅을 마친다. 😃</p>]]></content><author><name>LEE JAEHYEOK</name></author><category term="Jekyll" /><category term="Jekyll" /><category term="yat" /><category term="테마적용" /><category term="GitHub Pages" /><summary type="html"><![CDATA[Jekyll 테마 적용]]></summary></entry><entry><title type="html">TIL) Spring DTO</title><link href="http://localhost:4000/til/2022/10/21/til.html" rel="alternate" type="text/html" title="TIL) Spring DTO" /><published>2022-10-21T00:00:00+09:00</published><updated>2022-10-21T00:00:00+09:00</updated><id>http://localhost:4000/til/2022/10/21/til</id><content type="html" xml:base="http://localhost:4000/til/2022/10/21/til.html"><![CDATA[<p>section 3가 시간한 첫번째 금요일</p>

<p><img src="https://ifh.cc/g/lfoBC7.gif" align="left" /></p>

<p><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /></p>

<p>나태해지는 요일이랄까..?<br />
주말에 공부는할건데 금요일이되면 그냥 설렌다<br />
오늘은 예전부터 미뤄왔던 Github IO 블로그를 꾸미고있다…<br />
아직 너무나 생소해 조금 시간이 걸릴 것 같다.<br />
IT기술 블로그와 옛날부터 해온 여행블로그를 전부 옮기고 싶다.</p>

<hr />

<p>오늘은 DTO에 대해서 공부했다.<br />
유효성 검증과 같이 공부한걸 적어보려한다.</p>

<h3 id="dto"><strong>DTO</strong></h3>
<p>Data Transfer Object의 약자로 <br />
애플리케이션 아키텍처 패턴의 하나이다.</p>

<pre><code class="language-Java">@PostMapping
public ResponseEntity postMember(@RequestParam("age") int age,
                                 @RequestParam("name") String name,
                                 @RequestParam("sex") String sex) {
     .
     .
     .
	return ..
 }
</code></pre>

<p>간단하게 위의 내용을 살펴보자<br />
어제 배웠던 것을 생각해보면 우리는 @PostMapping을 통해<br />
@RequestParam의 키로 값을 가져온다.<br />
즉 POST 로 자원 요청시 키와 Value값을 보내게 되는데<br />
그 값으로 우리가 사용할 수 있고, 서버에 저장도 하는 것이다.<br />
현재는 3가지(나이,이름,성별)에 대해서 받아오지만<br />
나중에 학교,전화번호 등등 여러가지 데이터가 많이 추가된다고 가정하면<br />
Controller 클래스의 너무나 많은 RequsetParam을 사용해야한다.<br />
그래서 나오게 된 것이 DTO 기술이다.</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@PostMapping</span>
<span class="kd">public</span> <span class="nc">ResponseEntity</span> <span class="nf">postMember</span><span class="o">(</span><span class="nd">@RequestBody</span> <span class="nc">MemberDto</span> <span class="n">memberDto</span><span class="o">)</span> <span class="o">{</span>
     <span class="o">.</span>
     <span class="o">.</span>
     <span class="o">.</span>
    <span class="k">return</span> <span class="o">..</span>
<span class="o">}</span>
</code></pre></div></div>

<p>우선 위에서 사용한 @RequsetParam -&gt; @RequestBody로 변경한다.<br />
그리고 MemberDto라는 클래스를 만들어 매개변수로 받아준다.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Getter</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MemberDto</span> <span class="o">{</span>
 
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">age</span><span class="o">;</span>

    <span class="kd">private</span> <span class="nc">String</span> <span class="nc">Name</span><span class="o">;</span>
   
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">sex</span><span class="o">;</span>
    
<span class="o">}</span>
</code></pre></div></div>

<p>이렇게 될 경우에. 클라이언트 측에서 Json 형식으로 URI와 함께 요청을 한다면<br />
Json의 있는 키값들이 MemberDto의 필드변수에 할당되어진다.</p>

<p>*로컬환경에서 Postman으로 요청한다고 가정<br />
POST http://localhost:8080/api/member<br />
raw Json</p>

<p>{<br />
“age” : 22,<br />
“Name” : “Lee”,<br />
“sex” : “male”<br />
}</p>

<p>실제로 Json 형식으로 요청시 MemberDto 클래스의<br />
age, Name, sex의 값이 22, Lee, male 이렇게<br />
들어가는 것을 확인 할 수 있다.<br />
확인 하는 방법은 getter를 메서드를 이용해 확인이 가능하다</p>

<p><br /></p>

<p><strong>유효성 검증</strong><br />
그렇다면? 위의 Json객체로 보낼때 데이터를 이상하게 보내거나<br />
안보내면 어떻게 되는 것인가?<br />
예를들어 아래와 같이 입력했다고 가정하자<br />
String타입의 sex를 입력하지 않고 요청을 보냈을 경우</p>

<p><strong>case 1) String 타입을 안넣었을 경우</strong></p>

<p>{<br />
“age” : “22”,<br />
“Name” : “Lee”<br />
}</p>

<p>age = 22<br />
Name = Lee<br />
sex = null<br />
이렇게 값이 매칭된다. 즉, String타입은 값이 없을 때 null로 받는다</p>

<p><strong>case 2) int 타입을 안넣었을 경우</strong></p>

<p>{<br />
“name”: “Lee”,<br />
“sex”: “male”<br />
}</p>

<p>age = 0<br />
Name = Lee<br />
sex = male<br />
이렇게 결과값이 나왔다. int타입은 0으로 받는 것 같다.</p>

<p><strong>case 3) Integer 타입을 안넣었을 경우</strong><br />
만약에 위에 처럼 Json 객체 요청시<br />
age가 private Integer age; 라고 가정하였을 경우에는<br />
500번 Internal Server Error가 발생하고<br />
Spring 애플리케이션에서는 NullPointerException이 발생한다<br />
무언가 타입에 따라 값이 있어도되고 없어도되는 무언가가 있는 것 같은데</p>

<p>원시자료형과 참조자료형의 차이인지… <br />
조금더 심도있는 공부가 필요해보인다..<br />
우선은 위에 요청이 들어왔을때 기준으로 한번 가볍게 알아보았고<br />
이제 유효성 검증을 통해 원하는 데이터가 들어오지 않을 경우<br />
코드를 실행시키지 않을 수 있다.</p>

<p>1). 우선 위에 예제 코드에서 @Vaild를 Dto 매개변수 앞에 달아주고</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@PostMapping</span>
<span class="kd">public</span> <span class="nc">ResponseEntity</span> <span class="nf">postMember</span><span class="o">(</span><span class="nd">@Vaild</span> <span class="nd">@RequestBody</span> <span class="nc">MemberDto</span> <span class="n">memberDto</span><span class="o">)</span> <span class="o">{</span>
     <span class="o">.</span>
     <span class="o">.</span>
     <span class="o">.</span>
    <span class="k">return</span> <span class="o">..</span>
<span class="o">}</span>
</code></pre></div></div>
<p><br />
2). Dto 클래스의 원하는 유효성 검증 애노테이션으로 조건을 설정한다.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Getter</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MemberDto</span> <span class="o">{</span>
    <span class="nd">@Min</span><span class="o">(</span><span class="mi">100</span><span class="o">)</span>
    <span class="nd">@Max</span><span class="o">(</span><span class="mi">50000</span><span class="o">)</span> <span class="c1">// 100~50000사이에만 price 유혀성 검사 통과</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">age</span><span class="o">;</span>
    
    <span class="nd">@Pattern</span><span class="o">(</span><span class="n">regexp</span> <span class="o">=</span> <span class="s">"^([A-Za-z])(\\s?[A-Za-z])*$"</span><span class="o">,</span>
            <span class="n">message</span> <span class="o">=</span> <span class="s">"글자사이의 공백이 1개가 초과하거나 ,알파벳이 아닌 글자가 들어왔습니다"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="nc">Name</span><span class="o">;</span>
    
    <span class="nd">@NotBlank</span> <span class="c1">// 공백만으로 구성되있지 않아야한다.</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">sex</span><span class="o">;</span>
    
<span class="o">}</span>
</code></pre></div></div>
<p>@Vaild<br />
-&gt; 유효성 검증을 적용해주는 애노테이션<br />
DTO 앞에 @Vaild를 붙여 클래스를 유효성 검증해줌 만약 유효성검증에 실패하면 요청은 거부(reject)된다.</p>

<p>implementation ‘org.springframework.boot:spring-boot-starter-validation’<br />
-&gt; 그레이들 의존성주입</p>

<p>@Validated<br />
-&gt; @Vaild와 같이 유효성 검증하도록 해줌. 하지만 위치가 서로다름<br />
-&gt; @Valid는 DTO 필드에서 검사하는데, @Valdated는 맵핑 매서드 매개변수에다 쓴다<br />
ex) @PatchMapping(“/{coffee-id}”) public ResponseEntity patchCoffee(@PathVariable(“coffee-id”)</p>

<p>@Min(1) long coffeeId) -&gt; @Min을 사용하는 예제.</p>

<p><em>문자열관련</em><br />
-&gt; @NotBlank : null, 공백, 스페이스 값 모두 허용하지 않음<br />
-&gt; @NotSpace : 공백을 허용하지 않음<br />
-&gt; @NotNull : null을 허용하지 않음<br />
-&gt; @Null : Null만 가능<br />
-&gt; @Size(min=1, max=3) : 문자열의 최소 길이, 최대 길이 제한</p>

<p><em>숫자를 다룰때</em><br />
-&gt; @Min(1) : 값이 최소 1이상이어야하는 유효성 검사 통과<br />
-&gt; @Max(500) : 값이 최대 500이하로 값이 와야 유효성 검사 통과<br />
-&gt; @Range(min=1, max=500) : 범위안에 값이 오면 유효성 검사 통과<br />
-&gt; @Positive : 양수만 허용<br />
-&gt; @PositiveOrZero : 양수와 0만 허용<br />
-&gt; @Negative : 음수만 허용<br />
-&gt; @NegativeOrZero : 음수와 0만 허용</p>

<p><em>정규식 관련</em><br />
-&gt;@Email: 이메일 정보가 비어있는지 검증<br />
-&gt;@Pattern: 특정 패턴을 정규식으로 표현 (@Pattern(regex = “^010-\\d{3,4}-\\d{4}$”)</p>

<hr />

<p>오늘은 DTO의 쓰임새와<br />
유효성 검증에 대한 프로그램을 간단하게 알아보았다.<br />
그 중에서도 특히 Pattern의 정규식관련된 부분은<br />
앞으로 지속적인 학습이 필요해보인다. 아직은 생소해서<br />
어떻게 검사가되는지 각 해당하는 특수문자의 내용을 이해할 수 있도록<br />
주말에 공부해보려한다</p>

<p>오늘 공부는 끝!</p>

<p><br /></p>

<p><span style="color:#994C00"><strong>오늘의 커피량</strong></span>: ☕️ ☕️ ☕️ ☕️<br />
<strong>오늘의 점심</strong>: 오징어 덮밥</p>]]></content><author><name>LEE JAEHYEOK</name></author><category term="TIL" /><category term="TIL" /><category term="부트캠프" /><category term="코드스테이츠" /><summary type="html"><![CDATA[section 3가 시간한 첫번째 금요일]]></summary></entry><entry><title type="html">TIL) Spring MVC , Controller</title><link href="http://localhost:4000/til/2022/10/20/til.html" rel="alternate" type="text/html" title="TIL) Spring MVC , Controller" /><published>2022-10-20T00:00:00+09:00</published><updated>2022-10-20T00:00:00+09:00</updated><id>http://localhost:4000/til/2022/10/20/til</id><content type="html" xml:base="http://localhost:4000/til/2022/10/20/til.html"><![CDATA[<p>오랜만에 깊은 숙면을 했다.</p>

<p><img src="https://ifh.cc/g/j3W1OJ.jpg" align="left" width="300px" height="300px" />
<br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /></p>

<p>섹션2가 끝나고 섹션3이 시작되는 날이다.<br />
드디어 Spring에 대한 여러 공부들이 이루어질 것 같다.<br />
Spring MVC에 대해 주로 공부할 것 같다<br />
오늘도 열심히 달려보자 !</p>

<hr />

<h2 id="spring-mvc"><strong>Spring MVC</strong></h2>

<p>Spring Web MVC를 줄요서 Spring MVC라고 부른다.<br />
MVC는 Model, View, Controller의 약자들이고<br />
클라이언트의 요청을 편리하게 처리해주는 프레임워크들이다.<br />
우리가 이제부터 만들게 될 샘플 애플리케이션은<br />
Spring MVC가 제공해주는 기능을 이용해서 만들기 때문에 중요한 시간이라고 볼 수 있다.</p>

<p><strong>Model</strong> : 작업의 처리 결과 데이터<br />
<strong>View</strong> : Model 데이터를 이용해 웹브라우저 같은 클라이언트 애플리케이션의<br />
화면의 보여지는 리소스를 제공하는 역할</p>

<p><strong>Controller</strong> : 클라이언트 측의 요청을 직접적으로 전달 받는 엔드포인트로써<br />
Model과 View의 중간에서 상호작용을 해주는 역할</p>

<p><img src="https://ifh.cc/g/z1godo.jpg" alt="example image" /></p>

<p>아래는 이전에 공부했던 계층형 아키텍처이다.<br />
여기서 API계층을 Spring MVC 기반의 코드로 구현해보자</p>

<p><img src="https://ifh.cc/g/WcnZXw.jpg" alt="example image" /></p>

<p><strong>패키지 구조</strong></p>

<p>1).기능 기반 패키지 구조<br />
   -. 하나의 기능을 완성하기 위한 계층별 클래스들을 모아놓는 구조</p>

<p><img src="https://ifh.cc/g/fvyThO.png" align="left" width="300px" height="200px" />
<br /><br /><br /><br /><br /><br /><br /><br /><br /></p>

<p>2). 계층 기반 패키지 구조<br />
   -. 패키지를 하나의 계층으로 보고 클래스들을 계층별로 묶어서 관리하는 구조</p>

<p><img src="https://ifh.cc/g/HXg2bo.png" alt="example image" /></p>

<p><br /><br /></p>

<p>Controller 관련 부분을 배워보자<br />
현재 Postman을 통해 API를 요청중이다.</p>

<p><img src="https://ifh.cc/g/X2Ql9J.jpg" alt="example image" /></p>

<p>status : 404<br />
Not Found 에러가 리턴되었는데<br />
클라이언트의 요청을 처리할 핸들러 메서드가 아지 없기 때문이다.<br />
간단하게 여러 애노테이션을 알아보고 사용해보자</p>

<p><strong>핸들러 메서드(Handler Method)</strong><br />
@RestController<br />
-&gt; 클래스에 추가함으로써 해당 클래스를 REST API의 리소스를 <br />
처리하기 위한 API 엔드포인트로 동작하게 해준다</p>

<p>@RequestMapping<br />
-&gt; Controller 클래스 레벨에 추가하여 클래스 전체에 사용되는 공통 Base URL을 설정할 수 있다.<br />
-&gt; 방식을 명시하지 않을 경우, GET,POST사용</p>

<p>@GetMapping<br />
-&gt; 조회 맵핑<br />
-&gt; {} 동적으로 바뀌는 값이되어짐</p>

<p>@PostMapping<br />
-&gt; 쓰기 맵핑<br />
-&gt; {} 동적으로 바뀌는 값이되어짐</p>

<p>@PathVariable<br />
-&gt; 클라이언트 요청 URI에 패턴 형식으로 지정된 변수값을 파라미터로 전달받는다<br />
-&gt; GetMapping의 괄호안에 문자열과 동일해야한다.<br />
만약 다를경우 MissingPathVaribleException을 발생한다.</p>

<p>@RequestParam<br />
-&gt; 주로 클라이언트 쪽에서 전송하는 요청 데이터를 쿼리 파라미터(Query Parmeter 또는 Query String), <br />
폼 데이터(form-data), x-www-form-urlencoded 형식으로 전송하면 <br />
이를 서버 쪽에서 전달 받을 때 사용하는 애너테이션입니다.</p>

<p><strong>ResponseEntity</strong></p>

<p>ResponseEntity 타입의 객체로 map과 HTTP상태를 보냄<br />
-&gt; Map&lt;String,String&gt; map = new HashMap&lt;&gt;(); 데이터를 담은 map<br />
-&gt; HTTP상태, CREATE, OK 등등…<br />
-&gt; Handler Method를 통해 ReponseEntity객체를 반환하면 ResponseBody로 전달됨</p>

<p>HttpStatus<br />
Eunm<HttpStatus>로 구성되어져있음.  
HTTP 상태를 나타내는 여러 상수들이 있음  
물론 더 있지만 우선 오늘 사용해본것들 위주로 예제프로그램을 작성해보자  
기존에 값이 저장되어있는 Map에 데이터를 수정하는 프로그램이다.</HttpStatus></p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@RestController</span>
<span class="nd">@RequestMapping</span><span class="o">(</span><span class="s">"/v1/members"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MemberController</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="nc">Map</span><span class="o">&lt;</span><span class="nc">Long</span><span class="o">,</span> <span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">Object</span><span class="o">&gt;&gt;</span> <span class="n">members</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">HashMap</span><span class="o">&lt;&gt;();</span>

    <span class="nd">@PostConstruct</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">init</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">Object</span><span class="o">&gt;</span> <span class="n">member1</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">HashMap</span><span class="o">&lt;&gt;();</span>
        <span class="kt">long</span> <span class="n">memberId</span> <span class="o">=</span> <span class="mi">1L</span><span class="o">;</span>
        <span class="n">member1</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"memberId"</span><span class="o">,</span> <span class="n">memberId</span><span class="o">);</span>
        <span class="n">member1</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"email"</span><span class="o">,</span> <span class="s">"dhfif718@naver.com"</span><span class="o">);</span>
        <span class="n">member1</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"name"</span><span class="o">,</span> <span class="s">"이재혁"</span><span class="o">);</span>
        <span class="n">member1</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"phone"</span><span class="o">,</span> <span class="s">"010-1111-5555"</span><span class="o">);</span>
        <span class="n">members</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">memberId</span><span class="o">,</span> <span class="n">member1</span><span class="o">);</span>
    <span class="o">}</span>
    
    <span class="nd">@PostMapping</span><span class="o">(</span><span class="s">"/phone/{memberId}"</span><span class="o">)</span>
    <span class="kd">public</span> <span class="nc">ResponseEntity</span> <span class="nf">changeCoffees</span><span class="o">(</span><span class="nd">@PathVariable</span><span class="o">(</span><span class="s">"memberId"</span><span class="o">)</span> <span class="kt">long</span> <span class="n">memberId</span><span class="o">,</span>
                                        <span class="nd">@RequestParam</span><span class="o">(</span><span class="s">"phone"</span><span class="o">)</span> <span class="nc">String</span> <span class="n">phone</span><span class="o">)</span> <span class="o">{</span>

        <span class="c1">//저장되어있는 객체 조회</span>
        <span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">Object</span><span class="o">&gt;</span> <span class="n">chagnePhoneNumber</span> <span class="o">=</span> <span class="n">members</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">memberId</span><span class="o">);</span>

        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"--&gt;Phone 번호 변경 로직 실행됨"</span><span class="o">);</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"변경전 : "</span> <span class="o">+</span> <span class="n">members</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">memberId</span><span class="o">));</span>

        <span class="c1">//해당 members 맵에 회원 id가 없을 경우 BAD_REQUSET 반환</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">members</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">memberId</span><span class="o">)</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"해당 memberId에 데이터가 존재하지 않습니다"</span><span class="o">);</span>
            <span class="k">return</span> <span class="k">new</span> <span class="nf">ResponseEntity</span><span class="o">(</span><span class="nc">HttpStatus</span><span class="o">.</span><span class="na">BAD_REQUEST</span><span class="o">);</span>
        <span class="o">}</span>

        <span class="c1">//핸드폰 번호 변경 로직</span>
        <span class="c1">//얕은 복사로 같은 객체를 변경하는 것이기 때문에 members.put을 따로 해줄 필요는 없다.</span>
        <span class="n">chagnePhoneNumber</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"phone"</span><span class="o">,</span> <span class="n">phone</span><span class="o">);</span>

        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"변경후 : "</span> <span class="o">+</span> <span class="n">chagnePhoneNumber</span><span class="o">);</span>

        <span class="k">return</span> <span class="k">new</span> <span class="nf">ResponseEntity</span><span class="o">(</span><span class="n">chagnePhoneNumber</span><span class="o">,</span> <span class="nc">HttpStatus</span><span class="o">.</span><span class="na">OK</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>POST에 해당하는 핸들러 메서드를 만들었다.<br />
Postman을 통해 요청을 보냈더니<br />
ResponseEntity를 통해 객체와 상태를 리턴해주었다.</p>

<p><br /></p>

<p><img src="https://ifh.cc/g/GgtVZa.jpg" alt="example image" /></p>

<p>API 요청시 인텔리제이의 System.out 프린트로 출력된 로그</p>

<p>–&gt;Phone 번호 변경 로직 실행됨<br />
변경전 : {phone=010-1111-5555, name=이재혁, email=dhfif718@naver.com, memberId=1}<br />
변경후 : {phone=010-1111-6777, name=이재혁, email=dhfif718@naver.com, memberId=1}</p>

<hr />

<p>오늘은 정리가 조금 부실하다…<br />
실습하기 바쁘기도했고, 오늘 저녁에<br />
백엔드 현업개발자 친구를 만나 여러가지 얘기도나누고<br />
공부방향이 잘되고있는 건지 등<br />
여러 잡담을 나누다보니 집에 11시에 도착해버렸다…<br />
부랴부랴 오늘 학습한 내용을 정리하는데,, 머릿속이 텅…<br />
비어버려서 내일학습에 지장이 생기면안될 것 같아.<br />
우선 간단하게만 정리하고 마무리해보려한다.<br />
주말을 이용해 인프런강의와 오늘 배운 여러지식들을 다시 공부해봐야겠다.</p>

<p><br /></p>

<p><span style="color:#994C00"><strong>오늘의 커피량</strong></span>: ☕️ ☕️ ☕️<br />
<strong>오늘의 점심</strong>: 오징어 덮밥, 계란 부침</p>]]></content><author><name>LEE JAEHYEOK</name></author><category term="TIL" /><category term="TIL" /><category term="부트캠프" /><category term="코드스테이츠" /><summary type="html"><![CDATA[오랜만에 깊은 숙면을 했다.]]></summary></entry><entry><title type="html">TIL) 두달차 회고</title><link href="http://localhost:4000/til/2022/10/19/til.html" rel="alternate" type="text/html" title="TIL) 두달차 회고" /><published>2022-10-19T00:00:00+09:00</published><updated>2022-10-19T00:00:00+09:00</updated><id>http://localhost:4000/til/2022/10/19/til</id><content type="html" xml:base="http://localhost:4000/til/2022/10/19/til.html"><![CDATA[<p>학습의 학습 또 학습..<br />
매일매일 새로운 것들이 머릿속을 가득채우고있다.</p>

<p>그래서 그런지 시간이 엄청 빨리가는 느낌이다.<br />
<img src="https://ifh.cc/g/9pvkkd.gif" align="left" width="350px" height="200px" />
<br /><br /><br /><br /><br /><br /><br /><br /><br /></p>

<p>늘 생각한다 개발을 좀더 일찍 시작할껄..하는<br />
아쉬움이 조금씩 남아있다.<br />
한편으론 지금이라도 시작해서 다행인 것 같기도하고..</p>

<p>코드스테이츠 부트캠프를 시작한지<br />
벌써 두달이나 지났다.<br />
학습에 불만족스러운 부분은 없는 것 같다.<br />
방치형이라든가 콘텐츠가 불친절하다든가.. 여러 얘기들이 있지만</p>

<p>내가 가지고온 기준은 부트캠프를 통해서<br />
학습의 방향을 정하고, 내 스스로 학습의지를 높일 수 있도록 하려는 목표가 강했기 때문에<br />
지금 학습법에 상당한 만족감을 느끼고 있다.</p>

<hr />

<h2 id="회고"><strong>회고</strong></h2>

<h4 id="두달차의-나는"><strong>두달차의 나는?</strong></h4>

<p>첫달차에는 아무래도 Java라는 언어에 대해 친숙하지 않다보니까<br />
Java 문법과 기초적인 컴퓨터 CS지식에 대해 공부했다면</p>

<p>두달차에는 하루에한번씩 알고리즘 풀이를 통한<br />
언어의 친숙함과 문제해결 능력을 길르고<br />
알고리즘의 관한 살짝 깊은내용들 (재귀,자료구조,Greedy, 순열 … 등)에 대한<br />
문제 풀이와 공부 그리고 본격적으로 세달차에 다루게될 Spring에 대한<br />
아주 기초적인 지식과 찍먹을 해보았다.</p>

<p>그래도 지속적인 학습을 통해<br />
어느정도 Java문법 사용에 있어서는 익숙해진 것 같다.<br />
하지만 알고리즘은 당혹 그 자체였다.</p>

<p><img src="https://ifh.cc/g/GNSW2H.jpg" align="left" width="300px" height="250px" />
<br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /></p>

<p>마치 위가 안보이는 벽을 두드리는 심정이었다.</p>

<p>재귀, 탐욕알고리즘, 가지각색의 탐색 알고리즘…<br />
이 것들은 내 머리를 쥐어짜는 것도 모잘라 너무 혼란스럽게 했다.<br />
이런 혼란스러움 마음을 가지고 스프링 기초 학습을 진행하니<br />
집중도도 떨어지고 어려운 벽에 부딪히니 약간의 그로기상태가 온 것 같다.<br />
내가 궁극적을 원하는 목표를 달리기위해 다시 재정비를 해보려고 한다.</p>

<p><br /></p>

<h4 id="재정비"><strong>재정비</strong></h4>

<p>내가 부트캠프를 시작했던 가장 큰 목표는 사실 ‘취업’이라고 말할 수 있다.
근데 그 이전에 취업을 하기위한 조건?을 만들기위해<br />
코드스테이츠 백엔드 코스에 합류한 것이고, 그 조건을 만들기위해선<br />
절대적으론 프로그래밍 실력을 향상시키는 것에 있다고 생각한다.</p>

<p>즉 내가 원하는 목표를 도달하기위해선<br />
컴퓨터에 대한 이해와 프로그래밍 실력을 늘리는 것이다.<br />
내가 학습에 집중하고 문제풀이에 유연해질 수 있도록 재정비하는<br />
시간을 가지는게 중요한 것 같다.</p>

<p>내가 이루고자하는 ‘프로그램을 잘하는 것’은 사실상 신입인 내게<br />
무리한 요구이며, 그렇게 되는것도 터무니없는 요청이다.<br />
나는 취업이라는 전략에 맞게 그에 해당하는 실력을 우선적으로 만들고<br />
계속발전해나가야한다는 필요성을 느꼈다.<br />
그렇게 하기위해선 현재 하루 공부 템포를 조절하는 것, 마인드 관리하는 것<br />
등 효과적인 공부 방법을 강구해볼 필요가 있는 것 같다.</p>

<p>지금 나의 공부 계획중 가져가는 것과 문제되는 것을 파악해 정리해보자</p>

<p><br /></p>

<h4 id="keep--problem"><strong>Keep , Problem</strong></h4>

<p>첫달차에서 정한 나만의 룰 4가지가 있었다.</p>
<ol>
  <li>매일매일 Commit 하기</li>
  <li>알고리즘 하루 1회 풀기</li>
  <li>블로그 TIL 포스팅하기</li>
  <li>운동 꾸준히나가기</li>
</ol>

<p>학습량이 늘어남에따라 위에 4가지를 전부 지키기에는 시간적 정신적<br />
부담감이 강하다는걸 느끼고 있었다.<br />
2달간 매일 실천하면서 가장 압박이 심했던 것은 알고리즘이다.<br />
알고리즘 학습 스프링 학습을 하는데 물론 하루만에 이해가 안될 뿐더러<br />
공부하다보면 어느새 10시가 넘어버린다..</p>

<p>그 상황에서 백준알고리즘을 풀고 운동을나가거나, 포스팅까지 하려고하면<br />
새벽이 넘어야만 잠을 청할 수 있다. 이렇게 몇일 반복되다보니<br />
압박감을 느끼게되었고, 개선할 필요가 있다고 느꼈다.</p>

<ol>
  <li>
    <p>하루에 한번씩 Commit하기<br />
-&gt; 크게 압박을 느끼는 것은 없고, 내가 공부한 내용을 커밋하는 것이기때문에<br />
계속 유지해서 할 생각이다.</p>
  </li>
  <li>
    <p>알고리즘 하루 1회 풀기<br />
-&gt; 학습량에 따라 조절이 필요할 것 같다.<br />
목표는 1개를 푸는것으로 두는것으로하고, 반드시 지키려는 압박은 버리려고한다.<br />
그날 학습에 대한 이해가 충분하다고 판단되어질때 알고리즘 공부를 하려한다.<br />
하지만 스프링 학습이 어느정도 이루어지고 프로젝트 진행할때 라든가<br />
4개월차 이후에는 필수적으로 알고리즘을 깊이 공부하는 시간을 주기적으로 가져야할 것 같다고<br />
판단되고 그렇게 할 생각이다.</p>
  </li>
  <li>
    <p>블로그 TIL 포스팅하기<br />
-&gt; 포스팅에 대한 시간 투자는 많이 하는편이긴한데, 정리하면서 내가 배운 것들을 점검하고<br />
글로만 보던 것을 예제로 만들고 적으려고하니 더블체크도 하는 좋은 순기능 같아<br />
계속 유지할 생각이다.</p>
  </li>
  <li>
    <p>운동 꾸준히나가기<br />
-&gt; 운동을 1시간 정도 나갔다가 돌아와서 공부를 하고있는데<br />
최근에 알고리즘,스프링 학습하면서 그 시간도 아깝다는 생각이 들었다.<br />
목적은 리프레쉬하거나 머리를 식히고 공부의 집중도를 늘리기위한 목적이었는데<br />
그 목적을 이루어지지 않는 느낌이라 그시간 동안 공부에 집중할 수 있는 대채제를<br />
찾는게 좋을 것 같다. 휴식을 취하면 확실히 공부의욕이 생겨서<br />
당분간은 30분 휴식후 공부를 다시시작하는 방식으로 변경하려한다.</p>
  </li>
</ol>

<p><br /></p>

<p>당분간 학습루틴을 이렇게 변경 해보았다.<br />
1,3번은 하루에 한번씩 필수<br />
2,4번은 학습량에 따른 선택적 실행<br />
어떻게 보면 게을러진 것 같은 생각이들어 4가지를 다 무조건 지키려고했지만<br />
좋은 학습은 온전히 내가 집중하는 것에서 부터 발휘되는 것 같아서<br />
조금은 변경적용해 너프하게 압박을 덜 느끼면서 공부해보려한다.</p>

<p>학습에 가장 큰 방해 요소들도 존재한다.<br />
<img src="https://ifh.cc/g/6oZ6XV.jpg" align="left" width="450px" height="250px" />
<br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /></p>

<p>대부분 비슷하다고 생각이든다ㅎㅎ….<br />
의지박약일까? 작심삼일일까… 나란사람은 왜이렇게 나태할까 ㅋㅋㅋㅋ<br />
유튜브를 한번보면 머리 텅빈채로 보다보니 계속 보게되고<br />
수업 집중도가 확 떨어지는걸 느낄 수 있었다.</p>

<p>그래서 수업중에는 왠만하면 핸드폰을 키지 않는다.<br />
그 순간 해야될 것들은 전부 이해하기전까지는 딴짓을 안하려고 노력중이다.</p>

<p>가장 좋은 해결책은 Java 프로그램을 하는 것 자체를<br />
게임과 같은 기분으로 하는게 모든 집중요소를 해결할 수 있는 비책인 것 같다.<br />
한동안 알고리즘 간단한 문제풀때는 그런느낌이 들었었다…<br />
너무 재밌어서 쉴때도 문제 하나씩풀고 유튜브보다가도 옆에 노트북놓고 풀고..<br />
하지만 벽을느끼고 사그라들었지만…</p>

<p><br /></p>

<h4 id="그래도-해야지-"><strong>그래도 해야지 !</strong></h4>

<p>내가 선택한길이고 정말 잘하고 싶기도하고<br />
앞으로 프로그램을하면서 밥벌어먹고 싶기 때문에<br />
이왕 발을 담궜으니 최대한 노력할 수 있는 만큼해보고<br />
다른 유혹에 빠지지 않고 집중해서 공부해보자!!</p>

<p>마지막으로 정리해보자면</p>
<ol>
  <li>
    <p>학습에 집중하기
-&gt; 학습에 대한 압박, 기타 유흥거리에 대한 유혹 등을 이겨내고<br />
온전히 배우고 있는 것을 흡수해 적용할 수 있게 집중하기.</p>
  </li>
  <li>
    <p>프로그램 실력 늘리기<br />
-&gt; 알고리즘 공부 열심히하기 , 단 현재 학습단계에선 조절이 필요. <br />
이렇게 우선순위를 정해 공부할 수 있도록 방향을 조정해봐야겠다!</p>
  </li>
</ol>

<p><br /></p>

<p>2개월째 공부를하고 있고<br />
4개월을 더 공부해야한다. 터무니없이 부족한 시간인 것도 맞고<br />
내가 열심히 공부해 수료를 마치더라도 취업에 성공할 수 있을지도 불확실하다</p>

<p><img src="https://ifh.cc/g/0v9YZK.jpg" align="left" width="280px" height="300px" />
<br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /></p>

<p>그래도 한번 크게먹은 마음인 만큼<br />
도전에 대한 후회는 남지 않도록 회고를 쓰면서<br />
다시한번 마음을 다잡아본다.</p>

<p><br /></p>]]></content><author><name>LEE JAEHYEOK</name></author><category term="TIL" /><category term="TIL" /><category term="부트캠프" /><category term="코드스테이츠" /><summary type="html"><![CDATA[학습의 학습 또 학습.. 매일매일 새로운 것들이 머릿속을 가득채우고있다.]]></summary></entry><entry><title type="html">TIL) Spring AOP 2</title><link href="http://localhost:4000/til/2022/10/18/til.html" rel="alternate" type="text/html" title="TIL) Spring AOP 2" /><published>2022-10-18T00:00:00+09:00</published><updated>2022-10-18T00:00:00+09:00</updated><id>http://localhost:4000/til/2022/10/18/til</id><content type="html" xml:base="http://localhost:4000/til/2022/10/18/til.html"><![CDATA[<p>올해 처음으로 늦잠을 자 지각을 해버렸다..</p>

<p><img src="https://ifh.cc/g/VL0aYH.gif" align="left" width="350px" height="250px" />
<br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /></p>

<p>해야할 일이 있거나 약속이 있으면 무조건<br />
늦잠을 안자고 번뜩일어나는데<br />
오늘은 알람소리를 못들었다…..<br />
수면패턴이 조금 바뀌어서 그런가 싶기도하고</p>

<p>구내염도 난 것 보면<br />
스트레스관리와 수면관리좀 해야할 것 같다.</p>

<hr />

<p>어제는 AOP의 간단한 용어들과\<br />
Advice의 타입별 사용방법을 알아보았었다.<br />
오늘은 Pointcut 표현식과 JoinPoint 특징과</p>

<p>자바코드로 예제를 직접짜보고 Spring 적용 변경해보는<br />
실습을 혼자만들어서 해보자!</p>

<p><br /></p>

<h3 id="pointcut-표현식"><strong>Pointcut 표현식</strong></h3>

<p>Pointcut은 어제 알아보았듯이<br />
우리가 JoinPoint에서 어느 부분을 쓸지 정해주는 부분이다<br />
AspectJ 이용해 우리는 표현식을 사용할 수 있다.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">org.aspectj.lang.annotation.*</span><span class="o">;</span>
</code></pre></div></div>

<p>어제 보았던 예제를 보자</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Around</span><span class="o">(</span><span class="s">"execution(* com.aop.section2aopcalculate..*(..))"</span><span class="o">)</span>
<span class="kd">public</span> <span class="nc">Object</span> <span class="nf">AroundLog</span><span class="o">(</span><span class="nc">ProceedingJoinPoint</span> <span class="n">joinPoint</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">Throwable</span><span class="o">{</span>
    <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"--&gt; Aspect 실행 : "</span> <span class="o">+</span> <span class="n">joinPoint</span><span class="o">.</span><span class="na">getSignature</span><span class="o">().</span><span class="na">getName</span><span class="o">());</span>
    <span class="k">try</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">joinPoint</span><span class="o">.</span><span class="na">proceed</span><span class="o">();</span>
    <span class="o">}</span><span class="k">finally</span> <span class="o">{</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"--&gt; Aspect 종료 : "</span> <span class="o">+</span> <span class="n">joinPoint</span><span class="o">.</span><span class="na">getSignature</span><span class="o">().</span><span class="na">getName</span><span class="o">());</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>Adivce 타입은 @Around이고</p>

<p>Pointcut 부분은 (“execution(* com.aop.section2aopcalculate..*(..))”)에<br />
해당한다. 첫번째는 <strong>‘포인트컷 지시자(PCD)’</strong> 이고 뒤에는 내 패키지내 경로이다.</p>

<p>execution : 포인트컷 지시자<br />
com.aop.section2aopcalculate..*(..) : 패키지 경로, 클래스 메서드 명</p>

<p>주로 execution을 가장 많이 사용한다.</p>

<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>execution</td>
      <td>메서드 실행 JoinPoint를 매칭한다.</td>
    </tr>
    <tr>
      <td>within</td>
      <td>특정 타입 내의 JoinPotin를 매칭한다.</td>
    </tr>
    <tr>
      <td>args</td>
      <td>인자가 주어진 타입의 인스턴스인 JoinPoint</td>
    </tr>
    <tr>
      <td>this</td>
      <td>Spring Bean을 대상으로 하는 JoinPoint</td>
    </tr>
    <tr>
      <td>target</td>
      <td>Target 객체를 대상으로 하는 JoinPoint</td>
    </tr>
    <tr>
      <td>bean</td>
      <td>Spring 전용 PCD이고 Bean의 이름으로 Pointcut을 지정한다.</td>
    </tr>
  </tbody>
</table>

<p>**&amp;&amp;, || , ! 같은 표현식**을 사용해 결합할 수 도 있다.<br />
어제 예제를 가져와서 아래와 같은 경로에 있다고 가정하자.<br />
<img src="https://ifh.cc/g/oD90th.png" align="left" width="650px" height="300px" />
<br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /></p>

<p>NewCalculate라는 클래스는<br />
com.aop.section2aopcalculate.calculate 패키지 안에 경로가 지정되어있다.</p>

<p>예를 들어 하나의 클래스의 메서드만 동작시키고 싶을 경우 (우린 add메서드를 가정하자)<br />
아래와 가은 방식으로 표현할 수 있다.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">(</span><span class="s">"execution(* com.aop.section2aopcalculate.calculate.NewCalculate.add(..))"</span><span class="o">)</span>
</code></pre></div></div>

<p>여기서 결합식을 사용해 우리가 add메서드와 sub메서드를 둘다 실행시킬 수 있다.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">(</span><span class="s">"execution(* com.aop.section2aopcalculate.calculate.NewCalculate.add(..)) || execution(* com.aop.section2aopcalculate.calculate.NewCalculate.sub(..))"</span><span class="o">)</span>
</code></pre></div></div>

<p>|| 표현식으로 결합식을 사용하면 add,sub 메서드가 둘다 지정되어<br />
실행되는 모습을 볼 수 있다.</p>

<p><br /></p>

<h3 id="joinpoint"><strong>JoinPoint</strong></h3>

<p>JoinPoint는 우리가 포인트컷으로 지정한 곳이고<br />
추상적인 개념으로 AOP를 적용할 수 있는 지점을 의미한다.</p>

<ol>
  <li>Advice가 적용될 수 있는 위치, 메소드 실행, 생성자 호출, 필드값 접근 같은 프로그램 실행 중 지점을 나타낸다.</li>
  <li>AspectJ를 사용해서 컴파일 시점과 클래스 로딩 시점에 적용하는AOP는 바이트코드를 실제 조작하기 때문에 해당 기능을 모든 지점에 다 적용할 수 있다.</li>
  <li>프록시 방식을 사용하는 Spring AOP는 메서드 실행 지점에만 AOP 적용이 가능하다.</li>
  <li>프록시는 메서드 오러라이딩 개념으로 동작한다.</li>
  <li>프록시를 사용하는 Spring AOP의 JoinPoint는 메서드 실행으로 제한된다.</li>
</ol>

<p><em><strong>JoinPoint 인터페이스 기능</strong></em><br />
.getArgs() : 전달된 인자를 배열로 반환한다.<br />
.getThis() : AOP 프록시 객체를 반환한다.<br />
.getTarget() : AOP가 적용된 대상 객체를 반환한다. (비지니스 메소드를 포함하는 객체반환)<br />
.toString() : 방법에 대한 유용한 설명을 인쇄한다.<br />
.getSignature() : 메서드에 대한 설명을 반환한다. <br />
-&gt; getSignature().getName() : 호출한 메서드의 이름을 반환한다. (String)<br />
-&gt; getSignature().toLongString() : 호출한 메서드의 리턴타입, 이름, 매개변수를 패키지 경로까지 포함해서 반환한다. (String)<br />
-&gt; getSignature().toShoryString() : 호출한 메서드 시그니처를 축약한 문자열로 반환한다. (String)</p>

<p><em><strong>ProceedingJoinPoint 인터페이스 기능</strong></em><br />
.proceed() : 다음 어드바이스나 타겟을 호출한다.</p>

<p><br /></p>

<h3 id="java-코드로-aop-작성해보기"><strong>Java 코드로 AOP 작성해보기</strong></h3>
<p>조금 더 AOP에 대해 심도있게 이해해보기 위해서<br />
셀프과제를 만들었다.</p>

<ol>
  <li>Java 코드로 AOP를 작성해보는 시간을 가져보았다.</li>
  <li>공통 관심 사항을 메서드 실행 시간 측정으로 두었고</li>
  <li>핵심 로직은 점수 합산과 평균을 구하는 것으로 지정했다.</li>
  <li>메서드 실행시 AOP가 동작하는지 확인</li>
</ol>

<p><img src="https://ifh.cc/g/t3Ym8R.png" align="left" width="300" height="150px" />
<br /><br /><br /><br /><br /><br /><br /></p>

<p>총 4개의 Class를 만들어 테스트를 해보았다.</p>

<p><strong>&lt;Exam.interface / 메서드 인터페이스 추상화&gt;</strong></p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">Exam</span> <span class="o">{</span>
    <span class="kt">int</span> <span class="nf">total</span><span class="o">();</span>
    <span class="kt">float</span> <span class="nf">avg</span><span class="o">();</span>
<span class="o">}</span>
</code></pre></div></div>

<p>Score.class에서 구현하게 추상화를 해둔 Interface<br />
가장 큰 이유는 아래에 Aop.class에서<br />
Proxy.newProxyInstance의 매개변수로 인터페이스를 사용해야하기 때문</p>

<p><strong>&lt;Score.class / 핵심 로직(합산,평균)&gt;</strong></p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">lombok.Getter</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">lombok.Setter</span><span class="o">;</span>

<span class="nd">@Getter</span>
<span class="nd">@Setter</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Score</span> <span class="kd">implements</span> <span class="nc">Exam</span><span class="o">{</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">kor</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">eng</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">math</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">com</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">Score</span><span class="o">(</span><span class="kt">int</span> <span class="n">kor</span><span class="o">,</span> <span class="kt">int</span> <span class="n">eng</span><span class="o">,</span> <span class="kt">int</span> <span class="n">math</span><span class="o">,</span> <span class="kt">int</span> <span class="n">com</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">kor</span> <span class="o">=</span> <span class="n">kor</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">eng</span> <span class="o">=</span> <span class="n">eng</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">math</span> <span class="o">=</span> <span class="n">math</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">com</span> <span class="o">=</span> <span class="n">com</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">int</span> <span class="nf">total</span><span class="o">(){</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"--&gt; total method 시작"</span><span class="o">);</span>
        <span class="kt">int</span> <span class="n">result</span> <span class="o">=</span> <span class="n">kor</span><span class="o">+</span><span class="n">eng</span><span class="o">+</span><span class="n">math</span><span class="o">+</span><span class="n">com</span><span class="o">;</span>
        <span class="k">try</span><span class="o">{</span>
            <span class="nc">Thread</span><span class="o">.</span><span class="na">sleep</span><span class="o">(</span><span class="mi">1000</span><span class="o">);</span>
        <span class="o">}</span><span class="k">catch</span> <span class="o">(</span><span class="nc">Exception</span> <span class="n">e</span><span class="o">){</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">e</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">result</span><span class="o">);</span>
        <span class="k">return</span> <span class="n">result</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">float</span> <span class="nf">avg</span><span class="o">(){</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"--&gt; avg method 시작"</span><span class="o">);</span>
        <span class="kt">float</span> <span class="n">result</span> <span class="o">=</span> <span class="o">(</span><span class="n">kor</span><span class="o">+</span><span class="n">eng</span><span class="o">+</span><span class="n">math</span><span class="o">+</span><span class="n">com</span><span class="o">)</span> <span class="o">/</span> <span class="mf">4.0f</span><span class="o">;</span>
        <span class="k">try</span><span class="o">{</span>
            <span class="nc">Thread</span><span class="o">.</span><span class="na">sleep</span><span class="o">(</span><span class="mi">2000</span><span class="o">);</span>
        <span class="o">}</span><span class="k">catch</span> <span class="o">(</span><span class="nc">Exception</span> <span class="n">e</span><span class="o">){</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">e</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">result</span><span class="o">);</span>
        <span class="k">return</span> <span class="n">result</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>Lombok @Getter,@Setter를 사용하여<br />
Getter,Setter의 긴 코드를 생략했습니다.</p>

<p>메서드 시간측정을 위해 중간 중간에 Thread.sleep();을<br />
이용해 메서드의 머무는 시간을 늘려주었습니다.</p>

<p>각각메서드의 시작을 알리는 코멘트를 프린트하였고<br />
메서드 실행 결과값을 출력하였습니다.</p>

<p><strong>&lt;Aop.class / 공통관심사 코드&gt;</strong></p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">java.lang.reflect.InvocationHandler</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.lang.reflect.Method</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.lang.reflect.Proxy</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Aop</span> <span class="o">{</span>
        <span class="c1">// Proxy를 이용한 AOP 구현 방법</span>
        <span class="kd">public</span> <span class="nc">Exam</span> <span class="nf">aopApply</span><span class="o">(</span><span class="nc">Exam</span> <span class="n">exam</span><span class="o">){</span>
            <span class="nc">Exam</span> <span class="n">proxy</span> <span class="o">=</span> <span class="o">(</span><span class="nc">Exam</span><span class="o">)</span> <span class="nc">Proxy</span><span class="o">.</span><span class="na">newProxyInstance</span><span class="o">(</span><span class="nc">Score</span><span class="o">.</span><span class="na">class</span><span class="o">.</span><span class="na">getClassLoader</span><span class="o">(),</span>
                    <span class="k">new</span> <span class="nc">Class</span><span class="o">[]{</span><span class="nc">Exam</span><span class="o">.</span><span class="na">class</span><span class="o">},</span>
                    <span class="k">new</span> <span class="nf">InvocationHandler</span><span class="o">()</span> <span class="o">{</span>
                        <span class="nd">@Override</span>
                        <span class="kd">public</span> <span class="nc">Object</span> <span class="nf">invoke</span><span class="o">(</span><span class="nc">Object</span> <span class="n">proxy</span><span class="o">,</span> <span class="nc">Method</span> <span class="n">method</span><span class="o">,</span> <span class="nc">Object</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">Throwable</span> <span class="o">{</span>
                            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"START: "</span> <span class="o">+</span> <span class="mi">0</span>  <span class="o">+</span> <span class="s">"ms"</span> <span class="o">+</span> <span class="s">" / "</span> <span class="o">+</span><span class="n">getClass</span><span class="o">());</span>

                            <span class="kt">long</span> <span class="n">start</span> <span class="o">=</span> <span class="nc">System</span><span class="o">.</span><span class="na">currentTimeMillis</span><span class="o">();</span>
                            <span class="nc">Object</span> <span class="n">result</span> <span class="o">=</span> <span class="n">method</span><span class="o">.</span><span class="na">invoke</span><span class="o">(</span><span class="n">exam</span><span class="o">,</span> <span class="n">args</span><span class="o">);</span>
                            <span class="kt">long</span> <span class="n">end</span> <span class="o">=</span> <span class="nc">System</span><span class="o">.</span><span class="na">currentTimeMillis</span><span class="o">();</span>

                            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"END: "</span> <span class="o">+</span> <span class="o">(</span><span class="n">end</span><span class="o">-</span><span class="n">start</span><span class="o">)</span> <span class="o">+</span> <span class="s">"ms"</span> <span class="o">+</span> <span class="s">" / "</span> <span class="o">+</span><span class="n">getClass</span><span class="o">());</span>
                            <span class="k">return</span> <span class="n">result</span><span class="o">;</span>
                        <span class="o">}</span>
                    <span class="o">});</span>
            <span class="k">return</span> <span class="n">proxy</span><span class="o">;</span>
        <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p><strong>동적 프록시(Dynamic Proxy)</strong>를 사용하여 코드를 작성했다.<br />
동적프록시는 런타임 시점에 프록시 클래스를 만들어주는 방식이다.<br />
사용하는 이유는 프록시 타겟코드의 수정없이 접근 제어 , 부가기능을 추가하려고 사용한다.<br />
즉, 우리가 AOP를 사용하는 목적과 부합한다!!!<br />
Proxy.newProxyInstance() 메서드로 Proxy를 생성하는데 3개의 파라미터를 가진다.</p>

<ul>
  <li>loader : 프록시 클래스를 정의하는 클래스 로더</li>
  <li>interfaces : 프록시 클래스가 구현하는 인터페이스 리스트</li>
  <li>h : 메서드 호출을 처리하는 핸들러</li>
</ul>

<ol>
  <li>프록시 클래스를 지정 : Score.class.getClassLoader()</li>
  <li>프록시 클래스가 구현하는 인터페이스를 지정 : new Class[]{Exam.class}</li>
  <li>메서드 호출을 처리하는 핸들러 구현 : new InvocationHandler(){}<br />
.invoke 메서드를 Override 하여 구현하기</li>
</ol>

<p>시작과 끝을 알리는 코멘트를 추가했으며<br />
메서드 호출 전후로 시간을 측정하여 차액을 표시하게 해두었다.</p>

<p><strong>&lt;Application.class / 클라이언트 요청부분&gt;</strong></p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Application</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">Aop</span> <span class="n">aop</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Aop</span><span class="o">();</span>
        <span class="nc">Exam</span> <span class="n">exam</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Score</span><span class="o">(</span><span class="mi">100</span><span class="o">,</span><span class="mi">80</span><span class="o">,</span><span class="mi">80</span><span class="o">,</span><span class="mi">90</span><span class="o">);</span>
        <span class="nc">Exam</span> <span class="n">proxy</span> <span class="o">=</span> <span class="n">aop</span><span class="o">.</span><span class="na">aopApply</span><span class="o">(</span><span class="n">exam</span><span class="o">);</span>
        
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"======================="</span><span class="o">);</span>
        <span class="n">proxy</span><span class="o">.</span><span class="na">total</span><span class="o">();</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"======================="</span><span class="o">);</span>
        <span class="n">proxy</span><span class="o">.</span><span class="na">avg</span><span class="o">();</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"======================="</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
<span class="cm">/* 출력
=======================
START: 0ms / class com.AopExample.Aop_Example.aopSpring.TimeTraceAop
--&gt; total method 시작
350
END: 1049ms / class com.AopExample.Aop_Example.aopSpring.TimeTraceAop
=======================
START: 0ms / class com.AopExample.Aop_Example.aopSpring.TimeTraceAop
--&gt; avg method 시작
87.5
END: 2004ms / class com.AopExample.Aop_Example.aopSpring.TimeTraceAop
=======================
*/</span>
</code></pre></div></div>

<p>전부 구현을 완료했으니 동작을 해보자!<br />
Application을 main메서드를 만들어 동작시킬 수 있게 해주었다.<br />
먼저 각각 점수를 입력하기위해 Exam타입의 Score객체를 만들었다.</p>

<p>만듣 객체는 Aop클래스의 aopApply 매개변수로 객체가 전달되어<br />
해당 객체로 반환받은 Exam타입의 proxy 참조변수를 이용하여<br />
.total(), .avg()를 호출 할 수 있다.</p>

<p>출력 결과를 보면 알 수 있듯이 main 메서드에서<br />
proxy.total() , proxy.avg()를 실행시켰는데<br />
사이에 우리가 측정하고자하는 공통관심 코드가 적용된 것을 볼 수 있다.</p>

<p>여기서 중요한점 !!<br />
우리는 Score.class의 있는 코드를 전혀 수정하지 않아도<br />
공통관심코드가 핵심코드 사이에 햄버거마냥<br />
딱 끼워져서 동작하는 모습을 볼 수 있다는 점!! ★★</p>

<p>우리가 수백개의 메서드를 추가하여도 공통관심코드를 통해<br />
메서드가 호출되기때문에 AOP가 잘 적용되어졌다고 볼 수 있을 것 같다.</p>

<h3 id="spring을-이용해-aop-작성해보기"><strong>Spring을 이용해 AOP 작성해보기</strong></h3>

<p>조건은 위에서 작성한 것과 동일하다 이번에는 인터페이스를 이용하지 않고<br />
Score의 내용을 분리한다음에 Spring의 @Aspect를 이용하여<br />
위와 동일하게 동작하게 만들어보려한다.</p>

<p><img src="https://ifh.cc/g/9PGsAz.png" align="left" width="400px" height="200px" />
<br /><br /><br /><br /><br /><br /><br /><br /><br /></p>

<p>총 4개의 클래스로 구성했고<br />
패키지명은 위와 같이 경로를 지정했으니 아래코드에서 헷갈리지말자!<br />
코드로 내용을 확인해보자.</p>

<p><strong>&lt;Score.class / 점수 관리 객체&gt;</strong></p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">lombok.Getter</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">lombok.Setter</span><span class="o">;</span>

<span class="nd">@Getter</span>
<span class="nd">@Setter</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Score</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">kor</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">eng</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">math</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">com</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">Score</span><span class="o">(</span><span class="kt">int</span> <span class="n">kor</span><span class="o">,</span> <span class="kt">int</span> <span class="n">eng</span><span class="o">,</span> <span class="kt">int</span> <span class="n">math</span><span class="o">,</span> <span class="kt">int</span> <span class="n">com</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">kor</span> <span class="o">=</span> <span class="n">kor</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">eng</span> <span class="o">=</span> <span class="n">eng</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">math</span> <span class="o">=</span> <span class="n">math</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">com</span> <span class="o">=</span> <span class="n">com</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>위와 동일하게 Lombok을 이용해<br />
Getter,Setter를 만들고 후에 클라이언트에서 객체를 만들어<br />
점수를 넣고 테스트하려고 만든 클래스이다.</p>

<p><strong>&lt;NewlecService / 핵심 로직(합산,평균)&gt;</strong></p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">org.springframework.stereotype.Service</span><span class="o">;</span>

<span class="nd">@Service</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">NewlecService</span> <span class="o">{</span>

    <span class="kd">public</span> <span class="kt">int</span> <span class="nf">total</span><span class="o">(</span><span class="nc">Score</span> <span class="n">score</span><span class="o">){</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"--&gt; total method 시작"</span><span class="o">);</span>
        <span class="kt">int</span> <span class="n">result</span> <span class="o">=</span> <span class="n">score</span><span class="o">.</span><span class="na">getKor</span><span class="o">()</span>
                <span class="o">+</span><span class="n">score</span><span class="o">.</span><span class="na">getEng</span><span class="o">()</span>
                <span class="o">+</span><span class="n">score</span><span class="o">.</span><span class="na">getMath</span><span class="o">()</span>
                <span class="o">+</span><span class="n">score</span><span class="o">.</span><span class="na">getCom</span><span class="o">();</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">result</span><span class="o">);</span>
        <span class="k">try</span><span class="o">{</span>
            <span class="nc">Thread</span><span class="o">.</span><span class="na">sleep</span><span class="o">(</span><span class="mi">1000</span><span class="o">);</span>
        <span class="o">}</span><span class="k">catch</span> <span class="o">(</span><span class="nc">Exception</span> <span class="n">e</span><span class="o">){</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">e</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="n">result</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">float</span> <span class="nf">avg</span><span class="o">(</span><span class="nc">Score</span> <span class="n">score</span><span class="o">){</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"--&gt; avg method 시작"</span><span class="o">);</span>
        <span class="kt">float</span> <span class="n">result</span> <span class="o">=</span> <span class="o">(</span><span class="n">score</span><span class="o">.</span><span class="na">getKor</span><span class="o">()</span>
                <span class="o">+</span><span class="n">score</span><span class="o">.</span><span class="na">getEng</span><span class="o">()</span>
                <span class="o">+</span><span class="n">score</span><span class="o">.</span><span class="na">getMath</span><span class="o">()</span>
                <span class="o">+</span><span class="n">score</span><span class="o">.</span><span class="na">getCom</span><span class="o">())</span> <span class="o">/</span> <span class="mf">4.0f</span><span class="o">;</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">result</span><span class="o">);</span>
        <span class="k">try</span><span class="o">{</span>
            <span class="nc">Thread</span><span class="o">.</span><span class="na">sleep</span><span class="o">(</span><span class="mi">2000</span><span class="o">);</span>
        <span class="o">}</span><span class="k">catch</span> <span class="o">(</span><span class="nc">Exception</span> <span class="n">e</span><span class="o">){</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">e</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="n">result</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>Java 코드로 작성한 Score.class와 동일한 부분이다.<br />
메서드 실행시 코멘트로 알려주고 쓰레드 딜레이를 넣어<br />
메서드 실행 시간을 늘려주었다.<br />
@Service를 이용해 Bean에 등록해 스프링 컨테이너가 관리한다.</p>

<p><strong>&lt;TimeTraceAop.class / 공통 관심 코드&gt;</strong></p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">org.aspectj.lang.ProceedingJoinPoint</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.aspectj.lang.annotation.Around</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.aspectj.lang.annotation.Aspect</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.stereotype.Component</span><span class="o">;</span>

<span class="nd">@Aspect</span> <span class="c1">// AOP</span>
<span class="nd">@Component</span> <span class="c1">// Bean 등록</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">TimeTraceAop</span> <span class="o">{</span>

    <span class="nd">@Around</span><span class="o">(</span><span class="s">"execution(* com.AopExample.Aop_Example..*(..))"</span><span class="o">)</span>
     <span class="kd">public</span> <span class="nc">Object</span> <span class="nf">execute</span><span class="o">(</span><span class="nc">ProceedingJoinPoint</span> <span class="n">joinPoint</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">Throwable</span><span class="o">{</span>
        <span class="kt">long</span> <span class="n">start</span> <span class="o">=</span> <span class="nc">System</span><span class="o">.</span><span class="na">currentTimeMillis</span><span class="o">();</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"START: "</span> <span class="o">+</span> <span class="mi">0</span>  <span class="o">+</span> <span class="s">"ms"</span> <span class="o">+</span> <span class="s">" / "</span> <span class="o">+</span><span class="n">getClass</span><span class="o">());</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="k">return</span> <span class="n">joinPoint</span><span class="o">.</span><span class="na">proceed</span><span class="o">();</span>
        <span class="o">}</span><span class="k">finally</span> <span class="o">{</span>

            <span class="kt">long</span> <span class="n">end</span> <span class="o">=</span> <span class="nc">System</span><span class="o">.</span><span class="na">currentTimeMillis</span><span class="o">();</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"END: "</span> <span class="o">+</span> <span class="o">(</span><span class="n">end</span><span class="o">-</span><span class="n">start</span><span class="o">)</span> <span class="o">+</span> <span class="s">"ms"</span> <span class="o">+</span> <span class="s">" / "</span> <span class="o">+</span> <span class="n">getClass</span><span class="o">());</span>
        <span class="o">}</span>
     <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>동일하게 시간을 측정하는 공통관심 클래스이다.<br />
@Aspect 어노테이션으로 AOP 사용을 알려주고<br />
@Component로 Bean을 등록했다.</p>

<p>@Around Adive타입을 이용해 메서드를 만들었고<br />
Pointcut은 Aop_Example 패키지 전체를 메서드로 지정했다.<br />
joinPoint.proceed();를 이용해 메서드를 호출하고 있고<br />
위 아래에 시간을 측정하는 코드를 두었다.</p>

<p><strong>&lt;AopExampleApplication.class / 스프링 부트실행, 클라이언트코드&gt;</strong></p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">com.AopExample.Aop_Example.aopSpring.NewlecService</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.AopExample.Aop_Example.aopSpring.Score</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.boot.SpringApplication</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.boot.autoconfigure.SpringBootApplication</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.context.ApplicationContext</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.context.annotation.AnnotationConfigApplicationContext</span><span class="o">;</span>

<span class="nd">@SpringBootApplication</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">AopExampleApplication</span> <span class="o">{</span>
   <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
      <span class="nc">SpringApplication</span><span class="o">.</span><span class="na">run</span><span class="o">(</span><span class="nc">AopExampleApplication</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">args</span><span class="o">);</span>
      <span class="nc">ApplicationContext</span> <span class="n">applicationContext</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">AnnotationConfigApplicationContext</span><span class="o">(</span><span class="nc">AopExampleApplication</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
      <span class="nc">NewlecService</span> <span class="n">newlecService</span> <span class="o">=</span> <span class="n">applicationContext</span><span class="o">.</span><span class="na">getBean</span><span class="o">(</span><span class="s">"newlecService"</span><span class="o">,</span> <span class="nc">NewlecService</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>

      <span class="nc">Score</span> <span class="n">myScore</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Score</span><span class="o">(</span><span class="mi">100</span><span class="o">,</span><span class="mi">80</span><span class="o">,</span><span class="mi">80</span><span class="o">,</span><span class="mi">90</span><span class="o">);</span>

      <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"======================="</span><span class="o">);</span>
      <span class="n">newlecService</span><span class="o">.</span><span class="na">total</span><span class="o">(</span><span class="n">myScore</span><span class="o">);</span>
      <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"======================="</span><span class="o">);</span>
      <span class="n">newlecService</span><span class="o">.</span><span class="na">avg</span><span class="o">(</span><span class="n">myScore</span><span class="o">);</span>
      <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"======================="</span><span class="o">);</span>
   <span class="o">}</span>
<span class="o">}</span>
<span class="cm">/* 출력
=======================
START: 0ms / class com.AopExample.Aop_Example.aopSpring.TimeTraceAop
--&gt; total method 시작
350
END: 1029ms / class com.AopExample.Aop_Example.aopSpring.TimeTraceAop
=======================
START: 0ms / class com.AopExample.Aop_Example.aopSpring.TimeTraceAop
--&gt; avg method 시작
87.5
END: 2006ms / class com.AopExample.Aop_Example.aopSpring.TimeTraceAop
=======================
*/</span>
</code></pre></div></div>

<p>스프링 부트 실행 클래스 아래에 클라이언트 요청 코드도 같이두었다.<br />
Java코드로 작성한 것과 다른점은 Java코드에선 proxy 객체를 이용했고<br />
Spring은 스프링컨테이너(ApplicationContext)에서<br />
.getBean으로 객체를 가져와 컨테이너에 있는 객체로 메서드를 호출했다.</p>

<p>현재 스프링 컨테이너에 등록된 Bean은<br />
com.AopExample.Aop_Example.AopExampleApplication$$EnhancerBySpringCGLIB$$62eea1e6@236ab296<br />
com.AopExample.Aop_Example.aopSpring.NewlecService@5c84624f<br />
com.AopExample.Aop_Example.aopSpring.TimeTraceAop@63034ed1<br />
이렇게 3개로 확인해볼 수 있다.</p>

<p>AopExampleApplication은 뒤에 EnhancerBy~~이렇게 붙여져있는데<br />
스프링에 빈을 등록할때 바이트 코드를 조작한 객체가 스프링 컨테이너에 등록되기 때문이다.<br />
AOP 기술과 싱글톤 보장의 이유기도하다.<br />
@Configuration도 동일한 기능을 제공해주고<br />
@SpringBootApplication을 사용하였기때문에 내부에<br />
@SpringBootConfiguration이 있기 때문에 위와 같이 바이트 코드가 조작된 객체로 보이는 것이다.</p>

<hr />

<p>오늘은 이렇게 Pointcut 표현식과 JoinPoint에 대해 간단히 알아봤고<br />
Java로 작성한 AOP기술을 이용한 예제와<br />
Spring으로 작성한 AOP기술을 이용한 예제<br />
이렇게 2개를 비교해서 알아보았다.<br />
동일한 동작을 하는 코드로 작성하였고<br />
이렇게 두개를 비교하면서 프로그램을 타이핑해보니<br />
조금더 이해가 쏙쏙되는 느낌이다.</p>

<p>오늘 공부는 여기서 끝!</p>

<p><br /></p>

<p><span style="color:#994C00"><strong>오늘의 커피량</strong></span>: ☕️ ☕️ ☕️ ☕️<br />
<strong>오늘의 점심</strong>: 제육볶음, 밥</p>]]></content><author><name>LEE JAEHYEOK</name></author><category term="TIL" /><category term="TIL" /><category term="부트캠프" /><category term="코드스테이츠" /><summary type="html"><![CDATA[올해 처음으로 늦잠을 자 지각을 해버렸다..]]></summary></entry><entry><title type="html">TIL) Spring AOP 1</title><link href="http://localhost:4000/til/2022/10/17/til.html" rel="alternate" type="text/html" title="TIL) Spring AOP 1" /><published>2022-10-17T00:00:00+09:00</published><updated>2022-10-17T00:00:00+09:00</updated><id>http://localhost:4000/til/2022/10/17/til</id><content type="html" xml:base="http://localhost:4000/til/2022/10/17/til.html"><![CDATA[<p>스펙타클한 주말이었다.<br />
물론 나는 아니지만 카카오 서버가 죽어버리는 일이 생겼다…</p>

<p><img src="https://ifh.cc/g/DnZoyl.gif" align="left" width="350px" height="250px" />
<br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /></p>

<p>화재로 인해 전기를 내려서 서버가 죽었고<br />
장애가 생겨 거의 하루종일 서비스 이용이 안되고<br />
어떤사람은 전동킥보드를 빌렸는데 서비스장애로<br />
돈이 10만원 넘게 청구되었단다 ㅋㅋㅋㅋ</p>

<p>뭔가 남일 같지만은 않은…<br />
나중에 내가 어떤회사의 서비스를 맡고 저런일이 생긴다면<br />
정말 힘든 나날이 될 것 같다…</p>

<hr />

<p>여하튼 오늘은 AOP에 대해 공부하는 날이다.<br />
AOP는 이론은 정말 간단 한거 같은데<br />
어떻게 스프링을 이용해 적용하는지가 가장 궁금하다.<br />
공부를 시작해보자</p>

<h3 id="aop"><strong>AOP</strong></h3>

<p>Aspect Oriented Programming의 약자이다.<br />
이전에도 알아보았지만 관심지향 프로그래밍으로<br />
모듈화의 핵심 단위를 관점으로 작성하는 프로그래밍이다.<br />
OOP방식의 불필요한 반복을 해결하기 위한 방법이다.</p>

<p>간단하게 생각하자면<br />
한가지의 기능을 여러가지 메소드에 쓰고싶을때<br />
같은 코드를 여러번 작성하면 코드 길이가 길어지고<br />
추후 수정이 필요할때 전부 수정하는 번거로움이 있기 때문에<br />
하나의 관심기능으로 묶어 기존의 코드를 손대지 않고<br />
그 기능들을 적용해서 사용할 수 있는 방식을 얘기하는 것이다.</p>

<ol>
  <li>
    <p><strong>핵심 관심 사항 (core concern)</strong><br />
-. 객체가 제공하는 고유의 기능이다. (업무 로직 등..)</p>
  </li>
  <li>
    <p><strong>공통 관심 사항 (cross-cutting concern)</strong><br />
-. 핵심 기능을 보조하기 위해 제공되는 기능이다.<br />
-. 주로 로그 추적로직, 트랜잭션, 보안 기능 등이 있다.</p>
  </li>
</ol>

<p>AOP 기술을 사용하기전에 용어에 익숙해지기위해<br />
관련 용어에 대한 내용을 알아보자</p>

<p><img src="https://ifh.cc/g/N89VNm.png" align="left" width="400px" height="250px" />
<br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /></p>

<p><strong>Aspect</strong><br />
-. 여러 객체에 공통으로 적용되는 기능</p>

<p><strong>Pointcut</strong><br />
-. JoinPoint 중에서 Advice가 적용될 위치를 선별하는 기능<br />
-. 관심 JoinPoint를 결정하므로, Advice가 실행되는 시기를 제어할 수 있다.</p>

<p><strong>JoinPoint</strong><br />
-. 애플리케이션 실행 흐름에서의 특정 포인트를 의미한다 (클래스 초기화, 메소드 호출 etc..)<br />
-. Spring은 프록시 방식을 사용하여 JoinPoint는 항상 메소드 실행 지점으로 제한된다.</p>

<p><strong>Advice</strong><br />
-. JointPoint에서 수행되는 코드</p>

<p>위 내용만 종합해보면<br />
Advice라는 코드로 적용해야할 대상인 JoinPoint들에서<br />
우리가 Pointcut으로 적용할 놈들만 지정해준다. 라고 이해를 했다.</p>

<p>즉, 내가 생각하기엔<br />
Advice : 공통 적용 코드<br />
JoinPoint : 프로그램 내 모든 메소드<br />
Pointcut : 모든 메소드에서 내가 적용하고 싶은 것만 선택<br />
이라고 생각이 든달까나..?</p>

<p>그 외에 다른 용어 들도 있다.</p>

<p><strong>Weaving</strong><br />
-. Pointcut으로 결정한 타겟의 JoinPoint에 Advice를 적용하는 것을 뜻함<br />
-. 즉, 공통 적용 코드를 비지니스 로직에 적용한다는 의미<br />
-. 간단하게 프록시 방식을 통해서 AOP가 구현되는 과정</p>

<p><strong>AOP proxy</strong><br />
-. AOP 기능을 구현하기 위해 만든 가짜 객체이다.<br />
-. Spring에서 AOP proxy는 JDK동적 프록시, CGLIB 프록시 이다.</p>

<h4 id="advice-종류"><strong>Advice 종류</strong></h4>
<p>@Before, @AfterReturning, @Afterthrowing, @After, @Around …<br />
위에 애노테이션정도가 종류에 포함되어있곡<br />
가장 강력한 Advice는 @Around이다. 이것하나만 있어도 위에 모든 기능을 제공한다.<br />
하지만 모든기능을 제공하는 만큼 개발자의 실수 유발이 가능하므로<br />
상황에 맞는 Advice를 사용하자</p>

<p>테스트를 위해 계산기 프로그램을 만들어 사용해보자</p>

<p><strong>&lt;계산기 메인 프로그램, 빈등록해서 관리&gt;</strong></p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Service</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">NewCalculate</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kt">int</span> <span class="nf">add</span> <span class="o">(</span><span class="kt">int</span> <span class="n">x</span><span class="o">,</span> <span class="kt">int</span> <span class="n">y</span><span class="o">){</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"--&gt; Methode 실행 : add"</span><span class="o">);</span>
        <span class="k">return</span> <span class="n">x</span><span class="o">+</span><span class="n">y</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kt">int</span> <span class="nf">sub</span> <span class="o">(</span><span class="kt">int</span> <span class="n">x</span><span class="o">,</span> <span class="kt">int</span> <span class="n">y</span><span class="o">){</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"--&gt; Methode 실행 : sub"</span><span class="o">);</span>
        <span class="k">return</span> <span class="n">x</span><span class="o">-</span><span class="n">y</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kt">int</span> <span class="nf">mul</span> <span class="o">(</span><span class="kt">int</span> <span class="n">x</span><span class="o">,</span> <span class="kt">int</span> <span class="n">y</span><span class="o">){</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"--&gt; Methode 실행 : mul"</span><span class="o">);</span>
        <span class="k">return</span> <span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kt">double</span> <span class="nf">div</span> <span class="o">(</span><span class="kt">int</span> <span class="n">x</span><span class="o">,</span> <span class="kt">int</span> <span class="n">y</span><span class="o">){</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"--&gt; Methode 실행 : div"</span><span class="o">);</span>
        <span class="k">return</span> <span class="o">(</span><span class="kt">double</span><span class="o">)</span> <span class="n">x</span><span class="o">/</span><span class="n">y</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p><strong>&lt;AOP 적용 프로그램, 빈등록해서 관리&gt;</strong></p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Aspect</span>
<span class="nd">@Component</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">AspectCalculate</span> <span class="o">{</span>
    <span class="c1">// 변경될 내용들 @Before, @After ~~</span>
<span class="o">}</span>
</code></pre></div></div>

<p><strong>&lt;Test 실행 프로그램, Junit5&gt;</strong></p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@SpringBootTest</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">TestCalcualte</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="nc">NewCalculate</span> <span class="n">newCalculate</span><span class="o">;</span>

    <span class="nd">@Autowired</span>
    <span class="kd">public</span> <span class="nf">TestCalcualte</span><span class="o">(</span><span class="nc">NewCalculate</span> <span class="n">newCalculate</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">newCalculate</span> <span class="o">=</span> <span class="n">newCalculate</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@Test</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">addTest</span><span class="o">(){</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">newCalculate</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="mi">100</span><span class="o">,</span><span class="mi">50</span><span class="o">));</span>
    <span class="o">}</span>
    <span class="nd">@Test</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">subTest</span><span class="o">(){</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">newCalculate</span><span class="o">.</span><span class="na">sub</span><span class="o">(</span><span class="mi">100</span><span class="o">,</span><span class="mi">50</span><span class="o">));</span>
    <span class="o">}</span>
    <span class="nd">@Test</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">divTest</span><span class="o">(){</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">newCalculate</span><span class="o">.</span><span class="na">div</span><span class="o">(</span><span class="mi">100</span><span class="o">,</span><span class="mi">50</span><span class="o">));</span>
    <span class="o">}</span>
    <span class="nd">@Test</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">mulTest</span><span class="o">(){</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">newCalculate</span><span class="o">.</span><span class="na">mul</span><span class="o">(</span><span class="mi">100</span><span class="o">,</span><span class="mi">50</span><span class="o">));</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>2개의 클래스는 java 폴더에<br />
1개의 클래스는 test 폴더에 넣어 테스트용 프로그램을 만들었다.<br />
4개의 메소드를 호출할때 AOP적용된 프로그램이<br />
어떻게 동작하는지 보자</p>

<p><em><strong>@Before</strong></em><br />
1). 조인 포인트 실행 이전에 실행한다.<br />
2). Advice를 구현한 메서드는 일반적으로 리턴타입이 void이다.<br />
3). 메서드에서 예외를 발생시킬 경우 대상 객체의 메서드가 호출되지 않는다.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Aspect</span>
<span class="nd">@Component</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">AspectCalculate</span> <span class="o">{</span>
    <span class="nd">@Before</span><span class="o">(</span><span class="s">"execution(* com.aop.section2aopcalculate..*(..))"</span><span class="o">)</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">beforeLog</span><span class="o">(</span><span class="nc">JoinPoint</span> <span class="n">joinPoint</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"--&gt; Aspect 실행 : "</span> <span class="o">+</span> <span class="n">joinPoint</span><span class="o">.</span><span class="na">getSignature</span><span class="o">().</span><span class="na">getName</span><span class="o">());</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="c1">//출력</span>
<span class="o">--&gt;</span> <span class="nc">Aspect</span> <span class="n">실행</span> <span class="o">:</span> <span class="n">sub</span>
<span class="o">--&gt;</span> <span class="nc">Methode</span> <span class="n">실행</span> <span class="o">:</span> <span class="n">sub</span>
<span class="mi">50</span>
<span class="o">--&gt;</span> <span class="nc">Aspect</span> <span class="n">실행</span> <span class="o">:</span> <span class="n">add</span>
<span class="o">--&gt;</span> <span class="nc">Methode</span> <span class="n">실행</span> <span class="o">:</span> <span class="n">add</span>
<span class="mi">150</span>
<span class="o">--&gt;</span> <span class="nc">Aspect</span> <span class="n">실행</span> <span class="o">:</span> <span class="n">mul</span>
<span class="o">--&gt;</span> <span class="nc">Methode</span> <span class="n">실행</span> <span class="o">:</span> <span class="n">mul</span>
<span class="mi">5000</span>
<span class="o">--&gt;</span> <span class="nc">Aspect</span> <span class="n">실행</span> <span class="o">:</span> <span class="n">div</span>
<span class="o">--&gt;</span> <span class="nc">Methode</span> <span class="n">실행</span> <span class="o">:</span> <span class="n">div</span>
<span class="mf">2.0</span>
</code></pre></div></div>

<p>보는 것과 같이 메서드가 실행되기전에<br />
Aspect 실행 문구가 출력되는 것을 볼 수있다.</p>

<p><em><strong>@After</strong></em><br />
1). 조인 포인트의 메서드 예외나 정상과는 상관없이 실행한다.<br />
2). 메서드 실행 완료 후 공통 기능 실행을 한다.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Aspect</span>
<span class="nd">@Component</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">AspectCalculate</span> <span class="o">{</span>
    <span class="nd">@After</span><span class="o">(</span><span class="s">"execution(* com.aop.section2aopcalculate..*(..))"</span><span class="o">)</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">AfterLog</span><span class="o">(</span><span class="nc">JoinPoint</span> <span class="n">joinPoint</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"--&gt; Aspect 실행 : "</span> <span class="o">+</span> <span class="n">joinPoint</span><span class="o">.</span><span class="na">getSignature</span><span class="o">().</span><span class="na">getName</span><span class="o">());</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="c1">//출력</span>
<span class="o">--&gt;</span> <span class="nc">Methode</span> <span class="n">실행</span> <span class="o">:</span> <span class="n">sub</span>
<span class="o">--&gt;</span> <span class="nc">Aspect</span> <span class="n">실행</span> <span class="o">:</span> <span class="n">sub</span>
<span class="mi">50</span>
<span class="o">--&gt;</span> <span class="nc">Methode</span> <span class="n">실행</span> <span class="o">:</span> <span class="n">add</span>
<span class="o">--&gt;</span> <span class="nc">Aspect</span> <span class="n">실행</span> <span class="o">:</span> <span class="n">add</span>
<span class="mi">150</span>
<span class="o">--&gt;</span> <span class="nc">Methode</span> <span class="n">실행</span> <span class="o">:</span> <span class="n">mul</span>
<span class="o">--&gt;</span> <span class="nc">Aspect</span> <span class="n">실행</span> <span class="o">:</span> <span class="n">mul</span>
<span class="mi">5000</span>
<span class="o">--&gt;</span> <span class="nc">Methode</span> <span class="n">실행</span> <span class="o">:</span> <span class="n">div</span>
<span class="o">--&gt;</span> <span class="nc">Aspect</span> <span class="n">실행</span> <span class="o">:</span> <span class="n">div</span>
<span class="mf">2.0</span>
</code></pre></div></div>

<p>각 메서드들이 실행 완료된 후에<br />
Aspect 실행 문구 출력되는 것을 볼 수 있다.</p>

<p><strong>@AfterReturning</strong><br />
1). 조인 포인트 실행 완료 후 실행한다.<br />
2). 메서드가 예외 없이 실행된 이후 공통 기능을 실행</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Aspect</span>
<span class="nd">@Component</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">AspectCalculate</span> <span class="o">{</span>
    <span class="nd">@AfterReturning</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">"execution(* com.aop.section2aopcalculate..*(..))"</span><span class="o">,</span> <span class="n">returning</span> <span class="o">=</span> <span class="s">"value"</span><span class="o">)</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">AfterReturningLog</span><span class="o">(</span><span class="nc">JoinPoint</span> <span class="n">joinPoint</span><span class="o">,</span> <span class="nc">Object</span> <span class="n">value</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"--&gt; Aspect 실행 : "</span> <span class="o">+</span> <span class="n">joinPoint</span><span class="o">.</span><span class="na">getSignature</span><span class="o">().</span><span class="na">getName</span><span class="o">());</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"--&gt; returning = "</span> <span class="o">+</span> <span class="n">value</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="c1">//출력</span>
<span class="o">--&gt;</span> <span class="nc">Methode</span> <span class="n">실행</span> <span class="o">:</span> <span class="n">sub</span>
<span class="o">--&gt;</span> <span class="nc">Aspect</span> <span class="n">실행</span> <span class="o">:</span> <span class="n">sub</span>
<span class="o">--&gt;</span> <span class="n">returning</span> <span class="o">=</span> <span class="mi">50</span>
<span class="mi">50</span>
<span class="o">--&gt;</span> <span class="nc">Methode</span> <span class="n">실행</span> <span class="o">:</span> <span class="n">add</span>
<span class="o">--&gt;</span> <span class="nc">Aspect</span> <span class="n">실행</span> <span class="o">:</span> <span class="n">add</span>
<span class="o">--&gt;</span> <span class="n">returning</span> <span class="o">=</span> <span class="mi">150</span>
<span class="mi">150</span>
<span class="o">--&gt;</span> <span class="nc">Methode</span> <span class="n">실행</span> <span class="o">:</span> <span class="n">mul</span>
<span class="o">--&gt;</span> <span class="nc">Aspect</span> <span class="n">실행</span> <span class="o">:</span> <span class="n">mul</span>
<span class="o">--&gt;</span> <span class="n">returning</span> <span class="o">=</span> <span class="mi">5000</span>
<span class="mi">5000</span>
<span class="o">--&gt;</span> <span class="nc">Methode</span> <span class="n">실행</span> <span class="o">:</span> <span class="n">div</span>
<span class="o">--&gt;</span> <span class="nc">Aspect</span> <span class="n">실행</span> <span class="o">:</span> <span class="n">div</span>
<span class="o">--&gt;</span> <span class="n">returning</span> <span class="o">=</span> <span class="mf">2.0</span>
<span class="mf">2.0</span>
</code></pre></div></div>

<p>After와 다른점은 returning로 값을 활용할 수가 있다.<br />
위에 예제에서 프린트문을 하나더 추가했고<br />
value라는 변수에 담아 출력하였다.<br />
메서드의 반환값을 출력한 모습을 볼 수 있다.</p>

<p><strong>@AfterThrowing</strong><br />
1). 메서드가 예외를 던지는 경우 실행한다.<br />
2). 메서드를 실행하는 도중 예외가 발생한 경우 공통 기능을 실행한다.<br />
이경우에는 강제로 예외처리를 만들어야한다.</p>

<p>간단하게 add함수에다 만들어서 진행해보자</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kt">int</span> <span class="nf">add</span> <span class="o">(</span><span class="kt">int</span> <span class="n">x</span><span class="o">,</span> <span class="kt">int</span> <span class="n">y</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
    <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"--&gt; Methode 실행 : add"</span><span class="o">);</span>
    <span class="k">if</span><span class="o">(</span><span class="n">x</span><span class="o">+</span><span class="n">y</span><span class="o">&gt;</span><span class="mi">101</span><span class="o">)</span> <span class="k">throw</span> <span class="k">new</span> <span class="nc">Exception</span><span class="o">(</span><span class="s">"예외"</span><span class="o">);</span>
    <span class="k">return</span> <span class="n">x</span><span class="o">+</span><span class="n">y</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div></div>

<p>기존 코드에서 예외처리만 추가했다 x+y값이 101보다 크면<br />
“예외”를 던져주게 프로그램을 작성했다.<br />
예외가 추가됨에따라 기존 Test 코드에도 임시로 throws Exception를<br />
달아주면 정상적으로 테스트코드가 동작할 것이다.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Test</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">addTest</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
    <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">newCalculate</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="mi">100</span><span class="o">,</span><span class="mi">50</span><span class="o">));</span>
<span class="o">}</span>
</code></pre></div></div>

<p>이제 준비는 되었으니 예외 발생시 받을 변수 ex를 설정하고 출력구문을 넣어<br />
AfterThrowing를 적용하여 작동시켜보자.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Aspect</span>
<span class="nd">@Component</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">AspectCalculate</span> <span class="o">{</span>
    <span class="nd">@AfterThrowing</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">"execution(* com.aop.section2aopcalculate..*(..))"</span><span class="o">,</span> <span class="n">throwing</span> <span class="o">=</span> <span class="s">"ex"</span><span class="o">)</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">AfterThrowingLog</span><span class="o">(</span><span class="nc">JoinPoint</span> <span class="n">joinPoint</span><span class="o">,</span> <span class="nc">Exception</span> <span class="n">ex</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"--&gt; Aspect 실행 : "</span> <span class="o">+</span> <span class="n">joinPoint</span><span class="o">.</span><span class="na">getSignature</span><span class="o">().</span><span class="na">getName</span><span class="o">());</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"--&gt; Exception = "</span> <span class="o">+</span> <span class="n">ex</span><span class="o">.</span><span class="na">getMessage</span><span class="o">());</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="c1">//출력</span>
<span class="o">--&gt;</span> <span class="nc">Methode</span> <span class="n">실행</span> <span class="o">:</span> <span class="n">sub</span>
<span class="mi">50</span>
<span class="o">--&gt;</span> <span class="nc">Methode</span> <span class="n">실행</span> <span class="o">:</span> <span class="n">add</span>
<span class="o">--&gt;</span> <span class="nc">Aspect</span> <span class="n">실행</span> <span class="o">:</span> <span class="n">add</span>
<span class="o">--&gt;</span> <span class="nc">Exception</span> <span class="o">=</span> <span class="n">예외</span>
<span class="o">--&gt;</span> <span class="nc">Methode</span> <span class="n">실행</span> <span class="o">:</span> <span class="n">mul</span>
<span class="mi">5000</span>
<span class="o">--&gt;</span> <span class="nc">Methode</span> <span class="n">실행</span> <span class="o">:</span> <span class="n">div</span>
<span class="mf">2.0</span>
</code></pre></div></div>

<p>위의 출력을 보면 알 수 있듯이<br />
sub,mul,div 메서드들은 공통코드인 Aspect코드들이<br />
적용되어 출력되지 않은 모습이다.</p>

<p>오직 add 메서드에서만 예외라는 출력구문이 출력되었다.<br />
즉 예외가 발생한 메서드의 값을 사용할 수 있다는 뜨읏~<br />
그리고 메서드 실행 완료후 Aspect코드가 실행되었다는 점!</p>

<p><strong>@Around</strong><br />
1). 위에 얘기했듯이 이 문법하나로 위에 있는 것들 전부 동작이 가능하다.<br />
호출 전후에 수행이 가능하며 조인 포인트 실행여부 선택, 반환 값 변환, 예외 변환 등이 가능하다.</p>

<p>2). 메서드 실행 전,후, 예외 발생 시점에 공통 기능을 실행한다.<br />
조인 포인트 실행 여부 - joinPoint.proceed()<br />
전달 값 변환 - joinPoint.proceed(args[])<br />
try ~ catch ~ finally 구문처리 가능<br />
다른 얘들과는 다르게 ProceedingJoinPoint 타입을 사용해야한다.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Aspect</span>
<span class="nd">@Component</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">AspectCalculate</span> <span class="o">{</span>
    <span class="nd">@Around</span><span class="o">(</span><span class="s">"execution(* com.aop.section2aopcalculate..*(..))"</span><span class="o">)</span>
    <span class="kd">public</span> <span class="nc">Object</span> <span class="nf">AroundLog</span><span class="o">(</span><span class="nc">ProceedingJoinPoint</span> <span class="n">joinPoint</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">Throwable</span><span class="o">{</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"--&gt; Aspect 실행 : "</span> <span class="o">+</span> <span class="n">joinPoint</span><span class="o">.</span><span class="na">getSignature</span><span class="o">().</span><span class="na">getName</span><span class="o">());</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="k">return</span> <span class="n">joinPoint</span><span class="o">.</span><span class="na">proceed</span><span class="o">();</span>
        <span class="o">}</span><span class="k">finally</span> <span class="o">{</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"--&gt; Aspect 종료 : "</span> <span class="o">+</span> <span class="n">joinPoint</span><span class="o">.</span><span class="na">getSignature</span><span class="o">().</span><span class="na">getName</span><span class="o">());</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="c1">//출력</span>
<span class="o">--&gt;</span> <span class="nc">Aspect</span> <span class="n">실행</span> <span class="o">:</span> <span class="n">sub</span>
<span class="o">--&gt;</span> <span class="nc">Methode</span> <span class="n">실행</span> <span class="o">:</span> <span class="n">sub</span>
<span class="o">--&gt;</span> <span class="nc">Aspect</span> <span class="n">종료</span> <span class="o">:</span> <span class="n">sub</span>
<span class="mi">50</span>
<span class="o">--&gt;</span> <span class="nc">Aspect</span> <span class="n">실행</span> <span class="o">:</span> <span class="n">add</span>
<span class="o">--&gt;</span> <span class="nc">Methode</span> <span class="n">실행</span> <span class="o">:</span> <span class="n">add</span>
<span class="o">--&gt;</span> <span class="nc">Aspect</span> <span class="n">종료</span> <span class="o">:</span> <span class="n">add</span>
<span class="mi">150</span>
<span class="o">--&gt;</span> <span class="nc">Aspect</span> <span class="n">실행</span> <span class="o">:</span> <span class="n">mul</span>
<span class="o">--&gt;</span> <span class="nc">Methode</span> <span class="n">실행</span> <span class="o">:</span> <span class="n">mul</span>
<span class="o">--&gt;</span> <span class="nc">Aspect</span> <span class="n">종료</span> <span class="o">:</span> <span class="n">mul</span>
<span class="mi">5000</span>
<span class="o">--&gt;</span> <span class="nc">Aspect</span> <span class="n">실행</span> <span class="o">:</span> <span class="n">div</span>
<span class="o">--&gt;</span> <span class="nc">Methode</span> <span class="n">실행</span> <span class="o">:</span> <span class="n">div</span>
<span class="o">--&gt;</span> <span class="nc">Aspect</span> <span class="n">종료</span> <span class="o">:</span> <span class="n">div</span>
<span class="mf">2.0</span>
</code></pre></div></div>

<p>위에 예제에서 볼 수 있듯이<br />
joinPoint.procced(); 위,아래로 출력문을 넣어<br />
실행과 종료시점을 적어 두었다.<br />
그렇게 적어놓고 출력해본 결과…</p>

<p>위와 같이 출력된 걸 볼 수 있다.</p>

<p>즉, joinPoint.procced();의 흐름을 제어함에 따라<br />
우리가 원하는 출력시점을 정할 수 있다는점?<br />
이 예제는 하나의 메서드의 실행 시간을 측정하는 프로그램 같은<br />
예제에서 조금 더 어울리는 것 같다는 생각이 든다.</p>

<hr />

<p>오늘 AOP 공부는 여기까지!!<br />
정말 간단한 예제로 내가 직접 만들어서<br />
테스트를 해보면서 이래저래 알아보는 시간을 가졌다.<br />
내일은 다른 예제로 AOP사용법을 좀 더 익숙하게 적용을 해보자</p>

<p><br /></p>

<p><span style="color:#994C00"><strong>오늘의 커피량</strong></span>: ☕️ ☕️ ☕️ <br />
<strong>오늘의 점심</strong>: 제육볶음, 밥</p>]]></content><author><name>LEE JAEHYEOK</name></author><category term="TIL" /><category term="TIL" /><category term="부트캠프" /><category term="코드스테이츠" /><summary type="html"><![CDATA[스펙타클한 주말이었다. 물론 나는 아니지만 카카오 서버가 죽어버리는 일이 생겼다…]]></summary></entry></feed>